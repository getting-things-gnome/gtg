cscope 15 $HOME/Documents/git/new_gtg/gtg/GTG               0000851441
	@__init__.py

1 #!/
u¤
/
bš
/
’v
 
pythÚ3


2 #-*- 
codšg
: 
utf
-8 -*-

4 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


5 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


6 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


7 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


8 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


10 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


11 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


12 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


14 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


15 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
G‘tšg
 
Thšgs
 
	gGNOME
! 
A
 
³rsÚ®
 
Ügªiz”
 
the
 
GNOME
 
	gdesktİ


21 
impÜt
 
os


22 
impÜt
 
	gloÿË


23 #F®lback 
to
 
LANG
 
C
 
unsuµÜ‹d
 
loÿË


24 
	gŒy
:

25 
loÿË
.
£oÿË
ÖoÿË.
LC_ALL
, '')

26 
	gexû±
:

27 
loÿË
.
£oÿË
ÖoÿË.
LC_ALL
, 'C')

29 
impÜt
 
	gg‘‹xt


31 #FIXME 
is
 
this
 
cÚ¡ruùiÚ
 
Ãeded
?

32 #Th”
¬e
 
mªy
 
Ùh”
 
¶aûs
 
wh”e
 
this
 
is
 
u£d


33 
	gŒy
:

34 
äom
 
xdg
.
Ba£DœeùÜy
 
impÜt
 
xdg_cÚfig_home


35 
cÚfig_home
 = 
xdg_cÚfig_home


36 
exû±
 
ImpÜtE¼Ü
:

37 
cÚfig_home
 = 
os
.
·th
.
	$dœÇme
(
__fe__
)

39 
LOCAL_ROOTDIR
 = 
os
.
·th
.
	`ab¥©h
(os.·th.
	`još
(os.·th.
	`dœÇme
(
__fe__
), '..'))

41 #T¿n¦©iÚ 
	`£tup
 (
äom
 
pyroom
)

42 
GETTEXT_DOMAIN
 = 'gtg'

43 
LOCALE_PATH
 = 
g‘‹xt
.
	$bšd‹xtdomaš
(
GETTEXT_DOMAIN
)

45 
g‘‹xt
.
	$bšd‹xtdomaš
(
GETTEXT_DOMAIN
, 
LOCALE_PATH
)

46 
g‘‹xt
.
	$‹xtdomaš
(
GETTEXT_DOMAIN
)

47 #FIXME 
£t
 
Œª¦©iÚ
 
Bud”
 
as
 
w–l
!

49 
Œª¦©iÚ
 = 
g‘‹xt
.
	$Œª¦©iÚ
(
GETTEXT_DOMAIN
, 
LOCALE_PATH
, 
çÎback
=
True
)

51 
_
 = 
Œª¦©iÚ
.
g‘‹xt


52 
ng‘‹xt
 = 
Œª¦©iÚ
.ngettext

54 #GTG 
dœeùÜ›s
 
£tup


55 
os
.
·th
.
	`isdœ
(os.·th.
	`još
(
LOCAL_ROOTDIR
, 'data')):

56 
DATA_DIR
 = 
os
.
·th
.
	`još
(
LOCAL_ROOTDIR
, 'data')

58 
DATA_DIR
 = 
LOCAL_ROOTDIR


60 #GTG 
¶ugš
 
dœ
 
£tup


61 
PLUGIN_DIR
 = [
os
.
·th
.
	`još
(
LOCAL_ROOTDIR
, 'GTG/plugins')]

63 
u£r_¶ugšs
 = 
os
.
·th
.
	`još
(
cÚfig_home
, 'gtg/plugins')

64 
os
.
·th
.
	$isdœ
(
u£r_¶ugšs
):

65 
PLUGIN_DIR
.
	`­³nd
(
u£r_¶ugšs
)

	@backends/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
Back’ds
 
¬e
 
a
 
way
 
to
 
³rmª’y
 
¡Üe
‡ 
´ojeù
 
Ú
‡ 
	gmedium


19 (
like
 
Ú
 
the
 
h¬d
 
disk
 
Ü
 oÀth
	gš‹º‘
)

20 
ªd
 
to
 
»ad
 
´ojeùs
 
äom
 
this
 
	gmedium


23 
impÜt
 
sys


24 
impÜt
 
uuid


25 
impÜt
 
	gos
.
·th


27 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


28 
äom
 
	gGTG
.
	gtoŞs
.
bÜg
 
impÜt
 
BÜg


29 
äom
 
	gGTG
.
	gback’ds
.
g’”icback’d
 
impÜt
 
G’”icBack’d


30 
äom
 
	gGTG
.
cÜe
 
impÜt
 
fœ¡run_sks


31 
äom
 
	gGTG
.
toŞs
 
impÜt
 
ş—nxml


32 
äom
 
	gGTG
.
cÜe
 
impÜt
 
CÜeCÚfig


35 
şass
 
	$Back’dFaùÜy
(
BÜg
):

37 
This
 
şass
 
hŞds
 
the
 
šfÜm©iÚ
 
about
h
back’d
 
ty³s
.

38 
Sšû
 
™
's‡boutypes,‡ll information is static. The instantiated

39 
back’ds
 
¬e
 
hªdËd
 
š
 
the
 
D©a¡Üe
.

40 
It
 
is
 
a
 
BÜg
 
wh©
 
m©‹rs
 
™s
 
Úly
 
	`¡©e
 (
_back’d_moduËs
),

41 
sšû
 
™
 
makes
 
no
 
£n£
 
of
 
k“pšg
 
muÉË
 
š¡ªûs
 oà
this
.

44 
BACKEND_PREFIX
 = "backend_"

46 
def
 
	$__š™__
(
£lf
):

48 
C»©es
 
a
 
diùiÚ¬y
 
of
 
the
 
cu¼’y
 
avaabË
 
back’d
 
moduËs


50 
BÜg
.
	$__š™__
(
£lf
)

51 
	`ha§‰r
(
£lf
, "backend_modules"):

52 #Thi 
objeù
 
has
 
®»ady
 
b“n
 
cÚ¡ruùed


54 
£lf
.
back’d_moduËs
 = {
	}
}

55 
back’d_fes
 = 
£lf
.
	$_fšd_back’d_fes
()

56 #C»©
moduË
 
Çmes


57 
moduË_Çmes
 = [
f
.
	`»¶aû
(".py", ""èà
š
 
back’d_fes
]

58 
Log
.
	`debug
("Back’d found: " + 
	$¡r
(
moduË_Çmes
))

59 #Lßd 
back’d
 
moduËs


60 
moduË_Çme
 
š
 
moduË_Çmes
:

61 
ex‹nded_moduË_Çme
 = "GTG.back’ds." + 
moduË_Çme


62 
Œy
:

63 
	$__impÜt__
(
ex‹nded_moduË_Çme
)

64 
exû±
 
ImpÜtE¼Ü
 
as
 
exû±iÚ
:

65 #Som‘hšg 
is
 
wrÚg
 
w™h
 
this
 
back’d
, 
skpšg


66 
Log
.
	`w¬nšg
("Backend %s could‚ot be†oaded: %s" %

67 (
moduË_Çme
, 
	$¡r
(
exû±iÚ
)))

69 
exû±
 
Exû±iÚ
 
as
 
exû±iÚ
:

70 #Oth” 
exû±iÚ
 
log
 
as
 
”rÜs


71 
Log
.
	`”rÜ
("Malformated backend %s: %s" %

72 (
moduË_Çme
, 
	$¡r
(
exû±iÚ
)))

75 
£lf
.
back’d_moduËs
[
moduË_Çme
] = \

76 
sys
.
moduËs
[
ex‹nded_moduË_Çme
]

78 
def
 
	$_fšd_back’d_fes
(
£lf
):

79 #Look 
back’ds
 
š
 
the
 
GTG
/back’d 
dœ


80 
this_dœ
 = 
os
.
·th
.
	$dœÇme
(
__fe__
)

81 
f’ame
 
š
 
os
.
	$li¡dœ
(
this_dœ
):

82 
is_pythÚ
 = 
f’ame
.
	`’dsw™h
(".py")

83 
has_´efix
 = 
f’ame
.
	$¡¬tsw™h
(
£lf
.
BACKEND_PREFIX
)

84 
is_pythÚ
 
ªd
 
has_´efix
:

85 
y›ld
 
f’ame


87 
def
 
	$g‘_back’d
(
£lf
, 
back’d_Çme
):

89 
R‘uºs
 
the
 
back’d
 
moduË
 thback’d 
m©chšg


90 
back’d_Çme
. 
El£
, 
»tuºs
 
nÚe


92 
back’d_Çme
 
š
 
£lf
.
back’d_moduËs
:

93  
£lf
.
back’d_moduËs
[
back’d_Çme
]

95 
Log
.
	`debug
("TryšgØlßd back’d %s, buˆçed!" % 
back’d_Çme
)

96  
NÚe


98 
def
 
	$g‘_®l_back’ds
(
£lf
):

100 
R‘uºs
 
a
 
diùiÚ¬y
 
cÚššg
 
®l
 
the
 
back’ds
 
ty³s


102  
£lf
.
back’d_moduËs


104 
def
 
	`g‘_Ãw_back’d_diù
(
£lf
, 
back’d_Çme
, 
add™iÚ®_·¿m‘”s
={
	}
}):

106 
CÚ¡ruùs
 
a
 
Ãw
 
back’d
 
š™Ÿliz©iÚ
 
diùiÚ¬y
. 
In
 
mÜe


107 
exaù
 
‹rms
, 
ü—‹s
 
a
 
	gdiùiÚ¬y
, 
cÚššg
 
®l
 
the
 
Ãûs§ry


108 
’Œ›s
 
to
 
š™Ÿlize
 
a
 
	gback’d
.

110 
back’d_Çme
 
nÙ
 
š
 
	g£lf
.
	gback’d_moduËs
:

111  
NÚe


112 
dic
 = {}

113 
moduË
 = 
£lf
.
	$g‘_back’d
(
back’d_Çme
)

114 #Difã»Á 
pids
 
¬e
 
Ãûs§ry
 
to
 
disûº
 
b‘w“n
 
back’ds
 
of
 
the
 
§me


116 
·¿m‘”s
 = 
moduË
.
Back’d
.
	$g‘_¡©ic_·¿m‘”s
()

117 #w
®l
 
the
 
·¿m‘”s
 
ªd
 
theœ
  
v®ues
 
š
 
dic


118 
·¿m_Çme
, 
·¿m_dic
 
š
 
·¿m‘”s
.
	$™ems
():

119 
dic
[
·¿m_Çme
] = 
·¿m_dic
[
G’”icBack’d
.
PARAM_DEFAULT_VALUE
]

120 
dic
["pid"] = 
	`¡r
(
uuid
.
	$uuid4
())

121 
dic
["moduË"] = 
moduË
.
Back’d
.
	$g‘_Çme
()

122 
·¿m_Çme
, 
·¿m_v®ue
 
š
 
add™iÚ®_·¿m‘”s
.
	$™ems
():

123 
dic
[
·¿m_Çme
] = 
·¿m_v®ue


124 
dic
["back’d"] = 
moduË
.
	$Back’d
(
dic
)

125  
dic


127 
def
 
	$»¡Üe_back’d_äom_xml
(
£lf
, 
dic
):

129 
FunùiÚ
 
»¡Üšg
 
a
 
back’d
 
äom
 
™s
 
xml
 
desütiÚ
.

130 
dic
 
should
 
be
 
a
 
diùiÚ¬y
 
cÚššg
 
©
 
Ëa¡
 
the
 
key


131 - "moduË", 
w™h
 
the
 
moduË
 
Çme


132 - "xmlobjeù", 
w™h
 
™s
 
xml
 
desütiÚ
.

133 
Ev”y
 
Ùh”
 
key
 
is
 
·s£d
 
as
-i 
to
 
the
 
back’d
,‡ 
·¿m‘”
.

135 
R‘uºs
 
the
 
back’d
 
š¡ªû
, 
Ü
 
NÚe
 
is
 
som‘hšg
 
gÛs
 
wrÚg


137 
nÙ
 "moduË" 
š
 
dic
 
Ü
‚ot "xmlobject" in dic:

138 
Log
.
	`debug
("Malformed backend configuration found! %s" %

139 
dic
)

140 
moduË
 = 
£lf
.
	`g‘_back’d
(
dic
["module"])

141 
moduË
 
is
 
NÚe
:

142 
Log
.
	`debug
("could‚ot†oad module for backend %s" %

143 
dic
["module"])

144  
NÚe


145 #w
pİ
 
the
 
xml
 
objeù
, 
as
 
™
 
wl
 
be
 
»dundªt
 
wh’
h
·¿m‘”s


146 #¬
£t
 
dœeùly
 
š
 
the
 
diù


147 
xp
 = 
dic
.
	`pİ
("xmlobject")

148 #Budšg 
the
 
diùiÚ¬y


149 
·¿m‘”s_¥ecs
 = 
moduË
.
Back’d
.
	$g‘_¡©ic_·¿m‘”s
()

150 
dic
["pid"] = 
	`¡r
(
xp
.
	`g‘A‰ribu‹
("pid"))

151 
·¿m_Çme
, 
·¿m_dic
 
š
 
·¿m‘”s_¥ecs
.
	$™ems
():

152 
xp
.
	$hasA‰ribu‹
(
·¿m_Çme
):

153 #w
Ãed
 
to
 
cÚv”t
 
the
 
·¿m‘”
Øth
right
 
fÜm©
.

154 #w
ãtch
 
the
 
fÜm©
 
äom
h
¡©ic_·¿m‘”s


155 
·¿m_ty³
 = 
·¿m_dic
[
G’”icBack’d
.
PARAM_TYPE
]

156 
·¿m_v®ue
 = 
G’”icBack’d
.
	`ÿ¡_·¿m_ty³_äom_¡ršg
(

157 
xp
.
	`g‘A‰ribu‹
(
·¿m_Çme
), 
·¿m_ty³
)

158 
dic
[
·¿m_Çme
] = 
·¿m_v®ue


159 #W
put
 
the
 
back’d
 
™£lf
 
š
h
diù


160 
dic
["back’d"] = 
moduË
.
	$Back’d
(
dic
)

161  
dic
["backend"]

163 
def
 
	$g‘_§ved_back’ds_li¡
(
£lf
):

164 
back’ds_dic
 = 
£lf
.
	$_»ad_back’d_cÚfigu¿tiÚ_fe
()

166 #R‘rocom·tib™y:  
back’d
 
has
 
chªged
 
Çme


167 
dic
 
š
 
back’ds_dic
:

168 
dic
["module"] == "localfile":

169 
dic
["module"] = "backend_localfile"

170 
dic
["pid"] = 
	`¡r
(
uuid
.
	$uuid4
())

171 
dic
["need_conversion"] = \

172 
dic
["xmlobjeù"].
	`g‘A‰ribu‹
("filename")

174 #Now 
th©
 
the
 
back’d
 
li¡
 
is
 
bud
, 
we
 
wl
 
cÚ¡ruù
 
them


175 
dic
 
š
 
back’ds_dic
:

176 
£lf
.
	$»¡Üe_back’d_äom_xml
(
dic
)

177 #Ià
no
 
back’d
 
avaabË
, 
we
 
ü—‹
 
a
 
Ãw
 
usšg
 
loÿlfe
. 
Xmlobjeù


178 #wÈ
be
 
fËd
 
š
 
by
 
the
 
back’d


179 
	`Ën
(
back’ds_dic
) == 0:

180 
dic
 = 
	`Back’dFaùÜy
().
	`g‘_Ãw_back’d_diù
(

182 
dic
["back’d"].
	`this_is_the_fœ¡_run
(
fœ¡run_sks
.
	$pİuÏ‹
())

183 
back’ds_dic
.
	$­³nd
(
dic
)

184  
back’ds_dic


186 
def
 
	$_»ad_back’d_cÚfigu¿tiÚ_fe
(
£lf
):

188 
R—ds
 
the
 
fe
 
desüibšg
h
cu¼’t
 
back’d
 
cÚfigu¿tiÚ


189 (
´ojeù
.
xml
è
ªd
 
»tuºs
 
a
 
li¡
 
of
 
diùiÚ¬›s
, 
—ch
 
cÚššg
:

190 - 
the
 
xml
 
objeù
 
defššg
h
back’d
 
ch¬aù”i¡ics
 
und”


192 - 
the
 
Çme
 
of
h
back’d
 
und”
 "module"

194 #R—d 
cÚfigu¿tiÚ
 
fe
, 
™
 
dÛs
 
nÙ
 
exi¡
, 
ü—‹
 
Úe


195 
d©afe
 = 
os
.
·th
.
	`još
(
	`CÜeCÚfig
().
	`g‘_d©a_dœ
(),

196 
CÜeCÚfig
.
DATA_FILE
)

197 
doc
, 
cÚfigxml
 = 
ş—nxml
.
	`İ’xmlfe
(
d©afe
, "config")

198 
xmÍrojeù
 = 
doc
.
	`g‘EËm’tsByTagName
("backend")

199 #cŞËù 
cÚfigu»d
 
back’ds


200  [{"xmlobjeù": 
xp
,

201 "moduË": 
xp
.
	`g‘A‰ribu‹
("moduË")
	}
} x°
š
 
xmÍrojeù
]

	@backends/backend_evolution.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
Back’d
 
	g¡Üšg
/
lßdšg
 
sks
 
š
 
EvŞutiÚ
 
	gTasks


21 
impÜt
 
os


22 
impÜt
 
time


23 
impÜt
 
uuid


24 
impÜt
 
d©‘ime


25 
impÜt
 
evŞutiÚ


26 
äom
 
	gd©eut
.
tz
 
impÜt
 
	gtzutc
, 
tzloÿl


28 
äom
 
GTG
 
impÜt
 
_


29 
äom
 
	gGTG
.
	gback’ds
.
g’”icback’d
 
impÜt
 
G’”icBack’d


30 
äom
 
	gGTG
.
	gback’ds
.
³riodicimpÜtback’d
 
impÜt
 
P”iodicImpÜtBack’d


31 
äom
 
	gGTG
.
	gback’ds
.
synûngše
 
impÜt
 
	gSyncEngše
, 
SyncMeme


32 
äom
 
	gGTG
.
	gcÜe
.
sk
 
impÜt
 
Task


33 
äom
 
	gGTG
.
	gtoŞs
.
š‹¼u±ibË
 
impÜt
 interruptible

34 
äom
 
	gGTG
.
	gtoŞs
.
d©es
 
impÜt
 
D©e


35 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


36 
äom
 
	gGTG
.
	gtoŞs
.
gs
 
impÜt
 
	gexŒaù_gs_äom_‹xt


38 #DiùiÚ¬› 
to
 
Œª¦©e
 
GTG
 
sks
 
š
 
EvŞutiÚ
 
Úes


39 
	g_GTG_TO_EVOLUTION_STATUS
 = \

40 {
Task
.
STA_ACTIVE
: 
evŞutiÚ
.
eÿl
.
ICAL_STATUS_CONFIRMED
,

41 
Task
.
STA_DONE
: 
evŞutiÚ
.
eÿl
.
ICAL_STATUS_COMPLETED
,

42 
Task
.
STA_DISMISSED
: 
evŞutiÚ
.
eÿl
.
ICAL_STATUS_CANCELLED
}

44 
_EVOLUTION_TO_GTG_STATUS
 = \

45 {
evŞutiÚ
.
eÿl
.
ICAL_STATUS_CONFIRMED
: 
Task
.
STA_ACTIVE
,

46 
evŞutiÚ
.
eÿl
.
ICAL_STATUS_DRAFT
: 
Task
.
STA_ACTIVE
,

47 
evŞutiÚ
.
eÿl
.
ICAL_STATUS_FINAL
: 
Task
.
STA_ACTIVE
,

48 
evŞutiÚ
.
eÿl
.
ICAL_STATUS_INPROCESS
: 
Task
.
STA_ACTIVE
,

49 
evŞutiÚ
.
eÿl
.
ICAL_STATUS_NEEDSACTION
: 
Task
.
STA_ACTIVE
,

50 
evŞutiÚ
.
eÿl
.
ICAL_STATUS_NONE
: 
Task
.
STA_ACTIVE
,

51 
evŞutiÚ
.
eÿl
.
ICAL_STATUS_TENTATIVE
: 
Task
.
STA_ACTIVE
,

52 
evŞutiÚ
.
eÿl
.
ICAL_STATUS_X
: 
Task
.
STA_ACTIVE
,

53 
evŞutiÚ
.
eÿl
.
ICAL_STATUS_COMPLETED
: 
Task
.
STA_DONE
,

54 
evŞutiÚ
.
eÿl
.
ICAL_STATUS_CANCELLED
: 
Task
.
STA_DISMISSED
}

57 
şass
 
	$Back’d
(
P”iodicImpÜtBack’d
):

59 
EvŞutiÚ
 
back’d


62 
_g’”®_desütiÚ
 = {

63 
G’”icBack’d
.
BACKEND_NAME
: "backend_evolution",

64 
G’”icBack’d
.
BACKEND_HUMAN_NAME
: 
	`_
("Evolutionasks"),

65 
G’”icBack’d
.
BACKEND_AUTHORS
: ["Luca Invernizzi"],

66 
G’”icBack’d
.
BACKEND_TYPE
: G’”icBack’d.
TYPE_READWRITE
,

67 
G’”icBack’d
.
BACKEND_DESCRIPTION
:

68 
	`_
("Lets you synchronize your GTGasks with Evolutionasks"),

69 
	}
}

71 
_¡©ic_·¿m‘”s
 = {

73 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_INT
,

74 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
: 10, },

76 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_BOOL
,

77 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
: 
True
, },

80 ###############################################################################
###Back’d 
¡ªd¬d
 
m‘hods
 ##################################################

81 ###############################################################################
 __š™__(£lf,…¬am‘”s):

83 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
	gfunùiÚ
.

84 
Lßds
 
the
 
§ved
 
¡©e
 
of
h
	gsync
, 
	gªy


86 
su³r
(
Back’d
, 
£lf
).
	$__š™__
(
·¿m‘”s
)

87 #lßdšg 
the
 
§ved
 
¡©e
 
of
h
synchrÚiz©iÚ
, 
ªy


88 
£lf
.
sync_’gše_·th
 = 
os
.
·th
.
	`još
('backends/evolution/',

89 "sync_’gše-" + 
£lf
.
	$g‘_id
())

90 
£lf
.
sync_’gše
 = s–f.
	`_lßd_pickËd_fe
(£lf.
sync_’gše_·th
,

91 
	$SyncEngše
())

92 #£t 
up
 
the
 
cÚÃùiÚ
 
to
h
evŞutiÚ
 
­i


93 
sk_³rsÚ®
 = 
evŞutiÚ
.
eÿl
.
	`li¡_sk_sourûs
()[0][1]

94 
£lf
.
_evŞutiÚ_sks
 = 
evŞutiÚ
.
eÿl
.
	$İ’_ÿËnd¬_sourû
(

95 
sk_³rsÚ®
,

96 
evŞutiÚ
.
eÿl
.
CAL_SOURCE_TYPE_TODO
)

98 
def
 
	$do_³riodic_impÜt
(
£lf
):

100 
S“
 
P”iodicImpÜtBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

102 
¡Üed_evŞutiÚ_sk_ids
 = 
	`£t
(
£lf
.
sync_’gše
.
	$g‘_®l_»mÙe
())

103 
®l_sks
 = 
£lf
.
_evŞutiÚ_sks
.
	$g‘_®l_objeùs
()

104 
cu¼’t_evŞutiÚ_sk_ids
 = 
	`£t
([
sk
.
	$g‘_uid
()

105 
sk
 
š
 
®l_sks
])

106 #Ià
™
' thv”y fœ¡imthback’d i run, it'
s
 
possibË
 
th©


107 #th
u£r
 
®»ady
 
synûd
 
his
 
sks
 
š
 
some
 
	`way
 (
but
 
we
 
dÚ
't knowhat

108 #). 
Th”efÜe
, 
we
 
©‹m±
 
to
 
šduû
 
tho£
 
sks
 
»ÏtiÚshs
 
m©chšg


109 #th
t™Ës
.

110 
£lf
.
_·¿m‘”s
["is-first-run"]:

111 
gtg_t™Ës_dic
 = {
	}
}

112 
tid
 
š
 
£lf
.
d©a¡Üe
.
	$g‘_®l_sks
():

113 
gtg_sk
 = 
£lf
.
d©a¡Üe
.
	$g‘_sk
(
tid
)

114 
nÙ
 
£lf
.
	$_gtg_sk_is_synÿbË_³r_©ched_gs
(
gtg_sk
):

116 
gtg_t™Ë
 = 
gtg_sk
.
	$g‘_t™Ë
()

117 
gtg_t™Ë
 
š
 
gtg_t™Ës_dic
:

118 
gtg_t™Ës_dic
[
gtg_sk
.
	`g‘_t™Ë
()].
	$­³nd
(
tid
)

120 
gtg_t™Ës_dic
[
gtg_sk
.
	`g‘_t™Ë
()] = [
tid
]

121 
evo_sk_id
 
š
 
cu¼’t_evŞutiÚ_sk_ids
:

122 
evo_sk
 = 
£lf
.
	$_evo_g‘_sk
(
evo_sk_id
)

123 
Œy
:

124 
tids
 = 
gtg_t™Ës_dic
[
evo_sk
.
	`g‘_summ¬y
()]

125 #w
»move
 
the
 
tid
, 
so
 
th©
 
™
 
ÿn
't be†inkedowo

126 #difã»Á 
evŞutiÚ
 
sks


127 
tid
 = 
tids
.
	$pİ
()

128 
gtg_sk
 = 
£lf
.
d©a¡Üe
.
	$g‘_sk
(
tid
)

129 
meme
 = 
	`SyncMeme
(
gtg_sk
.
	`g‘_modif›d
(),

130 
£lf
.
	`_evo_g‘_modif›d
(
evo_sk
),

132 
£lf
.
sync_’gše
.
	`»cÜd_»ÏtiÚsh
(

133 
loÿl_id
=
tid
,

134 
»mÙe_id
=
evo_sk
.
	`g‘_uid
(),

135 
meme
=meme)

136 
exû±
 
KeyE¼Ü
:

137 
·ss


138 #¨
fœ¡
 
run
 
has
 
b“n
 
com¶‘ed
 
sucûssfuÎy


139 
£lf
.
_·¿m‘”s
["is-fœ¡-run"] = 
F®£


141 
evo_sk_id
 
š
 
cu¼’t_evŞutiÚ_sk_ids
:

142 #Addšg 
ªd
 
upd©šg


143 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

144 
£lf
.
	$_´oûss_evo_sk
(
evo_sk_id
)

146 
evo_sk_id
 
š
 
¡Üed_evŞutiÚ_sk_ids
.
	$difã»nû
(

147 
cu¼’t_evŞutiÚ_sk_ids
):

148 #Removšg 
the
 
Şd
 
Úes


149 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

150 
tid
 = 
£lf
.
sync_’gše
.
	$g‘_loÿl_id
(
evo_sk_id
)

151 
£lf
.
d©a¡Üe
.
	$»que¡_sk_d–‘iÚ
(
tid
)

152 
Œy
:

153 
£lf
.
sync_’gše
.
	$b»ak_»ÏtiÚsh
(
»mÙe_id
=
evo_sk_id
)

154 
exû±
 
KeyE¼Ü
:

155 
·ss


157 
def
 
	$§ve_¡©e
(
£lf
):

159 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

161 
£lf
.
	$_¡Üe_pickËd_fe
(
£lf
.
sync_’gše_·th
, s–f.
sync_’gše
)

163 ###############################################################################
###Proûs 
sks
 #############################################################
###############################################################################
@
š‹¼u±ibË


164 
def
 
	$»move_sk
(
£lf
, 
tid
):

166 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

168 
Œy
:

169 
evo_sk_id
 = 
£lf
.
sync_’gše
.
	$g‘_»mÙe_id
(
tid
)

170 
£lf
.
	`_d–‘e_evŞutiÚ_sk
(£lf.
	$_evo_g‘_sk
(
evo_sk_id
))

171 
exû±
 
KeyE¼Ü
:

172 
·ss


173 
Œy
:

174 
£lf
.
sync_’gše
.
	$b»ak_»ÏtiÚsh
(
loÿl_id
=
tid
)

175 
exû±
:

176 
·ss


178 @
š‹¼u±ibË


179 
def
 
	$£t_sk
(
£lf
, 
sk
):

181 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

183 
tid
 = 
sk
.
	$g‘_id
()

184 
is_synÿbË
 = 
£lf
.
	$_gtg_sk_is_synÿbË_³r_©ched_gs
(
sk
)

185 
aùiÚ
, 
evo_sk_id
 = 
£lf
.
sync_’gše
.
	$ª®yze_loÿl_id
(

186 
tid
,

187 
£lf
.
d©a¡Üe
.
has_sk
,

188 
£lf
.
_evo_has_sk
,

189 
is_synÿbË
)

190 
Log
.
	`debug
('GTG->EvØ£ˆsk (%s, %s)' % (
aùiÚ
, 
is_synÿbË
))

192 
aùiÚ
 
is
 
NÚe
:

195 
aùiÚ
 =ğ
SyncEngše
.
ADD
:

196 
evo_sk
 = 
evŞutiÚ
.
eÿl
.
	$EC®CompÚ’t
(

197 
iÿl
=
evŞutiÚ
.
eÿl
.
CAL_COMPONENT_TODO
)

198 
w™h
 
£lf
.
d©a¡Üe
.
	$g‘_back’d_mu‹x
():

199 
£lf
.
_evŞutiÚ_sks
.
	$add_objeù
(
evo_sk
)

200 
£lf
.
	$_pİuÏ‹_evo_sk
(
sk
, 
evo_sk
)

201 
meme
 = 
	`SyncMeme
(
sk
.
	`g‘_modif›d
(),

202 
£lf
.
	`_evo_g‘_modif›d
(
evo_sk
),

204 
£lf
.
sync_’gše
.
	`»cÜd_»ÏtiÚsh
(

205 
loÿl_id
=
tid
, 
»mÙe_id
=
evo_sk
.
	`g‘_uid
(),

206 
meme
=meme)

208 
–if
 
aùiÚ
 =ğ
SyncEngše
.
UPDATE
:

209 
w™h
 
£lf
.
d©a¡Üe
.
	$g‘_back’d_mu‹x
():

210 
evo_sk
 = 
£lf
.
	$_evo_g‘_sk
(
evo_sk_id
)

211 
meme
 = 
£lf
.
sync_’gše
.
	`g‘_meme_äom_loÿl_id
(
sk
.
	$g‘_id
())

212 
Ãwe¡
 = 
meme
.
	`which_is_Ãwe¡
(
sk
.
	`g‘_modif›d
(),

213 
£lf
.
	$_evo_g‘_modif›d
(
evo_sk
))

214 
Ãwe¡
 == "local":

215 
£lf
.
	$_pİuÏ‹_evo_sk
(
sk
, 
evo_sk
)

216 
meme
.
	`£t_»mÙe_Ï¡_modif›d
(

217 
£lf
.
	$_evo_g‘_modif›d
(
evo_sk
))

218 
meme
.
	`£t_loÿl_Ï¡_modif›d
(
sk
.
	$g‘_modif›d
())

220 #w
sk
 
§všg
 
the
 
¡©e


223 
–if
 
aùiÚ
 =ğ
SyncEngše
.
REMOVE
:

224 
£lf
.
d©a¡Üe
.
	$»que¡_sk_d–‘iÚ
(
tid
)

225 
Œy
:

226 
£lf
.
sync_’gše
.
	$b»ak_»ÏtiÚsh
(
loÿl_id
=
tid
)

227 
exû±
 
KeyE¼Ü
:

228 
·ss


230 
–if
 
aùiÚ
 =ğ
SyncEngše
.
LOST_SYNCABILITY
:

231 
evo_sk
 = 
£lf
.
	$_evo_g‘_sk
(
evo_sk_id
)

232 
£lf
.
	$_exec_lo¡_synÿb™y
(
tid
, 
evo_sk
)

233 
£lf
.
	$§ve_¡©e
()

235 
def
 
	$_´oûss_evo_sk
(
£lf
, 
evo_sk_id
):

237 
Takes
 
ª
 
evŞutiÚ
 
sk
 
id
 
ªd
 
ÿ¼›s
 
out
 
the
 
Ãûs§ry
 
İ”©iÚs
 
to


238 
»äesh
 
the
 
sync
 
¡©e


240 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

241 
evo_sk
 = 
£lf
.
	$_evo_g‘_sk
(
evo_sk_id
)

242 
is_synÿbË
 = 
£lf
.
	$_evo_sk_is_synÿbË
(
evo_sk
)

243 
aùiÚ
, 
tid
 = 
£lf
.
sync_’gše
.
	$ª®yze_»mÙe_id
(

244 
evo_sk_id
,

245 
£lf
.
d©a¡Üe
.
has_sk
,

246 
£lf
.
_evo_has_sk
,

247 
is_synÿbË
)

248 
Log
.
	`debug
('GTG<-EvØ£ˆsk (%s, %s)' % (
aùiÚ
, 
is_synÿbË
))

250 
aùiÚ
 =ğ
SyncEngše
.
ADD
:

251 
w™h
 
£lf
.
d©a¡Üe
.
	$g‘_back’d_mu‹x
():

252 
tid
 = 
	`¡r
(
uuid
.
	$uuid4
())

253 
sk
 = 
£lf
.
d©a¡Üe
.
	$sk_çùÜy
(
tid
)

254 
£lf
.
	$_pİuÏ‹_sk
(
sk
, 
evo_sk
)

255 
meme
 = 
	`SyncMeme
(
sk
.
	`g‘_modif›d
(),

256 
£lf
.
	`_evo_g‘_modif›d
(
evo_sk
),

258 
£lf
.
sync_’gše
.
	$»cÜd_»ÏtiÚsh
(
loÿl_id
=
tid
,

259 
»mÙe_id
=
evo_sk_id
,

260 
meme
=meme)

261 
£lf
.
d©a¡Üe
.
	$push_sk
(
sk
)

263 
–if
 
aùiÚ
 =ğ
SyncEngše
.
UPDATE
:

264 
w™h
 
£lf
.
d©a¡Üe
.
	$g‘_back’d_mu‹x
():

265 
sk
 = 
£lf
.
d©a¡Üe
.
	$g‘_sk
(
tid
)

266 
meme
 = 
£lf
.
sync_’gše
.
	$g‘_meme_äom_»mÙe_id
(
evo_sk_id
)

267 
Ãwe¡
 = 
meme
.
	`which_is_Ãwe¡
(
sk
.
	`g‘_modif›d
(),

268 
£lf
.
	$_evo_g‘_modif›d
(
evo_sk
))

269 
Ãwe¡
 == "remote":

270 
£lf
.
	$_pİuÏ‹_sk
(
sk
, 
evo_sk
)

271 
meme
.
	`£t_»mÙe_Ï¡_modif›d
(

272 
£lf
.
	$_evo_g‘_modif›d
(
evo_sk
))

273 
meme
.
	`£t_loÿl_Ï¡_modif›d
(
sk
.
	$g‘_modif›d
())

275 
–if
 
aùiÚ
 =ğ
SyncEngše
.
REMOVE
:

277 
Œy
:

278 
evo_sk
 = 
£lf
.
	$_evo_g‘_sk
(
evo_sk_id
)

279 
£lf
.
	$_d–‘e_evŞutiÚ_sk
(
evo_sk
)

280 
£lf
.
sync_’gše
.
	$b»ak_»ÏtiÚsh
(
»mÙe_id
=
evo_sk
)

281 
exû±
 
KeyE¼Ü
:

282 
·ss


284 
–if
 
aùiÚ
 =ğ
SyncEngše
.
LOST_SYNCABILITY
:

285 
£lf
.
	$_exec_lo¡_synÿb™y
(
tid
, 
evo_sk
)

286 
£lf
.
	$§ve_¡©e
()

288 ###############################################################################
###H–³¸
m‘hods
 ############################################################

289 ###############################################################################
 _evo_has_sk(£lf,ƒvo_sk_id):

291  
	`boŞ
(
£lf
.
	$_evo_g‘_sk
(
evo_sk_id
))

293 
def
 
	$_evo_g‘_sk
(
£lf
, 
evo_sk_id
):

295  
£lf
.
_evŞutiÚ_sks
.
	`g‘_objeù
(
evo_sk_id
, "")

297 
def
 
	$_evo_g‘_modif›d
(
£lf
, 
evo_sk
):

299  
d©‘ime
.d©‘ime.
	`äomtime¡amp
(
evo_sk
.
	$g‘_modif›d
())

301 
def
 
	$_d–‘e_evŞutiÚ_sk
(
£lf
, 
evo_sk
):

303 
£lf
.
_evŞutiÚ_sks
.
	$»move_objeù
(
evo_sk
)

304 
£lf
.
_evŞutiÚ_sks
.
	$upd©e_objeù
(
evo_sk
)

306 
def
 
	$_pİuÏ‹_sk
(
£lf
, 
sk
, 
evo_sk
):

308 
Upd©es
 
the
 
©Œibu‹s
 
of
 
a
 
GTG
 
sk
 
cİyšg
h
Úes
 oà
ª
 
EvŞutiÚ


309 
sk


311 
sk
.
	`£t_t™Ë
(
evo_sk
.
	$g‘_summ¬y
())

312 
‹xt
 = 
evo_sk
.
	$g‘_desütiÚ
()

313 
‹xt
 
is
 
NÚe
:

314 
‹xt
 = ""

315 
sk
.
	$£t_‹xt
(
‹xt
)

316 
due_d©e_time¡amp
 = 
evo_sk
.
	$g‘_due
()

317 
	`isš¡ªû
(
due_d©e_time¡amp
, (, )):

318 
due_d©e
 = 
£lf
.
	$__d©e_äom_evo_to_gtg
(
due_d©e_time¡amp
)

320 
due_d©e
 = 
D©e
.
	$no_d©e
()

321 
sk
.
	$£t_due_d©e
(
due_d©e
)

322 
¡©us
 = 
evo_sk
.
	$g‘_¡©us
()

323 
sk
.
	`g‘_¡©us
(è!ğ
_EVOLUTION_TO_GTG_STATUS
[
¡©us
]:

324 
sk
.
	$£t_¡©us
(
_EVOLUTION_TO_GTG_STATUS
[
¡©us
])

325 
sk
.
	`£t_Úly_the£_gs
(
	$exŒaù_gs_äom_‹xt
(
‹xt
))

327 
def
 
	$_pİuÏ‹_evo_sk
(
£lf
, 
sk
, 
evo_sk
):

328 
evo_sk
.
	`£t_summ¬y
(
sk
.
	$g‘_t™Ë
())

329 
‹xt
 = 
sk
.
	$g‘_exû½t
(
¡r_gs
=
True
, 
¡r_subsks
=True)

330 
evo_sk
.
	`g‘_desütiÚ
(è!ğ
‹xt
:

331 
evo_sk
.
	$£t_desütiÚ
(
‹xt
)

332 
due_d©e
 = 
sk
.
	$g‘_due_d©e
()

333 
due_d©e
 =ğ
D©e
.
	$no_d©e
():

334 
evo_sk
.
	$£t_due
(
NÚe
)

336 
evo_sk
.
	`£t_due
(
£lf
.
	$__d©e_äom_gtg_to_evo
(
due_d©e
))

337 
¡©us
 = 
sk
.
	$g‘_¡©us
()

338 
_EVOLUTION_TO_GTG_STATUS
[
evo_sk
.
	`g‘_¡©us
()] !ğ
¡©us
:

339 
evo_sk
.
	$£t_¡©us
(
_GTG_TO_EVOLUTION_STATUS
[
¡©us
])

340 #thi 
ÿÎs
 
¬e
 
som‘ime
 
ignÜed
 
by
 
evŞutiÚ
. 
Došg
 
™
 
twiû


341 #i 
a
 
hackish
 
way
 
to
 
sŞve
 
the
 
´obËm
. (
TODO
: 
£nd
 
bug
 
»pÜt
)

342 
£lf
.
_evŞutiÚ_sks
.
	$upd©e_objeù
(
evo_sk
)

343 
£lf
.
_evŞutiÚ_sks
.
	$upd©e_objeù
(
evo_sk
)

345 
def
 
	$_exec_lo¡_synÿb™y
(
£lf
, 
tid
, 
evo_sk
):

347 
Execu‹d
 
wh’
 
a
 
»ÏtiÚsh
 
b‘w“n
 
sks
 
lo£s
 
™s
 
synÿb™y


348 
´İ”ty
. 
S“
 
SyncEngše
 
ª
 
ex¶ª©iÚ
 
of
 
th©
.

349 
This
 
funùiÚ
 
fšds
 
out
 
which
 
objeù
 
is
 
the
 
Üigš®
 
Úe


350 
ªd
 
which
 
is
 
the
 
cİy
,‡nd 
d–‘es
he copy.

352 
meme
 = 
£lf
.
sync_’gše
.
	$g‘_meme_äom_loÿl_id
(
tid
)

353 
£lf
.
sync_’gše
.
	$b»ak_»ÏtiÚsh
(
loÿl_id
=
tid
)

354 
meme
.
	`g‘_Üigš
() == "GTG":

355 
evo_sk
 = 
£lf
.
	`_evo_g‘_sk
Óvo_sk.
	$g‘_uid
())

356 
£lf
.
	$_d–‘e_evŞutiÚ_sk
(
evo_sk
)

358 
£lf
.
d©a¡Üe
.
	$»que¡_sk_d–‘iÚ
(
tid
)

360 
def
 
	$_evo_sk_is_synÿbË
(
£lf
, 
evo_sk
):

362 
R‘uºs
 
True
 
this
 
EvŞutiÚ
 
sk
 
should
 
be
 
synûd
 
što
 
GTG
 
sks
.

364 @
·¿m
 
evo_sk
: 
ª
 
EvŞutiÚ
 
sk


365 @
»tuºs
 
BoŞ—n


367 
©ched_gs
 = 
	`£t
(
£lf
.
	$g‘_©ched_gs
())

368 
G’”icBack’d
.
ALLTASKS_TAG
 
š
 
©ched_gs
:

369  
True


370  
evo_sk
.
	$is_disjošt
(
©ched_gs
)

372 
def
 
	$__d©e_äom_evo_to_gtg
(
£lf
, 
evo_d©e_time¡amp
):

374 
CÚv”ts
 
ª
 
evŞutiÚ
 
d©e
 
objeù
 
što
 
the
 
fÜm©
 
und”¡ood
 
by
 
GTG


376 @
·¿m
 
evo_d©e
: 
ª
 , 
which
 
»´e£Á
 
time
 
äom
 
•och
 
š
 
UTC


377 
cÚv’tiÚ


379 
evo_d©‘ime
 = 
d©‘ime
.d©‘ime.
	$äomtime¡amp
(
evo_d©e_time¡amp
)

380 #S“ 
£lf
.
__d©e_äom_gtg_to_evo
 
ª
 
ex¶ª©iÚ


381 
evo_d©‘ime
 =ƒvo_d©‘ime.
	`»¶aû
(
tzšfo
=
	$tzloÿl
())

382 
gtg_d©‘ime
 = 
evo_d©‘ime
.
	`a¡imezÚe
(
	$tzutc
())

383 #w
¡r
 
timezÚe
 
šfos
, 
as
 
they
're‚ot used orƒxpected in GTG

384 
gtg_d©‘ime
.
	$»¶aû
(
tzšfo
=
NÚe
)

385  
	`D©e
(
gtg_d©‘ime
.
	$d©e
())

387 
def
 
	$__d©e_äom_gtg_to_evo
(
£lf
, 
gtg_d©e
):

389 
CÚv”ts
 
a
 
d©‘ime
.
d©e
 
objeù
 
što
 
the
 
fÜm©
 
und”¡ood
 
by
 
EvŞutiÚ


391 @
·¿m
 
gtg_d©e
: 
a
 
GTG
 
D©e
 
objeù


393 #GTG 
thšks
 
š
 
loÿl
 
time
, 
evŞutiÚ
 iÀ
utc


394 #tØ
cÚv”t
 
d©e
 
objeùs
 
b‘w“n
 
difã»Á
 
timezÚes
, 
we
 
mu¡
 convert

395 #them 
to
 
d©‘ime
 
objeùs


396 
gtg_d©‘ime
 = 
d©‘ime
.d©‘ime.
	`combše
(
gtg_d©e
.
	`to_py_d©e
(),

397 
d©‘ime
.
	$time
(0))

398 #W
dÚ
't wantoƒxpress GTG date into‡ UTCƒquivalent. Instead, we

399 #wªˆ
the
 *
§me
* 
d©e
 
š
 
GTG
 
ªd
 
evŞutiÚ
. 
Th”efÜe
, 
we
 
mu¡
 
nÙ
 do

400 #th
cÚv”siÚ
 
Loÿl
-> 
	`UTC
 (
which
 
would
 
pošt
 
to
 
the
 
§me
 
mom’t
 
š


401 #tim
š
 
difã»Á
 
cÚv’tiÚs
), 
but
 dØ
the
 
İpos™e
 
cÚv”siÚ
 
UTC
->

402 #LoÿÈ(
which
 
wl
 
»ãr
 
to
 
difã»Á
 
pošts
 
š
 
time
, 
but
Ø
the
 
§me


403 #wr™‹À
d©e
)

404 
gtg_d©‘ime
 = gtg_d©‘ime.
	`»¶aû
(
tzšfo
=
	$tzutc
())

405 
evo_d©‘ime
 = 
gtg_d©‘ime
.
	`a¡imezÚe
(
	$tzloÿl
())

406  (
time
.
	`mktime
(
evo_d©‘ime
.
	`tim‘u¶e
()))

	@backends/backend_gnote.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
The
 
gnÙe
 
	gback’d
. Th
aùu®
 
back’d
 
is
 
®l
 
š
 
	gG’”icTomboy
, 
sšû
 
	g™
's

19 
sh¬ed
 
w™h
 
the
 
tomboy
 
	gback’d
.

21 #TØ
šŒo¥eù
 
tomboy
: 
qdbus
 
Üg
.
gnome
.
Tomboy
 /Üg/gnome/Tomboy/
RemÙeCÚŒŞ


23 
äom
 
	gGTG
.
	gback’ds
.
g’”icback’d
 
impÜt
 
G’”icBack’d


24 
äom
 
GTG
 
impÜt
 
_


25 
äom
 
	gGTG
.
	gback’ds
.
g’”iùomboy
 
impÜt
 
G’”icTomboy


28 
şass
 
	$Back’d
(
G’”icTomboy
):

30 
A
 
sim¶e
 
şass
 
th©
 
adds
 
some
 
desütiÚ
 
to
 
the
 
G’”icTomboy
 class.

31 
It
's donehis way since Tomboy‡nd Gnote backends have different

32 
desütiÚs
 
ªd
 
Dbus
 
add»s£s
 
but
 
the
 
§me
 
back’d
 
behšd
 
them
.

35 
_g’”®_desütiÚ
 = {

36 
G’”icBack’d
.
BACKEND_NAME
: "backend_gnote",

37 
G’”icBack’d
.
BACKEND_HUMAN_NAME
: 
	`_
("Gnote"),

38 
G’”icBack’d
.
BACKEND_AUTHORS
: ["Luca Invernizzi"],

39 
G’”icBack’d
.
BACKEND_TYPE
: G’”icBack’d.
TYPE_READWRITE
,

40 
G’”icBack’d
.
BACKEND_DESCRIPTION
:

41 
	`_
("This service can synchronize‡ll or…art of your Gnote"

46 
	}
}

48 
_¡©ic_·¿m‘”s
 = {

49 
G’”icBack’d
.
KEY_ATTACHED_TAGS
: {

50 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_LIST_OF_STRINGS
,

51 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
: ["@GTG-Gnote"]},

54 
BUS_ADDRESS
 = ("org.gnome.Gnote",

	@backends/backend_launchpad.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
Back’d
 
impÜtšg
 
Ïunch·d
 
bugs
 
š
 
	gGTG


20 #Docum’tiÚ 
Ú
 
Ïunch­adlib
: 
h‰ps
:

22 
impÜt
 
os


23 
impÜt
 
uuid


24 
impÜt
 
d©‘ime


25 
äom
 
	gxdg
.
Ba£DœeùÜy
 
impÜt
 
xdg_ÿche_home


26 
äom
 
	gÏunch·dlib
.
Ïunch·d
 
impÜt
 
	gLaunch·d
, 
EDGE_SERVICE_ROOT


28 
äom
 
	gGTG
.
	gcÜe
.
sk
 
impÜt
 
Task


29 
äom
 
GTG
 
impÜt
 
_


30 
äom
 
	gGTG
.
	gback’ds
.
g’”icback’d
 
impÜt
 
G’”icBack’d


31 
äom
 
	gGTG
.
	gback’ds
.
back’dsigÇls
 
impÜt
 
Back’dSigÇls


32 
äom
 
	gGTG
.
	gback’ds
.
synûngše
 
impÜt
 
	gSyncEngše
, 
SyncMeme


33 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


34 
äom
 
	gGTG
.
šfo
 
impÜt
 
NAME
 
as
 
GTG_NAME


35 
äom
 
	gGTG
.
	gback’ds
.
³riodicimpÜtback’d
 
impÜt
 
	gP”iodicImpÜtBack’d


37 #Uncomm’ˆ
this
 
to
 
£e
 
—ch
 
h‰p
 
»que¡


38 #impÜˆ
h‰¶ib2


39 #h‰¶ib2.
debugËv–
 = 1

42 
şass
 
	$Back’d
(
P”iodicImpÜtBack’d
):

45 
_g’”®_desütiÚ
 = {

46 
G’”icBack’d
.
BACKEND_NAME
: "backend_launchpad",

47 
G’”icBack’d
.
BACKEND_HUMAN_NAME
: 
	`_
("Launchpad"),

48 
G’”icBack’d
.
BACKEND_AUTHORS
: ["Luca Invernizzi"],

49 
G’”icBack’d
.
BACKEND_TYPE
: G’”icBack’d.
TYPE_READONLY
,

50 
G’”icBack’d
.
BACKEND_DESCRIPTION
:

51 
	`_
("This synchronization service†ets you importhe bugs‡ssigned"

66 
	}
}

68 
_¡©ic_·¿m‘”s
 = {

70 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_STRING
,

71 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
: "insert your username here"},

73 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_INT
,

74 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
: 2, },

76 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_BOOL
,

77 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
: 
F®£
},

79 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_BOOL
,

80 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
: 
True
},

83 ###############################################################################
###Back’d 
¡ªd¬d
 
m‘hods
 ##################################################

84 ###############################################################################
 __š™__(£lf,…¬am‘”s):

86 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
	gfunùiÚ
.

87 
	gRe
-
lßds
 
the
 
§ved
 
¡©e
 
of
h
	gsynchrÚiz©iÚ


89 
su³r
(
Back’d
, 
£lf
).
	$__š™__
(
·¿m‘”s
)

90 #lßdšg 
the
 
§ved
 
¡©e
 
of
h
synchrÚiz©iÚ
, 
ªy


91 
£lf
.
d©a_·th
 = 
os
.
·th
.
	`još
('backends/launchpad/',

92 "sync_’gše-" + 
£lf
.
	$g‘_id
())

93 
£lf
.
sync_’gše
 = s–f.
	`_lßd_pickËd_fe
(£lf.
d©a_·th
,

94 
	$SyncEngše
())

96 
def
 
	$do_³riodic_impÜt
(
£lf
):

98 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

99 
CÚÃù
 
to
 
Ïunch·d
 
ªd
 
upd©es
 
the
 
¡©e
 
of
 
GTG
 
sks
Ø
»æeù
he

100 
bugs
 
Ú
 
Ïunch·d
.

103 #IMPORTANT 
NOTE
!

104 #Bug 
ÿn
 
be
 
¥l™‹d
 
š
 
bug
 
	`sks
 (
such
 
as
, 
you
 cª 
assign
 
a
 
sšgË


105 #bug 
to
 
muÉË
 
´ojeùs
: 
you
 
have
 
Úe
 
bug
 
ªd
 
£v”®
 bug 
sks
).

106 #Aˆ
Ëa¡
, 
Úe
 
bug
 
cÚšs
 
a
 bug 
	`sk
 (
™
's„eferringo‡ single

108 #H”e, 
we
 
´oûss
 
bug
 
sks
, 
sšû
 
tho£
 
¬e
 
the
 
Úes
 
th©
 
g‘


109 #assigÃd 
to
 
someÚe
.

110 #TØ
avoid
 
havšg
 
muÉË
 
GTG
 
Tasks
 
the
 
§me
 
	`bug
 (
beÿu£
 
we
 
u£


111 #bug 
sks
, 
this
 
may
 
h­³n
 
somebody
 
is
 
wÜkšg
 
©
 
the
 
§me
 
bug
 

112 #difã»Á 
´ojeùs
), 
we
 
u£
 
the
 
bug
 
£lf_lšk
 
šdexšg
h
sks
.

114 #CÚÃùšg 
to
 
Launch·d


115 
CACHE_DIR
 = 
os
.
·th
.
	`još
(
xdg_ÿche_home
, 'gtg/backends/',

116 
£lf
.
	$g‘_id
())

117 
Œy
:

118 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

119 
£lf
.
Ïunch·d
 = 
Launch·d
.
	$logš_ªÚymou¦y
(

120 
GTG_NAME
, 
EDGE_SERVICE_ROOT
, 
CACHE_DIR
)

121 
exû±
:

122 #Th
cÚÃùiÚ
 
is
 
nÙ
 
	`wÜkšg
 (
the
 
exû±iÚ
 
ty³
 
ÿn
 
be


124 
	`Back’dSigÇls
().
	`back’d_çed
(
£lf
.
	`g‘_id
(),

125 
Back’dSigÇls
.
ERRNO_NETWORK
)

127 #G‘tšg 
the
 
u£r
 
d©a


128 
Œy
:

129 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

130 
me
 = 
£lf
.
Ïunch·d
.
³İË
[£lf.
_·¿m‘”s
["username"]]

131 
exû±
 
KeyE¼Ü
:

132 
£lf
.
	$qu™
(
di§bË
=
True
)

133 
	`Back’dSigÇls
().
	`back’d_çed
(
£lf
.
	`g‘_id
(),

134 
Back’dSigÇls
.
ERRNO_AUTHENTICATION


137 #F‘chšg 
the
 
bugs


138 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

139 
my_bugs_sks
 = 
me
.
	`£¬chTasks
(
assigÃe
=me, 
¡©us
=["New",

145 #Addšg 
ªd
 
upd©šg


146 
bug_sk
 
š
 
my_bugs_sks
:

147 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

148 
£lf
.
	$_´oûss_Ïunch·d_bug
(
bug_sk
)

150 #»movšg 
the
 
Şd
 
Úes


151 
Ï¡_bug_li¡
 = 
£lf
.
sync_’gše
.
	$g‘_®l_»mÙe
()

152 
Ãw_bug_li¡
 = [
bug
.
£lf_lšk
 bug 
š
 
my_bugs_sks
]

153 
bug_lšk
 
š
 
	`£t
(
Ï¡_bug_li¡
).
	`difã»nû
(
	$£t
(
Ãw_bug_li¡
)):

154 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

155 #w
make
 
su»
 
th©
 
the
 
Ùh”
 
back’ds
 
¬e
 
nÙ
 
modifyšg
h
sk


157 
w™h
 
£lf
.
d©a¡Üe
.
	$g‘_back’d_mu‹x
():

158 
tid
 = 
£lf
.
sync_’gše
.
	$g‘_loÿl_id
(
bug_lšk
)

159 
£lf
.
d©a¡Üe
.
	$»que¡_sk_d–‘iÚ
(
tid
)

160 
Œy
:

161 
£lf
.
sync_’gše
.
	$b»ak_»ÏtiÚsh
(
»mÙe_id
=
bug_lšk
)

162 
exû±
 
KeyE¼Ü
:

163 
·ss


165 
def
 
	$§ve_¡©e
(
£lf
):

167 
£lf
.
	$_¡Üe_pickËd_fe
(
£lf
.
d©a_·th
, s–f.
sync_’gše
)

169 ###############################################################################
###Proûs 
sks
 #############################################################
###############################################################################
 _´oûss_Ïunch·d_bug(£lf, bug):

171 
Giv’
 
a
 
bug
 
objeù
, 
fšds
 
out
 
™
 
mu¡
 
be
 
synûd
 
to
‡ 
GTG
 
nÙe
 
ªd
,

172 
so
, 
™
 
ÿ¼›s
 
out
 
the
 
	`synchrÚiz©iÚ
 (
by
 
ü—tšg
 
Ü


173 
upd©šg
 
a
 
GTG
 
sk
, 
Ü
 
d–‘šg
 
™£lf
 
the
 
»Ï‹d
ask 
has


174 
b“n
 
d–‘ed
)

176 @
·¿m
 
nÙe
: 
a
 
Ïunch·d
 
bug


178 
has_sk
 = 
£lf
.
d©a¡Üe
.has_task

179 
aùiÚ
, 
tid
 = 
£lf
.
sync_’gše
.
	`ª®yze_»mÙe_id
(
bug
.
£lf_lšk
,

180 
has_sk
,

181 
Ïmbda
 
b
: 
True
)

182 
Log
.
	`debug
("´oûssšg†aunch·d (%s)" % (
aùiÚ
))

184 
aùiÚ
 
is
 
NÚe
:

187 
bug_dic
 = 
£lf
.
	$_´eãtch_bug_d©a
(
bug
)

188 #fÜ 
the
 
»¡
 
of
h
funùiÚ
, 
no
 
acûss
 
to
 
bug
 
mu¡
 
be
 
made
, 
so


189 #th© 
the
 
time
 
of
 
blockšg
 
šside
h
w™h
 
¡©em’ts
 
is
 .

190 #TØ
be
 
su»
 
of
 
th©
, 
£t
 
bug
 
to
 
NÚe


191 
bug
 = 
NÚe


193 
w™h
 
£lf
.
d©a¡Üe
.
	$g‘_back’d_mu‹x
():

194 
aùiÚ
 =ğ
SyncEngše
.
ADD
:

195 
tid
 = 
	`¡r
(
uuid
.
	$uuid4
())

196 
sk
 = 
£lf
.
d©a¡Üe
.
	$sk_çùÜy
(
tid
)

197 
£lf
.
	$_pİuÏ‹_sk
(
sk
, 
bug_dic
)

198 
meme
 = 
	`SyncMeme
(

199 
sk
.
	`g‘_modif›d
(), 
bug_dic
['modif›d'], 
£lf
.
	$g‘_id
())

200 
£lf
.
sync_’gše
.
	`»cÜd_»ÏtiÚsh
(

201 
loÿl_id
=
tid
,

202 
»mÙe_id
=
	`¡r
(
bug_dic
['self_link']),

203 
meme
=meme,

205 
£lf
.
d©a¡Üe
.
	$push_sk
(
sk
)

207 
–if
 
aùiÚ
 =ğ
SyncEngše
.
UPDATE
:

208 
sk
 = 
£lf
.
d©a¡Üe
.
	$g‘_sk
(
tid
)

209 
£lf
.
	$_pİuÏ‹_sk
(
sk
, 
bug_dic
)

210 
meme
 = 
£lf
.
sync_’gše
.
	`g‘_meme_äom_»mÙe_id
(

211 
bug_dic
['self_link'])

212 
meme
.
	`£t_loÿl_Ï¡_modif›d
(
sk
.
	$g‘_modif›d
())

213 
meme
.
	`£t_»mÙe_Ï¡_modif›d
(
bug_dic
['modified'])

214 
£lf
.
	$§ve_¡©e
()

216 
def
 
	$_pİuÏ‹_sk
(
£lf
, 
sk
, 
bug_dic
):

218 
Fls
 
a
 
GTG
 
sk
 
w™h
 
the
 
d©a
 
äom
‡ 
Ïunch·d
 
bug
.

220 @
·¿m
 
sk
: 
a
 
Task


221 @
·¿m
 
bug
: 
a
 
Ïunch·d
 bug 
diùiÚ¬y
, 
g’”©ed
 
w™h


222 
_´eãtch_bug_d©a


224 #£ˆ
sk
 
¡©us


225 
bug_dic
["completed"]:

226 
sk
.
	$£t_¡©us
(
Task
.
STA_DONE
)

228 
sk
.
	$£t_¡©us
(
Task
.
STA_ACTIVE
)

229 
sk
.
	`g‘_t™Ë
(è!ğ
bug_dic
['title']:

230 
sk
.
	`£t_t™Ë
(
	`_
("Bug"è+ " %s: " % 
bug_dic
["number"]

231 + 
bug_dic
['title'])

232 
‹xt
 = 
£lf
.
	$_bud_bug_‹xt
(
bug_dic
)

233 
sk
.
	`g‘_exû½t
(è!ğ
‹xt
:

234 
sk
.
	$£t_‹xt
(
‹xt
)

235 
Ãw_gs_sourûs
 = []

236 
£lf
.
_·¿m‘”s
["import-bug-tags"]:

237 
Ãw_gs_sourûs
 +ğ
bug_dic
['tags']

238 
£lf
.
_·¿m‘”s
["tag-with-project-name"]:

239 
Ãw_gs_sourûs
 +ğ[
dic
['project_short']

240 
dic
 
š
 
bug_dic
['projects']]

241 
Ãw_gs
 = 
	`£t
(['@' + 
	$¡r
(
g
èg 
š
 
Ãw_gs_sourûs
])

242 
cu¼’t_gs
 = 
	`£t
(
sk
.
	$g‘_gs_Çme
())

243 #»mov
the
 
lo¡
 
gs


244 
g
 
š
 
cu¼’t_gs
.
	$difã»nû
(
Ãw_gs
):

245 
sk
.
	$»move_g
(
g
)

246 #add 
the
 
Ãw
 
Úes


247 
g
 
š
 
Ãw_gs
.
	$difã»nû
(
cu¼’t_gs
):

248 
sk
.
	$add_g
(
g
)

249 
sk
.
	`add_»mÙe_id
(
£lf
.
	`g‘_id
(), 
bug_dic
['self_link'])

251 
def
 
	$_g‘_bug_modif›d_d©‘ime
(
£lf
, 
bug
):

253 
Giv’
 
a
 
bug
, 
»tuºs
 
™s
 
modifiÿtiÚ
 
d©‘ime


255 @
·¿m
 
bug
: 
a
 
Ïunch·d
 bug

257 #NOTE: 
givšg
 
dœeùly
 
bug
.
d©e_Ï¡_upd©ed
 
çs
 
a
 
»asÚ
 
I


259  
d©‘ime
.d©‘ime.
	`¡½time
(

260 
bug
.
d©e_Ï¡_upd©ed
.
	`¡ráime
("YYYY-MM-DDTHH:MM:SS.mmmmmm"),

263 
def
 
	$_´eãtch_bug_d©a
(
£lf
, 
bug_sk
):

265 
We
 
ãtch
 
®l
 
the
 
Ãûs§ry
 
šfo
 
th©
 
we
 
Ãed
 
äom
h
bug
 
to
 
pİuÏ‹
 
a


266 
sk
 
	`befÜehªd
 (
the£
 
wl
 
be
 
u£d
 
š
 
_pİuÏ‹_sk
).

267 
This
 
funùiÚ
 
kes
 
a
 
time
 
to
 
	`com¶‘e
 (
®l
 
acûss
Ø
bug
 
d©a
 
¬e


268 
»que¡s
 
Ú
 
th’
 
Ãt
), 
but
 
™
 
ÿn
 
üash
 
w™hout
 
havšg
 
the
 
¡©e
 
of
he

269 
»Ï‹d
 
sk
 
h®f
-
chªged
.

271 @
·¿m
 
bug
: 
a
 
Ïunch·d
 bug 
sk


272 @
»tuºs
 
diù
: 
a
 
diùiÚ¬y
 
cÚššg
 
the
 
»Ëvªt
 
bug
 
©Œibu‹s


274 
bug
 = 
bug_sk
.bug

275 #W
Ãed
 
to
 
u£
 
Üigš®
 
lšk
, 
nÙ
 
äom
 
bug
 
objeù


276 
£lf_lšk
 = 
bug_sk
.self_link

277 
owÃr
 = 
bug
.owner

278 
bug_dic
 = {'t™Ë': 
bug
.
t™Ë
,

279 '‹xt': 
bug
.
desütiÚ
,

280 'gs': 
bug
.
gs
,

281 '£lf_lšk': 
£lf_lšk
,

282 'modif›d': 
£lf
.
	`_g‘_bug_modif›d_d©‘ime
(
bug
),

283 'owÃr': 
owÃr
.
di¥Ïy_Çme
,

284 'com¶‘ed': 
bug_sk
.
¡©us
 
š
 ["Fix Committed",

286 'owÃr_k¬ma': 
owÃr
.
k¬ma
}

287 
bug_dic
['numb”'] = bug_dic['£lf_lšk'][bug_dic['£lf_lšk'].
ršdex
(

289 #fšd 
the
 
´ojeùs
 
rg‘
 
of
h
bug


290 
´ojeùs
 = []

291 
sk
 
š
 
bug
.
bug_sks
:

292 #wÜk¬ound: 
assigÃe
.
Çme
 
dÛ¢
't work,‡lthough

293 #assigÃe.
di¥Ïy_Çme
 
dÛs
.

294 
Œy
:

295 
a_¦
 = 
sk
.
assigÃe
.
£lf_lšk


296 
exû±
 
A‰ribu‹E¼Ü
:

297 #bug 
sk
 
is
 
nÙ
 
assigÃd
 
to
 
ªyÚe


299 
a_¦
[a_¦.
šdex
("~") + 1:]

300 
a_¦
[a_¦.
šdex
("~"è+ 1:] =ğ
£lf
.
_·¿m‘”s
["username"]:

301 
t_¦
 = 
sk
.
rg‘
.
£lf_lšk


302 
´ojeùs
.
­³nd
(

303 {"´ojeù_shÜt": 
t_¦
[t_¦.
ršdex
("/") + 1:],

304 "´ojeù_lÚg": 
sk
.
bug_rg‘_di¥Ïy_Çme
, })

305 
bug_dic
["´ojeùs"] = 
´ojeùs


306  
bug_dic


308 
def
 
	$_bud_bug_‹xt
(
£lf
, 
bug_dic
):

310 
C»©es
 
the
 
‹xt
 
th©
 
desüibes
 
a
 
bug


312 
‹xt
 = 
	`_
("Reported by: ") + '%s(karma: %s)' % \

313 (
bug_dic
["owner"], bug_dic["owner_karma"]) + '\n'

314 #Ú
lšk
 
is
 
’ough
, 
sšû
 
they
're‡ll‡lias

315 
bug_´ojeù
 = 
bug_dic
['projects'][0]['project_short']

316 
‹xt
 +ğ
	`_
("Linko bug: ") + \

318 (
bug_´ojeù
, 
bug_dic
["number"]) + '\n'

319 
‹xt
 +ğ'\n' + 
bug_dic
["text"]

320  
‹xt


	@backends/backend_localfile.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
Loÿlfe
 
is
 
a
 
	g»ad
/
wr™e
 
back’d
 
th©
 
wl
 
¡Üe
 
your
 
sks
 
š
 
ª
 
XML
 
fe


19 
This
 
fe
 
wl
 
be
 
š
 
your
 
	g$XDG_DATA_DIR
/
gtg
 
	gfŞd”
.

21 
This
 
back’d
 
cÚšs
 
comm’ts
 
th©
 
¬e
 
m—Á
 
as
 
a
 
	g»ã»nû
, 
š
 
someÚe


22 
wªts
 
to
 
wr™e
 
a
 
	gback’d
.

25 
impÜt
 
os


27 
äom
 
GTG
 
impÜt
 
_


28 
äom
 
	gGTG
.
	gback’ds
.
g’”icback’d
 
impÜt
 
G’”icBack’d


29 
äom
 
	gGTG
.
	gback’ds
.
back’dsigÇls
 
impÜt
 
Back’dSigÇls


30 
äom
 
	gGTG
.
cÜe
 
impÜt
 
CÜeCÚfig


31 
äom
 
	gGTG
.
toŞs
 
impÜt
 
	gş—nxml
, 
	gskxml


33 #IgnÜ
®l
 
Ùh”
 
–em’ts
 
but
 
this
 
Úe


34 
	gTASK_NODE
 = "task"

37 
şass
 
	$Back’d
(
G’”icBack’d
):

39 
Loÿlfe
 
back’d
, 
which
 
¡Ües
 
your
 
sks
 
š
 
a
 
XML
 
fe
 iÀ
the
 
¡ªd¬d


40 
XDG_DATA_DIR
/
gtg
 
	`fŞd”
 (
the
 
·th
 
is
 
cÚfigu¿bË
).

41 
An
 
š¡ªû
 
of
 
this
 
şass
 
is
 
u£d
 
as
 
the
  
back’d
 
GTG
.

42 
This
 
back’d
 
lßds
 
®l
 
the
 
sks
 
¡Üed
 
š
h
loÿlfe
 
aá”
 
™
'sƒnabled

43 
ªd
 
äom
 
th©
 
pošt
 
Ú
 
ju¡
 
wr™es
 
the
 
chªges
 
to
h
fe
: 
™
 
dÛs
 
nÙ


44 
li¡’
 
ev’tu®
 
fe
 
chªges


47 #G’”® 
desütiÚ
 
of
 
the
 
back’d
: 
the£
 
¬e
 
u£d
 
to
 
show
 
a
 description

48 #oà
the
 
back’d
 
to
h
u£r
 
wh’
 
s
/
he
 
is
 
cÚsid”šg
 
addšg
 
™
.

49 #BACKEND_NAME 
is
 
the
 
Çme
 
of
h
back’d
 
u£d
 
	`š‹º®ly
 (
™
 
mu¡
 
be


51 #PËa£ 
nÙe
 
th©
 
BACKEND_NAME
 
ªd
 
BACKEND_ICON_NAME
 
should
 *
nÙ
* 
be


53 
_g’”®_desütiÚ
 = {

54 
G’”icBack’d
.
BACKEND_NAME
: "backend_localfile",

55 
G’”icBack’d
.
BACKEND_HUMAN_NAME
: 
	`_
("Local File"),

56 
G’”icBack’d
.
BACKEND_AUTHORS
: ["Lionel Dricot",

58 
G’”icBack’d
.
BACKEND_TYPE
: G’”icBack’d.
TYPE_READWRITE
,

59 
G’”icBack’d
.
BACKEND_DESCRIPTION
:

60 
	`_
("Yourasks‡re saved in‡ext file (XML format). " +

63 
	}
}

65 #The£ 
¬e
 
the
 
·¿m‘”s
 
to
 
cÚfigu»
 
a
 
Ãw
 
back’d
 
of
 
this
 
ty³
. 
A


66 #·¿m‘” 
has
 
a
 
Çme
,‡ 
ty³
 
ªd
‡  
v®ue
.

67 #H”e, 
we
 
defše
 
a
 
·¿m‘”
 "·th", 
which
 
is
‡ 
¡ršg
, 
ªd
 
has
‡ 

68 #v®u
as
 
a
 
¿ndom
 
fe
 
š
 
the
  
·th


69 
	g_¡©ic_·¿m‘”s
 = {

71 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_STRING
,

72 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
:

75 
def
 
	$__š™__
(
£lf
, 
·¿m‘”s
):

77 
In¡ªtŸ‹s
 
a
 
Ãw
 
back’d
.

79 @
·¿m
 
·¿m‘”s
: 
A
 
diùiÚ¬y
 
of
…¬am‘”s, 
g’”©ed
 
äom


80 
_¡©ic_·¿m‘”s
. 
A
 
ãw
 
·¿m‘”s
 
¬e
 
added
 
to
 
tho£
, 
the
 
li¡
 
of


81 
the£
 
is
 
š
 
the
 "DeçuÉBack’d" 
şass
, 
look
 th
KEY_
* 
cÚ¡ªts
.

83 
The
 
back’d
 
should
 
ke
 
ÿ»
 
Úe
 
ex³ùed
 
v®ue
 
is
 
NÚe
 
Ü


84 
dÛs
 
nÙ
 
exi¡
 
š
 
the
 
diùiÚ¬y
.

86 
	`su³r
(
Back’d
, 
£lf
).
	$__š™__
(
·¿m‘”s
)

88 #NOTE: 
»Œocom·tib™y
 
äom
 
the
 0.2 
£r›s
 
to
 0.3.

89 #W
cÚv”t
 "f’ame" 
to
 "·th‡nd wfÜg‘‡bouˆ"
f’ame
 "

90 "Ãed_cÚv”siÚ" 
š
 
·¿m‘”s
:

91 
·¿m‘”s
["·th"] =…¬am‘”s.
	`pİ
("need_conversion")

92 
nÙ
 
£lf
.
KEY_DEFAULT_BACKEND
 
š
 
·¿m‘”s
:

93 
·¿m‘”s
[
£lf
.
KEY_DEFAULT_BACKEND
] = 
True


95 
£lf
.
doc
, s–f.
xmÍroj
 = 
ş—nxml
.
	`İ’xmlfe
(

96 
£lf
.
	`g‘_·th
(), "project")

98 #¡©u 
backup
 
was
 
u£d
 
Œyšg
 
to
 
İ’
 
xml
 
fe


99 
£lf
.
_u£d_backup
 = 
ş—nxml
.
	$u£d_backup
()

100 
£lf
.
_backup_fe_šfo
 = 
ş—nxml
.
	$backup_fe_šfo
()

102 #Mak
§ãty
 
day
 
backup
 
aá”
 
lßdšg


103 
ş—nxml
.
	`§vexml
(
£lf
.
	`g‘_·th
(), s–f.
doc
, 
backup
=
True
)

105 
def
 
	$g‘_·th
(
£lf
):

107 
R‘uº
 
the
 
cu¼’t
 
·th
 
to
 
XML


109 
P©h
 
ÿn
 
be
 
»Ïtive
 
to
 
´ojeùs
.
xml


111 
·th
 = 
£lf
.
_·¿m‘”s
["path"]

112 
os
.
£p
 
nÙ
 
š
 
·th
:

113 #LoÿÈ
·th


114 
d©a_dœ
 = 
	`CÜeCÚfig
().
	$g‘_d©a_dœ
()

115 
·th
 = 
os
.·th.
	$još
(
d©a_dœ
, 
·th
)

116  
os
.
·th
.
	$ab¥©h
(
·th
)

118 
def
 
	$š™Ÿlize
(
£lf
):

120 
	`su³r
(
Back’d
, 
£lf
).
	$š™Ÿlize
()

121 
£lf
.
doc
, s–f.
xmÍroj
 = 
ş—nxml
.
	`İ’xmlfe
(

122 
£lf
.
	`g‘_·th
(), "project")

124 
def
 
	$this_is_the_fœ¡_run
(
£lf
, 
xml
):

126 
This
 
funùiÚ
 
is
 
Ãeded
 
Úly
 
š
 
this
 
back’d
, 
beÿu£
 
™
 
ÿn
 
be
 
u£d
 
as


127  
Úe
.

128 
The
 
xml
 
·¿m‘”
 
is
 
ª
 
objeù
 
cÚššg
 
GTG
  
sks
. 
It
 
wl
 
be


129 
§ved
 
to
 
a
 
fe
, 
ªd
 
the
 
back’d
 
wl
 
be
 
£t
 
as
 .

130 @
·¿m
 
xml
: 
ª
 xmÈ
objeù
 
cÚššg
 
the
  
sks
.

132 
£lf
.
_·¿m‘”s
[£lf.
KEY_DEFAULT_BACKEND
] = 
True


133 
ş—nxml
.
	`§vexml
(
£lf
.
	`g‘_·th
(), 
xml
)

134 
£lf
.
doc
, s–f.
xmÍroj
 = 
ş—nxml
.
	`İ’xmlfe
(

135 
£lf
.
	`g‘_·th
(), "project")

136 
£lf
.
_u£d_backup
 = 
F®£


138 
def
 
	$¡¬t_g‘_sks
(
£lf
):

140 
GTG
 
cÜe
. 
It
's„un‡s‡ separatehread.

142 @: 
	$¡¬t_g‘_sks
(è
might
 
nÙ
  
Ü
 
fšish


144 
node
 
š
 
£lf
.
xmÍroj
.
chdNodes
:

145 
node
.
nodeName
 !ğ
TASK_NODE
:

147 
tid
 = 
node
.
	`g‘A‰ribu‹
("id")

148 
sk
 = 
£lf
.
d©a¡Üe
.
	$sk_çùÜy
(
tid
)

149 
sk
:

150 
sk
 = 
skxml
.
	$sk_äom_xml
(
sk
, 
node
)

151 
£lf
.
d©a¡Üe
.
	$push_sk
(
sk
)

153 
def
 
	$£t_sk
(
£lf
, 
sk
):

155 
This
 
funùiÚ
 
is
 
ÿÎed
 
äom
 
GTG
 
cÜe
 
wh’ev”
 
a
 
sk
 
should
 
be


156 
§ved
, 
e™h”
 
beÿu£
 
™
's‡‚ew one or it has been modified.

157 
This
 
funùiÚ
 
wl
 
look
 
što
 
the
 
lßded
 
XML
 
objeù
 th
sk
 
is


158 
´e£Á
, 
ªd
 
™
's‚ot, it will create it. Then, it will savehe

159 
sk
 
d©a
 
š
 
the
 
XML
 
objeù
.

161 @
·¿m
 
sk
: 
the
ask 
objeù
 
to
 
§ve


163 
tid
 = 
sk
.
	$g‘_id
()

164 #W
ü—‹
 
ª
 
XML
 
»´e£Á©iÚ
 
of
 
the
 
sk


165 
t_xml
 = 
skxml
.
	$sk_to_xml
(
£lf
.
doc
, 
sk
)

167 #w
fšd
 
the
 
sk
 
exi¡s
 
š
h
XML
 
Œ“node
.

168 
exi¡šg
 = 
NÚe


169 
node
 
š
 
£lf
.
xmÍroj
.
chdNodes
:

170 
node
.
nodeName
 =ğ
TASK_NODE
 
ªd
‚ode.
	`g‘A‰ribu‹
("id"è=ğ
tid
:

171 
exi¡šg
 = 
node


173 
modif›d
 = 
F®£


174 #W
th’
 
»¶aû
 
the
 
exi¡šg
 
node


175 
exi¡šg
 
ªd
 
t_xml
:

176 #W
wl
 
wr™e
 
Úly
 
the
 
sk
 
has
 
chªged


177 
t_xml
.
	`toxml
(è!ğ
exi¡šg
.
	$toxml
():

178 
£lf
.
xmÍroj
.
	$»¶aûChd
(
t_xml
, 
exi¡šg
)

179 
modif›d
 = 
True


180 #Ià
the
 
node
 
dÛ¢
'tƒxist, we create it

182 
£lf
.
xmÍroj
.
	$­³ndChd
(
t_xml
)

183 
modif›d
 = 
True


185 #ià
the
 
XML
 
objeù
 
has
 
chªged
, 
we
 
§ve
 
™
 
to
 
fe


186 
modif›d
 
ªd
 
£lf
.
_·¿m‘”s
["·th"]‡nd s–f.
doc
:

187 
ş—nxml
.
	`§vexml
(
£lf
.
	`g‘_·th
(), s–f.
doc
)

189 
def
 
	$»move_sk
(
£lf
, 
tid
):

191 
»moved
 
äom
 
the
 
back’d
. 
NÙe
 
th©
h
sk
 
could
 
be
 
nÙ
 
´e£Á
 
h”e
.

193 @
·¿m
 
tid
: 
the
 
id
 
of
h
sk
 
to
 
d–‘e


195 
modif›d
 = 
F®£


196 
node
 
š
 
£lf
.
xmÍroj
.
chdNodes
:

197 
node
.
nodeName
 =ğ
TASK_NODE
 
ªd
‚ode.
	`g‘A‰ribu‹
("id"è=ğ
tid
:

198 
modif›d
 = 
True


199 
£lf
.
xmÍroj
.
	$»moveChd
(
node
)

201 #W
§ve
 
the
 
XML
 
fe
 
Úly
 
™
's‚ecessary

202 
modif›d
:

203 
ş—nxml
.
	`§vexml
(
£lf
.
	`g‘_·th
(), s–f.
doc
, 
backup
=
True
)

205 
def
 
	$u£d_backup
(
£lf
):

207 
w”e
 
u£d
 
wh’
 
š¡ªtŸtšg
 
Back’d
 
şass
.

209  
£lf
.
_u£d_backup


211 
def
 
	$backup_fe_šfo
(
£lf
):

213 
gtg_sks
.
xml


215  
£lf
.
_backup_fe_šfo


217 
def
 
	$nÙify_u£r_about_backup
(
£lf
):

219 
about
 
fe
 
»cov”y
.

221 
mes§ge
 = 
	`_
(

224 è+ 
£lf
.
	$backup_fe_šfo
()

225 
	`Back’dSigÇls
().
	`š‹¿ùiÚ_»que¡ed
(

226 
£lf
.
	`g‘_id
(), 
mes§ge
,

227 
	`Back’dSigÇls
().
INTERACTION_INFORM
, "on_continue_clicked")

229 
def
 
	$Ú_cÚtšue_şicked
(
£lf
, *
¬gs
):

232 
·ss


	@backends/backend_mantis.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
impÜt
 
os


18 
impÜt
 
uuid


20 
äom
 
GTG
 
impÜt
 
_


21 
äom
 
	gGTG
.
	gback’ds
.
g’”icback’d
 
impÜt
 
G’”icBack’d


22 
äom
 
	gGTG
.
	gback’ds
.
back’dsigÇls
 
impÜt
 
Back’dSigÇls


23 
äom
 
	gGTG
.
	gback’ds
.
³riodicimpÜtback’d
 
impÜt
 
P”iodicImpÜtBack’d


24 
äom
 
	gGTG
.
	gback’ds
.
synûngše
 
impÜt
 
	gSyncEngše
, 
SyncMeme


25 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


27 
äom
 
	gGTG
.
	gcÜe
.
sk
 
impÜt
 
Task


28 
äom
 
	gsuds
.
ş›Á
 
impÜt
 
	gCl›Á


31 
Back’d
 
impÜtšg
 
mªtis
 
issues
 
š
 
GTG


33 
	gD•’d’c›s
:

34 * 
pythÚ
-
suds


38 
şass
 
	$Back’d
(
P”iodicImpÜtBack’d
):

39 
_g’”®_desütiÚ
 = {

40 
G’”icBack’d
.
BACKEND_NAME
: "backend_mantis",

41 
G’”icBack’d
.
BACKEND_HUMAN_NAME
: 
	`_
("MantisBT"),

42 
G’”icBack’d
.
BACKEND_AUTHORS
: ["Luca Invernizzi", "Alayn Gortazar"],

43 
G’”icBack’d
.
BACKEND_TYPE
: G’”icBack’d.
TYPE_READONLY
,

44 
G’”icBack’d
.
BACKEND_DESCRIPTION
:

45 
	`_
("This synchronization service†ets you importhe issues found"

60 
	}
}

62 
_¡©ic_·¿m‘”s
 = {

64 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_INT
,

65 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
: 5, },

67 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_STRING
,

68 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
: 'insert your username', },

70 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_PASSWORD
,

71 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
: '', },

73 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_STRING
,

74 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
: 'http://example.com/mantis',

77 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_BOOL
,

78 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
: 
True
},

81 
def
 
	$__š™__
(
£lf
, 
·¿m‘”s
):

83 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

84 
Re
-
lßds
 
the
 
§ved
 
¡©e
 
of
h
synchrÚiz©iÚ


86 
	`su³r
(
Back’d
, 
£lf
).
	$__š™__
(
·¿m‘”s
)

87 #lßdšg 
the
 
§ved
 
¡©e
 
of
h
synchrÚiz©iÚ
, 
ªy


88 
£lf
.
d©a_·th
 = 
os
.
·th
.
	`još
('backends/mantis/',

89 "sync_’gše-" + 
£lf
.
	$g‘_id
())

90 
£lf
.
sync_’gše
 = s–f.
	`_lßd_pickËd_fe
(£lf.
d©a_·th
,

91 
	$SyncEngše
())

93 
def
 
	$§ve_¡©e
(
£lf
):

95 
£lf
.
	$_¡Üe_pickËd_fe
(
£lf
.
d©a_·th
, s–f.
sync_’gše
)

97 
def
 
	$do_³riodic_impÜt
(
£lf
):

98 #E¡ablishšg 
cÚÃùiÚ


99 
Œy
:

100 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

101 
ş›Á
 = 
	`Cl›Á
('%s/api/soap/mantisconnect.php?wsdl' %

102 (
£lf
.
_·¿m‘”s
['service-url']))

103 
exû±
 
KeyE¼Ü
:

104 
£lf
.
	$qu™
(
di§bË
=
True
)

105 
	`Back’dSigÇls
().
	`back’d_çed
(
£lf
.
	`g‘_id
(),

106 
Back’dSigÇls
.
ERRNO_AUTHENTICATION


110 
´ojeùs
 = 
ş›Á
.
£rviû
.
	`mc_´ojeùs_g‘_u£r_acûssibË
(

111 
£lf
.
_·¿m‘”s
['username'],

112 
£lf
.
_·¿m‘”s
['password'])

113 
f‹rs
 = 
ş›Á
.
£rviû
.
	`mc_f‹r_g‘
(
£lf
.
_·¿m‘”s
['username'],

114 
£lf
.
_·¿m‘”s
['password'], 0)

116 #F‘chšg 
the
 
issues


117 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

118 
my_issues
 = []

119 
ft
 
š
 
f‹rs
:

120 
ft
['name'] == 'gtg':

121 
´ojeù
 
š
 
´ojeùs
:

122 
my_issues
 = 
ş›Á
.
£rviû
.
	`mc_f‹r_g‘_issues
(

123 
£lf
.
_·¿m‘”s
['username'],

124 
£lf
.
_·¿m‘”s
['password'],

125 
´ojeù
['id'],

126 
ft
['id'], 0, 100)

127 
issue
 
š
 
my_issues
:

128 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

129 
£lf
.
	$_´oûss_mªtis_issue
(
issue
)

130 
Ï¡_issue_li¡
 = 
£lf
.
sync_’gše
.
	$g‘_®l_»mÙe
()

131 
Ãw_issue_li¡
 = [
	`¡r
(
issue
['id']èissu
š
 
my_issues
]

132 
issue_lšk
 
š
 
	`£t
(
Ï¡_issue_li¡
).
	`difã»nû
(
	$£t
(
Ãw_issue_li¡
)):

133 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

134 #w
make
 
su»
 
th©
 
the
 
Ùh”
 
back’ds
 
¬e
 
nÙ
 
modifyšg
h
sk


136 
w™h
 
£lf
.
d©a¡Üe
.
	$g‘_back’d_mu‹x
():

137 
tid
 = 
£lf
.
sync_’gše
.
	$g‘_loÿl_id
(
issue_lšk
)

138 
£lf
.
d©a¡Üe
.
	$»que¡_sk_d–‘iÚ
(
tid
)

139 
Œy
:

140 
£lf
.
sync_’gše
.
	$b»ak_»ÏtiÚsh
(
»mÙe_id
=
issue_lšk
)

141 
exû±
 
KeyE¼Ü
:

142 
·ss


145 ###############################################################################
###Proûs 
sks
 #############################################################
###############################################################################
 _´oûss_mªtis_issue(£lf, issue):

147 
Giv’
 
a
 
issue
 
objeù
, 
fšds
 
out
 
™
 
mu¡
 
be
 
synûd
 
to
‡ 
GTG
 
nÙe
 
ªd
,

148 
so
, 
™
 
ÿ¼›s
 
out
 
the
 
	`synchrÚiz©iÚ
 (
by
 
ü—tšg
 
Ü


149 
upd©šg
 
a
 
GTG
 
sk
, 
Ü
 
d–‘šg
 
™£lf
 
the
 
»Ï‹d
ask 
has


150 
b“n
 
d–‘ed
)

152 @
·¿m
 
nÙe
: 
a
 
mªtis
 
issue


154 
has_sk
 = 
£lf
.
d©a¡Üe
.has_task

155 
aùiÚ
, 
tid
 = 
£lf
.
sync_’gše
.
	`ª®yze_»mÙe_id
(
	`¡r
(
issue
['id']),

156 
has_sk
,

157 
Ïmbda
 
b
: 
True
)

158 
Log
.
	`debug
("´oûssšg mªti (%s)" % (
aùiÚ
))

160 
aùiÚ
 
is
 
NÚe
:

163 
issue_dic
 = 
£lf
.
	$_´eãtch_issue_d©a
(
issue
)

164 #fÜ 
the
 
»¡
 
of
h
funùiÚ
, 
no
 
acûss
 
to
 
issue
 
mu¡
 
be
 
made
, 
so


165 #th© 
the
 
time
 
of
 
blockšg
 
šside
h
w™h
 
¡©em’ts
 
is
 .

166 #TØ
be
 
su»
 
of
 
th©
, 
£t
 
issue
 
to
 
NÚe


167 
issue
 = 
NÚe


169 
w™h
 
£lf
.
d©a¡Üe
.
	$g‘_back’d_mu‹x
():

170 
aùiÚ
 =ğ
SyncEngše
.
ADD
:

171 
tid
 = 
	`¡r
(
uuid
.
	$uuid4
())

172 
sk
 = 
£lf
.
d©a¡Üe
.
	$sk_çùÜy
(
tid
)

173 
£lf
.
	$_pİuÏ‹_sk
(
sk
, 
issue_dic
)

174 
meme
 = 
	`SyncMeme
(

175 
sk
.
	`g‘_modif›d
(), 
issue_dic
['modif›d'], 
£lf
.
	$g‘_id
())

176 
£lf
.
sync_’gše
.
	`»cÜd_»ÏtiÚsh
(

177 
loÿl_id
=
tid
,

178 
»mÙe_id
=
	`¡r
(
issue_dic
['number']),

179 
meme
=meme

181 
£lf
.
d©a¡Üe
.
	$push_sk
(
sk
)

183 
–if
 
aùiÚ
 =ğ
SyncEngše
.
UPDATE
:

184 
sk
 = 
£lf
.
d©a¡Üe
.
	$g‘_sk
(
tid
)

185 
£lf
.
	$_pİuÏ‹_sk
(
sk
, 
issue_dic
)

186 
meme
 = 
£lf
.
sync_’gše
.
	`g‘_meme_äom_»mÙe_id
(

187 
issue_dic
['number'])

188 
meme
.
	`£t_loÿl_Ï¡_modif›d
(
sk
.
	$g‘_modif›d
())

189 
meme
.
	`£t_»mÙe_Ï¡_modif›d
(
issue_dic
['modified'])

190 
£lf
.
	$§ve_¡©e
()

192 
def
 
	$_´eãtch_issue_d©a
(
£lf
, 
mªtis_issue
):

194 
We
 
ãtch
 
®l
 
the
 
Ãûs§ry
 
šfo
 
th©
 
we
 
Ãed
 
äom
h
mªtis_issue
 
to


195 
pİuÏ‹
 
a
 
sk
 
	`befÜehªd
 (
the£
 
wl
 
be
 
u£d
 
š
 
_pİuÏ‹_sk
).

197 @
·¿m
 
mªtis_issue
: 
a
 
mªtis
 
issue


198 @
»tuºs
 
diù
: 
a
 
diùiÚ¬y
 
cÚššg
 
the
 
»Ëvªt
 
issue
 
©Œibu‹s


200 
issue_dic
 = {'t™Ë': 
mªtis_issue
['summary'],

201 '‹xt': 
mªtis_issue
['description'],

202 '»pÜ‹r': 
mªtis_issue
['»pÜ‹r'].
Çme
,

203 'modif›d': 
mªtis_issue
['last_updated'],

204 '´ojeù': 
mªtis_issue
['´ojeù'].
Çme
,

205 '¡©us': 
mªtis_issue
['¡©us'].
Çme
,

206 'com¶‘ed': (
mªtis_issue
['¡©us'].
id
 >= 80),

207 'numb”': 
	`¡r
(
mªtis_issue
['id'])
	}
}

209 
Œy
:

210 
issue_dic
['assigÃd'] = 
mªtis_issue
['hªdËr'].
Çme
 == \

211 
£lf
.
_·¿m‘”s
['username']

212 
exû±
 
A‰ribu‹E¼Ü
:

213 
issue_dic
['assigÃd'] = 
F®£


215  
issue_dic


217 
def
 
	$_pİuÏ‹_sk
(
£lf
, 
sk
, 
issue_dic
):

219 
Fls
 
a
 
GTG
 
sk
 
w™h
 
the
 
d©a
 
äom
‡ 
mªtis
 
issue
.

221 @
·¿m
 
sk
: 
a
 
Task


222 @
·¿m
 
issue_dic
: 
a
 
mªtis
 
issue


225 #£ˆ
sk
 
¡©us


226 
issue_dic
["completed"]:

227 
sk
.
	$£t_¡©us
(
Task
.
STA_DONE
)

229 
sk
.
	$£t_¡©us
(
Task
.
STA_ACTIVE
)

230 
sk
.
	`g‘_t™Ë
(è!ğ
issue_dic
['title']:

231 
sk
.
	`£t_t™Ë
(
	`_
("Iss."è+ " %s: " % 
issue_dic
["number"]

232 + 
issue_dic
['title'])

233 
‹xt
 = 
£lf
.
	$_bud_issue_‹xt
(
issue_dic
)

234 
sk
.
	`g‘_exû½t
(è!ğ
‹xt
:

235 
sk
.
	$£t_‹xt
(
‹xt
)

237 
Ãw_gs
 = 
	$£t
([])

238 
£lf
.
_·¿m‘”s
["tag-with-project-name"]:

239 
Ãw_gs
 = 
	`£t
(['@' + 
issue_dic
['project']])

240 
cu¼’t_gs
 = 
	`£t
(
sk
.
	$g‘_gs_Çme
())

241 #add 
the
 
Ãw
 
Úes


242 
g
 
š
 
Ãw_gs
.
	$difã»nû
(
cu¼’t_gs
):

243 
sk
.
	$add_g
(
g
)

245 
sk
.
	`add_»mÙe_id
(
£lf
.
	`g‘_id
(), 
issue_dic
['number'])

247 
def
 
	$_bud_issue_‹xt
(
£lf
, 
issue_dic
):

249 
C»©es
 
the
 
‹xt
 
th©
 
desüibes
 
a
 
issue


251 
‹xt
 = 
	`_
("R•Ü‹d by: "è+ 
issue_dic
["reporter"] + '\n'

252 
‹xt
 +ğ
	`_
("Linko issue: ") + \

253 
£lf
.
_·¿m‘”s
['service-url'] + '/view.php?id=%s' % \

254 (
issue_dic
["number"]) + '\n'

255 
‹xt
 +ğ'\n' + 
issue_dic
["text"]

256  
‹xt


	@backends/backend_rtm.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
Rememb”
 
the
 
mk
 
	gback’d


21 
impÜt
 
os


22 
impÜt
 
cgi


23 
impÜt
 
uuid


24 
impÜt
 
time


25 
impÜt
 
th»adšg


26 
impÜt
 
d©‘ime


27 
impÜt
 
sub´oûss


28 
äom
 
	gd©eut
.
tz
 
impÜt
 
	gtzutc
, 
tzloÿl


30 
äom
 
	gGTG
.
	gback’ds
.
g’”icback’d
 
impÜt
 
G’”icBack’d


31 
äom
 
GTG
 
impÜt
 
_


32 
äom
 
	gGTG
.
	gback’ds
.
back’dsigÇls
 
impÜt
 
Back’dSigÇls


33 
äom
 
	gGTG
.
	gback’ds
.
synûngše
 
impÜt
 
	gSyncEngše
, 
SyncMeme


34 
äom
 
	gGTG
.
	gback’ds
.
	g¹m
.
¹m
 
impÜt
 
	gü—‹RTM
, 
	gRTME¼Ü
, 
RTMAPIE¼Ü


35 
äom
 
	gGTG
.
	gback’ds
.
³riodicimpÜtback’d
 
impÜt
 
P”iodicImpÜtBack’d


36 
äom
 
	gGTG
.
	gtoŞs
.
d©es
 
impÜt
 
D©e


37 
äom
 
	gGTG
.
	gcÜe
.
sk
 
impÜt
 
Task


38 
äom
 
	gGTG
.
	gtoŞs
.
š‹¼u±ibË
 
impÜt
 interruptible

39 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


40 
äom
 
funùoŞs
 
impÜt
 
»duû


43 
şass
 
	$Back’d
(
P”iodicImpÜtBack’d
):

45 
_g’”®_desütiÚ
 = {

46 
G’”icBack’d
.
BACKEND_NAME
: "backend_rtm",

47 
G’”icBack’d
.
BACKEND_HUMAN_NAME
: 
	`_
("Remember The Milk"),

48 
G’”icBack’d
.
BACKEND_AUTHORS
: ["Luca Invernizzi"],

49 
G’”icBack’d
.
BACKEND_TYPE
: G’”icBack’d.
TYPE_READWRITE
,

50 
G’”icBack’d
.
BACKEND_DESCRIPTION
:

51 
	`_
("This service synchronizes yourasks withhe web service"

55 
	}
}

57 
_¡©ic_·¿m‘”s
 = {

59 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_INT
,

60 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
: 10, },

62 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_BOOL
,

63 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
: 
True
, },

66 ###############################################################################
###Back’d 
¡ªd¬d
 
m‘hods
 ##################################################

68 
def
 
	$__š™__
(
£lf
, 
·¿m‘”s
):

70 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

71 
Lßds
 
the
 
§ved
 
¡©e
 
of
h
sync
, 
ªy


73 
	`su³r
(
Back’d
, 
£lf
).
	$__š™__
(
·¿m‘”s
)

74 #lßdšg 
the
 
§ved
 
¡©e
 
of
h
synchrÚiz©iÚ
, 
ªy


75 
£lf
.
sync_’gše_·th
 = 
os
.
·th
.
	`još
('backends/rtm/',

76 "sync_’gše-" + 
£lf
.
	$g‘_id
())

77 
£lf
.
sync_’gše
 = s–f.
	`_lßd_pickËd_fe
(£lf.
sync_’gše_·th
,

78 
	$SyncEngše
())

79 #»lßdšg 
the
 
ßuth
 
auth’tiÿtiÚ
 
tok’
, 
ªy


80 
£lf
.
tok’_·th
 = 
os
.
·th
.
	`još
('backends/rtm/',

81 "auth_tok’-" + 
£lf
.
	$g‘_id
())

82 
£lf
.
tok’
 = s–f.
	$_lßd_pickËd_fe
(
£lf
.
tok’_·th
, 
NÚe
)

83 
£lf
.
’queued_¡¬t_g‘_sk
 = 
F®£


84 
£lf
.
logš_ev’t
 = 
th»adšg
.
	$Ev’t
()

85 
£lf
.
_this_is_the_fœ¡_loİ
 = 
True


87 
def
 
	$š™Ÿlize
(
£lf
):

89 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

91 
	`su³r
(
Back’d
, 
£lf
).
	$š™Ÿlize
()

92 
£lf
.
¹m_´oxy
 = 
	$RTMProxy
(
£lf
.
_ask_u£r_to_cÚfœm_auth’tiÿtiÚ
,

93 
£lf
.
_Ú_sucûssful_auth’tiÿtiÚ
,

94 
£lf
.
tok’
)

96 
def
 
	$§ve_¡©e
(
£lf
):

98 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

100 
£lf
.
	$_¡Üe_pickËd_fe
(
£lf
.
sync_’gše_·th
, s–f.
sync_’gše
)

102 
def
 
	$_ask_u£r_to_cÚfœm_auth’tiÿtiÚ
(
£lf
):

104 
C®ls
 
a
 
u£r
 
š‹¿ùiÚ
 
duršg
 
auth’tiÿtiÚ


106 
£lf
.
logš_ev’t
.
	$ş—r
()

107 
	`Back’dSigÇls
().
	`š‹¿ùiÚ_»que¡ed
(
£lf
.
	`g‘_id
(),

115 
	`Back’dSigÇls
(

116 ).
INTERACTION_CONFIRM
,

118 
£lf
.
logš_ev’t
.
	$wa™
()

120 
def
 
	$Ú_logš
(
£lf
):

122 
C®Ëd
 
wh’
 
the
 
u£r
 
cÚfœms
h
logš


124 
£lf
.
logš_ev’t
.
	$£t
()

126 ###############################################################################
###TWO 
WAY
 
SYNC
 ##############################################################

128 
def
 
	$do_³riodic_impÜt
(
£lf
):

130 
S“
 
P”iodicImpÜtBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

133 #w
g‘
 
the
 
Şd
 
li¡
 
of
 
synûd
 
sks
, 
ªd
 
com·»
 
w™h
h
Ãw
asks

135 
¡Üed_¹m_sk_ids
 = 
£lf
.
sync_’gše
.
	$g‘_®l_»mÙe
()

136 
cu¼’t_¹m_sk_ids
 = [
tid
 tid 
š


137 
£lf
.
¹m_´oxy
.
	`g‘_¹m_sks_diù
().
	`keys
()]

139 #Ià
™
' thv”y fœ¡imthback’d i run, it'
s
 
possibË
 
th©


140 #th
u£r
 
®»ady
 
synûd
 
his
 
sks
 
š
 
some
 
	`way
 (
but
 
we
 
dÚ
't know

141 #th©). 
Th”efÜe
, 
we
 
©‹m±
 
to
 
šduû
 
tho£
 
sks
 
»ÏtiÚshs


142 #m©chšg 
the
 
t™Ës
.

143 
£lf
.
_·¿m‘”s
["is-first-run"]:

144 
gtg_t™Ës_dic
 = {
	}
}

145 
tid
 
š
 
£lf
.
d©a¡Üe
.
	$g‘_®l_sks
():

146 
gtg_sk
 = 
£lf
.
d©a¡Üe
.
	$g‘_sk
(
tid
)

147 
nÙ
 
£lf
.
	$_gtg_sk_is_synÿbË_³r_©ched_gs
(
gtg_sk
):

149 
gtg_t™Ë
 = 
gtg_sk
.
	$g‘_t™Ë
()

150 
gtg_t™Ë
 
š
 
gtg_t™Ës_dic
:

151 
gtg_t™Ës_dic
[
gtg_sk
.
	`g‘_t™Ë
()].
	$­³nd
(
tid
)

153 
gtg_t™Ës_dic
[
gtg_sk
.
	`g‘_t™Ë
()] = [
tid
]

154 
¹m_sk_id
 
š
 
cu¼’t_¹m_sk_ids
:

155 
¹m_sk
 = 
£lf
.
¹m_´oxy
.
	`g‘_¹m_sks_diù
()[
¹m_sk_id
]

156 
Œy
:

157 
tids
 = 
gtg_t™Ës_dic
[
¹m_sk
.
	`g‘_t™Ë
()]

158 #w
»move
 
the
 
tid
, 
so
 
th©
 
™
 
ÿn
't be†inkedowo

159 #difã»Á 
¹m
 
sks


160 
tid
 = 
tids
.
	$pİ
()

161 
gtg_sk
 = 
£lf
.
d©a¡Üe
.
	$g‘_sk
(
tid
)

162 
meme
 = 
	`SyncMeme
(
gtg_sk
.
	`g‘_modif›d
(),

163 
¹m_sk
.
	`g‘_modif›d
(),

165 
£lf
.
sync_’gše
.
	`»cÜd_»ÏtiÚsh
(

166 
loÿl_id
=
tid
,

167 
»mÙe_id
=
¹m_sk
.
	`g‘_id
(),

168 
meme
=meme)

169 
exû±
 
KeyE¼Ü
:

170 
·ss


171 #¨
fœ¡
 
run
 
has
 
b“n
 
com¶‘ed
 
sucûssfuÎy


172 
£lf
.
_·¿m‘”s
["is-fœ¡-run"] = 
F®£


174 
¹m_sk_id
 
š
 
cu¼’t_¹m_sk_ids
:

175 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

176 #Addšg 
ªd
 
upd©šg


177 
£lf
.
	$_´oûss_¹m_sk
(
¹m_sk_id
)

179 
¹m_sk_id
 
š
 
	`£t
(
¡Üed_¹m_sk_ids
).
	`difã»nû
(

180 
	$£t
(
cu¼’t_¹m_sk_ids
)):

181 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

182 #Removšg 
the
 
Şd
 
Úes


183 
nÙ
 
£lf
.
¶—£_qu™
:

184 
tid
 = 
£lf
.
sync_’gše
.
	$g‘_loÿl_id
(
¹m_sk_id
)

185 
£lf
.
d©a¡Üe
.
	$»que¡_sk_d–‘iÚ
(
tid
)

186 
Œy
:

187 
£lf
.
sync_’gše
.
	$b»ak_»ÏtiÚsh
(
»mÙe_id
=
¹m_sk_id
)

188 
£lf
.
	$§ve_¡©e
()

189 
exû±
 
KeyE¼Ü
:

190 
·ss


192 
def
 
	$_Ú_sucûssful_auth’tiÿtiÚ
(
£lf
):

194 
Saves
 
the
 
tok’
 
ªd
 
»que¡s
 
a
 
fuÎ
 
æush
 
Ú
 
fœ¡
 
au‹ÁiÿtiÚ


196 
£lf
.
_this_is_the_fœ¡_loİ
 = 
F®£


197 
£lf
.
	`_¡Üe_pickËd_fe
(£lf.
tok’_·th
,

198 
£lf
.
¹m_´oxy
.
	$g‘_auth_tok’
())

199 #w
ask
 
the
 
D©a¡Üe
 
to
 
æush
 
®l
h
sks
 
Ú
 
us


200 
th»adšg
.
	`Tim”
(10,

201 
£lf
.
d©a¡Üe
.
æush_®l_sks
,

202 
¬gs
=(
£lf
.
	`g‘_id
(),)).
	`¡¬t
()

204 @
š‹¼u±ibË


205 
def
 
	$»move_sk
(
£lf
, 
tid
):

207 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

209 
nÙ
 
£lf
.
¹m_´oxy
.
	$is_auth’tiÿ‹d
():

211 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

212 
Œy
:

213 
¹m_sk_id
 = 
£lf
.
sync_’gše
.
	$g‘_»mÙe_id
(
tid
)

214 
¹m_sk_id
 
nÙ
 
š
 
£lf
.
¹m_´oxy
.
	$g‘_¹m_sks_diù
():

215 #w
might
 
Ãed
 
to
 
»äesh
 
our
 
sk
 
ÿche


216 
£lf
.
¹m_´oxy
.
	$»äesh_¹m_sks_diù
()

217 
¹m_sk
 = 
£lf
.
¹m_´oxy
.
	`g‘_¹m_sks_diù
()[
¹m_sk_id
]

218 
¹m_sk
.
	$d–‘e
()

219 
Log
.
	`debug
("»movšgask % äom RTM" % 
¹m_sk_id
)

220 
exû±
 
KeyE¼Ü
:

221 
·ss


222 
Œy
:

223 
£lf
.
sync_’gše
.
	$b»ak_»ÏtiÚsh
(
loÿl_id
=
tid
)

224 
£lf
.
	$§ve_¡©e
()

225 
exû±
:

226 
·ss


228 ###############################################################################
###Proûs 
sks
 #############################################################
###############################################################################
@
š‹¼u±ibË


229 
def
 
	$£t_sk
(
£lf
, 
sk
):

231 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

233 
nÙ
 
£lf
.
¹m_´oxy
.
	$is_auth’tiÿ‹d
():

235 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

236 
tid
 = 
sk
.
	$g‘_id
()

237 
is_synÿbË
 = 
£lf
.
	$_gtg_sk_is_synÿbË_³r_©ched_gs
(
sk
)

238 
aùiÚ
, 
¹m_sk_id
 = 
£lf
.
sync_’gše
.
	$ª®yze_loÿl_id
(

239 
tid
,

240 
£lf
.
d©a¡Üe
.
has_sk
,

241 
£lf
.
¹m_´oxy
.
has_¹m_sk
,

242 
is_synÿbË
)

243 
Log
.
	`debug
("GTG->RTM s‘ask (%s, %s)" % (
aùiÚ
, 
is_synÿbË
))

245 
aùiÚ
 
is
 
NÚe
:

248 
aùiÚ
 =ğ
SyncEngše
.
ADD
:

249 
sk
.
	`g‘_¡©us
(è!ğ
Task
.
STA_ACTIVE
:

251 #w
dÚ
't syncaskshat have‡lready been closed before we

252 #ev’ 
synûd
 
them
 
Úû


254 
Œy
:

255 
¹m_sk
 = 
£lf
.
¹m_´oxy
.
	`ü—‹_Ãw_¹m_sk
(
sk
.
	$g‘_t™Ë
())

256 
£lf
.
	$_pİuÏ‹_¹m_sk
(
sk
, 
¹m_sk
)

257 
exû±
:

258 
¹m_sk
.
	$d–‘e
()

259 
¿i£


260 
meme
 = 
	`SyncMeme
(
sk
.
	`g‘_modif›d
(),

261 
¹m_sk
.
	`g‘_modif›d
(),

263 
£lf
.
sync_’gše
.
	`»cÜd_»ÏtiÚsh
(

264 
loÿl_id
=
tid
, 
»mÙe_id
=
¹m_sk
.
	`g‘_id
(), 
meme
=meme)

266 
–if
 
aùiÚ
 =ğ
SyncEngše
.
UPDATE
:

267 
Œy
:

268 
¹m_sk
 = 
£lf
.
¹m_´oxy
.
	`g‘_¹m_sks_diù
()[
¹m_sk_id
]

269 
exû±
 
KeyE¼Ü
:

270 #š 
this
 , 
we
 
dÚ
't have yetheask in our†ocal cache

271 #oà
wh©
's onhe„tm website

272 
£lf
.
¹m_´oxy
.
	$»äesh_¹m_sks_diù
()

273 
¹m_sk
 = 
£lf
.
¹m_´oxy
.
	`g‘_¹m_sks_diù
()[
¹m_sk_id
]

274 
w™h
 
£lf
.
d©a¡Üe
.
	$g‘_back’d_mu‹x
():

275 
meme
 = 
£lf
.
sync_’gše
.
	`g‘_meme_äom_loÿl_id
(
sk
.
	$g‘_id
())

276 
Ãwe¡
 = 
meme
.
	`which_is_Ãwe¡
(
sk
.
	`g‘_modif›d
(),

277 
¹m_sk
.
	$g‘_modif›d
())

278 
Ãwe¡
 == "local":

279 
Œª§ùiÚ_ids
 = []

280 
Œy
:

281 
£lf
.
	$_pİuÏ‹_¹m_sk
(

282 
sk
, 
¹m_sk
, 
Œª§ùiÚ_ids
)

283 
exû±
:

284 
£lf
.
¹m_´oxy
.
	$uÄŞl_chªges
(
Œª§ùiÚ_ids
)

285 
¿i£


286 
meme
.
	`£t_»mÙe_Ï¡_modif›d
(
¹m_sk
.
	$g‘_modif›d
())

287 
meme
.
	`£t_loÿl_Ï¡_modif›d
(
sk
.
	$g‘_modif›d
())

289 #w
sk
 
§všg
 
the
 
¡©e


292 
–if
 
aùiÚ
 =ğ
SyncEngše
.
REMOVE
:

293 
£lf
.
d©a¡Üe
.
	$»que¡_sk_d–‘iÚ
(
tid
)

294 
Œy
:

295 
£lf
.
sync_’gše
.
	$b»ak_»ÏtiÚsh
(
loÿl_id
=
tid
)

296 
exû±
 
KeyE¼Ü
:

297 
·ss


299 
–if
 
aùiÚ
 =ğ
SyncEngše
.
LOST_SYNCABILITY
:

300 
Œy
:

301 
¹m_sk
 = 
£lf
.
¹m_´oxy
.
	`g‘_¹m_sks_diù
()[
¹m_sk_id
]

302 
exû±
 
KeyE¼Ü
:

303 #š 
this
 , 
we
 
dÚ
't have yetheask in our†ocal cache

304 #oà
wh©
's onhe„tm website

305 
£lf
.
¹m_´oxy
.
	$»äesh_¹m_sks_diù
()

306 
¹m_sk
 = 
£lf
.
¹m_´oxy
.
	`g‘_¹m_sks_diù
()[
¹m_sk_id
]

307 
£lf
.
	$_exec_lo¡_synÿb™y
(
tid
, 
¹m_sk
)

309 
£lf
.
	$§ve_¡©e
()

311 
def
 
	$_exec_lo¡_synÿb™y
(
£lf
, 
tid
, 
¹m_sk
):

313 
Execu‹d
 
wh’
 
a
 
»ÏtiÚsh
 
b‘w“n
 
sks
 
lo£s
 
™s
 
synÿb™y


314 
´İ”ty
. 
S“
 
SyncEngše
 
ª
 
ex¶ª©iÚ
 
of
 
th©
.

316 @
·¿m
 
tid
: 
a
 
GTG
 
sk
id

317 @
·¿m
 
nÙe
: 
a
 
RTM
 
sk


319 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

320 
meme
 = 
£lf
.
sync_’gše
.
	$g‘_meme_äom_loÿl_id
(
tid
)

321 #Fœ¡ 
of
 
®l
, 
the
 
»ÏtiÚsh
 
is
 
lo¡


322 
£lf
.
sync_’gše
.
	$b»ak_»ÏtiÚsh
(
loÿl_id
=
tid
)

323 
meme
.
	`g‘_Üigš
() == "GTG":

324 
¹m_sk
.
	$d–‘e
()

326 
£lf
.
d©a¡Üe
.
	$»que¡_sk_d–‘iÚ
(
tid
)

328 
def
 
	$_´oûss_¹m_sk
(
£lf
, 
¹m_sk_id
):

330 
Takes
 
a
 
¹m
 
sk
 
id
 
ªd
 
ÿ¼›s
 
out
 
the
 
Ãûs§ry
 
İ”©iÚs
 
to


331 
»äesh
 
the
 
sync
 
¡©e


333 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

334 
nÙ
 
£lf
.
¹m_´oxy
.
	$is_auth’tiÿ‹d
():

336 
¹m_sk
 = 
£lf
.
¹m_´oxy
.
	`g‘_¹m_sks_diù
()[
¹m_sk_id
]

337 
is_synÿbË
 = 
£lf
.
	$_¹m_sk_is_synÿbË_³r_©ched_gs
(
¹m_sk
)

338 
aùiÚ
, 
tid
 = 
£lf
.
sync_’gše
.
	$ª®yze_»mÙe_id
(

339 
¹m_sk_id
,

340 
£lf
.
d©a¡Üe
.
has_sk
,

341 
£lf
.
¹m_´oxy
.
has_¹m_sk
,

342 
is_synÿbË
)

343 
Log
.
	`debug
("GTG<-RTM s‘ask (%s, %s)" % (
aùiÚ
, 
is_synÿbË
))

345 
aùiÚ
 
is
 
NÚe
:

348 
aùiÚ
 =ğ
SyncEngše
.
ADD
:

349 
¹m_sk
.
	`g‘_¡©us
(è!ğ
Task
.
STA_ACTIVE
:

351 #w
dÚ
't syncaskshat have‡lready been closed before we

352 #ev’ 
§w
 
them


354 
tid
 = 
	`¡r
(
uuid
.
	$uuid4
())

355 
sk
 = 
£lf
.
d©a¡Üe
.
	$sk_çùÜy
(
tid
)

356 
£lf
.
	$_pİuÏ‹_sk
(
sk
, 
¹m_sk
)

357 
meme
 = 
	`SyncMeme
(
sk
.
	`g‘_modif›d
(),

358 
¹m_sk
.
	`g‘_modif›d
(),

360 
£lf
.
sync_’gše
.
	$»cÜd_»ÏtiÚsh
(

361 
loÿl_id
=
tid
,

362 
»mÙe_id
=
¹m_sk_id
,

363 
meme
=meme)

364 
£lf
.
d©a¡Üe
.
	$push_sk
(
sk
)

366 
–if
 
aùiÚ
 =ğ
SyncEngše
.
UPDATE
:

367 
sk
 = 
£lf
.
d©a¡Üe
.
	$g‘_sk
(
tid
)

368 
w™h
 
£lf
.
d©a¡Üe
.
	$g‘_back’d_mu‹x
():

369 
meme
 = 
£lf
.
sync_’gše
.
	$g‘_meme_äom_»mÙe_id
(
¹m_sk_id
)

370 
Ãwe¡
 = 
meme
.
	`which_is_Ãwe¡
(
sk
.
	`g‘_modif›d
(),

371 
¹m_sk
.
	$g‘_modif›d
())

372 
Ãwe¡
 == "remote":

373 
£lf
.
	$_pİuÏ‹_sk
(
sk
, 
¹m_sk
)

374 
meme
.
	`£t_»mÙe_Ï¡_modif›d
(
¹m_sk
.
	$g‘_modif›d
())

375 
meme
.
	`£t_loÿl_Ï¡_modif›d
(
sk
.
	$g‘_modif›d
())

377 #w
sk
 
§všg
 
the
 
¡©e


380 
–if
 
aùiÚ
 =ğ
SyncEngše
.
REMOVE
:

381 
Œy
:

382 
¹m_sk
.
	$d–‘e
()

383 
£lf
.
sync_’gše
.
	$b»ak_»ÏtiÚsh
(
»mÙe_id
=
¹m_sk_id
)

384 
exû±
 
KeyE¼Ü
:

385 
·ss


387 
–if
 
aùiÚ
 =ğ
SyncEngše
.
LOST_SYNCABILITY
:

388 
£lf
.
	$_exec_lo¡_synÿb™y
(
tid
, 
¹m_sk
)

390 
£lf
.
	$§ve_¡©e
()

392 ###############################################################################
###H–³¸
m‘hods
 ############################################################

394 
def
 
	$_pİuÏ‹_sk
(
£lf
, 
sk
, 
¹m_sk
):

396 
Cİ›s
 
the
 
cÚ‹Á
 
of
 
a
 
RTMTask
 
š
‡ 
Task


398 
sk
.
	`£t_t™Ë
(
¹m_sk
.
	$g‘_t™Ë
())

399 
sk
.
	`£t_‹xt
(
¹m_sk
.
	$g‘_‹xt
())

400 
sk
.
	`£t_due_d©e
(
¹m_sk
.
	$g‘_due_d©e
())

401 
¡©us
 = 
¹m_sk
.
	$g‘_¡©us
()

402 
GTG_TO_RTM_STATUS
[
sk
.
	`g‘_¡©us
()] !ğ
¡©us
:

403 
sk
.
	`£t_¡©us
(
¹m_sk
.
	$g‘_¡©us
())

405 
gs
 = 
	`£t
(['@%s' % 
g
 g 
š
 
¹m_sk
.
	`g‘_gs
()])

406 
gtg_gs_low”
 = 
	`£t
([
t
.
	`g‘_Çme
().
	$low”
(è
t
 
š
 
sk
.
	`g‘_gs
()])

407 #g 
to
 
»move


408 
g
 
š
 
gtg_gs_low”
.
	$difã»nû
(
gs
):

409 
sk
.
	$»move_g
(
g
)

410 #g 
to
 
add


411 
g
 
š
 
gs
.
	$difã»nû
(
gtg_gs_low”
):

412 
gtg_®l_gs
 = 
£lf
.
d©a¡Üe
.
	$g‘_®l_gs
()

413 
m©chšg_gs
 = [
t
 ˆ
š
 
gtg_®l_gs
 t.
	`low”
(è=ğ
g
]

414 
	`Ën
(
m©chšg_gs
) != 0:

415 
g
 = 
m©chšg_gs
[0]

416 
sk
.
	$add_g
(
g
)

418 
def
 
	$_pİuÏ‹_¹m_sk
(
£lf
, 
sk
, 
¹m_sk
, 
Œª§ùiÚ_ids
=[]):

420 
Cİ›s
 
the
 
cÚ‹Á
 
of
 
a
 
Task
 
što
‡ 
RTMTask


422 @
·¿m
 
sk
: 
a
 
GTG
 
Task


423 @
·¿m
 
¹m_sk
: 
ª
 
RTMTask


424 @
·¿m
 
Œª§ùiÚ_ids
: 
a
 
li¡
 
to
 
fl
 
w™h
 
Œª§ùiÚ
 
ids


426 #G‘ 
m‘hods
 
of
 
ª
 
¹m_sk
 
¬e
 
ç¡
, 
£t
‡» 
¦ow
: 
th”efÜe
,

427 #w
Œy
 
to
 
u£
 
£t
 
as
 
¿»ly
‡ 
possibË


429 #fœ¡ 
thšg
: 
the
 
¡©us
. 
This
 
way
, 
we
 
¬e
 
syncšg
 
a
 
com¶‘ed


430 #sk 
™
 
dÛ¢
't†inger foren seconds inhe RTM Inbox

431 
¡©us
 = 
sk
.
	$g‘_¡©us
()

432 
¹m_sk
.
	`g‘_¡©us
(è!ğ
¡©us
:

433 
£lf
.
	$__ÿÎ_Ü_»Œy
(
¹m_sk
.
£t_¡©us
, 
¡©us
, 
Œª§ùiÚ_ids
)

434 
t™Ë
 = 
sk
.
	$g‘_t™Ë
()

435 
¹m_sk
.
	`g‘_t™Ë
(è!ğ
t™Ë
:

436 
£lf
.
	$__ÿÎ_Ü_»Œy
(
¹m_sk
.
£t_t™Ë
, 
t™Ë
, 
Œª§ùiÚ_ids
)

437 
‹xt
 = 
sk
.
	$g‘_exû½t
(
¡r_gs
=
True
, 
¡r_subsks
=True)

438 
¹m_sk
.
	`g‘_‹xt
(è!ğ
‹xt
:

439 
£lf
.
	$__ÿÎ_Ü_»Œy
(
¹m_sk
.
£t_‹xt
, 
‹xt
, 
Œª§ùiÚ_ids
)

440 
gs
 = 
sk
.
	$g‘_gs_Çme
()

441 
¹m_sk_gs
 = []

442 
g
 
š
 
¹m_sk
.
	$g‘_gs
():

443 
g
[0] != '@':

444 
g
 = '@' +ag

445 
¹m_sk_gs
.
	$­³nd
(
g
)

446 #¹m 
gs
 
¬e
 
low”ÿ£
 
Úly


447 
¹m_sk_gs
 !ğ[
t
.
	$low”
(è
t
 
š
 
gs
]:

448 
£lf
.
	$__ÿÎ_Ü_»Œy
(
¹m_sk
.
£t_gs
, 
gs
, 
Œª§ùiÚ_ids
)

449 
due_d©e
 = 
sk
.
	$g‘_due_d©e
()

450 
¹m_sk
.
	`g‘_due_d©e
(è!ğ
due_d©e
:

451 
£lf
.
	$__ÿÎ_Ü_»Œy
(
¹m_sk
.
£t_due_d©e
, 
due_d©e
,

452 
Œª§ùiÚ_ids
)

454 
def
 
	$__ÿÎ_Ü_»Œy
(
£lf
, 
fun
, *
¬gs
):

456 
This
 
funùiÚ
 
ÿÂÙ
 
¡ªd
 
the
 
ÿÎ
 "fun" 
to
 
ç
, 
so
 
™
 
»Œ›s


457 
th»e
 
times
 
befÜe
 
givšg
 
up
.

459 
MAX_ATTEMPTS
 = 3

460 
i
 
š
 
	$¿nge
(
MAX_ATTEMPTS
):

461 
Œy
:

462  
	$fun
(*
¬gs
)

463 
exû±
:

464 
i
 >ğ
MAX_ATTEMPTS
:

465 
¿i£


467 
def
 
	$_¹m_sk_is_synÿbË_³r_©ched_gs
(
£lf
, 
¹m_sk
):

469 
H–³r
 
funùiÚ
 
which
 
checks
 
the
 
giv’
 
sk
 
§tisf›s
h
f‹ršg


470 
impo£d
 
by
 
the
 
gs
 
©ched
 
to
h
back’d
.

471 
Th©
 
m—ns
, 
a
 
u£r
 
wªts
‡ 
back’d
 
to
 
sync
 
Úly
 
sks
 
gged
 @
wÜks
,

472 
this
 
funùiÚ
 
should
 
be
 
u£d
 
to
 
check
 
th©
 
is
 
v”if›d
.

474 @
»tuºs
 
boŞ
: 
True
 
the
 
sk
 
should
 
be
 
synûd


476 
©ched_gs
 = 
£lf
.
	$g‘_©ched_gs
()

477 
G’”icBack’d
.
ALLTASKS_TAG
 
š
 
©ched_gs
:

478  
True


479 
g
 
š
 
¹m_sk
.
	$g‘_gs
():

480 "@" + 
g
 
š
 
©ched_gs
:

481  
True


482  
F®£


484 ###############################################################################
###RTM 
PROXY
 #################################################################
###############################################################################


486 
şass
 
	$RTMProxy
(
objeù
):

488 
The
 
pu½o£
 
of
 
this
 
şass
 
is
 
´oducšg
 
ª
 
upd©ed
 
li¡
 oà
RTMTasks
.

489 
To
 dØ
th©
, 
™
 
hªdËs
:

490 - 
auth’tiÿtiÚ
 
to
 
RTM


491 - 
k“pšg
 
the
 
li¡
 
äesh


492 - 
dowÆßdšg
 
the
 
li¡


495 
PUBLIC_KEY
 = "2a440fdfe9d890c343c25a91afd84c7e"

496 
PRIVATE_KEY
 = "ca078fee48d0bbfa"

498 
def
 
	$__š™__
(
£lf
,

499 
auth_cÚfœm_fun
,

500 
Ú_auth_fun
,

501 
tok’
=
NÚe
):

502 
£lf
.
auth_cÚfœm
 = 
auth_cÚfœm_fun


503 
£lf
.
Ú_auth
 = 
Ú_auth_fun


504 
£lf
.
tok’
 =oken

505 
£lf
.
auth’tiÿ‹d
 = 
th»adšg
.
	$Ev’t
()

506 
£lf
.
logš_ev’t
 = 
th»adšg
.
	$Ev’t
()

507 
£lf
.
is_nÙ_»äeshšg
 = 
th»adšg
.
	$Ev’t
()

508 
£lf
.
is_nÙ_»äeshšg
.
	$£t
()

513 
def
 
	$¡¬t_auth’tiÿtiÚ
(
£lf
):

515 
Launches
 
the
 
auth’tiÿtiÚ
 
´oûss


517 
š™Ÿlize_th»ad
 = 
th»adšg
.
	$Th»ad
(
rg‘
=
£lf
.
_auth’tiÿ‹
)

518 
š™Ÿlize_th»ad
.
	$£tD«mÚ
(
True
)

519 
š™Ÿlize_th»ad
.
	$¡¬t
()

521 
def
 
	$is_auth’tiÿ‹d
(
£lf
):

523 
R‘uºs
 
Œue
 
we
've‡utheticatedo RTM

525  
£lf
.
auth’tiÿ‹d
.
	$isS‘
()

527 
def
 
	$wa™_fÜ_auth’tiÿtiÚ
(
£lf
):

529 
Inhib™s
 
the
 
th»ad
 
uÁ
 
auth’tiÿtiÚ
 
occours


531 
£lf
.
auth’tiÿ‹d
.
	$wa™
()

533 
def
 
	$g‘_auth_tok’
(
£lf
):

535 
R‘uºs
 
the
 
ßuth
 
tok’
, 
Ü
 
nÚe


537 
Œy
:

538  
£lf
.
tok’


539 
exû±
:

540  
NÚe


542 
def
 
	$_auth’tiÿ‹
(
£lf
):

544 
auth’tiÿtiÚ
 
maš
 
funùiÚ


546 
£lf
.
auth’tiÿ‹d
.
	$ş—r
()

547 
nÙ
 
£lf
.
auth’tiÿ‹d
.
	$isS‘
():

548 
nÙ
 
£lf
.
tok’
:

549 
£lf
.
¹m
 = 
	$ü—‹RTM
(

550 
£lf
.
PUBLIC_KEY
, s–f.
PRIVATE_KEY
, s–f.
tok’
)

551 
sub´oûss
.
	`Pİ’
(['xdg-İ’', 
£lf
.
¹m
.
	`g‘AuthURL
()])

552 
£lf
.
	$auth_cÚfœm
()

553 
Œy
:

554 
time
.
	$¦“p
(1)

555 
£lf
.
tok’
 = s–f.
¹m
.
	$g‘Tok’
()

556 
exû±
 
Exû±iÚ
:

557 #som‘hšg 
w’t
 
wrÚg
.

558 
£lf
.
tok’
 = 
NÚe


560 
Œy
:

561 
£lf
.
	$_logš
():

562 
£lf
.
auth’tiÿ‹d
.
	$£t
()

563 
£lf
.
	$Ú_auth
()

564 
exû±
 
IOE¼Ü
:

565 
	`Back’dSigÇls
().
	`back’d_çed
(
£lf
.
	`g‘_id
(),

566 
Back’dSigÇls
.
ERRNO_NETWORK
)

568 
def
 
	$_logš
(
£lf
):

570 
Tr›s
 
to
 
e¡ablish
 
a
 
cÚÃùiÚ
Ø
¹m
 
w™h
‡ 
tok’
 
gÙ
 
äom
 
the


571 
auth’tiÿtiÚ
 
´oûss


573 
Œy
:

574 
£lf
.
¹m
 = 
	$ü—‹RTM
(
£lf
.
PUBLIC_KEY
, s–f.
PRIVATE_KEY
, s–f.
tok’
)

575 
£lf
.
tim–še
 = s–f.
¹m
.
tim–šes
.
	`ü—‹
().timeline

576  
True


577 
	$exû±
 (
RTME¼Ü
, 
RTMAPIE¼Ü
è
as
 
e
:

578 
Log
.
	`”rÜ
("RTM ERROR" + 
	$¡r
(
e
))

579  
F®£


582 ###RTM 
TASKS
 
HANDLING
 ###################################################
##########################################################################

584 
def
 
	$uÄŞl_chªges
(
£lf
, 
Œª§ùiÚ_ids
):

586 
RŞl
 
backs
 
the
 
chªges
 
Œacked
 
by
h
li¡
 
of
 
Œª§ùiÚ_ids
 
giv’


588 
Œª§ùiÚ_id
 
š
 
Œª§ùiÚ_ids
:

589 
£lf
.
¹m
.
Œª§ùiÚs
.
	$undo
(
tim–še
=
£lf
.timeline,

590 
Œª§ùiÚ_id
=transaction_id)

592 
def
 
	$g‘_¹m_sks_diù
(
£lf
):

594 
R‘uºs
 
a
 
diù
 
of
 
RTMsks
. 
It
 
wl
 
¡¬t
 
auth‘iÿtiÚ
 
Ãûs§ry
.

595 
The
 
diù
 
is
 
k•t
 
upd©ed
 
autom©iÿÎy
.

597 
nÙ
 
	`ha§‰r
(
£lf
, '_rtm_task_dict'):

598 
£lf
.
	$»äesh_¹m_sks_diù
()

600 
time_difã»nû
 = 
d©‘ime
.d©‘ime.
	`now
() - \

601 
£lf
.
__¹m_sk_diù_time¡amp


602 
time_difã»nû
.
£cÚds
 > 60:

603 
£lf
.
	$»äesh_¹m_sks_diù
()

604  
£lf
.
_¹m_sk_diù
.
	$cİy
()

606 
def
 
	$__g‘©Œ_the_¹m_way
(
£lf
, 
ª_objeù
, 
©Œibu‹
):

608 
RTM
, 
to
 
com´ess
 
the
 
XML
 
fe
 
they
 
£nd
Ø
you
, 
cuts
 
out
 
®l
he

609 
uÂeûs§ry
 
¡uff
.

610 
Beÿu£
 
of
 
th©
, 
g‘tšg
 
ª
 
©Œibu‹
 
äom
‡À
objeù
 
mu¡
 
check
 
Úe


611 
of
 
tho£
 
İtimiz©iÚs
 
has
 
b“n
 
u£d
.

612 
This
 
funùiÚ
 
®ways
 
»tuºs
 
a
 
li¡
 
w¿µšg
 
the
 
objeùs
 
found


613 (
ªy
).

615 
Œy
:

616 
li¡_Ü_objeù
 = 
	$g‘©Œ
(
ª_objeù
, 
©Œibu‹
)

617 
exû±
 
A‰ribu‹E¼Ü
:

620 
	$isš¡ªû
(
li¡_Ü_objeù
, 
li¡
):

621  
li¡_Ü_objeù


623  [
li¡_Ü_objeù
]

625 
def
 
	$__g‘_¹m_li¡s
(
£lf
):

627 
G‘s
 
the
 
li¡
 
of
h
RTM
 
	`Li¡s
 (th
bs
 
Ú
h
tİ
 oà
¹m
 
webs™e
)

631 #¹m.
li¡s
.
g‘Li¡
.
¹m


632  
£lf
.
	`__g‘©Œ_the_¹m_way
(£lf.
¹m
.
li¡s
.
	`g‘Li¡
().lists,

635 
def
 
	$__g‘_¹m_sk£r›s_š_li¡
(
£lf
, 
li¡_id
):

637 
G‘s
 
the
 
li¡
 
of
 "sk£r›s" 
objeùs
 
š
 
a
 
¹m
†ist.

638 
FÜ
 
ª
 
ex¶’©iÚ
 
of
 
wh©
 
¬e
 
tho£
, 
£e


639 
h‰p
:

641 
li¡_objeù_w¿µ”
 = 
£lf
.
¹m
.
sks
.
	`g‘Li¡
(
li¡_id
=list_id,

642 
f‹r
='šşudeArchived:Œue').
sks


643 
li¡_objeù_li¡
 = 
£lf
.
	`__g‘©Œ_the_¹m_way
(

644 
li¡_objeù_w¿µ”
, 'list')

645 
nÙ
 
li¡_objeù_li¡
:

647 #w
asked
 
Úe
, 
so
 
we
 
should
 
g‘
 one

648 
	`as£¹
(
	`Ën
(
li¡_objeù_li¡
) == 1)

649 
li¡_objeù
 = 
li¡_objeù_li¡
[0]

650 #check 
th©
 
the
 
giv’
 
li¡
 
is
h
cÜ»ù
 
Úe


651 
	$as£¹
(
li¡_objeù
.
id
 =ğ
li¡_id
)

652  
£lf
.
	`__g‘©Œ_the_¹m_way
(
li¡_objeù
, 'taskseries')

654 
def
 
	$»äesh_¹m_sks_diù
(
£lf
):

656 
Buds
 
a
 
li¡
 
of
 
RTMTasks
 
ãtched
 
äom
 
RTM


658 
nÙ
 
£lf
.
	$is_auth’tiÿ‹d
():

659 
£lf
.
	$¡¬t_auth’tiÿtiÚ
()

660 
£lf
.
	$wa™_fÜ_auth’tiÿtiÚ
()

662 
nÙ
 
£lf
.
is_nÙ_»äeshšg
.
	$isS‘
():

663 #ià
we
're‡lready„efreshing, we just wait forhato happen‡nd

664 #th’ 
we
 
immedŸ‹ly
 

665 
£lf
.
is_nÙ_»äeshšg
.
	$wa™
()

667 
£lf
.
is_nÙ_»äeshšg
.
	$ş—r
()

668 
Log
.
	`debug
('refreshing„tm')

670 #TØ
und”¡ªd
 
wh©
 
this
 
funùiÚ
 
dÛs
, 
h”e
's‡ sample output ofhe

671 #¶aš 
	`g‘Li¡s
(è
äom
 
RTM
 
­i
:

674 #ou¸
pu½o£
 
is
 
to
 
fl
 
this
 
w™h
 "sks_id: RTMTask" 
™ems


675 
¹m_sks_diù
 = {
	}
}

677 
¹m_li¡s_li¡
 = 
£lf
.
	$__g‘_¹m_li¡s
()

678 #fÜ 
—ch
 
¹m
 
li¡
, 
we
 
»Œ›ve
 
®l
 
the
 
sks
 
š
 
™


679 
¹m_li¡
 
š
 
¹m_li¡s_li¡
:

680 
¹m_li¡
.
¬chived
 !ğ'0' 
Ü
„tm_li¡.
sm¬t
 != '0':

681 #w
sk
 
¬chived
 
ªd
 
sm¬t
 
li¡s


683 
¹m_sk£r›s_li¡
 = 
£lf
.
	$__g‘_¹m_sk£r›s_š_li¡
(

684 
¹m_li¡
.
id
)

685 
¹m_sk£r›s
 
š
 
¹m_sk£r›s_li¡
:

686 #w
drl
 
down
 
to
 
aùu®
 
sks


687 
¹m_sks_li¡
 = 
£lf
.
	`__g‘©Œ_the_¹m_way
(

688 
¹m_sk£r›s
, 'task')

689 
¹m_sk
 
š
 
¹m_sks_li¡
:

690 
¹m_sks_diù
[
¹m_sk
.
id
] = 
	$RTMTask
(
¹m_sk
,

691 
¹m_sk£r›s
,

692 
¹m_li¡
,

693 
£lf
.
¹m
,

694 
£lf
.
tim–še
)

697 #w
gÙ
 
™


698 
£lf
.
_¹m_sk_diù
 = 
¹m_sks_diù


699 
£lf
.
__¹m_sk_diù_time¡amp
 = 
d©‘ime
.d©‘ime.
	$now
()

700 
£lf
.
is_nÙ_»äeshšg
.
	$£t
()

702 
def
 
	$has_¹m_sk
(
£lf
, 
¹m_sk_id
):

704 
R‘uºs
 
True
 
we
 
have
 
£’
 
th©
 
sk
 
id


706 
ÿche_»suÉ
 = 
¹m_sk_id
 
š
 
£lf
.
	$g‘_¹m_sks_diù
()

707  
ÿche_»suÉ


708 #™ 
may
 
h­³n
 
th©
 
the
 
¹m_sk
 
is
 
Ú
h
webs™e
 
but
 
we
 
hav’
't

709 #dowÆßded 
™
 
y‘
. 
We
 
Ãed
 
to
 
upd©e
 
the
 
loÿl
 
ÿche
.

711 #™' ¨big s³ed†oss. L‘'
s
 
£e
 
we
 
ÿn
 
avoid
 
™
.

712 #£lf.
	`»äesh_¹m_sks_diù
()

713 #»tuº 
¹m_sk_id
 
š
 
£lf
.
	`g‘_¹m_sks_diù
()

715 
def
 
	$ü—‹_Ãw_¹m_sk
(
£lf
, 
t™Ë
, 
Œª§ùiÚ_ids
=[]):

717 
C»©es
 
a
 
Ãw
 
¹m
 
sk


719 
»suÉ
 = 
£lf
.
¹m
.
sks
.
	$add
(
tim–še
=
£lf
.tim–še, 
Çme
=
t™Ë
)

720 
¹m_sk
 = 
	$RTMTask
(
»suÉ
.
li¡
.
sk£r›s
.
sk
,

721 
»suÉ
.
li¡
.
sk£r›s
,

722 
»suÉ
.
li¡
,

723 
£lf
.
¹m
,

724 
£lf
.
tim–še
)

725 #addšg 
to
 
the
 
diù
 
right
 
away


726 
	`ha§‰r
(
£lf
, '_rtm_task_dict'):

727 #ià
the
 
li¡
 
ha¢
't been downloaded yet, we do‚ot create‡†ist,

728 #beÿu£ 
the
 
çù
 
th©
h
li¡
 
is
 
ü—‹d
 i 
u£d
 
to
 
k“p
 
Œack


729 #oà
li¡
 
upd©es


730 
£lf
.
_¹m_sk_diù
[
¹m_sk
.
	`g‘_id
()] =„tm_task

731 
Œª§ùiÚ_ids
.
	$­³nd
(
»suÉ
.
Œª§ùiÚ
.
id
)

732  
¹m_sk


735 ###############################################################################
###RTM 
TASK
 ##################################################################

736 ###############################################################################
#diùiÚ¬› 
to
 
Œª¦©e
 
a
 
RTM
 
¡©us
 
što
‡ 
GTG
 
	`Úe
 (
ªd
 
back
)

737 
GTG_TO_RTM_STATUS
 = {
Task
.
STA_ACTIVE
: 
True
,

738 
Task
.
STA_DONE
: 
F®£
,

739 
Task
.
STA_DISMISSED
: 
F®£
}

741 
RTM_TO_GTG_STATUS
 = {
True
: 
Task
.
STA_ACTIVE
,

742 
F®£
: 
Task
.
STA_DONE
}

745 
şass
 
	$RTMTask
(
objeù
):

747 
A
 
´oxy
 
objeù
 
th©
 
’ÿpsuÏ‹s
 
a
 
RTM
 
sk
, 
givšg
 
ª
 
—s›r
 
API
 
to
 
acûss


748 
ªd
 
modify
 
™s
 
©Œibu‹s
.

749 
This
 
back’d
 
®»ady
 
u£s
 
a
 
lib¿ry
 
to
 
š‹¿ù
 
w™h
 
RTM
, 
but
 
th©
 
is
 
ju¡


750 
a
 
thš
 
´oxy
 
HTML
 
g‘s
 
ªd
 
po¡s
.

751 
The
 
m—nšg
 
of
 
®l
 "special words"

753 
h‰p
:

756 
def
 
	$__š™__
(
£lf
, 
¹m_sk
, 
¹m_sk£r›s
, 
¹m_li¡
, 
¹m
, 
tim–še
):

758 
£ts
 
up
 
the
 
v¬ious
 
·¿m‘”s
 
Ãeded
 
to
 
š‹¿ù
 
w™h
 
a
 
sk
.

760 @
·¿m
 
sk
: 
the
ask 
objeù
 
giv’
 
by
h
und”lyšg
 
lib¿ry


761 @
·¿m
 
¹m_li¡
: 
the
 
¹m
 
li¡
h
sk
 
»sides
 
š
.

762 @
·¿m
 
¹m_sk£r›s
: 
®l
 
the
 
sks
 
¬e
 
’ÿpsuÏ‹d
 
š
 
a
 
sk£r›s


763 
objeù
. 
From
 
RTM
 
webs™e
::

765 
A
 
sk
 
£r›s
 
is
 
a
 
groupšg
 
of
 
sks
 
g’”©ed
 
by
‡ 
»cu¼’û


766 
	`·‰”n
 (
mÜe
 
¥ecifiÿÎy
, 
a
 
»cu¼’û
 
·‰”n
 
of
 
ty³
 
ev”y
 â€“ 
ª


767 
aá”
 
ty³
 
»cu¼’û
 
g’”©es
 
a
 
Ãw
 
sk
 
£r›s
 
ev”y


768 
occu¼’û
). 
Task
 
£r›s
' share common…roperties such‡s:

769 - 
Name
.

770 - 
Recu¼’û
 
·‰”n
.

771 - 
Tags
.

772 - 
NÙes
.

773 - 
PriÜ™y
.

774 @
·¿m
 
¹m
: 
a
 
hªdË
 
of
 
the
„tm 
objeù
, 
to
 
be
 
abË
Ø
¥—k
 
w™h
„tm.

775 
Auth’tiÿtiÚ
 
should
 
have
 
®»ady
 
b“n
 
dÚe
.

776 @
·¿m
 
tim–še
: 
a
 "tim–še" 
is
‡ 
£r›s
 
of
 
İ”©iÚs
 
¹m
 
ÿn
 
undo
 
š


777 
bulk
. 
We
 
¬e
 
ä“
 
of
 
»que¡šg
 
Ãw
 
tim–šes
 
as
 
we


778 
¶—£
, 
w™h
 
the
 
obvious
 
d¿wback
 
of
 
bešg
 
¦ow”
.

780 
£lf
.
¹m_sk
 =„tm_task

781 
£lf
.
¹m_li¡
 =„tm_list

782 
£lf
.
¹m_sk£r›s
 =„tm_taskseries

783 
£lf
.
¹m
 =„tm

784 
£lf
.
tim–še
 =imeline

786 
def
 
	$g‘_t™Ë
(
£lf
):

788  
£lf
.
¹m_sk£r›s
.
Çme


790 
def
 
	$£t_t™Ë
(
£lf
, 
t™Ë
, 
Œª§ùiÚ_ids
=[]):

792 
t™Ë
 = 
cgi
.
	$esÿ³
(
t™Ë
)

793 
»suÉ
 = 
£lf
.
¹m
.
sks
.
	$£tName
(
tim–še
=
£lf
.timeline,

794 
li¡_id
=
£lf
.
¹m_li¡
.
id
,

795 
sk£r›s_id
=
£lf
.
¹m_sk£r›s
.
id
,

796 
sk_id
=
£lf
.
¹m_sk
.
id
,

797 
Çme
=
t™Ë
)

798 
Œª§ùiÚ_ids
.
	$­³nd
(
»suÉ
.
Œª§ùiÚ
.
id
)

800 
def
 
	$g‘_id
(
£lf
):

802  
£lf
.
¹m_sk
.
id


804 
def
 
	$g‘_¡©us
(
£lf
):

806  
RTM_TO_GTG_STATUS
[
£lf
.
¹m_sk
.
com¶‘ed
 == ""]

808 
def
 
	$£t_¡©us
(
£lf
, 
gtg_¡©us
, 
Œª§ùiÚ_ids
=[]):

810 
¡©us
 = 
GTG_TO_RTM_STATUS
[
gtg_¡©us
]

811 
¡©us
 
is
 
True
:

812 
­i_ÿÎ
 = 
£lf
.
¹m
.
sks
.
uncom¶‘e


814 
­i_ÿÎ
 = 
£lf
.
¹m
.
sks
.
com¶‘e


815 
»suÉ
 = 
	$­i_ÿÎ
(
tim–še
=
£lf
.timeline,

816 
li¡_id
=
£lf
.
¹m_li¡
.
id
,

817 
sk£r›s_id
=
£lf
.
¹m_sk£r›s
.
id
,

818 
sk_id
=
£lf
.
¹m_sk
.
id
)

819 
Œª§ùiÚ_ids
.
	$­³nd
(
»suÉ
.
Œª§ùiÚ
.
id
)

821 
def
 
	$g‘_gs
(
£lf
):

823 
gs
 = 
£lf
.
¹m_sk£r›s
.tags

824 
nÙ
 
gs
:

827  
£lf
.
	`__g‘©Œ_the_¹m_way
(
gs
, 'tag')

829 
def
 
	$__g‘©Œ_the_¹m_way
(
£lf
, 
ª_objeù
, 
©Œibu‹
):

831 
RTM
, 
to
 
com´ess
 
the
 
XML
 
fe
 
they
 
£nd
Ø
you
, 
cuts
 
out
 
®l
he

832 
uÂeûs§ry
 
¡uff
.

833 
Beÿu£
 
of
 
th©
, 
g‘tšg
 
ª
 
©Œibu‹
 
äom
‡À
objeù
 
mu¡
 
check
 
Úe


834 
of
 
tho£
 
İtimiz©iÚs
 
has
 
b“n
 
u£d
.

835 
This
 
funùiÚ
 
®ways
 
»tuºs
 
a
 
li¡
 
w¿µšg
 
the
 
objeùs
 
found


836 (
ªy
).

838 
Œy
:

839 
li¡_Ü_objeù
 = 
	$g‘©Œ
(
ª_objeù
, 
©Œibu‹
)

840 
exû±
 
A‰ribu‹E¼Ü
:

842 
	$isš¡ªû
(
li¡_Ü_objeù
, 
li¡
):

843  
li¡_Ü_objeù


845  [
li¡_Ü_objeù
]

847 
def
 
	$£t_gs
(
£lf
, 
gs
, 
Œª§ùiÚ_ids
=[]):

849 
S‘s
 
a
 
Ãw
 
£t
 
of
 
gs
 
to
‡ 
sk
. 
Old
ag 
¬e
 
d–‘ed
.

851 #RTM 
acû±
 
gs
 
w™hout
 "@" 
as
 
´efix
, 
ªd
 
low”ÿ£


852 
gs
 = [
g
[1:].
	$low”
(è
g
 
š
 
gs
]

853 #fÜm©tšg 
them
 
š
 
a
 
comma
-
£·¿‹d
 
¡ršg


854 
	`Ën
(
gs
) > 0:

855 
g¡xt
 = 
	`»duû
(
Ïmbda
 
x
, 
y
: x + ", " + y, 
gs
)

857 
g¡xt
 = ""

858 
»suÉ
 = 
£lf
.
¹m
.
sks
.
	$£tTags
(
tim–še
=
£lf
.timeline,

859 
li¡_id
=
£lf
.
¹m_li¡
.
id
,

860 
sk£r›s_id
=
£lf
.
¹m_sk£r›s
.
id
,

861 
sk_id
=
£lf
.
¹m_sk
.
id
,

862 
gs
=
g¡xt
)

863 
Œª§ùiÚ_ids
.
	$­³nd
(
»suÉ
.
Œª§ùiÚ
.
id
)

865 
def
 
	$g‘_‹xt
(
£lf
):

867 
G‘s
 
the
 
cÚ‹Á
 
of
 
RTM
 
nÙes
, 
agg»g©ed
 
š
 
a
 
sšgË
 
¡ršg


869 
nÙes
 = 
£lf
.
¹m_sk£r›s
.notes

870 
nÙ
 
nÙes
:

873 
nÙe_li¡
 = 
£lf
.
	`__g‘©Œ_the_¹m_way
(
nÙes
, 'note')

874  "".
	`još
("%s\n" % 
	`g‘©Œ
(
nÙe
, '$t'ènÙ
š
 
nÙe_li¡
)

876 
def
 
	$£t_‹xt
(
£lf
, 
‹xt
, 
Œª§ùiÚ_ids
=[]):

878 
d–‘es
 
®l
 
the
 
Şd
 
nÙes
 
š
 
a
 
sk
 
ªd
 
£ts
‡ 
sšgË
 
nÙe
 
w™h
he

879 
giv’
 
‹xt


881 #d–‘
Şd
 
nÙes


882 
nÙes
 = 
£lf
.
¹m_sk£r›s
.notes

883 
nÙes
:

884 
nÙe_li¡
 = 
£lf
.
	`__g‘©Œ_the_¹m_way
(
nÙes
, 'note')

885 
nÙe_id
 
š
 [
nÙe
.
id
 nÙš 
nÙe_li¡
]:

886 
»suÉ
 = 
£lf
.
¹m
.
sksNÙes
.
	$d–‘e
(
tim–še
=
£lf
.timeline,

887 
nÙe_id
=note_id)

888 
Œª§ùiÚ_ids
.
	$­³nd
(
»suÉ
.
Œª§ùiÚ
.
id
)

890 
‹xt
 == "":

892 
‹xt
 = 
cgi
.
	$esÿ³
(
‹xt
)

894 #RTM 
dÛs
 
nÙ
 
suµÜt
 
w–l
 
	`nÙes
 (
th©
 
is
, 
™
 
d’›s
 
the
 
»que¡
)

895 #Thus, 
we
 
¥l™
 
‹xt
 
š
 
chunks
. 
To
 
make
 
them
 
show
 iÀ
the
 
cÜ»ù


896 #Üd” 
Ú
 
the
 
webs™e
, 
we
 
have
 
to
 
u¶ßd
 
them
 
äom
h
Ï¡
ohe

897 #fœ¡ (
they
 
show
 
the
 
mo¡
 
»ûÁ
 
Ú
 
tİ
)

898 
‹xt_cursÜ_’d
 = 
	$Ën
(
‹xt
)

899 
True
:

900 
‹xt_cursÜ_¡¬t
 = 
‹xt_cursÜ_’d
 - 1000

901 
‹xt_cursÜ_¡¬t
 < 0:

902 
‹xt_cursÜ_¡¬t
 = 0

904 
»suÉ
 = 
£lf
.
¹m
.
sksNÙes
.
	`add
(
tim–še
=self.timeline,

905 
li¡_id
=
£lf
.
¹m_li¡
.
id
,

906 
sk£r›s_id
=
£lf
.

907 
¹m_sk£r›s
.
id
,

908 
sk_id
=
£lf
.
¹m_sk
.
id
,

909 
nÙe_t™Ë
="",

910 
nÙe_‹xt
=
‹xt
[
‹xt_cursÜ_¡¬t
:

911 
‹xt_cursÜ_’d
])

912 
Œª§ùiÚ_ids
.
	$­³nd
(
»suÉ
.
Œª§ùiÚ
.
id
)

913 
‹xt_cursÜ_¡¬t
 <= 0:

915 
‹xt_cursÜ_’d
 = 
‹xt_cursÜ_¡¬t
 - 1

917 
def
 
	$g‘_due_d©e
(
£lf
):

919 
G‘s
 
the
 
sk
 
due
 
d©e


921 
due
 = 
£lf
.
¹m_sk
.due

922 
due
 == "":

923  
D©e
.
	$no_d©e
()

924 
d©e
 = 
£lf
.
	`__time_¹m_to_d©‘ime
(
due
).
	$d©e
()

925  
	$D©e
(
d©e
)

927 
def
 
	$£t_due_d©e
(
£lf
, 
due
, 
Œª§ùiÚ_ids
=[]):

929 
S‘s
 
the
 
sk
 
due
 
d©e


931 
kw¬gs
 = {'tim–še': 
£lf
.
tim–še
,

932 'li¡_id': 
£lf
.
¹m_li¡
.
id
,

933 'sk£r›s_id': 
£lf
.
¹m_sk£r›s
.
id
,

934 'sk_id': 
£lf
.
¹m_sk
.
id
}

935 
due
 
is
 
nÙ
 
NÚe
:

936 
kw¬gs
['parse'] = 1

937 
kw¬gs
['due'] = 
£lf
.
	$__time_d©e_to_¹m
(
due
)

938 
»suÉ
 = 
£lf
.
¹m
.
sks
.
	$£tDueD©e
(**
kw¬gs
)

939 
Œª§ùiÚ_ids
.
	$­³nd
(
»suÉ
.
Œª§ùiÚ
.
id
)

941 
def
 
	$g‘_modif›d
(
£lf
):

943 
G‘s
 
the
 
sk
 
modif›d
 
time
, 
š
 
loÿl
ime

945 #RTM 
dÛs
 
nÙ
 
£t
 
a
 "modif›d" 
©Œibu‹
 
š
‡ 
Ãw
 
nÙe
 
beÿu£
 
™
 
u£s


946 #¨"added" 
©Œibu‹
. 
We
 
Ãed
 
to
 
check
 
bÙh
.

947 
	`ha§‰r
(
£lf
.
¹m_sk
, 'modified'):

948 
¹m_sk_modif›d
 = 
£lf
.
	$__time_¹m_to_d©‘ime
(

949 
£lf
.
¹m_sk
.
modif›d
)

951 
¹m_sk_modif›d
 = 
£lf
.
	$__time_¹m_to_d©‘ime
(

952 
£lf
.
¹m_sk
.
added
)

953 
	`ha§‰r
(
£lf
.
¹m_sk£r›s
, 'modified'):

954 
¹m_sk£r›s_modif›d
 = 
£lf
.
	$__time_¹m_to_d©‘ime
(

955 
£lf
.
¹m_sk£r›s
.
modif›d
)

957 
¹m_sk£r›s_modif›d
 = 
£lf
.
	$__time_¹m_to_d©‘ime
(

958 
£lf
.
¹m_sk£r›s
.
added
)

959  
	$max
(
¹m_sk_modif›d
, 
¹m_sk£r›s_modif›d
)

961 
def
 
	$d–‘e
(
£lf
):

962 
£lf
.
¹m
.
sks
.
	$d–‘e
(
tim–še
=
£lf
.timeline,

963 
li¡_id
=
£lf
.
¹m_li¡
.
id
,

964 
sk£r›s_id
=
£lf
.
¹m_sk£r›s
.
id
,

965 
sk_id
=
£lf
.
¹m_sk
.
id
)

967 #RTM 
¥—ks
 
utc
, 
ªd
 
acû±s
 utø
the
 "·r£" 
İtiÚ
 
is
 
£t
.

968 
def
 
	$__tz_utc_to_loÿl
(
£lf
, 
dt
):

969 
dt
 = dt.
	`»¶aû
(
tzšfo
=
	$tzutc
())

970 
dt
 = dt.
	`a¡imezÚe
(
	$tzloÿl
())

971  
dt
.
	$»¶aû
(
tzšfo
=
NÚe
)

973 
def
 
	$__tz_loÿl_to_utc
(
£lf
, 
dt
):

974 
dt
 = dt.
	`»¶aû
(
tzšfo
=
	$tzloÿl
())

975 
dt
 = dt.
	`a¡imezÚe
(
	$tzutc
())

976  
dt
.
	$»¶aû
(
tzšfo
=
NÚe
)

978 
def
 
	$__time_¹m_to_d©‘ime
(
£lf
, 
¡ršg
):

979 
¡ršg
 = sŒšg.
	`¥l™
('.')[0].split('Z')[0]

980 
dt
 = 
d©‘ime
.d©‘ime.
	`¡½time
(
¡ršg
.
	`¥l™
(".")[0],

982  
£lf
.
	$__tz_utc_to_loÿl
(
dt
)

984 
def
 
	$__time_¹m_to_d©e
(
£lf
, 
¡ršg
):

985 
¡ršg
 = sŒšg.
	`¥l™
('.')[0].split('Z')[0]

986 
dt
 = 
d©‘ime
.d©‘ime.
	`¡½time
(
¡ršg
.
	`¥l™
(".")[0], "%Y-%m-%d")

987  
£lf
.
	$__tz_utc_to_loÿl
(
dt
)

989 
def
 
	$__time_d©‘ime_to_¹m
(
£lf
, 
timeobjeù
):

990 
timeobjeù
 
is
 
NÚe
:

992 
timeobjeù
 = 
£lf
.
	$__tz_loÿl_to_utc
(
timeobjeù
)

993  
timeobjeù
.
	`¡ráime
("%Y-%m-%dT%H:%M:%S")

995 
def
 
	$__time_d©e_to_¹m
(
£lf
, 
timeobjeù
):

996 
timeobjeù
 
is
 
NÚe
:

998 #WARNING: 
no
 
timezÚe
? 
£ems
 
to
  
the
 
symm‘ry
.

999  
timeobjeù
.
	`¡ráime
("%Y-%m-%d")

1001 
def
 
	$__¡r__
(
£lf
):

1002  "Task % (%s)" % (
£lf
.
	`g‘_t™Ë
(), s–f.
	`g‘_id
())

	@backends/backend_tomboy.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
The
 
tomboy
 
	gback’d
. Th
aùu®
 
back’d
 
is
 
®l
 
š
 
	gG’”icTomboy
, 
sšû
 
	g™
's

19 
sh¬ed
 
w™h
 
the
 
GnÙe
 
	gback’d
.

22 
äom
 
	gGTG
.
	gback’ds
.
g’”icback’d
 
impÜt
 
G’”icBack’d


23 
äom
 
GTG
 
impÜt
 
_


24 
äom
 
	gGTG
.
	gback’ds
.
g’”iùomboy
 
impÜt
 
G’”icTomboy


27 
şass
 
	$Back’d
(
G’”icTomboy
):

29 
A
 
sim¶e
 
şass
 
th©
 
adds
 
some
 
desütiÚ
 
to
 
the
 
G’”icTomboy
 class.

30 
It
's donehis way since Tomboy‡nd Gnote backends have different

31 
desütiÚs
 
ªd
 
Dbus
 
add»s£s
 
but
 
the
 
§me
 
back’d
 
behšd
 
them
.

34 
_g’”®_desütiÚ
 = {

35 
G’”icBack’d
.
BACKEND_NAME
: "backend_tomboy",

36 
G’”icBack’d
.
BACKEND_HUMAN_NAME
: 
	`_
("Tomboy"),

37 
G’”icBack’d
.
BACKEND_AUTHORS
: ["Luca Invernizzi"],

38 
G’”icBack’d
.
BACKEND_TYPE
: G’”icBack’d.
TYPE_READWRITE
,

39 
G’”icBack’d
.
BACKEND_DESCRIPTION
:

40 
	`_
("This synchronization service can synchronize‡ll or…art of"

45 
	}
}

47 
_¡©ic_·¿m‘”s
 = {

48 
G’”icBack’d
.
KEY_ATTACHED_TAGS
: {

49 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_LIST_OF_STRINGS
,

50 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
: ["@GTG-Tomboy"]},

53 
BUS_ADDRESS
 = ("org.gnome.Tomboy",

	@backends/backendsignals.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
GObjeù


19 
äom
 
	gGTG
.
	gtoŞs
.
bÜg
 
impÜt
 
BÜg


22 
şass
 
	$Back’dSigÇls
(
BÜg
):

24 
This
 
şass
 
hªdËs
 
the
 
sigÇls
 
th©
 
švŞve
 
back’ds
.

25 
In
 
·¹icuÏr
, 
™
's‡ wrapper Borg class‡round‡ _BackendSignalsGObject

26 
şass
, 
ªd
 
®l
 
m‘hod
 
of
 
the
 
w¿µed
 cÏs 
ÿn
 
be
 
u£d
 
as
 
they
 
w”e
 
·¹


27 
of
 
this
 
şass


30 #”rÜ 
codes
 
to
 
£nd
 
®Úg
 
w™h
 
the
 
BACKEND_FAILED
 
sigÇl


31 
ERRNO_AUTHENTICATION
 = "authentication failed"

32 
ERRNO_NETWORK
 = "network is down"

33 
ERRNO_DBUS
 = "DBus interface cannot be connected"

35 
def
 
	$__š™__
(
£lf
):

37 
gobjeù
'''

38 
	`su³r
(
Back’dSigÇls
, 
£lf
).
	$__š™__
()

39 
	`ha§‰r
(
£lf
, "_gobject"):

41 
£lf
.
_gobjeù
 = 
	$_Back’dSigÇlsGObjeù
()

43 
def
 
	$__g‘©Œ__
(
£lf
, 
©Œ
):

45 
From
 
outside
 
the
 
şass
, 
th”e
 
should
 
be
 
no
 
difã»nû
 
b‘w“n
 
£lf
's

46 
©Œibu‹s
 
ªd
 
£lf
.
_gobjeù
's‡ttributes.

48 
©Œ
 =ğ"_gobjeù" 
ªd
 
nÙ
 "_gobjeù" 
š
 
£lf
.
__diù__
:

49 
¿i£
 
A‰ribu‹E¼Ü


50  
	$g‘©Œ
(
£lf
.
_gobjeù
, 
©Œ
)

53 
def
 
	$sigÇl_ty³_çùÜy
(*
¬gs
):

55 
Sim¶y
 
»tuºs
 
a
 
gobjeù
 
sigÇl
 
ty³


57 @
»tuºs
: 
tu¶e


59  (
GObjeù
.
SigÇlFÏgs
.
RUN_FIRST
, 
NÚe
, 
¬gs
)

62 
şass
 
	$_Back’dSigÇlsGObjeù
(
GObjeù
.GObject):

64 #sigÇÈ
Çme
 
cÚ¡ªts


65 
BACKEND_STATE_TOGGLED
 = 'back’d-¡©e-toggËd' #em™‹d 
wh’
 
a


66 #back’d 
is


67 #’abËd 
Ü
 
di§bËd


68 
BACKEND_RENAMED
 = 'back’d-»Çmed' #em™‹d 
wh’
 
a
 
back’d
 
is
 
»Çmed


69 
BACKEND_ADDED
 = 'backend-added'

70 
BACKEND_REMOVED
 = 'back’d-added' #wh’ 
a
 
back’d
 
is
 
d–‘ed


71 
DEFAULT_BACKEND_LOADED
 = 'deçuÉ-back’d-lßded' #em™‹d 
aá”
 
®l


72 #sk 
have
 
b“n


73 #lßded 
äom
 
the


74 #deçuÉ 
back’d


75 
BACKEND_FAILED
 = 'back’d-çed' #som‘hšg 
w’t
 
wrÚg
 
w™h
 
a
 
back’d


76 
BACKEND_SYNC_STARTED
 = 'backend-sync-started'

77 
BACKEND_SYNC_ENDED
 = 'backend-sync-ended'

78 
INTERACTION_REQUESTED
 = 'user-interaction-requested'

80 
INTERACTION_CONFIRM
 = 'confirm'

81 
INTERACTION_TEXT
 = 'text'

82 
INTERACTION_INFORM
 = 'inform'

84 
__gsigÇls__
 = {
BACKEND_STATE_TOGGLED
: 
	`sigÇl_ty³_çùÜy
(
¡r
),

85 
BACKEND_RENAMED
: 
	`sigÇl_ty³_çùÜy
(
¡r
),

86 
BACKEND_ADDED
: 
	`sigÇl_ty³_çùÜy
(
¡r
),

87 
BACKEND_REMOVED
: 
	`sigÇl_ty³_çùÜy
(
¡r
),

88 
BACKEND_SYNC_STARTED
: 
	`sigÇl_ty³_çùÜy
(
¡r
),

89 
BACKEND_SYNC_ENDED
: 
	`sigÇl_ty³_çùÜy
(
¡r
),

90 
DEFAULT_BACKEND_LOADED
: 
	`sigÇl_ty³_çùÜy
(),

91 
BACKEND_FAILED
: 
	`sigÇl_ty³_çùÜy
(
¡r
, str),

92 
INTERACTION_REQUESTED
: 
	`sigÇl_ty³_çùÜy
(
¡r
, str,

93 
¡r
, sŒ)
	}
}

95 
def
 
	$__š™__
(
£lf
):

96 
	`su³r
(
_Back’dSigÇlsGObjeù
, 
£lf
).
	$__š™__
()

97 
£lf
.
back’ds_cu¼’y_syncšg
 = []

99 #############SigÇl #########
#cÚÃùšg 
to
 
sigÇls
 
is
 
fše
, 
but
 
k“p
 
ª
 
eye
 
you
 
should
 
em™
 
them
.

100 #A 
a
 
g’”®
 
ruË
, 
sigÇls
 
should
 
Úly
 
be
 
em™‹d
 
š
 
the
 
G’”icBack’d


102 
def
 
	$_em™_sigÇl
(
£lf
, 
sigÇl
, 
back’d_id
):

103 
GObjeù
.
	$idË_add
(
£lf
.
em™
, 
sigÇl
, 
back’d_id
)

105 
def
 
	$back’d_¡©e_chªged
(
£lf
, 
back’d_id
):

106 
£lf
.
	$_em™_sigÇl
(
£lf
.
BACKEND_STATE_TOGGLED
, 
back’d_id
)

108 
def
 
	$back’d_»Çmed
(
£lf
, 
back’d_id
):

109 
£lf
.
	$_em™_sigÇl
(
£lf
.
BACKEND_RENAMED
, 
back’d_id
)

111 
def
 
	$back’d_added
(
£lf
, 
back’d_id
):

112 
£lf
.
	$_em™_sigÇl
(
£lf
.
BACKEND_ADDED
, 
back’d_id
)

114 
def
 
	$back’d_»moved
(
£lf
, 
back’d_id
):

115 
£lf
.
	$_em™_sigÇl
(
£lf
.
BACKEND_REMOVED
, 
back’d_id
)

117 
def
 
	$deçuÉ_back’d_lßded
(
£lf
):

118 
GObjeù
.
	$idË_add
(
£lf
.
em™
, s–f.
DEFAULT_BACKEND_LOADED
)

120 
def
 
	$back’d_çed
(
£lf
, 
back’d_id
, 
”rÜ_code
):

121 
GObjeù
.
	$idË_add
(
£lf
.
em™
, s–f.
BACKEND_FAILED
, 
back’d_id
,

122 
”rÜ_code
)

124 
def
 
	$š‹¿ùiÚ_»que¡ed
(
£lf
, 
back’d_id
, 
desütiÚ
,

125 
š‹¿ùiÚ_ty³
, 
ÿÎback_¡r
):

126 
GObjeù
.
	$idË_add
(
£lf
.
em™
, s–f.
INTERACTION_REQUESTED
,

127 
back’d_id
, 
desütiÚ
, 
š‹¿ùiÚ_ty³
,

128 
ÿÎback_¡r
)

130 
def
 
	$back’d_sync_¡¬‹d
(
£lf
, 
back’d_id
):

131 
£lf
.
	$_em™_sigÇl
(
£lf
.
BACKEND_SYNC_STARTED
, 
back’d_id
)

132 
£lf
.
back’ds_cu¼’y_syncšg
.
	$­³nd
(
back’d_id
)

134 
def
 
	$back’d_sync_’ded
(
£lf
, 
back’d_id
):

135 
£lf
.
	$_em™_sigÇl
(
£lf
.
BACKEND_SYNC_ENDED
, 
back’d_id
)

136 
Œy
:

137 
£lf
.
back’ds_cu¼’y_syncšg
.
	$»move
(
back’d_id
)

138 
exû±
:

139 
·ss


141 
def
 
	$is_back’d_syncšg
(
£lf
, 
back’d_id
):

142  
back’d_id
 
š
 
£lf
.
back’ds_cu¼’y_syncšg


	@backends/genericbackend.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
This
 
fe
 
cÚšs
 
the
 
mo¡
 
g’”ic
 
»´e£Á©iÚ
 
of
 
a
 
	gback’d
,

19 
the
 
G’”icBack’d
 
	gşass


22 
impÜt
 
os


23 
impÜt
 
”ºo


24 
impÜt
 
pickË


25 
impÜt
 
th»adšg


26 
äom
 
cŞËùiÚs
 
impÜt
 
deque


28 
äom
 
	gGTG
.
	gback’ds
.
back’dsigÇls
 
impÜt
 
Back’dSigÇls


29 
äom
 
	gGTG
.
	gtoŞs
.
keyršg
 
impÜt
 
Keyršg


30 
äom
 
	gGTG
.
cÜe
 
impÜt
 
CÜeCÚfig


31 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


32 
äom
 
	gGTG
.
	gtoŞs
.
š‹¼u±ibË
 
impÜt
 
_ÿnûÎ©iÚ_pošt


33 
äom
 
funùoŞs
 
impÜt
 
»duû


35 
	gPICKLE_BACKUP_NBR
 = 2

38 
şass
 
	$G’”icBack’d
(
objeù
):

40 
Ba£
 
şass
 
ev”y
 
back’d
.

41 
It
 
defšes
 
the
 
š‹rçû
 
a
 
back’d
 
mu¡
 
have
 
ªd
 
kes
 
ÿ»
 
of
 
®l
he

42 
İ”©iÚs
 
commÚ
 
to
 
®l
 
back’ds
.

43 
A
 
·¹icuÏr
 
back’d
 
should
 
»defše
 
®l
 
the
 
m‘hods
 
m¬ked
 
as
 
such
.

46 ###########################################################################
###BACKEND 
INTERFACE
 #####################################################
###########################################################################
#G’”® 
desütiÚ
 
of
 
the
 
back’d
: 
the£
 
·¿m‘”s
 
¬e
 
u£d


47 #tØ
show
 
a
 
desütiÚ
 
of
 
the
 
back’d
 
to
h
u£r
 
wh’
 
s
/
he
 
is


48 #cÚsid”šg 
addšg
 
™
.

49 #FÜ 
ª
 
exam¶e
, 
£e
 
the
 
GTG
/
back’ds
/
back’d_loÿlfe
.
py
 
fe


50 #_g’”®_desütiÚ 
has
 
this
 
fÜm©
:

52 #G’”icBack’d.
BACKEND_NAME
: "backend_unique_identifier", \

53 #G’”icBack’d.
BACKEND_HUMAN_NAME
: 
	`_
("Human friendly‚ame"), \

54 #G’”icBack’d.
BACKEND_AUTHORS
: ["First‡uthor", \

55 #"
Chuck
 
NÜris
"], \
# G’”icBack’d.BACKEND_TYPE: G’”icBack’d.TYPE_READWRITE, \
# G’”icBack’d.BACKEND_DESCRIPTION: \
# _("
ShÜt
 
desütiÚ
 
of
 
the
 
back’d
"),\
# }

60 #Th
com¶‘e
 
li¡
 
of
 
cÚ¡ªts
 
ªd
 
theœ
 
m—nšg
 
is
 
giv’
 
b–ow
.

61 
_g’”®_desütiÚ
 = {}

63 #The£ 
¬e
 
the
 
·¿m‘”s
 
to
 
cÚfigu»
 
a
 
Ãw
 
back’d
 
of
 
this
 
ty³
. 
A


64 #·¿m‘” 
has
 
a
 
Çme
,‡ 
ty³
 
ªd
‡  
v®ue
.

65 #FÜ 
ª
 
exam¶e
, 
£e
 
the
 
GTG
/
back’ds
/
back’d_loÿlfe
.
py
 
fe


66 #_¡©ic_·¿m‘” 
has
 
this
 
fÜm©
:

68 #"
·¿m1_Çme
": { \
# GenericBackend.PARAM_TYPE: GenericBackend.TYPE_STRING,

70 #G’”icBack’d.
PARAM_DEFAULT_VALUE
: "my default value",

72 #"
·¿m2_Çme
": {

73 #G’”icBack’d.
PARAM_TYPE
: 
G’”icBack’d
.
TYPE_INT
,

74 #G’”icBack’d.
PARAM_DEFAULT_VALUE
: 42,

76 #Th
com¶‘e
 
li¡
 
of
 
cÚ¡ªts
 
ªd
 
theœ
 
m—nšg
 
is
 
giv’
 
b–ow
.

77 
_¡©ic_·¿m‘”s
 = {}

79 
def
 
	`š™Ÿlize
(
£lf
):

81 
C®Ëd
 
—ch
 
time
 
™
 
is
 
	`’abËd
 (
šşudšg
 
Ú
 
back’d
 
ü—tiÚ
).

82 
PËa£
 
nÙe
 
th©
 
a
 
şass
 
š¡ªû
 
—ch
 
di§bËd
 
back’d
 *
is
*

83 
ü—‹d
, 
but
 
™
's‚ot initialized.

84 
O±iÚ®
.

85 
NOTE
: 
make
 
su»
 
to
 
ÿÎ
 
	`su³r
().
	`š™Ÿlize
()

87 
£lf
.
_·¿m‘”s
[£lf.
KEY_ENABLED
] = 
True


88 
£lf
.
_is_š™Ÿlized
 = 
True


89 #w
sigÇl
 
th©
 
the
 
back’d
 
has
 
b“n
 
’abËd


90 
£lf
.
_sigÇl_mªag”
.
	`back’d_¡©e_chªged
(£lf.
	`g‘_id
())

92 
def
 
	`¡¬t_g‘_sks
(
£lf
):

94 
This
 
funùiÚ
 
¡¬ts
 
subm™tšg
 
the
 
sks
 
äom
h
back’d
 
što
 
GTG


95 
cÜe
.

96 
It
's„un‡s‡ separatehread.

98 @: 
	`¡¬t_g‘_sks
(è
might
 
nÙ
  
Ü
 
fšish


102 
def
 
	`£t_sk
(
£lf
, 
sk
):

104 
This
 
funùiÚ
 
is
 
ÿÎed
 
äom
 
GTG
 
cÜe
 
wh’ev”
 
a
 
sk
 
should
 
be


105 
§ved
, 
e™h”
 
beÿu£
 
™
's‡‚ew one or it has been modified.

106 
If
 
the
 
sk
 
id
 
is
 
Ãw
 th
back’d
, 
th’
 
a
‚ewask 
mu¡
 
be


107 
ü—‹d
. 
No
 
¥ecŸl
 
nÙifiÿtiÚ
 
th©
 
the
 
sk
 
is
 
a
 
Ãw
 
Úe
 i 
giv’
.

109 @
·¿m
 
sk
: 
the
ask 
objeù
 
to
 
§ve


111 
·ss


113 
def
 
	`»move_sk
(
£lf
, 
tid
):

115 
»moved
 
äom
 
the
 
back’d
. 
NÙe
 
th©
h
sk
 
could
 
be
 
nÙ
 
´e£Á
 
h”e
.

117 @
·¿m
 
tid
: 
the
 
id
 
of
h
sk
 
to
 
d–‘e


119 
·ss


121 
def
 
	`this_is_the_fœ¡_run
(
£lf
, 
xml
):

123 
O±iÚ®
, 
ªd
 
®mo¡
 
su»ly
 
nÙ
 
Ãeded
.

124 
C®Ëd
 
upÚ
 
the
 
v”y
 
fœ¡
 
GTG
 
¡¬tup
.

125 
This
 
funùiÚ
 
is
 
Ãeded
 
Úly
 
š
 
the
  
	`back’d
 (
XML
 
loÿlfe
,

126 
cu¼’y
).

127 
The
 
xml
 
·¿m‘”
 
is
 
ª
 
objeù
 
cÚššg
 
GTG
  
sks
.

129 @
·¿m
 
xml
: 
ª
 xmÈ
objeù
 
cÚššg
 
the
  
sks
.

131 
·ss


133 
def
 
	`qu™
(
£lf
, 
di§bË
=
F®£
):

135 
C®Ëd
 
wh’
 
GTG
 
qu™s
 
Ü
 
the
 
u£r
 
wªts
 
to
 
di§bË
h
back’d
.

137 @
·¿m
 
di§bË
: 
If
 di§bË 
is
 
True
, 
the
 
back’d
 
wÚ
't

138 
be
 
autom©iÿÎy
 
lßded
 
wh’
 
GTG
 
¡¬ts


140 
£lf
.
_·¿m‘”s
[£lf.
KEY_ENABLED
]:

141 
£lf
.
_is_š™Ÿlized
 = 
F®£


142 
di§bË
:

143 
£lf
.
_·¿m‘”s
[£lf.
KEY_ENABLED
] = 
F®£


144 #w
sigÇl
 
th©
 
we
 
have
 
b“n
 
di§bËd


145 
£lf
.
_sigÇl_mªag”
.
	`back’d_¡©e_chªged
(£lf.
	`g‘_id
())

146 
£lf
.
_sigÇl_mªag”
.
	`back’d_sync_’ded
(£lf.
	`g‘_id
())

147 
th»adšg
.
	`Th»ad
(
rg‘
=
£lf
.
sync
).
	`run
()

149 
def
 
	`§ve_¡©e
(
£lf
):

151 
It
'she†ast functionƒxecuted on‡ quitting backend,‡fterhe

152 
³ndšg
 
aùiÚs
 
have
 
b“n
 
dÚe
.

153 
U£ful
 
to
 
’su»
 
th©
 
the
 
¡©e
 
is
 
§ved
 
š
 
a
 
cÚsi¡’t
 
mªÃr


155 
·ss


157 ###############################################################################
###### 
You
 
dÚ
't‚eedo„eimplementhe functions belowhis†ine ############

159 ###########################################################################
###CONSTANTS #############################################################
###########################################################################
#BACKEND 
TYPE
 
DESCRIPTION


160 #Each 
back’d
 
mu¡
 
have
 
a
 "_g’”®_desütiÚ" 
©Œibu‹
, 
which


161 #i 
a
 
diùiÚ¬y
 
th©
 
hŞds
 
the
 
v®ues
 th
fŞlowšg
 
keys
.

162 
BACKEND_NAME
 = "Çme" #th
back’d
 
gtg
 
š‹º®
 
	`Çme
 (
dÛ¢
't change in

163 #Œª¦©iÚs, *
mu¡
 
be
 
unique
*)

164 
BACKEND_HUMAN_NAME
 = "humª-ä›ndly-Çme" #Th
Çme
 
shown
 
to
 
the
 
u£r


165 
BACKEND_DESCRIPTION
 = "desütiÚ" #A 
desütiÚ
 
of
 
the
 
back’d


166 
BACKEND_AUTHORS
 = "authÜs" #¨
li¡
 
of
 
¡ršgs


167 
BACKEND_TYPE
 = "type"

168 #BACKEND_TYPE 
is
 
Úe
 
of
:

169 
TYPE_READWRITE
 = "readwrite"

170 
TYPE_READONLY
 = "readonly"

171 
TYPE_IMPORT
 = "import"

172 
TYPE_EXPORT
 = "export"

174 #"
¡©ic_·¿m‘”s
" is‡ dictionary of dictionaries,ƒach of which

175 #¬
a
 
desütiÚ
 
of
‡ 
·¿m‘”
 
Ãeded
 
to
 
cÚfigu»
 
the
 
back’d
 
ªd


176 #i 
id’tif›d
 
š
 
the
 
ou‹r
 
diùiÚ¬y
 
by
 
a
 
key
 
which
 
is
h
Çme
 
of
he

178 #FÜ 
ª
 
exam¶e
, 
£e
 
the
 
GTG
/
back’ds
/
back’d_loÿlfe
.
py
 
fe


179 #Each 
diùiÚ¬y
 
cÚšs
 
the
 
keys
:

180 
PARAM_DEFAULT_VALUE
 = "deçuÉ_v®ue" #™  
v®ue


181 
PARAM_TYPE
 = "type"

182 #PARAM_TYPE 
is
 
Úe
 
of
 
the
 
	`fŞlowšg
 (
chªgšg
 
this
 
chªges
h
way


183 #th
u£r
 
ÿn
 
cÚfigu»
 
the
 
·¿m‘”
)

184 
TYPE_PASSWORD
 = "·sswÜd" #th
»®
 
·sswÜd
 
is
 
¡Üed
 
š
 
the
 
GNOME


186 #Thi 
is
 
ju¡
 
a
 
key
 
to
 
fšd
 
™
 
th”e


187 
TYPE_STRING
 = "¡ršg" #g’”iø
¡ršg
, 
nÙhšg
 
çncy
 
is
 
dÚe


188 
TYPE_INT
 = "št" #ed™ 
box
 
ÿn
 
cÚš
 
Úly
 
š‹g”s


189 
TYPE_BOOL
 = "boŞ" #checkbox 
is
 
shown


190 
TYPE_LIST_OF_STRINGS
 = "li¡¡ršg" #li¡ 
of
 
¡ršgs
. 
the
 "," 
ch¬aù”


191 #i 
´ohib™ed
 
š
 
¡ršgs


193 #The£ 
·¿m‘”s
 
¬e
 
commÚ
 
to
 
®l
 
back’ds
 
ªd
 
Ãûs§ry
.

194 #They 
wl
 
be
 
added
 
autom©iÿÎy
 
to
 
your
 
_¡©ic_·¿m‘”s
 
li¡


195 #NOTE: 
now
 
I
'm di§blšg chªgšghdeçuÉ back’d. Onû it'
s
 
®l


196 #£ˆ
up
, 
we
 
wl
 
£e
 
about
 
	`th©
 (
šv”nizzi
)

197 
KEY_DEFAULT_BACKEND
 = "Default"

198 
KEY_ENABLED
 = "enabled"

199 
KEY_HUMAN_NAME
 = 
BACKEND_HUMAN_NAME


200 
KEY_ATTACHED_TAGS
 = "attached-tags"

201 
KEY_USER
 = "user"

202 
KEY_PID
 = "pid"

203 
ALLTASKS_TAG
 = "gtg-gs-®l" #NOTE: 
this
 
has
 
b“n
 
moved
 
h”e
 
to
 
avoid


204 #cœcuÏ¸
impÜts
. 
It
'she same‡s in

205 #th
CÜeCÚfig
 
şass
, 
beÿu£
 
™
'she

206 #§m
thšg
 
cÚû±u®ly
. 
It
 
dÛ¢
't

207 #m©‹¸
™
 
the
 
Çmšg
 
div”ges
.

209 
_¡©ic_·¿m‘”s_oblig©Üy
 = {

210 
KEY_DEFAULT_BACKEND
: {

211 
PARAM_TYPE
: 
TYPE_BOOL
,

212 
PARAM_DEFAULT_VALUE
: 
F®£
,

214 
KEY_HUMAN_NAME
: {

215 
PARAM_TYPE
: 
TYPE_STRING
,

216 
PARAM_DEFAULT_VALUE
: "",

218 
KEY_USER
: {

219 
PARAM_TYPE
: 
TYPE_STRING
,

220 
PARAM_DEFAULT_VALUE
: "",

222 
KEY_PID
: {

223 
PARAM_TYPE
: 
TYPE_STRING
,

224 
PARAM_DEFAULT_VALUE
: "",

226 
KEY_ENABLED
: {

227 
PARAM_TYPE
: 
TYPE_BOOL
,

228 
PARAM_DEFAULT_VALUE
: 
F®£
,

231 
_¡©ic_·¿m‘”s_oblig©Üy_fÜ_rw
 = {

232 
KEY_ATTACHED_TAGS
: {

233 
PARAM_TYPE
: 
TYPE_LIST_OF_STRINGS
,

234 
PARAM_DEFAULT_VALUE
: [
ALLTASKS_TAG
],

237 #Hªdy 
diùiÚ¬y
 
u£d
 
š
 
ty³
 
	`cÚv”siÚ
 (
äom
 
¡ršg
 
to
ype)

238 
_ty³_cÚv”‹r
 = {
TYPE_STRING
: 
¡r
,

239 
TYPE_INT
: ,

242 @
şassm‘hod


243 
def
 
	`_g‘_¡©ic_·¿m‘”s
(
şs
):

245 
H–³r
 
m‘hod
, 
u£d
 
to
 
obš
 
the
 
fuÎ
 
li¡
 
of
h
¡©ic_·¿m‘”s


246 (
u£r
 
cÚfigu»d
 
ªd
  
Úes
)

248 @
»tuºs
 
diù
: 
the
 diù 
cÚššg
 
®l
h
·¿m‘”s


250 
‹mp_dic
 = 
şs
.
_¡©ic_·¿m‘”s_oblig©Üy
.
	`cİy
()

251 
şs
.
_g’”®_desütiÚ
[şs.
BACKEND_TYPE
] == \

252 
şs
.
TYPE_READWRITE
:

253 
key
, 
v®ue
 
š
 \

254 
şs
.
_¡©ic_·¿m‘”s_oblig©Üy_fÜ_rw
.
	`™ems
():

255 
‹mp_dic
[
key
] = 
v®ue


256 
key
, 
v®ue
 
š
 
şs
.
_¡©ic_·¿m‘”s
.
	`™ems
():

257 
‹mp_dic
[
key
] = 
v®ue


258  
‹mp_dic


260 
def
 
	`__š™__
(
£lf
, 
·¿m‘”s
):

262 
In¡ªtŸ‹s
 
a
 
Ãw
 
back’d
. 
PËa£
 
nÙe
 
th©
 
this
 
is
 
ÿÎed
 
®so


263 
di§bËd
 
back’ds
. 
Tho£
 
¬e
 
nÙ
 
š™Ÿlized
, 
so
 
you
 
might


264 
wªt
 
to
 
check
 
out
 
the
 
	`š™Ÿlize
(è
funùiÚ
.

266 
£lf
.
KEY_DEFAULT_BACKEND
 
nÙ
 
š
 
·¿m‘”s
:

267 #ià
™
's‚ot specified,henhis ishe default backend

268 #(
»Œo
-
com·tib™y
 
w™h
 
the
 
GTG
 0.2 
£r›s
)

269 
·¿m‘”s
[
£lf
.
KEY_DEFAULT_BACKEND
] = 
True


270 #deçuÉ 
back’ds
 
should
 
g‘
 
®l
 
the
 
sks


271 
·¿m‘”s
[
£lf
.
KEY_DEFAULT_BACKEND
] 
Ü
 \

272 (
nÙ
 
£lf
.
KEY_ATTACHED_TAGS
 
š
 
·¿m‘”s
 
ªd


273 
£lf
.
_g’”®_desütiÚ
[£lf.
BACKEND_TYPE
]

274 =ğ
£lf
.
TYPE_READWRITE
):

275 
·¿m‘”s
[
£lf
.
KEY_ATTACHED_TAGS
] = [£lf.
ALLTASKS_TAG
]

276 
£lf
.
_·¿m‘”s
 = 
·¿m‘”s


277 
£lf
.
_sigÇl_mªag”
 = 
	`Back’dSigÇls
()

278 
£lf
.
_is_š™Ÿlized
 = 
F®£


279 #ià
debuggšg
 
mode
 
is
 
’abËd
, 
sks
 
should
 
be
 
§ved
 
as
 
soÚ
‡s

281 #—s›¸
debuggšg
.

282 
Log
.
	`is_debuggšg_mode
():

283 
£lf
.
tim”_time¡•
 = 5

285 
£lf
.
tim”_time¡•
 = 1

286 
£lf
.
to_£t_tim”
 = 
NÚe


287 
£lf
.
¶—£_qu™
 = 
F®£


288 
£lf
.
ÿnûÎ©iÚ_pošt
 = 
Ïmbda
: 
	`_ÿnûÎ©iÚ_pošt
(

289 
Ïmbda
: 
£lf
.
¶—£_qu™
)

290 
£lf
.
to_£t
 = 
	`deque
()

291 
£lf
.
to_»move
 = 
	`deque
()

293 
def
 
	`g‘_©ched_gs
(
£lf
):

295 
R‘uºs
 
the
 
li¡
 
of
 
gs
 
which
 
¬e
 
hªdËd
 
by
 
this
 
back’d


297 
	`ha§‰r
(
£lf
.
_·¿m‘”s
, s–f.
KEY_DEFAULT_BACKEND
è
ªd
 \

298 
£lf
.
_·¿m‘”s
[£lf.
KEY_DEFAULT_BACKEND
]:

299 #deçuÉ 
back’ds
 
should
 
g‘
 
®l
 
the
 
sks


300 #NOTE: 
this
 
shouldn
'ˆbÃeded, buˆ™ dÛ¢'
t
 
co¡
 
ªythšg
 
ªd


301 #™ 
could
 
avoid
 
pÙ’tŸl
 
sks
 
los£s
.

302  [
£lf
.
ALLTASKS_TAG
]

303 
Œy
:

304  
£lf
.
_·¿m‘”s
[£lf.
KEY_ATTACHED_TAGS
]

305 
exû±
:

308 
def
 
	`£t_©ched_gs
(
£lf
, 
gs
):

310 
Chªges
 
the
 
£t
 
of
 
©ched
 
gs


312 @
·¿m
 
gs
: 
the
 
Ãw
 
©ched_gs
 
£t


314 
£lf
.
_·¿m‘”s
[£lf.
KEY_ATTACHED_TAGS
] = 
gs


316 @
şassm‘hod


317 
def
 
	`g‘_¡©ic_·¿m‘”s
(
şs
):

319 
R‘uºs
 
a
 
diùiÚ¬y
 
of
 
·¿m‘”s
 
Ãûs§ry
 
to
 
ü—‹
‡ 
back’d
.

321  
şs
.
	`_g‘_¡©ic_·¿m‘”s
()

323 
def
 
	`g‘_·¿m‘”s
(
£lf
):

325 
R‘uºs
 
a
 
diùiÚ¬y
 
of
 
the
 
cu¼’t
 
·¿m‘”s
.

327  
£lf
.
_·¿m‘”s


329 
def
 
	`£t_·¿m‘”
(
£lf
, 
·¿m‘”
, 
v®ue
):

331 
Chªge
 
a
 
·¿m‘”
 
this
 
back’d


333 @
·¿m
 
·¿m‘”
: 
the
…¬am‘” 
Çme


334 @
·¿m
 
v®ue
: 
the
 
Ãw
 value

336 
£lf
.
_·¿m‘”s
[
·¿m‘”
] = 
v®ue


338 @
şassm‘hod


339 
def
 
	`g‘_Çme
(
şs
):

341 
R‘uºs
 
the
 
Çme
 
of
h
back’d
 
as
 
™
 
should
 
be
 
di¥Ïyed
 
š
h
UI


343  
şs
.
	`_g‘_äom_g’”®_desütiÚ
(şs.
BACKEND_NAME
)

345 @
şassm‘hod


346 
def
 
	`g‘_desütiÚ
(
şs
):

348  
şs
.
	`_g‘_äom_g’”®_desütiÚ
(şs.
BACKEND_DESCRIPTION
)

350 @
şassm‘hod


351 
def
 
	`g‘_ty³
(
şs
):

353  
şs
.
	`_g‘_äom_g’”®_desütiÚ
(şs.
BACKEND_TYPE
)

355 @
şassm‘hod


356 
def
 
	`g‘_authÜs
(
şs
):

358 
»tuºs
 
the
 
back’d
 
	`authÜ
(
s
)

360  
şs
.
	`_g‘_äom_g’”®_desütiÚ
(şs.
BACKEND_AUTHORS
)

362 @
şassm‘hod


363 
def
 
	`_g‘_äom_g’”®_desütiÚ
(
şs
, 
key
):

365 
H–³r
 
m‘hod
 
to
 
exŒaù
 
v®ues
 
äom
 
şs
.
_g’”®_desütiÚ
.

367 @
·¿m
 
key
: 
the
 key 
to
 
exŒaù


369  
şs
.
_g’”®_desütiÚ
[
key
]

371 @
şassm‘hod


372 
def
 
	`ÿ¡_·¿m_ty³_äom_¡ršg
(
şs
, 
·¿m_v®ue
, 
·¿m_ty³
):

374 
P¬am‘”s
 
¬e
 
§ved
 
š
 
a
 
‹xt
 
fÜm©
, 
so
 
we
 
have
 
to
 
ÿ¡
 
them
Ø
the


375 
­´İrŸ‹
 
ty³
 
Ú
 
lßdšg
. 
This
 
funùiÚ
 
dÛs
 
exaùly
 
th©
.

377 @
·¿m
 
·¿m_v®ue
: 
the
 
aùu®
 
v®ue
 
of
h
·¿m‘”
, 
š
 
a
 
¡ršg


378 
fÜm©


379 @
·¿m
 
·¿m_ty³
: 
the
 
wª‹d
 
ty³


380 @
»tuºs
 
som‘hšg
: 
the
 
ÿ¡ed
 
·¿m_v®ue


382 
·¿m_ty³
 
š
 
şs
.
_ty³_cÚv”‹r
:

383  
şs
.
_ty³_cÚv”‹r
[
·¿m_ty³
](
·¿m_v®ue
)

384 
–if
 
·¿m_ty³
 =ğ
şs
.
TYPE_BOOL
:

385 
·¿m_v®ue
 == "True":

386  
True


387 
–if
 
·¿m_v®ue
 == "False":

388  
F®£


390 
¿i£
 
	`Exû±iÚ
("Unrecognized bool value '%s'" %

391 
·¿m_ty³
)

392 
–if
 
·¿m_ty³
 =ğ
şs
.
TYPE_PASSWORD
:

393 
·¿m_v®ue
 == -1:

394  
NÚe


395  
	`Keyršg
().
	`g‘_·sswÜd
((
·¿m_v®ue
))

396 
–if
 
·¿m_ty³
 =ğ
şs
.
TYPE_LIST_OF_STRINGS
:

397 
the_li¡
 = 
·¿m_v®ue
.
	`¥l™
(",")

398 
nÙ
 
	`isš¡ªû
(
the_li¡
, 
li¡
):

399 
the_li¡
 = [the_list]

400  
the_li¡


402 
¿i£
 
	`NÙIm¶em’‹d
("I don't know whatype is '%s'" %

403 
·¿m_ty³
)

405 
def
 
	`ÿ¡_·¿m_ty³_to_¡ršg
(
£lf
, 
·¿m_ty³
, 
·¿m_v®ue
):

407 
Inv”£
 
of
 
ÿ¡_·¿m_ty³_äom_¡ršg


409 @
·¿m
 
·¿m_v®ue
: 
the
 
aùu®
 
v®ue
 
of
h
·¿m‘”


410 @
·¿m
 
·¿m_ty³
: 
the
 
ty³
 
of
h
	`·¿m‘”
 (
·sswÜd
...)

411 @
»tuºs
 
som‘hšg
: 
·¿m_v®ue
 
ÿ¡ed
 
to
 
¡ršg


413 
·¿m_ty³
 =ğ
G’”icBack’d
.
TYPE_PASSWORD
:

414 
·¿m_v®ue
 
is
 
NÚe
:

415  
	`¡r
(-1)

417  
	`¡r
(
	`Keyršg
().
	`£t_·sswÜd
(

418 "GTG stÜed…asswÜd -" + 
£lf
.
	`g‘_id
(), 
·¿m_v®ue
))

419 
–if
 
·¿m_ty³
 =ğ
G’”icBack’d
.
TYPE_LIST_OF_STRINGS
:

420 
·¿m_v®ue
 == []:

422  
	`»duû
(
Ïmbda
 
a
, 
b
:‡ + "," + b, 
·¿m_v®ue
)

424  
	`¡r
(
·¿m_v®ue
)

426 
def
 
	`g‘_id
(
£lf
):

428 
»tuºs
 
the
 
back’ds
 
id
, 
u£d
 
š
h
d©a¡Üe
 
šdexšg
 backends

430 @
»tuºs
 
¡ršg
: 
the
 
back’d
 
id


432  
£lf
.
	`g‘_Çme
(è+ "@" + s–f.
_·¿m‘”s
["pid"]

434 @
şassm‘hod


435 
def
 
	`g‘_humª_deçuÉ_Çme
(
şs
):

437 
»tuºs
 
the
 
u£r
 
ä›ndly
  
back’d
 
Çme
, 
w™hout
 
ev’tu®
 user

438 
modifiÿtiÚs
.

440 @
»tuºs
 
¡ršg
: 
the
  "human‚ame"

442  
şs
.
_g’”®_desütiÚ
[şs.
BACKEND_HUMAN_NAME
]

444 
def
 
	`g‘_humª_Çme
(
£lf
):

446 
»tuºs
 
the
 
u£r
 
cu¡omized
 
back’d
 
Çme
. 
If
hu£¸
ha¢
't

447 
cu¡omized
 
™
, 
»tuºs
 
the
  
Úe
.

449 @
»tuºs
 
¡ršg
: 
the
 "humª‚ame" 
of
 
this
 
back’d


451 
£lf
.
KEY_HUMAN_NAME
 
š
 s–f.
_·¿m‘”s
 
ªd
 \

452 
£lf
.
_·¿m‘”s
[£lf.
KEY_HUMAN_NAME
] != "":

453  
£lf
.
_·¿m‘”s
[£lf.
KEY_HUMAN_NAME
]

455  
£lf
.
	`g‘_humª_deçuÉ_Çme
()

457 
def
 
	`£t_humª_Çme
(
£lf
, 
Çme
):

459 
£ts
 
a
 
cu¡om
 
Çme
 
the
 
back’d


461 @
·¿m
 
Çme
: 
the
 
Ãw
‚ame

463 
£lf
.
_·¿m‘”s
[£lf.
KEY_HUMAN_NAME
] = 
Çme


464 #w
sigÇl
 
the
 
chªge


465 
£lf
.
_sigÇl_mªag”
.
	`back’d_»Çmed
(£lf.
	`g‘_id
())

467 
def
 
	`is_’abËd
(
£lf
):

469 
R‘uºs
 
the
 
back’d
 
is
 
’abËd


471 @
»tuºs
: 
boŞ


473  
£lf
.
	`g‘_·¿m‘”s
()[
G’”icBack’d
.
KEY_ENABLED
] 
Ü
 \

474 
£lf
.
	`is_deçuÉ
()

476 
def
 
	`is_deçuÉ
(
£lf
):

478 
R‘uºs
 
the
 
back’d
 
is
 
’abËd


480 @
»tuºs
: 
boŞ


482  
£lf
.
	`g‘_·¿m‘”s
()[
G’”icBack’d
.
KEY_DEFAULT_BACKEND
]

484 
def
 
	`is_š™Ÿlized
(
£lf
):

486 
R‘uºs
 
the
 
back’d
 
is
 
up
 
ªd
 
ruÂšg


488 @
»tuºs
: 
is_š™Ÿlized


490  
£lf
.
_is_š™Ÿlized


492 
def
 
	`g‘_·¿m‘”_ty³
(
£lf
, 
·¿m_Çme
):

494 
Giv’
 
the
 
Çme
 
of
 
a
 
·¿m‘”
, 
»tuºs
 
™s
 
ty³
. 
If
h·¿m‘” 
is


495 
Úe
 
of
 
the
  
Úes
, 
™
 
dÛs
 
nÙ
 
have
 
a
 
ty³
: 
š
 
th©
 , it

496 
»tuºs
 
NÚe


498 @
·¿m
 
·¿m_Çme
: 
the
 
Çme
 
of
h
·¿m‘”


499 @
»tuºs
 
¡ršg
: 
the
 
ty³
, 
Ü
 
NÚe


501 
Œy
:

502  
£lf
.
	`g‘_¡©ic_·¿m‘”s
()[
·¿m_Çme
][£lf.
PARAM_TYPE
]

503 
exû±
:

504  
NÚe


506 
def
 
	`»gi¡”_d©a¡Üe
(
£lf
, 
d©a¡Üe
):

508 
S‘‹r
 
funùiÚ
 
to
 
šfÜm
 
the
 
back’d
 
about
h
d©a¡Üe
 
th©
's

509 
lßdšg
 
™
.

511 @
·¿m
 
d©a¡Üe
: 
a
 
D©a¡Üe


513 
£lf
.
d©a¡Üe
 = datastore

515 ###############################################################################
###HELPER 
FUNCTIONS
 ##########################################################

516 ###############################################################################
 _¡Üe_pickËd_fe(£lf,…©h, d©a):

518 
A
 
h–³r
 
funùiÚ
 
to
 
§ve
 
some
 
objeù
 
š
 
a
 
fe
.

520 @
·¿m
 
·th
: 
a
 
»Ïtive
…©h. 
A
 
good
 
choiû
 
is


522 @
·¿m
 
d©a
: 
the
 
objeù


524 
·th
 = 
os
.·th.
	`još
(
	`CÜeCÚfig
().
	`g‘_d©a_dœ
(),…ath)

525 #mkdœ -
p


526 
Œy
:

527 
os
.
	`makedœs
(os.
·th
.
	`dœÇme
(path))

528 
exû±
 
OSE¼Ü
 
as
 
exû±iÚ
:

529 
exû±iÚ
.
”ºo
 !ğ”ºo.
EEXIST
:

530 
¿i£


532 #Shiá 
backups


533 
i
 
š
 
	`¿nge
(
PICKLE_BACKUP_NBR
, 1, -1):

534 
de¡š©iÚ
 = "%s.bak.%d" % (
·th
, 
i
)

535 
sourû
 = "%s.bak.%d" % (
·th
, 
i
 - 1)

537 
os
.
·th
.
	`exi¡s
(
de¡š©iÚ
):

538 
os
.
	`uÆšk
(
de¡š©iÚ
)

540 
os
.
·th
.
	`exi¡s
(
sourû
):

541 
os
.
	`»Çme
(
sourû
, 
de¡š©iÚ
)

543 #Backu°
maš
 
fe


544 
PICKLE_BACKUP_NBR
 > 0:

545 
de¡š©iÚ
 = "%s.bak.1" % 
·th


546 
os
.
·th
.
	`exi¡s
(path):

547 
os
.
	`»Çme
(
·th
, 
de¡š©iÚ
)

550 
w™h
 
	`İ’
(
·th
, 'wb'è
as
 
fe
:

551 
pickË
.
	`dump
(
d©a
, 
fe
)

553 
def
 
	`_lßd_pickËd_fe
(
£lf
, 
·th
, 
deçuÉ_v®ue
=
NÚe
):

555 
A
 
h–³r
 
funùiÚ
 
to
 
lßd
 
some
 
objeù
 
äom
 
a
 
fe
.

557 @
·¿m
 
·th
: 
the
 
»Ïtive
…©h 
of
h
fe


558 @
·¿m
 
deçuÉ_v®ue
: 
the
 
v®ue
 
to
  th
fe
 
is
 
missšg
 
Ü


559 
cÜru±


560 @
»tuºs
 
objeù
: 
the
 
Ãeded
 objeù, 
Ü
 
deçuÉ_v®ue


562 
·th
 = 
os
.·th.
	`još
(
	`CÜeCÚfig
().
	`g‘_d©a_dœ
(),…ath)

563 
nÙ
 
os
.
·th
.
	`exi¡s
(path):

564  
deçuÉ_v®ue


566 
w™h
 
	`İ’
(
·th
, 'rb'è
as
 
fe
:

567 
Œy
:

568  
pickË
.
	`lßd
(
fe
)

569 
exû±
 
Exû±iÚ
:

570 
Log
.
	`”rÜ
("Pickle file for backend '%s' is damaged" %

571 
£lf
.
	`g‘_Çme
())

573 #Lßdšg 
fe
 
çed
, 
Œyšg
 
backups


574 
i
 
š
 
	`¿nge
(1, 
PICKLE_BACKUP_NBR
 + 1):

575 
backup_fe
 = "%s.bak.%d" % (
·th
, 
i
)

576 
os
.
·th
.
	`exi¡s
(
backup_fe
):

577 
w™h
 
	`İ’
(
backup_fe
, 'rb'è
as
 
fe
:

578 
Œy
:

579 
d©a
 = 
pickË
.
	`lßd
(
fe
)

580 
Log
.
	`šfo
("Succesfully„estored backup #%d for '%s'" %

581 (
i
, 
£lf
.
	`g‘_Çme
()))

582  
d©a


583 
exû±
 
Exû±iÚ
:

584 
Log
.
	`”rÜ
("Backup #%d for '%s' is damaged‡s well" %

585 (
i
, 
£lf
.
	`g‘_Çme
()))

587 #D©¨
could
 
nÙ
 
be
 
lßded
, 
deg¿de
 
to
  
d©a


588 
Log
.
	`”rÜ
("There is‚o suitable backup for '%s', "

589 "lßdšg deçuÉ d©a" % 
£lf
.
	`g‘_Çme
())

590  
deçuÉ_v®ue


592 
def
 
	`_gtg_sk_is_synÿbË_³r_©ched_gs
(
£lf
, 
sk
):

594 
H–³r
 
funùiÚ
 
which
 
checks
 
the
 
giv’
 
sk
 
§tisf›s
h
f‹ršg


595 
impo£d
 
by
 
the
 
gs
 
©ched
 
to
h
back’d
.

596 
Th©
 
m—ns
, 
a
 
u£r
 
wªts
‡ 
back’d
 
to
 
sync
 
Úly
 
sks
 
gged
 @
wÜks
,

597 
this
 
funùiÚ
 
should
 
be
 
u£d
 
to
 
check
 
th©
 
is
 
v”if›d
.

599 @
»tuºs
 
boŞ
: 
True
 
the
 
sk
 
should
 
be
 
synûd


601 
©ched_gs
 = 
£lf
.
	`g‘_©ched_gs
()

602 
G’”icBack’d
.
ALLTASKS_TAG
 
š
 
©ched_gs
:

603  
True


604 
g
 
š
 
sk
.
	`g‘_gs_Çme
():

605 
g
 
š
 
©ched_gs
:

606  
True


607  
F®£


609 ###############################################################################
###THREADING #################################################################
###############################################################################
 __Œy_Ïunch_£‰šg_th»ad(£lf):

611 
H–³r
 
funùiÚ
 
to
 
Ïunch
 
the
 
£‰šg
 
th»ad
, 
™
's‚ot„unning.

613 
£lf
.
to_£t_tim”
 
is
 
NÚe
 
ªd
 s–f.
	`is_’abËd
():

614 
£lf
.
to_£t_tim”
 = 
th»adšg
.
	`Tim”
(£lf.
tim”_time¡•
,

615 
£lf
.
Ïunch_£‰šg_th»ad
)

616 
£lf
.
to_£t_tim”
.
	`¡¬t
()

618 
def
 
	`Ïunch_£‰šg_th»ad
(
£lf
, 
by·ss_qu™_»que¡
=
F®£
):

620 
This
 
funùiÚ
 
is
 
Ïunched
 
as
 
a
 
£·¿‹
 
th»ad
. 
Its
 
job
 i 
to
 
³rfÜm


621 
the
 
chªges
 
th©
 
have
 
b“n
 
issued
 
äom
 
GTG
 
cÜe
.

622 
In
 
·¹icuÏr
, 
—ch
 
sk
 
š
 
the
 
£lf
.
to_£t
 
queue
, 
a
ask

623 
has
 
to
 
be
 
modif›d
 
Ü
Øb
	`ü—‹d
 (
the
 
tid
 
is
 
Ãw
), 
ªd
 

624 
—ch
 
sk
 
š
 
the
 
£lf
.
to_»move
 
queue
, 
a
ask 
has
 
to
 
be
 
d–‘ed


626 @
·¿m
 
by·ss_qu™_»que¡
: 
True
, 
the
 
th»ad
 
should
 
nÙ
 
be
 
¡İ³d


627 
ev’
 
asked
 
by
 
£lf
.
¶—£_qu™
 = 
True
.

628 
It
's used whenhe backend quits,o finish

629 
syncšg
 
®l
 
³ndšg
 
sks


631 
nÙ
 
£lf
.
¶—£_qu™
 
Ü
 
by·ss_qu™_»que¡
:

632 
Œy
:

633 
sk
 = 
£lf
.
to_£t
.
	`pİ
()

634 
exû±
 
IndexE¼Ü
:

636 
tid
 = 
sk
.
	`g‘_id
()

637 
tid
 
nÙ
 
š
 
£lf
.
to_»move
:

638 
£lf
.
	`£t_sk
(
sk
)

640 
nÙ
 
£lf
.
¶—£_qu™
 
Ü
 
by·ss_qu™_»que¡
:

641 
Œy
:

642 
tid
 = 
£lf
.
to_»move
.
	`pİ
()

643 
exû±
 
IndexE¼Ü
:

645 
£lf
.
	`»move_sk
(
tid
)

646 #w
»Ëa£
 
the
 
w—k
 
lock


647 
£lf
.
to_£t_tim”
 = 
NÚe


649 
def
 
	`queue_£t_sk
(
£lf
, 
sk
):

651 
sk
 
š
 
the
 
£lf
.
to_£t
 
queue
. 
A
 
th»ad
 
wl
 
shÜy
 
run
 
to
 
­¶y
he

652 
»que¡ed
 
chªges
.

654 @
·¿m
 
sk
: 
the
ask 
th©
 
should
 
be
 
§ved


656 
tid
 = 
sk
.
	`g‘_id
()

657 
sk
 
nÙ
 
š
 
£lf
.
to_£t
 
ªd
 
tid
‚Ù iÀ£lf.
to_»move
:

658 
£lf
.
to_£t
.
	`­³ndËá
(
sk
)

659 
£lf
.
	`__Œy_Ïunch_£‰šg_th»ad
()

661 
def
 
	`queue_»move_sk
(
£lf
, 
tid
):

663 
Queues
 
sk
 
to
 
be
 
»moved
. 
In
 
·¹icuÏr
, 
™
 
ju¡
 
’queues
 
the


664 
sk
 
š
 
the
 
£lf
.
to_»move
 
queue
. 
A
 
th»ad
 
wl
 
shÜy
 
run
 
to
 
­¶y


665 
the
 
»que¡ed
 
chªges
.

667 @
·¿m
 
tid
: 
The
 
Task
 
ID
 
of
 
the
 
sk
 
to
 
be
 
»moved


669 
tid
 
nÙ
 
š
 
£lf
.
to_»move
:

670 
£lf
.
to_»move
.
	`­³ndËá
(
tid
)

671 
£lf
.
	`__Œy_Ïunch_£‰šg_th»ad
()

672  
NÚe


674 
def
 
	`sync
(
£lf
):

676 
H–³r
 
m‘hod
. 
FÜûs
 
the
 
back’d
 
to
 
³rfÜm
 
®l
h
³ndšg
 
chªges
.

677 
It
 
is
 
usu®ly
 
ÿÎed
 
upÚ
 
qu™tšg
 
the
 
back’d
.

679 
£lf
.
to_£t_tim”
 
is
 
nÙ
 
NÚe
:

680 
£lf
.
¶—£_qu™
 = 
True


681 
Œy
:

682 
£lf
.
to_£t_tim”
.
	`ÿnûl
()

683 
exû±
:

684 
·ss


685 
Œy
:

686 
£lf
.
to_£t_tim”
.
	`još
()

687 
exû±
:

688 
·ss


689 
£lf
.
	`Ïunch_£‰šg_th»ad
(
by·ss_qu™_»que¡
=
True
)

690 
£lf
.
	`§ve_¡©e
()

	@backends/generictomboy.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
CÚšs
 
the
 
Back’d
 
şass
 
bÙh
 
Tomboy
 
ªd
 
	gGnÙe


20 #NÙe: 
To
 
šŒo¥eù
 
tomboy
, 
execu‹
:

21 #qdbu 
Üg
.
gnome
.
Tomboy
 /Üg/gnome/Tomboy/
RemÙeCÚŒŞ


23 
impÜt
 
os


24 
impÜt
 
th»adšg


25 
impÜt
 
uuid


26 
impÜt
 
dbus


27 
impÜt
 
d©‘ime


28 
impÜt
 
unicoded©a


30 
äom
 
	gGTG
.
	gtoŞs
.
bÜg
 
impÜt
 
BÜg


31 
äom
 
	gGTG
.
	gback’ds
.
g’”icback’d
 
impÜt
 
G’”icBack’d


32 
äom
 
	gGTG
.
	gback’ds
.
back’dsigÇls
 
impÜt
 
Back’dSigÇls


33 
äom
 
	gGTG
.
	gback’ds
.
synûngše
 
impÜt
 
	gSyncEngše
, 
SyncMeme


34 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


35 
äom
 
	gGTG
.
	gtoŞs
.
w©chdog
 
impÜt
 
W©chdog


36 
äom
 
	gGTG
.
	gtoŞs
.
š‹¼u±ibË
 
impÜt
 interruptible

37 
äom
 
	gGTG
.
	gtoŞs
.
gs
 
impÜt
 
exŒaù_gs_äom_‹xt


40 
şass
 
	$G’”icTomboy
(
G’”icBack’d
):

43 ###############################################################################
###Back’d 
¡ªd¬d
 
m‘hods
 ##################################################

44 ###############################################################################
 __š™__(£lf,…¬am‘”s):

46 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

48 
	`su³r
(
G’”icTomboy
, 
£lf
).
	$__š™__
(
·¿m‘”s
)

49 #lßdšg 
the
 
§ved
 
¡©e
 
of
h
synchrÚiz©iÚ
, 
ªy


50 
£lf
.
d©a_·th
 = 
os
.
·th
.
	`još
('backends/tomboy/',

51 "sync_’gše-" + 
£lf
.
	$g‘_id
())

52 
£lf
.
sync_’gše
 = s–f.
	`_lßd_pickËd_fe
(£lf.
d©a_·th
,

53 
	$SyncEngše
())

54 #w
Ët
 
some
 
time
 
·ss
 
befÜe
 
cÚsid”šg
 
a
 
tomboy
 
sk
 
impÜtšg
,

55 #a 
the
 
u£r
 
may
 
¡l
 
be
 
ed™šg
 
™
. 
H”e
, 
we
 
¡Üe
h
Tim”
 
objeùs


56 #th© 
wl
 
execu‹
 
aá”
 
some
 
time
‡á” 
—ch
 
tomboy
 
sigÇl
.

57 #NOTE: 
I
'm‚Ù su» iàthi i thÿ£‡nymÜ(buˆ™ shouldn'
t
 
hu¹


58 #ªyway). (
šv”nizzi
)

59 
£lf
.
_tomboy_£‰šg_tim”s
 = {
	}
}

61 #W
Ãed
 
to
 
‹Î
 
dbus
-
glib
Ø
š™Ÿlize
 
libdbus
'hread†ocks.

62 #Removšg 
this
 
ÿÎ
 
wl
 
»suÉ
 
š
 
¿ndom
 
£gçuÉs
 
ªd
 
üashes


63 #Ú 
’ablšg
 
GNÙe
 
ªd
 
Tomboy
 (
Bug
 #1264684è- 
·ršpÜecha


64 
dbus
.
mašloİ
.
glib
.
	$th»ads_š™
()

66 
def
 
	$š™Ÿlize
(
£lf
):

68 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

69 
CÚÃùs
 
to
 
the
 
£ssiÚ
 
bus
 
ªd
 
£ts
h
ÿÎbacks
 bu 
sigÇls


71 
	`su³r
(
G’”icTomboy
, 
£lf
).
	$š™Ÿlize
()

72 
w™h
 
£lf
.
	$DbusW©chdog
(
£lf
):

73 
bus
 = 
dbus
.
	$SessiÚBus
()

74 
bus
.
	`add_sigÇl_»ûiv”
(
£lf
.
Ú_nÙe_§ved
,

75 
dbus_š‹rçû
=
£lf
.
BUS_ADDRESS
[2],

76 
sigÇl_Çme
="NoteSaved")

77 
bus
.
	`add_sigÇl_»ûiv”
(
£lf
.
Ú_nÙe_d–‘ed
,

78 
dbus_š‹rçû
=
£lf
.
BUS_ADDRESS
[2],

79 
sigÇl_Çme
="NoteDeleted")

81 @
š‹¼u±ibË


82 
def
 
	$¡¬t_g‘_sks
(
£lf
):

84 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

85 
G‘s
 
®l
 
the
 
nÙes
 
äom
 
Tomboy
 
ªd
 
£es
 
they
 
mu¡
 
be
 
added
 
š
 
GTG


86 (
ªd
, 
so
, 
™
 
adds
 
them
).

88 
tomboy_nÙes
 = []

89 
w™h
 
£lf
.
	$TomboyCÚÃùiÚ
(
£lf
, *£lf.
BUS_ADDRESS
è
as
 
tomboy
:

90 
w™h
 
£lf
.
	$DbusW©chdog
(
£lf
):

91 
tomboy_nÙes
 = [
nÙe_id
 nÙe_id 
š


92 
tomboy
.
	`Li¡AÎNÙes
()]

93 #addšg 
the
 
Ãw
 
Úes


94 
nÙe
 
š
 
tomboy_nÙes
:

95 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

96 
£lf
.
	$_´oûss_tomboy_nÙe
(
nÙe
)

97 #checkšg 
some
 
nÙes
 
have
 
b“n
 
d–‘ed
 
GTG
 
was
 
nÙ
 
ruÂšg


98 
¡Üed_nÙes_ids
 = 
£lf
.
sync_’gše
.
	$g‘_®l_»mÙe
()

99 
nÙe
 
š
 
	`£t
(
¡Üed_nÙes_ids
).
	`difã»nû
(
	$£t
(
tomboy_nÙes
)):

100 
£lf
.
	$Ú_nÙe_d–‘ed
(
nÙe
, 
NÚe
)

102 
def
 
	$§ve_¡©e
(
£lf
):

104 
£lf
.
	$_¡Üe_pickËd_fe
(
£lf
.
d©a_·th
, s–f.
sync_’gše
)

106 
def
 
	$qu™
(
£lf
, 
di§bË
=
F®£
):

108 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

111 
def
 
	$qu™_th»ad
():

112 
True
:

113 
Œy
:

114 [
key
, 
tim”
] = \

115 
	`Ãxt
(
	`™”
(
£lf
.
_tomboy_£‰šg_tim”s
.
	$™ems
()))

116 
exû±
 
StİI‹¿tiÚ
:

118 
tim”
.
	$ÿnûl
()

119 
d–
 
£lf
.
_tomboy_£‰šg_tim”s
[
key
]

120 
th»adšg
.
	`Th»ad
(
rg‘
=
qu™_th»ad
).
	$¡¬t
()

121 
	`su³r
(
G’”icTomboy
, 
£lf
).
	$qu™
(
di§bË
)

123 ###############################################################################
###Som‘hšg 
gÙ
 
»moved
 #####################################################
###############################################################################
@
š‹¼u±ibË


124 
def
 
	$Ú_nÙe_d–‘ed
(
£lf
, 
nÙe
, 
som‘hšg
):

126 
C®lback
, 
execu‹d
 
wh’
 
a
 
tomboy
 
nÙe
 
is
 
d–‘ed
.

127 
D–‘es
 
the
 
»Ï‹d
 
GTG
 
sk
.

129 @
·¿m
 
nÙe
: 
the
 
id
 
of
h
Tomboy
‚ote

130 @
·¿m
 
som‘hšg
: 
nÙ
 
u£d
, 
h”e
 
sigÇl
 
ÿÎback
 
com·tib™y


132 
w™h
 
£lf
.
d©a¡Üe
.
	$g‘_back’d_mu‹x
():

133 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

134 
Œy
:

135 
tid
 = 
£lf
.
sync_’gše
.
	$g‘_loÿl_id
(
nÙe
)

136 
exû±
 
KeyE¼Ü
:

138 
£lf
.
d©a¡Üe
.
	$has_sk
(
tid
):

139 
£lf
.
d©a¡Üe
.
	$»que¡_sk_d–‘iÚ
(
tid
)

140 
£lf
.
	`b»ak_»ÏtiÚsh
(
»mÙe_id
=
nÙe
)

142 @
š‹¼u±ibË


143 
def
 
	$»move_sk
(
£lf
, 
tid
):

145 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

147 
w™h
 
£lf
.
d©a¡Üe
.
	$g‘_back’d_mu‹x
():

148 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

149 
Œy
:

150 
nÙe
 = 
£lf
.
sync_’gše
.
	$g‘_»mÙe_id
(
tid
)

151 
exû±
 
KeyE¼Ü
:

153 
w™h
 
£lf
.
	$TomboyCÚÃùiÚ
(
£lf
, *£lf.
BUS_ADDRESS
è
as
 
tomboy
:

154 
w™h
 
£lf
.
	$DbusW©chdog
(
£lf
):

155 
tomboy
.
	$NÙeExi¡s
(
nÙe
):

156 
tomboy
.
	$D–‘eNÙe
(
nÙe
)

157 
£lf
.
	$b»ak_»ÏtiÚsh
(
loÿl_id
=
tid
)

159 
def
 
	$_exec_lo¡_synÿb™y
(
£lf
, 
tid
, 
nÙe
):

161 
Execu‹d
 
wh’
 
a
 
»ÏtiÚsh
 
b‘w“n
 
sks
 
lo£s
 
™s
 
synÿb™y


162 
´İ”ty
. 
S“
 
SyncEngše
 
ª
 
ex¶ª©iÚ
 
of
 
th©
.

163 
This
 
funùiÚ
 
fšds
 
out
 
which
 
	`objeù
 (
sk
/
nÙe
è
is
 
the
 
Üigš®
 
Úe


164 
ªd
 
which
 
is
 
the
 
cİy
,‡nd 
d–‘es
he copy.

166 @
·¿m
 
tid
: 
a
 
GTG
 
sk
id

167 @
·¿m
 
nÙe
: 
a
 
tomboy
‚Ù
id


169 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

170 
meme
 = 
£lf
.
sync_’gše
.
	$g‘_meme_äom_»mÙe_id
(
nÙe
)

171 #Fœ¡ 
of
 
®l
, 
the
 
»ÏtiÚsh
 
is
 
lo¡


172 
£lf
.
sync_’gše
.
	$b»ak_»ÏtiÚsh
(
»mÙe_id
=
nÙe
)

173 
meme
.
	`g‘_Üigš
() == "GTG":

174 
w™h
 
£lf
.
	$TomboyCÚÃùiÚ
(
£lf
, *£lf.
BUS_ADDRESS
è
as
 
tomboy
:

175 
w™h
 
£lf
.
	$DbusW©chdog
(
£lf
):

176 
tomboy
.
	$D–‘eNÙe
(
nÙe
)

178 
£lf
.
d©a¡Üe
.
	$»que¡_sk_d–‘iÚ
(
tid
)

180 ###############################################################################
###Proûs 
sks
 #############################################################
###############################################################################
 _´oûss_tomboy_nÙe(£lf,‚Ùe):

182 
Giv’
 
a
 
tomboy
 
nÙe
, 
fšds
 
out
 
™
 
mu¡
 
be
 
synûd
 
to
‡ 
GTG
‚Ù
ªd
,

183 
so
, 
™
 
ÿ¼›s
 
out
 
the
 
	`synchrÚiz©iÚ
 (
by
 
ü—tšg
 
Ü
 
upd©šg
 
a


184 
GTG
 
sk
, 
Ü
 
d–‘šg
 
™£lf
 
the
 
»Ï‹d
ask 
has
 
b“n
 
d–‘ed
)

186 @
·¿m
 
nÙe
: 
a
 
Tomboy
‚Ù
id


188 
w™h
 
£lf
.
d©a¡Üe
.
	$g‘_back’d_mu‹x
():

189 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

190 
is_synÿbË
 = 
£lf
.
	$_tomboy_nÙe_is_synÿbË
(
nÙe
)

191 
has_sk
 = 
£lf
.
d©a¡Üe
.has_task

192 
nÙe_exi¡s
 = 
£lf
.
_tomboy_nÙe_exi¡s


193 
w™h
 
£lf
.
	$DbusW©chdog
(
£lf
):

194 
aùiÚ
, 
tid
 = 
£lf
.
sync_’gše
.
	$ª®yze_»mÙe_id
(
nÙe
,

195 
has_sk
,

196 
nÙe_exi¡s
,

197 
is_synÿbË
)

198 
Log
.
	`debug
("´oûssšgomboy (%s, %s)" % (
aùiÚ
, 
is_synÿbË
))

200 
aùiÚ
 =ğ
SyncEngše
.
ADD
:

201 
tid
 = 
	`¡r
(
uuid
.
	$uuid4
())

202 
sk
 = 
£lf
.
d©a¡Üe
.
	$sk_çùÜy
(
tid
)

203 
£lf
.
	$_pİuÏ‹_sk
(
sk
, 
nÙe
)

204 
modif›d_fÜ
 = 
£lf
.
	$g‘_modif›d_fÜ_nÙe
(
nÙe
)

205 
£lf
.
	`»cÜd_»ÏtiÚsh
(
loÿl_id
=
tid
,

206 
»mÙe_id
=
nÙe
,

207 
meme
=
	`SyncMeme
(
sk
.
	`g‘_modif›d
(),

208 
modif›d_fÜ
,

209 
£lf
.
	$g‘_id
()))

210 
£lf
.
d©a¡Üe
.
	$push_sk
(
sk
)

212 
–if
 
aùiÚ
 =ğ
SyncEngše
.
UPDATE
:

213 
sk
 = 
£lf
.
d©a¡Üe
.
	$g‘_sk
(
tid
)

214 
meme
 = 
£lf
.
sync_’gše
.
	$g‘_meme_äom_»mÙe_id
(
nÙe
)

215 
Ãwe¡
 = 
meme
.
	`which_is_Ãwe¡
(
sk
.
	`g‘_modif›d
(),

216 
£lf
.
	$g‘_modif›d_fÜ_nÙe
(
nÙe
))

217 
Ãwe¡
 == "remote":

218 
£lf
.
	$_pİuÏ‹_sk
(
sk
, 
nÙe
)

219 
meme
.
	`£t_loÿl_Ï¡_modif›d
(
sk
.
	$g‘_modif›d
())

220 
meme
.
	`£t_»mÙe_Ï¡_modif›d
(

221 
£lf
.
	$g‘_modif›d_fÜ_nÙe
(
nÙe
))

222 
£lf
.
	$§ve_¡©e
()

224 
–if
 
aùiÚ
 =ğ
SyncEngše
.
REMOVE
:

225 
w™h
 
£lf
.
	$TomboyCÚÃùiÚ
(
£lf
, *£lf.
BUS_ADDRESS
è
as
 
tomboy
:

226 
w™h
 
£lf
.
	$DbusW©chdog
(
£lf
):

227 
tomboy
.
	$D–‘eNÙe
(
nÙe
)

228 
Œy
:

229 
£lf
.
sync_’gše
.
	$b»ak_»ÏtiÚsh
(
»mÙe_id
=
nÙe
)

230 
exû±
 
KeyE¼Ü
:

231 
·ss


233 
–if
 
aùiÚ
 =ğ
SyncEngše
.
LOST_SYNCABILITY
:

234 
£lf
.
	`_exec_lo¡_synÿb™y
(
tid
, 
nÙe
)

236 @
š‹¼u±ibË


237 
def
 
	$£t_sk
(
£lf
, 
sk
):

239 
S“
 
G’”icBack’d
 
ª
 
ex¶ª©iÚ
 
of
 
this
 
funùiÚ
.

241 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

242 
is_synÿbË
 = 
£lf
.
	$_gtg_sk_is_synÿbË_³r_©ched_gs
(
sk
)

243 
tid
 = 
sk
.
	$g‘_id
()

244 
w™h
 
£lf
.
d©a¡Üe
.
	$g‘_back’d_mu‹x
():

245 
w™h
 
£lf
.
	$TomboyCÚÃùiÚ
(
£lf
, *£lf.
BUS_ADDRESS
è
as
 
tomboy
:

246 
has_sk
 = 
£lf
.
d©a¡Üe
.has_task

247 
has_nÙe
 = 
tomboy
.
NÙeExi¡s


248 
ÿn_sync
 = 
is_synÿbË


249 
w™h
 
£lf
.
	$DbusW©chdog
(
£lf
):

250 
aùiÚ
, 
nÙe
 = 
£lf
.
sync_’gše
.
	$ª®yze_loÿl_id
(
tid
,

251 
has_sk
,

252 
has_nÙe
,

253 
ÿn_sync
)

254 
Log
.
	`debug
("´oûssšg gtg (%s, %d)" % (
aùiÚ
, 
is_synÿbË
))

256 
aùiÚ
 =ğ
SyncEngše
.
ADD
:

257 #GTG 
®lows
 
muÉË
 
sks
 
w™h
 
the
 
§me
 
Çme
,

258 #Tomboy 
dÛ¢
't. we‚eedo handlehe„enaming

260 
t™Ë
 = 
sk
.
	$g‘_t™Ë
()

261 
du¶iÿ‹_couÁ”
 = 1

262 
w™h
 
£lf
.
	$DbusW©chdog
(
£lf
):

263 
nÙe
 = 
tomboy
.
	$C»©eNamedNÙe
(
t™Ë
)

264 
nÙe
 == "":

265 
du¶iÿ‹_couÁ”
 += 1

266 
nÙe
 = 
tomboy
.
	`C»©eNamedNÙe
(
t™Ë
 + "(%d)" %

267 
du¶iÿ‹_couÁ”
)

268 
du¶iÿ‹_couÁ”
 != 1:

269 #ià
we
 
Ãeded
 
to
 
»Çme
, w
have
Ø»Çm
®so


270 #th
gtg
 
sk


271 
sk
.
	`£t_t™Ë
(
t™Ë
 + " (%d)" % 
du¶iÿ‹_couÁ”
)

273 
£lf
.
	$_pİuÏ‹_nÙe
(
nÙe
, 
sk
)

274 
£lf
.
	`»cÜd_»ÏtiÚsh
(

275 
loÿl_id
=
tid
, 
»mÙe_id
=
nÙe
,

276 
meme
=
	`SyncMeme
(
sk
.
	`g‘_modif›d
(),

277 
£lf
.
	`g‘_modif›d_fÜ_nÙe
(
nÙe
),

280 
–if
 
aùiÚ
 =ğ
SyncEngše
.
UPDATE
:

281 
meme
 = 
£lf
.
sync_’gše
.
	`g‘_meme_äom_loÿl_id
(

282 
sk
.
	$g‘_id
())

283 
modif›d_fÜ
 = 
£lf
.
	$g‘_modif›d_fÜ_nÙe
(
nÙe
)

284 
Ãwe¡
 = 
meme
.
	`which_is_Ãwe¡
(
sk
.
	`g‘_modif›d
(),

285 
modif›d_fÜ
)

286 
Ãwe¡
 == "local":

287 
£lf
.
	$_pİuÏ‹_nÙe
(
nÙe
, 
sk
)

288 
meme
.
	`£t_loÿl_Ï¡_modif›d
(
sk
.
	$g‘_modif›d
())

289 
meme
.
	`£t_»mÙe_Ï¡_modif›d
(

290 
£lf
.
	$g‘_modif›d_fÜ_nÙe
(
nÙe
))

291 
£lf
.
	$§ve_¡©e
()

293 
–if
 
aùiÚ
 =ğ
SyncEngše
.
REMOVE
:

294 
£lf
.
d©a¡Üe
.
	$»que¡_sk_d–‘iÚ
(
tid
)

295 
Œy
:

296 
£lf
.
sync_’gše
.
	$b»ak_»ÏtiÚsh
(
loÿl_id
=
tid
)

297 
£lf
.
	$§ve_¡©e
()

298 
exû±
 
KeyE¼Ü
:

299 
·ss


301 
–if
 
aùiÚ
 =ğ
SyncEngše
.
LOST_SYNCABILITY
:

302 
£lf
.
	$_exec_lo¡_synÿb™y
(
tid
, 
nÙe
)

304 ###############################################################################
###H–³¸
m‘hods
 ############################################################

305 ###############################################################################
@
š‹¼u±ibË


306 
def
 
	$Ú_nÙe_§ved
(
£lf
, 
nÙe
):

308 
C®lback
, 
execu‹d
 
wh’
 
a
 
tomboy
 
nÙe
 
is
 
§ved
 
by
 
Tomboy
 
™£lf
.

309 
Upd©es
 
the
 
»Ï‹d
 
GTG
 
	`sk
 (
Ü
 
ü—‹s
 
Úe
, 
Ãûs§ry
).

311 @
·¿m
 
nÙe
: 
the
 
id
 
of
h
Tomboy
‚ote

313 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

314 #NOTE: 
we
 
Ët
 
some
 
£cÚds
 
·ss
 
befÜe
 
executšg
 
the
 
»®
 
ÿÎback
, 
as


315 #th
ed™šg
 
of
 
the
 
Tomboy
 
nÙe
 
may
 
¡l
 
be
 
š
 
´og»ss


317 @
š‹¼u±ibË


318 
def
 
	$_execu‹_Ú_nÙe_§ved
(
£lf
, 
nÙe
):

319 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

320 
Œy
:

321 
d–
 
£lf
.
_tomboy_£‰šg_tim”s
[
nÙe
]

322 
exû±
:

323 
·ss


324 
£lf
.
	$_´oûss_tomboy_nÙe
(
nÙe
)

325 
£lf
.
	$§ve_¡©e
()

327 
Œy
:

328 
£lf
.
_tomboy_£‰šg_tim”s
[
nÙe
].
	$ÿnûl
()

329 
exû±
 
KeyE¼Ü
:

330 
·ss


331 
fš®ly
:

332 
tim”
 = 
th»adšg
.
	`Tim”
(5, 
_execu‹_Ú_nÙe_§ved
,

333 
¬gs
=(
£lf
, 
nÙe
))

334 
£lf
.
_tomboy_£‰šg_tim”s
[
nÙe
] = 
tim”


335 
tim”
.
	$¡¬t
()

337 
def
 
	$_tomboy_nÙe_is_synÿbË
(
£lf
, 
nÙe
):

339 
R‘uºs
 
True
 
this
 
tomboy
 
nÙe
 
should
 
be
 
synûd
 
što
 
GTG
 
sks
.

341 @
·¿m
 
nÙe
: 
the
‚Ù
id


342 @
»tuºs
 
BoŞ—n


344 
©ched_gs
 = 
£lf
.
	$g‘_©ched_gs
()

345 
G’”icBack’d
.
ALLTASKS_TAG
 
š
 
©ched_gs
:

346  
True


347 
w™h
 
£lf
.
	$TomboyCÚÃùiÚ
(
£lf
, *£lf.
BUS_ADDRESS
è
as
 
tomboy
:

348 
w™h
 
£lf
.
	$DbusW©chdog
(
£lf
):

349 
cÚ‹Á
 = 
tomboy
.
	$G‘NÙeCÚ‹Ás
(
nÙe
)

350 
synÿbË
 = 
F®£


351 
g
 
š
 
©ched_gs
:

352 
Œy
:

353 
cÚ‹Á
.
	$šdex
(
g
)

354 
synÿbË
 = 
True


356 
exû±
 
V®ueE¼Ü
:

357 
·ss


358  
synÿbË


360 
def
 
	$_tomboy_nÙe_exi¡s
(
£lf
, 
nÙe
):

362 
R‘uºs
 
True
 
a
 
tomboy
 
nÙe
 
exi¡s
 
w™h
 
the
 
giv’
 
id
.

364 @
·¿m
 
nÙe
: 
the
‚Ù
id


365 @
»tuºs
 
BoŞ—n


367 
w™h
 
£lf
.
	$TomboyCÚÃùiÚ
(
£lf
, *£lf.
BUS_ADDRESS
è
as
 
tomboy
:

368 
w™h
 
£lf
.
	$DbusW©chdog
(
£lf
):

369  
tomboy
.
	$NÙeExi¡s
(
nÙe
)

371 
def
 
	$g‘_modif›d_fÜ_nÙe
(
£lf
, 
nÙe
):

373 
R‘uºs
 
the
 
modifiÿtiÚ
 
time
 th
giv’
 
nÙe
 
id
.

375 @
·¿m
 
nÙe
: 
the
‚Ù
id


376 @
»tuºs
 
d©‘ime
.datetime

378 
w™h
 
£lf
.
	$TomboyCÚÃùiÚ
(
£lf
, *£lf.
BUS_ADDRESS
è
as
 
tomboy
:

379 
w™h
 
£lf
.
	$DbusW©chdog
(
£lf
):

380  
d©‘ime
.d©‘ime.
	`äomtime¡amp
(

381 
tomboy
.
	$G‘NÙeChªgeD©e
(
nÙe
))

383 
def
 
	$_tomboy_¥l™_t™Ë_ªd_‹xt
(
£lf
, 
cÚ‹Á
):

385 
Tomboy
 
dÛs
 
nÙ
 
have
 
a
 "g‘T™Ë" 
ªd
 "g‘Text" 
funùiÚs
 
to
 
g‘
 
the


386 
t™Ë
 
ªd
 
the
 
‹xt
 
of
 
a
 
nÙe
 
£·¿‹ly
. 
In¡—d
, 
™
 
has
‡ 
g‘CÚ‹Á


387 
funùiÚ
, 
th©
 
»tuºs
 
bÙh
 
of
 
them
.

388 
This
 
funùiÚ
 
¥l™s
 
up
 
the
 
ouut
 
of
 
g‘CÚ‹Á
 
što
 
a
 
t™Ë
 
¡ršg


389 
ªd
 
a
 
‹xt
 
¡ršg
.

391 @
·¿m
 
cÚ‹Á
: 
a
 
¡ršg
, 
the
 
»suÉ
 
of
‡ 
g‘CÚ‹Á
 
ÿÎ


392 @
»tuºs
 
li¡
: 
a
†i¡ 
compo£d
 
by
 [
t™Ë
, 
‹xt
]

394 
Œy
:

395 
’d_of_t™Ë
 = 
cÚ‹Á
.
	`šdex
('\n')

396 
exû±
 
V®ueE¼Ü
:

397  
cÚ‹Á
, 
	`¡r
("")

398 
t™Ë
 = 
cÚ‹Á
[: 
’d_of_t™Ë
]

399 
	`Ën
(
cÚ‹Á
è> 
’d_of_t™Ë
:

400  
t™Ë
, 
cÚ‹Á
[
’d_of_t™Ë
 + 1:]

402  
t™Ë
, 
	`¡r
("")

404 
def
 
	$_pİuÏ‹_sk
(
£lf
, 
sk
, 
nÙe
):

406 
Cİ›s
 
the
 
cÚ‹Á
 
of
 
a
 
Tomboy
 
nÙe
 
što
‡ 
sk
.

408 @
·¿m
 
sk
: 
a
 
GTG
 
Task


409 @
·¿m
 
nÙe
: 
a
 
Tomboy
‚ote

411 #add 
gs
 
	`objeùs
 (
™
's‚otƒnougho have @tag inheexto‡dd‡

413 
w™h
 
£lf
.
	$TomboyCÚÃùiÚ
(
£lf
, *£lf.
BUS_ADDRESS
è
as
 
tomboy
:

414 
w™h
 
£lf
.
	$DbusW©chdog
(
£lf
):

415 
cÚ‹Á
 = 
tomboy
.
	$G‘NÙeCÚ‹Ás
(
nÙe
)

416 #upd©
the
 
gs
 
li¡


417 
sk
.
	`£t_Úly_the£_gs
(
	$exŒaù_gs_äom_‹xt
(
cÚ‹Á
))

418 #exŒaù 
t™Ë
 
ªd
 
‹xt


419 [
t™Ë
, 
‹xt
] = 
£lf
.
	`_tomboy_¥l™_t™Ë_ªd_‹xt
(
	$¡r
(
cÚ‹Á
))

420 #Tomboy 
¥—ks
 
unicode
, 
we
 
dÚ
't

421 
t™Ë
 = 
unicoded©a
.
	`nÜm®ize
('NFKD',itle)

422 
‹xt
 = 
unicoded©a
.
	`nÜm®ize
('NFKD',ext)

423 
sk
.
	$£t_t™Ë
(
t™Ë
)

424 
sk
.
	$£t_‹xt
(
‹xt
)

425 
sk
.
	`add_»mÙe_id
(
£lf
.
	`g‘_id
(), 
nÙe
)

427 
def
 
	$_pİuÏ‹_nÙe
(
£lf
, 
nÙe
, 
sk
):

429 
Cİ›s
 
the
 
cÚ‹Á
 
of
 
a
 
sk
 
što
‡ 
Tomboy
 
nÙe
.

431 @
·¿m
 
nÙe
: 
a
 
Tomboy
‚ote

432 @
·¿m
 
sk
: 
a
 
GTG
 
Task


434 
t™Ë
 = 
sk
.
	$g‘_t™Ë
()

435 
w™h
 
£lf
.
	$TomboyCÚÃùiÚ
(
£lf
, *£lf.
BUS_ADDRESS
è
as
 
tomboy
:

436 
w™h
 
£lf
.
	$DbusW©chdog
(
£lf
):

437 
tomboy
.
	`S‘NÙeCÚ‹Ás
(
nÙe
, 
t™Ë
 + '\n' +

438 
sk
.
	$g‘_exû½t
(
¡r_gs
=
F®£
))

440 
def
 
	$b»ak_»ÏtiÚsh
(
£lf
, *
¬gs
, **
kw¬gs
):

442 
Proxy
 
m‘hod
 
SyncEngše
.
b»ak_»ÏtiÚsh
, 
which
 
®so
 
§ves
 
the


443 
¡©e
 
of
 
the
 
synchrÚiz©iÚ
.

445 #tomboy 
·s£s
 
Dbus
.
SŒšg
 
objeùs
, 
which
 
¬e
 
nÙ
 
pickabË
. 
We
 
cÚv”t


446 #tho£ 
to
 
unicode


447 "»mÙe_id" 
š
 
kw¬gs
:

448 
kw¬gs
["»mÙe_id"] = 
	`¡r
(kwargs["remote_id"])

449 
Œy
:

450 
£lf
.
sync_’gše
.
	$b»ak_»ÏtiÚsh
(*
¬gs
, **
kw¬gs
)

451 #w
Œy
 
to
 
§ve
 
the
 
¡©e
 
©
 
—ch
 
chªge
 
š
h
sync_’gše
:

454 
£lf
.
	$§ve_¡©e
()

455 
exû±
 
KeyE¼Ü
:

456 
·ss


458 
def
 
	$»cÜd_»ÏtiÚsh
(
£lf
, *
¬gs
, **
kw¬gs
):

460 
Proxy
 
m‘hod
 
SyncEngše
.
b»ak_»ÏtiÚsh
, 
which
 
®so
 
§ves
 
the


461 
¡©e
 
of
 
the
 
synchrÚiz©iÚ
.

463 #tomboy 
·s£s
 
Dbus
.
SŒšg
 
objeùs
, 
which
 
¬e
 
nÙ
 
pickabË
. 
We
 
cÚv”t


464 #tho£ 
to
 
unicode


465 "»mÙe_id" 
š
 
kw¬gs
:

466 
kw¬gs
["»mÙe_id"] = 
	`¡r
(kwargs["remote_id"])

468 
£lf
.
sync_’gše
.
	$»cÜd_»ÏtiÚsh
(*
¬gs
, **
kw¬gs
)

469 #w
Œy
 
to
 
§ve
 
the
 
¡©e
 
©
 
—ch
 
chªge
 
š
h
sync_’gše
:

472 
£lf
.
	$§ve_¡©e
()

474 ###############################################################################
###CÚÃùiÚ 
hªdlšg
 #######################################################
###############################################################################
 TomboyCÚÃùiÚ(BÜg):

476 
TomboyCÚÃùiÚ
 
ü—‹s
 
a
 
cÚÃùiÚ
 
to
 
TOMBOY
 
vŸ
 
DBus
 
ªd


477 
hªdËs
 
®l
 
the
 
possibË
 
exû±iÚs
.

478 
It
 
is
 
a
 
şass
 
th©
 
ÿn
 
be
 
u£d
 
w™h
‡ w™h 
¡©em’t
.

479 
Exam¶e
::

480 
w™h
 
£lf
.
	$TomboyCÚÃùiÚ
(
£lf
, *£lf.
BUS_ADDRESS
è
as
 
tomboy
:

481 #dØ
som‘hšg


484 
def
 
	$__š™__
(
£lf
, 
back’d
, 
bus_Çme
, 
bus_·th
, 
bus_š‹rçû
):

486 
S“s
 
a
 
TomboyCÚÃùiÚ
 
objeù
 
®»ady
 
exi¡s
. 
If
 
so
, 
sšû
 
we


487 
¬e
 
šh”™šg
 
äom
 
a
 
BÜg
 
objeù
, 
the
 
š™Ÿliz©iÚ
 
®»ady
 
took


488 
¶aû
.

489 
If
 
nÙ
, 
™
 
Œ›s
 
to
 
cÚÃù
Ø
Tomboy
 
vŸ
 
Dbus
. Ià
the
 
cÚÃùiÚ


490 
is
 
nÙ
 
possibË
, 
the
 
u£r
 i 
nÙif›d
 
about
 
™
.

492 @
·¿m
 
back’d
: 
a
 
»ã»nû
 
to
‡ 
Back’d


493 @
·¿m
 
bus_Çme
: 
the
 
DBus
 
add»ss
 
of
 
Tomboy


494 @
·¿m
 
bus_·th
: 
the
 
DBus
 
·th
 
of
 
Tomboy
 
RemÙeCÚŒŞ


495 @
·¿m
 
bus_š‹rçû
: 
the
 
DBus
 
add»ss
 
of
 
Tomboy
 
RemÙeCÚŒŞ


497 
	`su³r
(
G’”icTomboy
.
TomboyCÚÃùiÚ
, 
£lf
).
	$__š™__
()

498 
	`ha§‰r
(
£lf
, "tomboy_cÚÃùiÚ_is_ok"è
ªd
 \

499 
£lf
.
tomboy_cÚÃùiÚ_is_ok
:

501 
£lf
.
back’d
 = backend

502 
£lf
.
tomboy_cÚÃùiÚ_is_ok
 = 
True


503 
w™h
 
G’”icTomboy
.
	$DbusW©chdog
(
back’d
):

504 
bus
 = 
dbus
.
	$SessiÚBus
()

505 
Œy
:

506 
obj
 = 
bus
.
	$g‘_objeù
(
bus_Çme
, 
bus_·th
)

507 
£lf
.
tomboy
 = 
dbus
.
	$IÁ”çû
(
obj
, 
bus_š‹rçû
)

508 
exû±
 
dbus
.
DBusExû±iÚ
:

509 
£lf
.
	$tomboy_çed
()

510 
£lf
.
tomboy
 = 
NÚe


512 
def
 
	$__’‹r__
(
£lf
):

514 
R‘uºs
 
the
 
Tomboy
 
cÚÃùiÚ


516 @
»tuºs
: 
dbus
.
IÁ”çû


518  
£lf
.
tomboy


520 
def
 
	$__ex™__
(
£lf
, 
exû±iÚ_ty³
, 
v®ue
, 
Œaûback
):

522 
Checks
 
the
 
¡©e
 
of
h
cÚÃùiÚ
.

523 
If
 
som‘hšg
 
w’t
 
wrÚg
 
the
 
cÚÃùiÚ
, 
nÙif›s
h
u£r
.

525 @
·¿m
 
exû±iÚ_ty³
: 
the
 
ty³
 
of
 
exû±iÚ
 
th©
 
occu¼ed
, 
Ü


526 
NÚe


527 @
·¿m
 
v®ue
: 
the
 
š¡ªû
 
of
h
exû±iÚ
 
occu¼ed
, 
Ü
 
NÚe


528 @
·¿m
 
Œaûback
: 
the
¿ûback 
of
h
”rÜ


529 @
»tuºs
: 
F®£
 
some
 
exû±iÚ
 
mu¡
 
be
 
»
-
¿i£d
.

531 
	$isš¡ªû
(
v®ue
, 
dbus
.
DBusExû±iÚ
è
Ü
 \

532 
nÙ
 
£lf
.
tomboy_cÚÃùiÚ_is_ok
:

533 
£lf
.
	$tomboy_çed
()

534  
True


536  
F®£


538 
def
 
	$tomboy_çed
(
£lf
):

541 
Di§bË
 
back’d
 
ªd
 
show
 
”rÜ
 
š
 
nÙifiÿtiÚ
 
b¬
 """

542 
£lf
.
tomboy_cÚÃùiÚ_is_ok
 = 
F®£


543 
	`Back’dSigÇls
().
	`back’d_çed
(
£lf
.
back’d
.
	`g‘_id
(),

544 
Back’dSigÇls
.
ERRNO_DBUS
)

545 
£lf
.
back’d
.
	$qu™
(
di§bË
=
True
)

547 
şass
 
	$DbusW©chdog
(
W©chdog
):

549 
A
 
sim¶e
 
w©chdog
 
to
 
d‘eù
 
¡®e
 
dbus
 
cÚÃùiÚs


552 
def
 
	$__š™__
(
£lf
, 
back’d
):

554 
Sim¶e
 
cÚ¡ruùÜ
, 
which
 
£ts
 
_wh’_kšg_too_lÚg
 
as
 
the


555 
funùiÚ
 
to
 
run
 
wh’
 
the
 
cÚÃùiÚ
 
is
 
kšg
 
too
 .

557 @
·¿m
 
back’d
: 
a
 
Back’d
 
objeù


559 
£lf
.
back’d
 = backend

560 
	`su³r
(
G’”icTomboy
.
DbusW©chdog
, 
£lf
).
	$__š™__
(

561 3, 
£lf
.
_wh’_kšg_too_lÚg
)

563 
def
 
	$_wh’_kšg_too_lÚg
(
£lf
):

565 
FunùiÚ
 
th©
 
is
 
execu‹d
 
wh’
 
the
 
Dbus
 
cÚÃùiÚ
 
£ems
 
to
 
be


566 
hªgšg
. 
It
 
di§bËs
 
the
 
back’d
 
ªd
 
sigÇls
h
”rÜ
 
to
h
u£r
.

568 
Log
.
	`”rÜ
("Dbus connection isakingoo†ong forhe Tomboy/Gnote"

570 
	`Back’dSigÇls
().
	`back’d_çed
(
£lf
.
back’d
.
	`g‘_id
(),

571 
Back’dSigÇls
.
ERRNO_DBUS
)

572 
£lf
.
back’d
.
	`qu™
(
di§bË
=
True
)

	@backends/periodicimportbackend.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
CÚšs
 
	gP”iodicImpÜtBack’d
, 
a
 
G’”icBack’d
 
¥ecŸlized
 
checkšg
 
the


19 
»mÙe
 
back’d
 
š
 
	gpŞlšg
.

22 
impÜt
 
th»adšg


24 
äom
 
	gGTG
.
	gback’ds
.
g’”icback’d
 
impÜt
 
G’”icBack’d


25 
äom
 
	gGTG
.
	gback’ds
.
back’dsigÇls
 
impÜt
 
Back’dSigÇls


26 
äom
 
	gGTG
.
	gtoŞs
.
š‹¼u±ibË
 
impÜt
 interruptible

29 
şass
 
	$P”iodicImpÜtBack’d
(
G’”icBack’d
):

31 
This
 
şass
 
ÿn
 
be
 
u£d
 
š
 
¶aû
 
of
 
G’”icBack’d
 
wh’
 
a
 
³riodic
 
impÜt
 
is


32 
Ãûs§ry
, 
as
 
the
 
»mÙe
 
£rviû
 
´ovidšg
 
sks
 
dÛs
 
nÙ
 
sigÇls
he

33 
chªges
.

34 
To
 
u£
 
this
, 
Úly
 
two
 
thšgs
 
¬e
 
Ãûs§ry
:

35 - 
usšg
 
do_³riodic_impÜt
 
š¡—d
 
of
 
¡¬t_g‘_sks


36 - 
havšg
 
š
 
_¡©ic_·¿m‘”s
 
a
 "³riod" 
key
, 
as
 in::

38 
G’”icBack’d
.
PARAM_TYPE
: G’”icBack’d.
TYPE_INT
,

39 
G’”icBack’d
.
PARAM_DEFAULT_VALUE
: 2, 
	}
},

40 
This
 
¥ecif›s
 
the
 
time
 
th©
 
mu¡
 
·ss
 
b‘w“n
 
cÚ£cutive
 
	gimpÜts


41 (
š
 
	gmšu‹s
)

44 
def
 
	$__š™__
(
£lf
, 
·¿m‘”s
):

45 
	`su³r
(
P”iodicImpÜtBack’d
, 
£lf
).
	$__š™__
(
·¿m‘”s
)

46 
£lf
.
ruÂšg_™”©iÚ
 = 
F®£


47 
£lf
.
urg’t_™”©iÚ
 = 
F®£


49 @
š‹¼u±ibË


50 
def
 
	$¡¬t_g‘_sks
(
£lf
):

52 
This
 
funùiÚ
 
Ïunches
 
the
 
fœ¡
 
³riodic
 
impÜt
, 
ªd
 
scheduËs
he

53 
Ãxt
 
Úes
.

55 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

56 #ià
we
're‡lready importing, we queue‡ "urgent" import cycle‡fter

57 #thi 
Úe
. 
The
 
ã–šg
 
of
 
»¥Úsiv’ess
 oà
the
 
back’d
 
is
 
im´oved
.

58 
nÙ
 
£lf
.
ruÂšg_™”©iÚ
:

59 
Œy
:

60 #ià
ª
 
™”©iÚ
 
was
 
scheduËd
, 
we
 
ÿnûl
 
™


61 
£lf
.
impÜt_tim”
:

62 
£lf
.
impÜt_tim”
.
	$ÿnûl
()

63 
exû±
:

64 
·ss


65 
£lf
.
	$is_’abËd
(è
is
 
F®£
:

68 #w
scheduË
 
the
 
Ãxt
 
™”©iÚ
, 
ju¡
 
š
 
this
 
Úe
 
çs


69 
nÙ
 
£lf
.
urg’t_™”©iÚ
:

70 
£lf
.
impÜt_tim”
 = 
th»adšg
.
	`Tim”
(

71 
£lf
.
_·¿m‘”s
['period'] * 60.0,

72 
£lf
.
¡¬t_g‘_sks
)

73 
£lf
.
impÜt_tim”
.
	$¡¬t
()

75 #execu‹ 
the
 
™”©iÚ


76 
£lf
.
ruÂšg_™”©iÚ
 = 
True


77 
£lf
.
	$_¡¬t_g‘_sks
()

78 
£lf
.
ruÂšg_™”©iÚ
 = 
F®£


79 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

81 #execu‹ 
ev’tu®
 
urg’t
 
™”©iÚ


82 #NOTE: 
this
 
way
, 
the
 
™”©iÚ
 
çs
,h
whŞe
 
³riodic
 
impÜt


83 #cyş
çs
.

84 
£lf
.
urg’t_™”©iÚ
:

85 
£lf
.
urg’t_™”©iÚ
 = 
F®£


86 
£lf
.
	$¡¬t_g‘_sks
()

88 
£lf
.
urg’t_™”©iÚ
 = 
True


90 
def
 
	$_¡¬t_g‘_sks
(
£lf
):

92 
This
 
funùiÚ
 
execu‹s
 
ª
 
impÜts
 
ªd
 
scheduËs
 
the
 
Ãxt


94 
£lf
.
	$ÿnûÎ©iÚ_pošt
()

95 
	`Back’dSigÇls
().
	`back’d_sync_¡¬‹d
(
£lf
.
	$g‘_id
())

96 
£lf
.
	$do_³riodic_impÜt
()

97 
	`Back’dSigÇls
().
	`back’d_sync_’ded
(
£lf
.
	$g‘_id
())

99 
def
 
	$qu™
(
£lf
, 
di§bË
=
F®£
):

101 
C®Ëd
 
wh’
 
GTG
 
qu™s
 
Ü
 
discÚÃùs
 
the
 
back’d
.

103 
	`su³r
(
P”iodicImpÜtBack’d
, 
£lf
).
	$qu™
(
di§bË
)

104 
Œy
:

105 
£lf
.
impÜt_tim”
.
	$ÿnûl
()

106 
exû±
 
Exû±iÚ
:

107 
·ss


108 
Œy
:

109 
£lf
.
impÜt_tim”
.
	$još
()

110 
exû±
 
Exû±iÚ
:

111 
·ss


	@backends/rtm/__init__.py

	@backends/rtm/rtm.py

1 #PythÚ 
lib¿ry
 
Rememb”
 
The
 
Mk
 
API


3 
	g__authÜ__
 = 'Sridhar Ratnakumar <http://nearfar.org/>'

4 
__®l__
 = (

11 
impÜt
 
	gu¾lib
.
»que¡


12 
impÜt
 
	gu¾lib
.
·r£


13 
impÜt
 
	gu¾lib
.
”rÜ


14 
äom
 
hashlib
 
impÜt
 
md5


16 
äom
 
GTG
 
impÜt
 
_


17 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


19 
	g_u£_jsÚlib
 = 
F®£


20 
Œy
:

21 
impÜt
 
sim¶ejsÚ
 
as
 
jsÚ


22 
as£¹
 
jsÚ


23 
_u£_jsÚlib
 = 
True


24 
exû±
 
ImpÜtE¼Ü
:

25 
Œy
:

26 
impÜt
 
jsÚ
 
as
 json

27 
as£¹
 
jsÚ


28 
_u£_jsÚlib
 = 
True


29 
exû±
 
ImpÜtE¼Ü
:

30 
Œy
:

31 
äom
 
djªgo
.
uts
 
impÜt
 
sim¶ejsÚ
 
as
 
jsÚ


32 
_u£_jsÚlib
 = 
True


33 
exû±
 
ImpÜtE¼Ü
:

34 
·ss


36 
nÙ
 
_u£_jsÚlib
:

37 
Log
.
w¬nšg
("simplejson module is‚ot‡vailable, "

42 
SERVICE_URL
 = 'http://api.rememberthemilk.com/services/rest/'

43 
AUTH_SERVICE_URL
 = 'http://www.rememberthemilk.com/services/auth/'

46 
şass
 
	$RTME¼Ü
(
Exû±iÚ
):

47 
·ss


50 
şass
 
	$RTMAPIE¼Ü
(
RTME¼Ü
):

51 
·ss


54 
şass
 
	$AuthS‹Machše
(
objeù
):

56 
şass
 
	$NoD©a
(
RTME¼Ü
):

57 
·ss


59 
def
 
	$__š™__
(
£lf
, 
¡©es
):

60 
£lf
.
¡©es
 = states

61 
£lf
.
d©a
 = {
	}
}

63 
def
 
	$d©aReûived
(
£lf
, 
¡©e
, 
d©um
):

64 
¡©e
 
nÙ
 
š
 
£lf
.
¡©es
:

65 
”rÜ_¡ršg
 = 
	`_
("Invalid state") + " <%s>"

67 
¿i£
 
	`RTME¼Ü
(
”rÜ_¡ršg
 % 
¡©e
)

68 
£lf
.
d©a
[
¡©e
] = 
d©um


70 
def
 
	$g‘
(
£lf
, 
¡©e
):

71 
¡©e
 
š
 
£lf
.
d©a
:

72  
£lf
.
d©a
[
¡©e
]

74 
¿i£
 
AuthS‹Machše
.
	`NoD©a
('NØd©¨fÜ <%s>' % 
¡©e
)

77 
şass
 
	$RTM
(
objeù
):

79 
def
 
	$__š™__
(
£lf
, 
­iKey
, 
£ü‘
, 
tok’
=
NÚe
):

80 
£lf
.
­iKey
 =‡piKey

81 
£lf
.
£ü‘
 = secret

82 
£lf
.
authInfo
 = 
	`AuthS‹Machše
(['frob', 'token'])

84 #thi 
’abËs
 
Úe
 
to
 dØ'¹m.sks.g‘Li¡()', 
exam¶e


85 
´efix
, 
m‘hods
 
š
 
	`li¡
(
API
.
	$™ems
()):

86 
	`£‰r
(
£lf
, 
´efix
,

87 
	$RTMAPIC©egÜy
(
£lf
, 
´efix
, 
m‘hods
))

89 
tok’
:

90 
£lf
.
authInfo
.
	`d©aReûived
('tok’', 
tok’
)

92 
def
 
	$_sign
(
£lf
, 
·¿ms
):

94 
·œs
 = ''.
	`još
(['%s%s' % (
k
, 
v
èk, v 
š
 
	`sÜ‹dI‹ms
(
·¿ms
)])

95  
	`md5
((
£lf
.
£ü‘
 + 
·œs
).
	`’code
('utf-8')).
	$hexdige¡
()

97 
def
 
	$g‘
(
£lf
, **
·¿ms
):

99 
·¿ms
['­i_key'] = 
£lf
.
­iKey


100 
·¿ms
['format'] = 'json'

101 
·¿ms
['­i_sig'] = 
£lf
.
	$_sign
(
·¿ms
)

103 
jsÚ_d©a
 = 
	`İ’URL
(
SERVICE_URL
, 
·¿ms
).
	$»ad
()

105 #LOG.
	`debug
("JSON„e¥Ú£: \n%s" % 
jsÚ
)

106 
_u£_jsÚlib
:

107 
d©a
 = 
	`dÙ‹dDiù
('ROOT', 
jsÚ
.
	`lßds
(
jsÚ_d©a
.
	`decode
('utf-8')))

109 
d©a
 = 
	`dÙ‹dJSON
(
jsÚ_d©a
.
	`decode
('utf-8'))

110 
r¥
 = 
d©a
.rsp

112 
r¥
.
¡©
 == 'fail':

113 
¿i£
 
	`RTMAPIE¼Ü
('API call failed - %s (%s)' % (

114 
r¥
.
”r
.
msg
,„¥.”r.
code
))

116  
r¥


118 
def
 
	$g‘NewFrob
(
£lf
):

119 
r¥
 = 
£lf
.
	`g‘
(
m‘hod
='rtm.auth.getFrob')

120 
£lf
.
authInfo
.
	`d©aReûived
('äob', 
r¥
.
äob
)

121  
r¥
.
äob


123 
def
 
	$g‘AuthURL
(
£lf
):

124 
Œy
:

125 
äob
 = 
£lf
.
authInfo
.
	`g‘
('frob')

126 
exû±
 
AuthS‹Machše
.
NoD©a
:

127 
äob
 = 
£lf
.
	$g‘NewFrob
()

129 
·¿ms
 = {

130 '­i_key': 
£lf
.
­iKey
,

132 'äob': 
äob


133 
	}
}

134 
·¿ms
['­i_sig'] = 
£lf
.
	$_sign
(
·¿ms
)

135  
AUTH_SERVICE_URL
 + '?' + 
u¾lib
.
·r£
.
	$u¾’code
(
·¿ms
)

137 
def
 
	$g‘Tok’
(
£lf
):

138 
äob
 = 
£lf
.
authInfo
.
	`g‘
('frob')

139 
r¥
 = 
£lf
.
	`g‘
(
m‘hod
='¹m.auth.g‘Tok’', 
äob
=frob)

140 
£lf
.
authInfo
.
	`d©aReûived
('tok’', 
r¥
.
auth
.
tok’
)

141  
r¥
.
auth
.
tok’


144 
şass
 
RTMAPIC©egÜy
:

147 
def
 
	$__š™__
(
£lf
, 
¹m
, 
´efix
, 
m‘hods
):

148 
£lf
.
¹m
 =„tm

149 
£lf
.
´efix
 =…refix

150 
£lf
.
m‘hods
 = methods

152 
def
 
	$__g‘©Œ__
(
£lf
, 
©Œ
):

153 
©Œ
 
š
 
£lf
.
m‘hods
:

154 
¿rgs
, 
ßrgs
 = 
£lf
.
m‘hods
[
©Œ
]

155 
£lf
.
´efix
 == 'tasksNotes':

156 
ªame
 = '¹m.sks.nÙes.%s' % 
©Œ


158 
ªame
 = '¹m.%s.%s' % (
£lf
.
´efix
, 
©Œ
)

159  
Ïmbda
 **
·¿ms
: 
£lf
.
	$ÿÎM‘hod
(

160 
ªame
, 
¿rgs
, 
ßrgs
, **
·¿ms
)

162 
¿i£
 
	`A‰ribu‹E¼Ü
('NØsuch‡‰ribu‹: %s' % 
©Œ
)

164 
def
 
	$ÿÎM‘hod
(
£lf
, 
ªame
, 
¿rgs
, 
ßrgs
, **
·¿ms
):

165 #Sª™y 
checks


166 
»quœedArg
 
š
 
¿rgs
:

167 
»quœedArg
 
nÙ
 
š
 
·¿ms
:

168 
¿i£
 
	`Ty³E¼Ü
(

169 'Requœed…¬am‘” (%sèmissšg' % 
»quœedArg
)

171 
·¿m
 
š
 
·¿ms
:

172 
·¿m
 
nÙ
 
š
 
¿rgs
 + 
ßrgs
:

173 
Log
.
	`”rÜ
('Inv®id…¬am‘” (%s)' % 
·¿m
)

175  
£lf
.
¹m
.
	`g‘
(
m‘hod
=
ªame
,

176 
auth_tok’
=
£lf
.
¹m
.
authInfo
.
	`g‘
('token'),

177 **
·¿ms
)

180 #Ut™y 
funùiÚs


181 
def
 
	$sÜ‹dI‹ms
(
diùiÚ¬y
):

183 
keys
 = 
	`li¡
(
diùiÚ¬y
.
	$keys
())

184 
keys
.
	$sÜt
()

185 
key
 
š
 
keys
:

186 
y›ld
 
key
, 
diùiÚ¬y
[key]

189 
def
 
	$İ’URL
(
u¾
, 
qu”yArgs
=
NÚe
):

190 
qu”yArgs
:

191 
u¾
 = u¾ + '?' + 
u¾lib
.
·r£
.
	$u¾’code
(
qu”yArgs
)

192 #LOG.
	`debug
("URL> %s", 
u¾
)

193  
u¾lib
.
»que¡
.
	$u¾İ’
(
u¾
)

196 
şass
 
	$dÙ‹dDiù
(
objeù
):

199 
def
 
	$__š™__
(
£lf
, 
Çme
, 
diùiÚ¬y
):

200 
£lf
.
_Çme
 = 
Çme


202 
	$ty³
(
diùiÚ¬y
è
is
 
diù
:

203 
key
, 
v®ue
 
š
 
	`li¡
(
diùiÚ¬y
.
	$™ems
()):

204 
	$ty³
(
v®ue
è
is
 
diù
:

205 
v®ue
 = 
	$dÙ‹dDiù
(
key
, 
v®ue
)

206 
–if
 
	$ty³
(
v®ue
è
	$š
 (
li¡
, 
tu¶e
è
ªd
 
key
 != 'tag':

207 
v®ue
 = [
	`dÙ‹dDiù
('%s_%d' % (
key
, 
i
), 
™em
)

208 
i
, 
™em
 
š
 
	`šdexed
(
v®ue
)]

209 
	$£‰r
(
£lf
, 
key
, 
v®ue
)

211 
¿i£
 
	`V®ueE¼Ü
('nÙ‡ diù: %s' % 
diùiÚ¬y
)

213 
def
 
	$__»´__
(
£lf
):

214 
chd»n
 = [
c
 ø
š
 
	$dœ
(
£lf
è
nÙ
 
c
.
	`¡¬tsw™h
('_')]

216 
£lf
.
_Çme
,

217 ', '.
	$još
(
chd»n
))

220 
def
 
	$§ãEv®
(
¡ršg
):

221  
	`ev®
(
¡ršg
, {
	}
}, {})

224 
def
 
	$dÙ‹dJSON
(
jsÚ
):

225  
	`dÙ‹dDiù
('ROOT', 
	$§ãEv®
(
jsÚ
))

228 
def
 
	$šdexed
(
£q
):

229 
šdex
 = 0

230 
™em
 
š
 
£q
:

231 
y›ld
 
šdex
, 
™em


232 
šdex
 += 1

235 #API 
¥ec


237 
API
 = {

353 
	}
}

356 
def
 
	$ü—‹RTM
(
­iKey
, 
£ü‘
, 
tok’
=
NÚe
):

357 
¹m
 = 
	$RTM
(
­iKey
, 
£ü‘
, 
tok’
)

358 #ià
tok’
 
is
 
NÚe
:

360 #´šˆ'Givmacûs h”e:', 
¹m
.
	`g‘AuthURL
()

362 #´šˆ'NÙdowÀthi tok’ fÜ futu» u£:', 
¹m
.
	`g‘Tok’
()

364  
¹m


367 
def
 
	$‹¡
(
­iKey
, 
£ü‘
, 
tok’
=
NÚe
):

368 
¹m
 = 
	$ü—‹RTM
(
­iKey
, 
£ü‘
, 
tok’
)

370 
r¥Tasks
 = 
¹m
.
sks
.
	`g‘Li¡
(
f‹r
='dueWithin:"1 week ofoday"')

371 
	$´št
([
t
.
Çme
 ˆ
š
 
r¥Tasks
.
sks
.
li¡
.
sk£r›s
])

372 
	$´št
(
r¥Tasks
.
sks
.
li¡
.
id
)

374 
r¥Li¡s
 = 
¹m
.
li¡s
.
	$g‘Li¡
()

375 #´šˆ
r¥Li¡s
.
li¡s
.
li¡


376 
	`´št
([(
x
.
Çme
, x.
id
èx 
š
 
r¥Li¡s
.
li¡s
.
li¡
])

379 
def
 
	$£t_log_Ëv–
(
Ëv–
):

382 >>> 
impÜt
 
¹m


383 >>> 
impÜt
 
loggšg


384 >>> 
¹m
.
	`£t_log_Ëv–
(
loggšg
.
INFO
)

387 #LOG.
	`£tLev–
(
Ëv–
)

	@backends/syncengine.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
This
 
lib¿ry
 
d—ls
 
w™h
 
synchrÚizšg
 
two
 
£ts
 
of
 
	gobjeùs
.

19 
It
 
wÜks
 
like
 
	gthis
:

20 - 
We
 
have
 
two
 
£ts
 
of
 
g’”ic
 
objeùs
 (
loÿl
 
ªd
 
»mÙe
)

21 - 
We
 
´e£Á
 
Úe
 
objeù
 
of
 
e™h”
 oÃ oà
the
 
£ts
 
ªd
 
ask
h
lib¿ry
 
wh©
's

22 
the
 
¡©e
 
of
 
™s
 
synchrÚiz©iÚ


23 - 
the
 
lib¿ry
 
wl
 
‹Î
 
us
 
we
 
Ãed
 
to
 
add
 
a
 
şÚe
 
objeù
 
š
h
Ùh”
 
£t
,

24 
upd©e
 
™
 
	gÜ
, 
the
 
Ùh”
 
Úe
 
has
 
b“n
 
	g»moved
, 
»move
 
®so
 
this
 
	gÚe


26 
äom
 
	gGTG
.
	gtoŞs
.
twokeydiù
 
impÜt
 
TwoKeyDiù


29 
	gTYPE_LOCAL
 = "local"

30 
TYPE_REMOTE
 = "remote"

33 
şass
 
	$SyncMeme
(
objeù
):

35 
A
 
SyncMeme
 
is
 
the
 
objeù
 
¡Üšg
h
d©a
 
Ãeded
 
to
 
k“p
 
Œack
 
of
h
¡©e


36 
of
 
two
 
objeùs
 
synchrÚiz©iÚ
.

37 
This
 
basic
 
v”siÚ
, 
th©
 
ÿn
 
be
 
ex·nded
 
as
 
Ãeded
 
by
 
the
 
code
 
usšg
he

38 
SyncEngše
, 
ju¡
 
¡Ües
 
the
 
modif›d
 
d©e
 
ªd
 
time
 
of
h
Ï¡


39 
synchrÚiz©iÚ
 
bÙh
 
	`objeùs
 (
loÿl
 
ªd
 
»mÙe
)

41 #NOTE: 
Checkšg
 
objeùs
 
CRCs
 
would
 
make
 
this
 
check
 
niûr
, 
as
 
we
 
could
 
know


42 #ià
the
 
objeù
 
was
 
»®ly
 
chªged
, 
Ü
 
™
 
has
 
ju¡
 
upd©ed
 
™s


43 #modif›d 
	`time
 (
šv”nizzi
)

44 
def
 
	$__š™__
(
£lf
,

45 
loÿl_modif›d
=
NÚe
,

46 
»mÙe_modif›d
=
NÚe
,

47 
Üigš
=
NÚe
):

49 
C»©es
 
a
 
Ãw
 
SyncMeme
, 
upd©šg
 
the
 
modif›d
 
times
 
bÙh
he

50 
loÿl
 
ªd
 
»mÙe
 
objeùs
,‡nd 
£ts
 
the
 
giv’
 
Üigš
.

51 
If
 
ªy
 
of
 
the
 
·¿m‘”s
 
is
 
£t
 
to
 
NÚe
, 
™
's ignored.

53 @
·¿m
 
loÿl_modif›d
: 
the
 
modif›d
 
time
 th
loÿl
 
objeù


54 @
·¿m
 
»mÙe_modif›d
: 
the
 
modif›d
 
time
 th
»mÙe
 
objeù


55 @
·¿m
 
Üigš
: 
ª
 
objeù
 
th©
 
id’tif›s
 
wh‘h”
 
the
 
loÿl
 
Ü
he

56 
»mÙe
 
is
 
the
 
Üigš®
 
objeù
,h
Ùh”
 
Úe
 
bešg
 
a


57 
cİy
.

59 
loÿl_modif›d
 
is
 
nÙ
 
NÚe
:

60 
£lf
.
	$£t_loÿl_Ï¡_modif›d
(
loÿl_modif›d
)

61 
»mÙe_modif›d
 
is
 
nÙ
 
NÚe
:

62 
£lf
.
	$£t_»mÙe_Ï¡_modif›d
(
»mÙe_modif›d
)

63 
Üigš
 
is
 
nÙ
 
NÚe
:

64 
£lf
.
	$£t_Üigš
(
Üigš
)

66 
def
 
	$£t_loÿl_Ï¡_modif›d
(
£lf
, 
modif›d_d©‘ime
):

68 
S‘‹r
 
funùiÚ
 
the
 
loÿl
 
objeù
 
modif›d
 
d©‘ime
.

70 @
·¿m
 
modif›d_d©‘ime
: 
the
 
loÿl
 
objeù
 
modif›d
 
d©‘ime


72 
£lf
.
loÿl_Ï¡_modif›d
 = 
modif›d_d©‘ime


74 
def
 
	$g‘_loÿl_Ï¡_modif›d
(
£lf
):

76 
G‘‹r
 
funùiÚ
 
the
 
loÿl
 
objeù
 
modif›d
 
d©‘ime
.

78  
£lf
.
loÿl_Ï¡_modif›d


80 
def
 
	$£t_»mÙe_Ï¡_modif›d
(
£lf
, 
modif›d_d©‘ime
):

82 
S‘‹r
 
funùiÚ
 
the
 
»mÙe
 
objeù
 
modif›d
 
d©‘ime
.

84 @
·¿m
 
modif›d_d©‘ime
: 
the
 
»mÙe
 
objeù
 
modif›d
 
d©‘ime


86 
£lf
.
»mÙe_Ï¡_modif›d
 = 
modif›d_d©‘ime


88 
def
 
	$g‘_»mÙe_Ï¡_modif›d
(
£lf
):

90 
G‘‹r
 
funùiÚ
 
the
 
»mÙe
 
objeù
 
modif›d
 
d©‘ime
.

92  
£lf
.
»mÙe_Ï¡_modif›d


94 
def
 
	$which_is_Ãwe¡
(
£lf
, 
loÿl_modif›d
, 
»mÙe_modif›d
):

96 
Giv’
 
the
 
upd©ed
 
modif›d
 
time
 
bÙh
h
loÿl
 
ªd
h
»mÙe


97 
objeùs
, 
™
 
checks
 
them
 
agaš¡
 
the
 
¡Üed
 
modif›d
 
times
 
ªd


98 
th’
 
agaš¡
 
—ch
 
Ùh”
.

100 @
»tuºs
 
¡ršg
: "loÿl"- 
the
 
loÿl
 
objeù
 
has
 
b“n
 
modif›d
 
ªd
 
™s


101 
the
 
Ãwe¡


102 "»mÙe" - 
the
 
§me
 th
»mÙe
 
objeù


103 
NÚe
 - 
no
 
objeù
 
modif›d
 
time
 
is
 
Ãw”
 
thª
 
the


104 
¡Üed
 
	`Úe
 (
the
 
objeùs
 
have
 
nÙ
 
b“n
 
modif›d
)

106 
loÿl_modif›d
 <ğ
£lf
.
loÿl_Ï¡_modif›d
 
ªd
 \

107 
»mÙe_modif›d
 <ğ
£lf
.
»mÙe_Ï¡_modif›d
:

108  
NÚe


109 
loÿl_modif›d
 > 
»mÙe_modif›d
:

114 
def
 
	$g‘_Üigš
(
£lf
):

116 
R‘uºs
 
the
 
Çme
 
of
h
sourû
 
th©
 
fœ¡ly
 
´e£Áed
h
objeù


118  
£lf
.
Üigš


120 
def
 
	$£t_Üigš
(
£lf
, 
Üigš
):

122 
S‘s
 
the
 
sourû
 
th©
 
´e£Áed
h
objeù
 th
fœ¡
 
time
. 
This


123 
sourû
 
hŞds
 
the
 
Üigš®
 
objeù
, th
Ùh”
 hŞd th
cİy
.

124 
This
 
ÿn
 
be
 
u£ful
 
š
 
the
 
of
 "lo¡ synÿb™y" (
£e
he

125 
SyncEngše
 
ª
 
ex¶aš©iÚ
).

127 @
·¿m
 
Üigš
: 
objeù
 
»´e£Ášg
 
the
 
sourû


129 
£lf
.
Üigš
 = origin

132 
şass
 
	$SyncMemes
(
TwoKeyDiù
):

134 
A
 
TwoKeyDiù
, 
w™h
 
ju¡
 
the
 
Çmes
 
chªged
 
to
 
be
 
b‘‹r
 
und”¡ªdabË
.

135 
The
 
m—nšg
 
of
 
the£
 
Çmes
 
is
 
ex¶ašed
 
š
 
the
 
SyncEngše
 
şass


136 
desütiÚ
. 
It
's usedo store‡ set of SyncMeme objects,ƒach one keeping

137 
¡Üšg
 
®l
 
the
 
d©a
 
Ãeded
 
to
 
k“p
 
Œack
 
of
 
a
 
sšgË
 
»ÏtiÚsh
.

140 
g‘_»mÙe_id
 = 
TwoKeyDiù
.
_g‘_£cÚd¬y_key


141 
g‘_loÿl_id
 = 
TwoKeyDiù
.
_g‘_´im¬y_key


142 
»move_loÿl_id
 = 
TwoKeyDiù
.
_»move_by_´im¬y


143 
»move_»mÙe_id
 = 
TwoKeyDiù
.
_»move_by_£cÚd¬y


144 
g‘_meme_äom_loÿl_id
 = 
TwoKeyDiù
.
_g‘_by_´im¬y


145 
g‘_meme_äom_»mÙe_id
 = 
TwoKeyDiù
.
_g‘_by_£cÚd¬y


146 
g‘_®l_loÿl
 = 
TwoKeyDiù
.
_g‘_®l_´im¬y_keys


147 
g‘_®l_»mÙe
 = 
TwoKeyDiù
.
_g‘_®l_£cÚd¬y_keys


150 
şass
 
	$SyncEngše
(
objeù
):

152 
The
 
SyncEngše
 
is
 
ª
 
objeù
 
u£ful
 
š
 
k“pšg
 
two
 
£ts
 
of
 
objeùs


153 
synchrÚized
.

154 
OÃ
 
£t
 
is
 
ÿÎed
 
the
 
Loÿl
 s‘,h
Ùh”
 i th
RemÙe
 
Úe
.

155 
It
 
¡Ües
 
the
 
¡©e
 
of
h
synchrÚiz©iÚ
 
ªd
h
Ï‹¡
 s‹ oà
—ch


156 
objeù
.

157 
Wh’
 
asked
, 
™
 
ÿn
 
‹Î
 
a
 
cou¶e
 
of
 
»Ï‹d
 
objeùs
 
¬e
 
up
 
to
 
d©e
 
š


158 
the
 
sync
 
ªd
, 
nÙ
, 
which
 
Úe
 
mu¡
 
be
 
upd©ed
.

160 
It
 
¡Ües
 
the
 
¡©e
 
of
 
—ch
 
»ÏtiÚsh
 
š
 
a
 
£r›s
 oà
SyncMeme
.

163 
UPDATE
 = "update"

164 
REMOVE
 = "remove"

165 
ADD
 = "add"

166 
LOST_SYNCABILITY
 = "lost syncability"

168 
def
 
	$__š™__
(
£lf
):

170 
In™Ÿlizes
 
the
 
¡Üage
 
of
 
objeù
 
»ÏtiÚshs
.

172 
£lf
.
sync_memes
 = 
	$SyncMemes
()

174 
def
 
	$_ª®yze_–em’t
(
£lf
,

175 
–em’t_id
,

176 
is_loÿl
,

177 
has_loÿl
,

178 
has_»mÙe
,

179 
is_synÿbË
=
True
):

181 
Giv’
 
ª
 
objeù
 
th©
 
should
 
be
 
synûd
 
w™h
 
ªÙh”
 
Úe
,

182 
™
 
fšds
 
out
 
about
 
the
 
»Ï‹d
 
objeù
, 
ªd
 
decides
 
wh‘h”
:

183 - 
the
 
Ùh”
 
objeù
 
ha¢
't been created yet (thus must be‡dded)

184 - 
the
 
Ùh”
 
objeù
 
has
 
b“n
 
	`d–‘ed
 (
thus
 
this
 
Úe
 
mu¡
 
be
 
d–‘ed
)

185 - 
the
 
Ùh”
 
objeù
 
is
 
´e£Á
, 
but
 
e™h”
 
Úe
 
has
 
b“n
 
chªged


187 
A
 
·¹icuÏr
 
h­³ns
 
the
 
Ùh”
 
objeù
 
is
 
´e£Á
, 
but
he

188 "is_synÿbË" 
	$·¿m‘”
 (
which
 
‹Îs
 
th©
 
we
 
š‹nd
 
to
 
k“p
 
the£
 
two


189 
objeùs
 
š
 
sync
è
is
 
£t
 
to
 
F®£
. 
In
 
this
 ,hi 
funùiÚ
 
»tuºs


190 
th©
 
the
 
Synÿb™y
 
´İ”ty
 
has
 
b“n
 
lo¡
. 
This
 
is
 
š‹»¡šg


191 
we
 
wªt
 
to
 
d–‘e
 
Úe
 
of
 
the
 
two
 
	`objeùs
 (thÚ
th©
 
has
 
b“n


192 
şÚed
 
äom
 
the
 
Üigš®
).

194 @
·¿m
 
–em’t_id
: 
the
 
id
 
of
h
–em’t
 
we
're‡nalysing.

195 @
·¿m
 
is_loÿl
: 
True
 
the
 
–em’t
 
ª®y£d
 
is
h
loÿl
 
	`Úe
 (
nÙ
he

196 
»mÙe
)

197 @
·¿m
 
has_loÿl
: 
funùiÚ
 
th©
 
acû±s
 
ª
 
id
 
of
 
the
 
loÿl
 
£t
 
ªd


198 
»tuºs
 
True
 
the
 
–em’t
 
is
 
´e£Á


199 @
·¿m
 
has_»mÙe
: 
funùiÚ
 
th©
 
acû±s
 
ª
 
id
 
of
 
the
 
»mÙe
 
£t
 
ªd


200 
»tuºs
 
True
 
the
 
–em’t
 
is
 
´e£Á


201 @
·¿m
 
is_synÿbË
: 
ex¶ašed
 
above


202 @
»tuºs
 
¡ršg
: 
Úe
 
of
 
£lf
.
UPDATE
, s–f.
ADD
, s–f.
REMOVE
,

203 
£lf
.
LOST_SYNCABILITY


205 
is_loÿl
:

206 
g‘_Ùh”_id
 = 
£lf
.
sync_memes
.
g‘_»mÙe_id


207 
is_sk_´e£Á
 = 
has_»mÙe


209 
g‘_Ùh”_id
 = 
£lf
.
sync_memes
.
g‘_loÿl_id


210 
is_sk_´e£Á
 = 
has_loÿl


212 
Œy
:

213 
Ùh”_id
 = 
	$g‘_Ùh”_id
(
–em’t_id
)

214 
	$is_sk_´e£Á
(
Ùh”_id
):

215 
is_synÿbË
:

216  
£lf
.
UPDATE
, 
Ùh”_id


218  
£lf
.
LOST_SYNCABILITY
, 
Ùh”_id


220  
£lf
.
REMOVE
, 
NÚe


221 
exû±
 
KeyE¼Ü
:

222 
is_synÿbË
:

223  
£lf
.
ADD
, 
NÚe


224  
NÚe
, None

226 
def
 
	$ª®yze_loÿl_id
(
£lf
, 
–em’t_id
, *
Ùh”_¬gs
):

228 
ShÜtcut
 
to
 
ÿÎ
 
_ª®yze_–em’t
 
a
 
loÿl
 
–em’t


230  
£lf
.
	$_ª®yze_–em’t
(
–em’t_id
, 
True
, *
Ùh”_¬gs
)

232 
def
 
	$ª®yze_»mÙe_id
(
£lf
, 
–em’t_id
, *
Ùh”_¬gs
):

234 
ShÜtcut
 
to
 
ÿÎ
 
_ª®yze_–em’t
 
a
 
»mÙe
 
–em’t


236  
£lf
.
	$_ª®yze_–em’t
(
–em’t_id
, 
F®£
, *
Ùh”_¬gs
)

238 
def
 
	$»cÜd_»ÏtiÚsh
(
£lf
, 
loÿl_id
, 
»mÙe_id
, 
meme
):

240 
RecÜds
 
th©
 
ª
 
objeù
 
äom
 
the
 
loÿl
 
£t
 
is
 
»Ï‹d
 
w™h
 
Úe
 
a
 
»mÙe


241 
£t
.

243 @
·¿m
 
loÿl_id
: 
the
 
id
 
of
h
loÿl
 
sk


244 @
·¿m
 
»mÙe_id
: 
the
 
id
 
of
h
»mÙe
 
sk


245 @
·¿m
 
meme
: 
the
 
SyncMeme
 
th©
 
k“ps
 
Œack
 
of
h
»ÏtiÚsh


247 
ŒËt
 = (
loÿl_id
, 
»mÙe_id
, 
meme
)

248 
£lf
.
sync_memes
.
	$add
(
ŒËt
)

250 
def
 
	$b»ak_»ÏtiÚsh
(
£lf
, 
loÿl_id
=
NÚe
, 
»mÙe_id
=None):

252 
b»aks
 
a
 
»ÏtiÚsh
 
b‘w“n
 
two
 
objeùs
.

253 
OÆy
 
Úe
 
of
 
the
 
two
 
·¿m‘”s
 
is
 
Ãûs§ry
 
to
 
id’tify
he

254 
»ÏtiÚsh
.

256 @
·¿m
 
loÿl_id
: 
the
 
id
 
of
h
loÿl
 
sk


257 @
·¿m
 
»mÙe_id
: 
the
 
id
 
of
h
»mÙe
 
sk


259 
loÿl_id
:

260 
£lf
.
sync_memes
.
	$»move_loÿl_id
(
loÿl_id
)

261 
–if
 
»mÙe_id
:

262 
£lf
.
sync_memes
.
	$»move_»mÙe_id
(
»mÙe_id
)

264 
def
 
	$__g‘©Œ__
(
£lf
, 
©Œ
):

266 
The
 
funùiÚs
 
li¡ed
 
h”e
 
¬e
 
·s£d
 
dœeùly
 
to
 
the
 
SyncMeme
 
objeù


268 @
·¿m
 
©Œ
: 
a
 
funùiÚ
 
Çme
 
amÚg
 
the
 
Úes
 
li¡ed
 
h”e


269 @
»tuºs
 
objeù
: 
the
 
funùiÚ
  object.

271 
©Œ
 
š
 ['get_remote_id',

277  
	$g‘©Œ
(
£lf
.
sync_memes
, 
©Œ
)

279 
¿i£
 
A‰ribu‹E¼Ü


	@core/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
	gGTG
's core functionality.

20 
In
 
Üd”
 
to
 
nÙ
 
š‹¿ù
 
dœeùly
 
w™h
 
the
 
	gd©a¡Üe
, 
we
 
	g´ovide


21 "»que¡”s". 
The
 
»que¡”
 
is
 
Úly
 
ª
 
š‹rçû
 
ªd
 
th”e
 
ÿn
 
be
 
as


22 
mªy
 
»que¡”s
 
as
 
you
 
wªt
‡ a 
they
 
¬e
 
®l
 
äom
 
the
 
§me


23 
	gd©a¡Üe
. 
Reque¡”
 
®so
 
´ovides
 
ª
 
š‹rçû
 
the
 
	gg¡Üe
.

25 
If
 
you
 
wªt
 
to
 
di¥Ïy
 
Úly
 
a
 
sub£t
 
of
 
	gsks
, you 
ÿn
 
	ge™h”
:

27 - 
have
 
acûss
 
to
 
the
 
maš
 
	$F‹»dT»e
 (
the
 
Úe
 
di¥Ïyed
 
š
h
maš


28 
wšdow
è
ªd
 
­¶y
 
f‹rs
 
Ú
 
™
. (
You
 
ÿn
 
ü—‹
 
your
 
own
)

30 - 
g‘
 
your
 
own
 
³rsÚ®
 
F‹»dT»e
 
ªd
 
­¶y
 
Ú
 
™
 
the
 
f‹rs
 
you


31 
wªt
 
w™hout
 
š‹rãršg
 
w™h
 
the
 
maš
 
v›w
. (
This
 
is
 
how
h
şo£d


32 
sks
 
·Ã
 
is
 
but
 
cu¼’y
)

35 #==ğ
IMPORT
 ===================================================================

36 
äom
 
»
 
impÜt
 
fšd®l


37 
impÜt
 
cÚfig·r£r


39 
äom
 
xdg
.
Ba£DœeùÜy
 
impÜt
 
xdg_d©a_home
, 
xdg_cÚfig_home
, 
xdg_d©a_dœs


40 
impÜt
 
os


42 
äom
 
GTG
.
toŞs
.
bÜg
 
impÜt
 
BÜg


43 
impÜt
 
GTG


45 
DEFAULTS
 = {

47 "bg_cŞÜ_’abË": 
True
,

48 "cÚ‹Ás_´ev›w_’abË": 
F®£
,

49 'g_·Ã': 
F®£
,

51 "şo£d_sk_·Ã": 
F®£
,

53 'toŞb¬': 
True
,

54 'quick_add': 
True
,

61 'max': 
F®£
,

75 
	}
}

78 #In¡—d 
of
 
acûssšg
 
dœeùly
 
the
 
CÚfigP¬£r
, 
—ch
 
moduË
 
wl
 
have


79 #Ú
SubCÚfig
 
objeù
. (
Úe
 SubCÚfig objeù 
®ways
 
m©ch
 oÃ 
fœ¡
 
Ëv–


80 #–em’ˆ
of
 
the
 
CÚfigP¬£r
 
dœeùÜy
)

81 #
#Th
gßl
 
of
 
the
 
SubCÚfig
 
objeù
 
is
 
to
 
hªdË
  
v®ue
 
ªd
 
cÚv”tšg


82 #SŒšg 
to
 
BoŞ
 
ªd
 
IÁ
 
wh’
 
Ãeded
.

83 #
#Each 
GTG
Â 
compÚ’t
 
usšg
 
cÚfig
 
should
 
be
 
pÜ‹d
 
to
 
SubCÚfig
 
ªd
, 
—ch


84 #£‰šg, 
a
  
v®ue
 
should
 
be
 
wr™‹n
 
š
 
the
 
DEFAULTS
 
above
.

85 #
#Cu¼’y 
dÚe
Â : 
brow£r


86 #TodØ: 
ed™Ü
, 
¶ugšs


88 
şass
 
	$SubCÚfig
():

90 
def
 
	$__š™__
(
£lf
, 
£ùiÚ
, 
cÚf
, 
cÚf_·th
):

91 
£lf
.
_£ùiÚ
 = 
£ùiÚ


92 
£lf
.
_cÚf
 = 
cÚf


93 
£lf
.
_cÚf_·th
 = 
cÚf_·th


95 #Thi  
the
 
v®ue
 
of
h
	`£‰šg
 (
Ü
h 
Úe
)

96 #
#Ià
a
  
v®ue
 
exi¡s
 
ªd
 
is
‡ 
IÁ
 
Ü
‡ 
BoŞ
, 
the
 
»tuºed


97 #v®u
is
 
cÚv”‹d
 
to
 
th©
 
ty³
.

98 
def
 
	$g‘
(
£lf
, 
İtiÚ
):

99 
£lf
.
_cÚf
.
	$has_İtiÚ
(
£lf
.
_£ùiÚ
, 
İtiÚ
):

100 
tÜ‘uº
 = 
£lf
.
_cÚf
.
	$g‘
(
£lf
.
_£ùiÚ
, 
İtiÚ
)

101 #CÚv”tšg 
to
 
the
 
good
 
ty³


102 
İtiÚ
 
š
 
DEFAULTS
[
£lf
.
_£ùiÚ
]:

103 
Áy³
 = 
	$ty³
(
DEFAULTS
[
£lf
.
_£ùiÚ
][
İtiÚ
])

104 
Áy³
 == :

105 
tÜ‘uº
 = (toreturn)

106 
–if
 
Áy³
 =ğ
li¡
:

107 #AÎ 
li¡
 
cÚfig
 
should
 
be
 
§ved
 
š
 ','.
	`još
Öi¡è
·‰”n


108 #Thi 
is
 
ju¡
 
backw¬d
 
com·tib™y


109 
tÜ‘uº
 
ªd
oreturn[0] == '['‡ndoreturn[-1] == ']':

110 
tÜ‘uº
 =oreturn[1:-1]

112 #S¶™tšg 
by
 ',' 
ÿu£d
 
bugs
 #1218093 
ªd
 #1216807.

113 #P¬sšg 
the
 
b–ow
 
way


114 #dÛ 
nÙ
 
¥l™
 "('¡ršg1', '¡ršg2', ... )" 
fu¹h”


115 
tÜ‘uº_backup_¡r
 = 
tÜ‘uº


116 
tÜ‘uº
 = 
	`fšd®l
(
r
'\(.*?\)',oreturn)

117 
nÙ
 
tÜ‘uº
:

118 
tÜ‘uº
 = 
tÜ‘uº_backup_¡r
.
	`¥l™
(',')

119 
tÜ‘uº
 
ªd
oreturn[-1] == '':

120 
tÜ‘uº
 =oreturn[:-1]

121 
–if
 
Áy³
 =ğ
boŞ
 
ªd
 
	`ty³
(
tÜ‘uº
è=ğ
¡r
:

122 
tÜ‘uº
 =Ü‘uº.
	`low”
() == "true"

123 
–if
 
İtiÚ
 
š
 
DEFAULTS
[
£lf
.
_£ùiÚ
]:

124 
tÜ‘uº
 = 
DEFAULTS
[
£lf
.
_£ùiÚ
][
İtiÚ
]

125 
£lf
.
	$£t
(
İtiÚ
, 
tÜ‘uº
)

127 
	`´št
("Warning :‚o default conf value for %s in %s" % (

128 
İtiÚ
, 
£lf
.
_£ùiÚ
))

129 
tÜ‘uº
 = 
NÚe


130  
tÜ‘uº


132 
def
 
	$ş—r
(
£lf
):

133 
İtiÚ
 
š
 
£lf
.
_cÚf
.
	$İtiÚs
(
£lf
.
_£ùiÚ
):

134 
£lf
.
_cÚf
.
	$»move_İtiÚ
(
£lf
.
_£ùiÚ
, 
İtiÚ
)

136 
def
 
	$§ve
(
£lf
):

137 
£lf
.
_cÚf
.
	`wr™e
(
	`İ’
(£lf.
_cÚf_·th
, 'w'))

139 
def
 
	$£t
(
£lf
, 
İtiÚ
, 
v®ue
):

140 
	`ty³
(
v®ue
è=ğ
li¡
:

141 
v®ue
 = ','.
	$još
(
v®ue
)

142 
£lf
.
_cÚf
.
	`£t
(£lf.
_£ùiÚ
, 
İtiÚ
, 
	$¡r
(
v®ue
))

143 #Sav
immedŸ‹ly


144 
£lf
.
	$§ve
()

147 
şass
 
	$TaskCÚfig
():

149 
v®ue
 
¬e
 
Úe
 
tu¶e
 
w™h
 
two
 
numb”s
, 
so
 
£t
 
ªd
 
g‘
 
wl
 
u£
 
još
‡nd

150 
¥l™
"""

152 
def
 
	$__š™__
(
£lf
, 
cÚf
, 
cÚf_·th
):

153 
£lf
.
_cÚf
 = 
cÚf


154 
£lf
.
_cÚf_·th
 = 
cÚf_·th


156 
def
 
	$has_£ùiÚ
(
£lf
, 
£ùiÚ
):

157  
£lf
.
_cÚf
.
	$has_£ùiÚ
(
£ùiÚ
)

159 
def
 
	$has_İtiÚ
(
£lf
, 
£ùiÚ
, 
İtiÚ
):

160  
£lf
.
_cÚf
.
	$has_İtiÚ
(
£ùiÚ
, 
İtiÚ
)

162 
def
 
	$add_£ùiÚ
(
£lf
, 
£ùiÚ
):

163 
£lf
.
_cÚf
.
	$add_£ùiÚ
(
£ùiÚ
)

165 
def
 
	$g‘
(
£lf
, 
tid
, 
İtiÚ
):

166 
v®ue
 = 
£lf
.
_cÚf
.
	$g‘
(
tid
, 
İtiÚ
)

167 #Check 
sšgË
 
quÙe
 
backw¬d
 
com·tib™y


168 
v®ue
[0] =ğ'(' 
ªd
 value[-1] == ')':

169 
v®ue
 = value[1:-1]

170 #Remov
®l
 
wh™e¥aûs
, 
bs
, 
Ãwlšes
 
ªd
 
th’
 
¥l™
 
by
 ','

171 
v®ue_w™hout_¥aûs
 = ''.
	`još
(
v®ue
.
	$¥l™
())

172  
v®ue_w™hout_¥aûs
.
	`¥l™
(',')

174 
def
 
	$£t
(
£lf
, 
tid
, 
İtiÚ
, 
v®ue
):

175 
v®ue
 = ','.
	`još
(
	$¡r
(
x
èx 
š
 
v®ue
)

176 
£lf
.
_cÚf
.
	$£t
(
tid
, 
İtiÚ
, 
v®ue
)

177 
£lf
.
	$§ve
()

179 
def
 
	$§ve
(
£lf
):

180 
£lf
.
_cÚf
.
	`wr™e
(
	`İ’
(£lf.
_cÚf_·th
, 'w'))

183 
şass
 
	$CÜeCÚfig
(
BÜg
):

184 #Th
´ojeùs
 
ªd
 
sks
 
¬e
 
of
 
cour£
 
DATA
 !

185 #W
th’
 
u£
 
XDG_DATA
 
them


187 
DATA_FILE
 = "projects.xml"

188 
CONF_FILE
 = "gtg.conf"

189 
TASK_CONF_FILE
 = "tasks.conf"

190 
cÚf_diù
 = 
NÚe


192 
BUSNAME
 = "org.gnome.GTG"

193 
BUSINTERFACE
 = "/org/gnome/GTG"

195 
ALLTASKS_TAG
 = "gtg-tags-all"

196 
NOTAG_TAG
 = "gtg-tags-none"

197 
SEP_TAG
 = "gtg-tags-sep"

198 
SEARCH_TAG
 = "search"

200 
def
 
	$check_cÚfig_fe
(
£lf
, 
·th
):

202 
to
 
İ’
 
smoÙhly
"""

203 
cÚfig
 = 
cÚfig·r£r
.
	$CÚfigP¬£r
()

204 
Œy
:

205 
cÚfig
.
	$»ad
(
·th
)

206 
exû±
 
cÚfig·r£r
.
E¼Ü
:

207 
	`İ’
(
·th
, "w").
	$şo£
()

208  
cÚfig


210 
def
 
	$__š™__
(
£lf
):

211 
	`ha§‰r
(
£lf
, 'data_dir'):

212 #BÜg 
has
 
®»ady
 
b“n
 
š™Ÿlized


214 
£lf
.
d©a_dœ
 = 
os
.
·th
.
	`još
(
xdg_d©a_home
, 'gtg/')

215 
£lf
.
cÚf_dœ
 = 
os
.
·th
.
	`još
(
xdg_cÚfig_home
, 'gtg/')

216 
nÙ
 
os
.
·th
.
	$exi¡s
(
£lf
.
cÚf_dœ
):

217 
os
.
	$makedœs
(
£lf
.
cÚf_dœ
)

218 
nÙ
 
os
.
·th
.
	$exi¡s
(
£lf
.
d©a_dœ
):

219 
os
.
	$makedœs
(
£lf
.
d©a_dœ
)

220 
£lf
.
cÚf_·th
 = 
os
.
·th
.
	$još
(
£lf
.
cÚf_dœ
, s–f.
CONF_FILE
)

221 
£lf
.
sk_cÚf_·th
 = 
os
.
·th
.
	$još
(
£lf
.
cÚf_dœ
, s–f.
TASK_CONF_FILE
)

222 
nÙ
 
os
.
·th
.
	$exi¡s
(
£lf
.
cÚf_·th
):

223 
	`İ’
(
£lf
.
cÚf_·th
, "w").
	$şo£
()

224 
nÙ
 
os
.
·th
.
	$exi¡s
(
£lf
.
sk_cÚf_·th
):

225 
	`İ’
(
£lf
.
sk_cÚf_·th
, "w").
	$şo£
()

226 
cÚf_fe
 
š
 [
£lf
.
cÚf_·th
, s–f.
sk_cÚf_·th
]:

227 
nÙ
 
os
.
	`acûss
(
cÚf_fe
, os.
R_OK
 | os.
W_OK
):

228 
¿i£
 
	`Exû±iÚ
("F" + 
fe
 +

231 
£lf
.
_cÚf
 = s–f.
	$check_cÚfig_fe
(
£lf
.
cÚf_·th
)

232 
£lf
.
_sk_cÚf
 = s–f.
	$check_cÚfig_fe
(
£lf
.
sk_cÚf_·th
)

234 
def
 
	$§ve
(
£lf
):

236 
£lf
.
_cÚf
.
	`wr™e
(
	`İ’
(£lf.
cÚf_·th
, 'w'))

237 
£lf
.
_sk_cÚf
.
	`wr™e
(
	`İ’
(£lf.
sk_cÚf_·th
, 'w'))

239 
def
 
	$g‘_subcÚfig
(
£lf
, 
£ùiÚ
):

240 
nÙ
 
£lf
.
_cÚf
.
	$has_£ùiÚ
(
£ùiÚ
):

241 
£lf
.
_cÚf
.
	$add_£ùiÚ
(
£ùiÚ
)

242  
	$SubCÚfig
(
£ùiÚ
, 
£lf
.
_cÚf
, s–f.
cÚf_·th
)

244 
def
 
	$g‘_skcÚfig
(
£lf
):

245  
	$TaskCÚfig
(
£lf
.
_sk_cÚf
, s–f.
sk_cÚf_·th
)

247 
def
 
	$g‘_icÚs_dœeùÜ›s
(
£lf
):

249 
icÚs_dœs
 = [
os
.
·th
.
	`još
(
dœ
, 'gtg/icÚs'èdœ 
š
 
xdg_d©a_dœs
]

250 
icÚs_dœs
.
	`­³nd
(
os
.
·th
.
	`još
(
GTG
.
DATA_DIR
, "icons"))

251 
icÚs_dœs
.
	$­³nd
(
GTG
.
DATA_DIR
)

252  
icÚs_dœs


254 
def
 
	$g‘_d©a_dœ
(
£lf
):

255  
£lf
.
d©a_dœ


257 
def
 
	$£t_d©a_dœ
(
£lf
, 
·th
):

258 
£lf
.
d©a_dœ
 = 
·th


260 
def
 
	$g‘_cÚf_dœ
(
£lf
):

261  
£lf
.
cÚf_dœ


263 
def
 
	$£t_cÚf_dœ
(
£lf
, 
·th
):

264 
£lf
.
cÚf_dœ
 = 
·th


265 
£lf
.
cÚf_·th
 = 
os
.
·th
.
	$još
(
£lf
.
cÚf_dœ
, s–f.
CONF_FILE
)

266 
£lf
.
sk_cÚf_·th
 = 
os
.
·th
.
	`još
(£lf.
cÚf_dœ
, s–f.
TASK_CONF_FILE
)

	@core/datastore.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
CÚšs
 
the
 
D©a¡Üe
 
	gobjeù
, 
which
 
is
h
mªag”
 
of
 
®l
h
aùive
 
	gback’ds


18 (
bÙh
 
’abËd
 
ªd
 
di§bËd
 
	gÚes
)

21 
	gTAG_XMLFILE
 = "tags.xml"

22 
TAG_XMLROOT
 = "tagstore"

24 
impÜt
 
th»adšg


25 
impÜt
 
uuid


26 
impÜt
 
os
.
·th


27 
äom
 
cŞËùiÚs
 
impÜt
 
deque


29 
äom
 
GTG
.
back’ds
.
back’dsigÇls
 
impÜt
 
Back’dSigÇls


30 
äom
 
GTG
.
back’ds
.
g’”icback’d
 
impÜt
 
G’”icBack’d


31 
äom
 
GTG
.
cÜe
 
impÜt
 
CÜeCÚfig


32 
äom
 
GTG
.
cÜe
 
impÜt
 
»que¡”


33 
äom
 
GTG
.
cÜe
.
£¬ch
 
impÜt
 
·r£_£¬ch_qu”y
, 
	g£¬ch_f‹r
, 
Inv®idQu”y


34 
äom
 
	gGTG
.
	gcÜe
.
g
 
impÜt
 
Tag


35 
äom
 
	gGTG
.
	gcÜe
.
sk
 
impÜt
 
Task


36 
äom
 
	gGTG
.
	gcÜe
.
Œ“çùÜy
 
impÜt
 
T»eFaùÜy


37 
äom
 
	gGTG
.
toŞs
 
impÜt
 
ş—nxml


38 
äom
 
	gGTG
.
	gtoŞs
.
bÜg
 
impÜt
 
BÜg


39 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


42 
şass
 
	$D©aStÜe
(
objeù
):

44 
A
 
w¿µ”
 
¬ound
 
®l
 
back’ds
 
th©
 
is
 
»¥ÚsibË
 
k“pšg
 
the
 
back’d


45 
š¡ªûs
. 
It
 
ÿn
 
’abË
, 
di§bË
, 
ªd
 
de¡roy
 
back’ds
,‡nd 
aùs


46 
as
 
š‹rçû
 
b‘w“n
 
the
 
back’ds
 
ªd
 
GTG
 
cÜe
.

47 
You
 
should
 
nÙ
 
š‹rçû
 
your£lf
 
dœeùly
 
w™h
 
the
 
D©aStÜe
: 
u£
he

48 
Reque¡”
 
	`š¡—d
 (
which
 
®so
 
£nds
 
sigÇls
 
as
 
you
 
issue
 
commªds
).

51 
def
 
	`__š™__
(
£lf
, 
glob®_cÚf
=
	$CÜeCÚfig
()):

53 
In™Ÿlizes
 
a
 
D©aStÜe
 
objeù


55 #diùiÚ¬y {
back’d_Çme_¡ršg
: 
Back’d
 
š¡ªû
}

56 
£lf
.
back’ds
 = {}

57 
£lf
.
Œ“çùÜy
 = 
	$T»eFaùÜy
()

58 
£lf
.
_sks
 = s–f.
Œ“çùÜy
.
	$g‘_sks_Œ“
()

59 
£lf
.
»que¡”
 =„eque¡”.
	$Reque¡”
(
£lf
, 
glob®_cÚf
)

60 
£lf
.
gfe
 = 
NÚe


61 
£lf
.
_g¡Üe
 = s–f.
Œ“çùÜy
.
	$g‘_gs_Œ“
(
£lf
.
»que¡”
)

62 
£lf
.
	$lßd_g_Œ“
()

63 
£lf
.
_back’d_sigÇls
 = 
	$Back’dSigÇls
()

65 #FÏg 
wh’
 
tuºed
 
to
 
Œue
, 
®l
 
³ndšg
 
İ”©iÚ
 
should
 
be


66 #com¶‘ed 
ªd
 
th’
 
GTG
 
should
 
qu™


67 
£lf
.
¶—£_qu™
 = 
F®£


69 #Th 
back’d
 
mu¡
 
be
 
lßded
 
fœ¡
. 
This
 
æag
 
tuºs
 
to
 
True


70 #wh’ 
the
  
back’d
 
lßdšg
 
has
 
fšished
.

71 
£lf
.
is_deçuÉ_back’d_lßded
 = 
F®£


72 
£lf
.
_back’d_sigÇls
.
	`cÚÃù
('default-backend-loaded',

73 
£lf
.
_aùiv©e_nÚ_deçuÉ_back’ds
)

74 
£lf
.
f‹»d_d©a¡Üe
 = 
	$F‹»dD©aStÜe
(
£lf
)

75 
£lf
.
_back’d_mu‹x
 = 
th»adšg
.
	$Lock
()

77 ###AcûssÜ 
to
 
embedded
 
objeùs
 
š
 
D©aStÜe
 ############################

78 
def
 
	$g‘_g¡Üe
(
£lf
):

80 
R‘uº
 
the
 
Tag¡Üe
 
assocŸ‹d
 
w™h
 
this
 
D©aStÜe


82 @ 
GTG
.
cÜe
.
g¡Üe
.
TagStÜe
: 
the
ag¡Ü
objeù


84  
£lf
.
_g¡Üe


86 
def
 
	$g‘_»que¡”
(
£lf
):

88 
R‘uº
 
the
 
Reque¡”
 
assocŸ‹
 
w™h
 
this
 
D©aStÜe


90 @
»tuºs
 
GTG
.
cÜe
.
»que¡”
.
Reque¡”
: 
the
„eque¡” 
assocŸ‹d
 
w™h


91 
this
 
d©a¡Üe


93  
£lf
.
»que¡”


95 
def
 
	$g‘_sks_Œ“
(
£lf
):

97 
R‘uº
 
the
 
T»e
 
w™h
 
®l
h
sks
 
cÚšed
 
š
 
this
 
D©a¡Üe


99 @
»tuºs
 
GTG
.
cÜe
.
Œ“
.
T»e
: 
a
 
sk
 
	`Œ“
 (
the
 
maš
 
Úe
)

101  
£lf
.
_sks


103 ###Tag 
funùiÚs
 ########################################################

104 
def
 
	$_add_Ãw_g
(
£lf
, 
Çme
, 
g
, 
f‹r_func
, 
·¿m‘”s
, 
·»Á_id
=
NÚe
):

106 
£lf
.
_g¡Üe
.
	$has_node
(
Çme
):

107 
¿i£
 
	`IndexE¼Ü
('g % wa ®»ady iÀthd©a¡Üe' % 
Çme
)

109 
£lf
.
_sks
.
	$add_f‹r
(
Çme
, 
f‹r_func
, 
·¿m‘”s
=parameters)

110 
£lf
.
_g¡Üe
.
	$add_node
(
g
, 
·»Á_id
=parent_id)

111 
g
.
	$£t_§ve_ÿÎback
(
£lf
.
§ve
)

113 
def
 
	`Ãw_g
(
£lf
, 
Çme
, 
©Œibu‹s
={
	}
}):

115 
C»©e
 
a
 
Ãw
 
g


117 @
»tuºs
 
GTG
.
cÜe
.
g
.
Tag
: 
the
 
Ãw
ag

119 
·¿m‘”s
 = {'g': 
Çme
}

120 
g
 = 
	$Tag
(
Çme
, 
»q
=
£lf
.
»que¡”
, 
©Œibu‹s
=attributes)

121 
£lf
.
	$_add_Ãw_g
(
Çme
, 
g
, 
£lf
.
Œ“çùÜy
.
g_f‹r
, 
·¿m‘”s
)

122  
g


124 
def
 
	`Ãw_£¬ch_g
(
£lf
, 
Çme
, 
qu”y
, 
©Œibu‹s
={
	}
}):

126 
C»©e
 
a
 
Ãw
 
£¬ch
 
g


128 @
»tuºs
 
GTG
.
cÜe
.
g
.
Tag
: 
the
 
Ãw
 
£¬ch
ag/
NÚe
 
a
 
šv®id
 
qu”y


130 
Œy
:

131 
·¿m‘”s
 = 
	$·r£_£¬ch_qu”y
(
qu”y
)

132 
exû±
 
Inv®idQu”y
 
as
 
e
:

133 
Log
.
	`w¬nšg
("Problem with…arsing query '%s' (skipping): %s" %

134 (
qu”y
, 
e
.
mes§ge
))

135  
NÚe


137 #C»©
own
 
cİy
 
of
 
©Œibu‹s
 
ªd
 
add
 
¥ecŸl
‡‰ribu‹ 
Ïb–
, 
qu”y


138 
š™_©Œ
 = 
	$diù
(
©Œibu‹s
)

139 
š™_©Œ
["Ïb–"] = 
Çme


140 
š™_©Œ
["qu”y"] = 
qu”y


142 
g
 = 
	$Tag
(
Çme
, 
»q
=
£lf
.
»que¡”
, 
©Œibu‹s
=
š™_©Œ
)

143 
£lf
.
	$_add_Ãw_g
(
Çme
, 
g
, 
£¬ch_f‹r
, 
·¿m‘”s
,

144 
·»Á_id
=
CÜeCÚfig
.
SEARCH_TAG
)

145 
£lf
.
	$§ve_gŒ“
()

146  
g


148 
def
 
	$»move_g
(
£lf
, 
Çme
):

150 
£lf
.
_g¡Üe
.
	$has_node
(
Çme
):

151 
£lf
.
_g¡Üe
.
	$d–_node
(
Çme
)

152 
£lf
.
	$§ve_gŒ“
()

154 
¿i£
 
	`IndexE¼Ü
("Th”i nØg %s" % 
Çme
)

156 
def
 
	$»Çme_g
(
£lf
, 
ŞdÇme
, 
ÃwÇme
):

159 
This
 
funùiÚ
 
is
 
qu™e
 
high
-
Ëv–
 
m‘hod
. 
Right
 
now
,

160 
Úly
 
»Çmšg
 
£¬ch
 
bookm¬ks
 
¬e
 
im¶em’‹d
 
by
 
»movšg


161 
the
 
Şd
 
Úe
 
ªd
 
ü—tšg
 
®mo¡
 
id’tiÿl
 oÃ 
w™h
h
Ãw
 
Çme
.

163 
NOTE
: 
Im¶em’tiÚ
 
»guÏr
 
sks
 
mu¡
 
be
 
much
 
mÜe
 
robu¡
.

164 
You
 
have
 
to
 
»¶aû
 
®l
 
occu»nûs
 
of
 
g
 
Çme
 
š
 
sks
 
desütiÚs
,

165 
theœ
 
·¿m‘”s
 
ªd
 
back’d
 
	`£‰šgs
 (
synchrÚize
 
Úly
 
û¹aš
 
gs
).

167 
Have
 
a
 
fun
 
w™h
 
im¶em’tšg
 
™
!

169 
g
 = 
£lf
.
	$g‘_g
(
ŞdÇme
)

171 
nÙ
 
g
.
	$is_£¬ch_g
():

172 
	`´št
("Tag„enaming‚ot implemented yet")

173  
NÚe


175 
qu”y
 = 
g
.
	`g‘_©Œibu‹
("query")

176 
£lf
.
	$»move_g
(
ŞdÇme
)

178 #Mak
su»
 
the
 
Çme
 
is
 
unique


179 
ÃwÇme
.
	`¡¬tsw™h
('!'):

180 
ÃwÇme
 = '_' +‚ewname

182 
Ïb–
, 
num
 = 
ÃwÇme
, 1

183 
£lf
.
_g¡Üe
.
	$has_node
(
Ïb–
):

184 
num
 += 1

185 
Ïb–
 = 
ÃwÇme
 + " " + 
	$¡r
(
num
)

187 
£lf
.
	$Ãw_£¬ch_g
(
Ïb–
, 
qu”y
)

189 
def
 
	$g‘_g
(
£lf
, 
gÇme
):

191 
R‘uºs
 
g
 
objeù


193 @ 
GTG
.
cÜe
.
g
.
Tag


195 
£lf
.
_g¡Üe
.
	$has_node
(
gÇme
):

196  
£lf
.
_g¡Üe
.
	$g‘_node
(
gÇme
)

198  
NÚe


200 
def
 
	$lßd_g_Œ“
(
£lf
):

202 
Lßds
 
the
 
g
 
Œ“
 
äom
 
a
 
xml
 
fe


204 
gfe
 = 
os
.
·th
.
	`još
(
	`CÜeCÚfig
().
	`g‘_d©a_dœ
(), 
TAG_XMLFILE
)

205 
doc
, 
xml¡Üe
 = 
ş—nxml
.
	$İ’xmlfe
(
gfe
, 
TAG_XMLROOT
)

206 
t
 
š
 
xml¡Üe
.
chdNodes
:

207 
gÇme
 = 
t
.
	`g‘A‰ribu‹
("name")

208 
·»Á
 = 
t
.
	`g‘A‰ribu‹
("parent")

210 
g_©Œ
 = {
	}
}

211 
©Œ
 = 
t
.
©Œibu‹s


212 
i
 
š
 
	$¿nge
(
©Œ
.
Ëngth
):

213 
©_Çme
 = 
©Œ
.
	`™em
(
i
).
Çme


214 
©_Çme
 
nÙ
 
š
 ["name", "parent"]:

215 
©_v®
 = 
t
.
	$g‘A‰ribu‹
(
©_Çme
)

216 
g_©Œ
[
©_Çme
] = 
©_v®


218 
·»Á
 =ğ
CÜeCÚfig
.
SEARCH_TAG
:

219 
qu”y
 = 
t
.
	`g‘A‰ribu‹
("query")

220 
g
 = 
£lf
.
	$Ãw_£¬ch_g
(
gÇme
, 
qu”y
, 
g_©Œ
)

222 
g
 = 
£lf
.
	$Ãw_g
(
gÇme
, 
g_©Œ
)

223 
·»Á
:

224 
g
.
	$£t_·»Á
(
·»Á
)

226 
£lf
.
gfe
 =agfile

228 
def
 
	$§ve_gŒ“
(
£lf
):

230 
nÙ
 
£lf
.
gfe
:

233 
doc
, 
xmÌoÙ
 = 
ş—nxml
.
	$em±ydoc
(
TAG_XMLROOT
)

234 
gs
 = 
£lf
.
_g¡Üe
.
	`g‘_maš_v›w
().
	$g‘_®l_nodes
()

235 
®»ady_§ved
 = []

237 
gÇme
 
š
 
gs
:

238 
gÇme
 
š
 
®»ady_§ved
:

241 
g
 = 
£lf
.
_g¡Üe
.
	$g‘_node
(
gÇme
)

242 
©Œibu‹s
 = 
g
.
	$g‘_®l_©Œibu‹s
(
buŠame
=
True
, 
w™h·»Á
=True)

243 "¥ecŸl" 
š
 
©Œibu‹s
 
Ü
 
	`Ën
(attributes) == 0:

246 
t_xml
 = 
doc
.
	`ü—‹EËm’t
("tag")

247 
t_xml
.
	`£tA‰ribu‹
("Çme", 
gÇme
)

248 
©Œ
 
š
 
©Œibu‹s
:

249 #sk 
Ïb–s
 
£¬ch
 
gs


250 
g
.
	$is_£¬ch_g
(è
ªd
 
©Œ
 == 'label':

253 
v®ue
 = 
g
.
	$g‘_©Œibu‹
(
©Œ
)

254 
v®ue
:

255 
t_xml
.
	$£tA‰ribu‹
(
©Œ
, 
v®ue
)

257 
xmÌoÙ
.
	$­³ndChd
(
t_xml
)

258 
®»ady_§ved
.
	$­³nd
(
gÇme
)

260 
ş—nxml
.
	$§vexml
(
£lf
.
gfe
, 
doc
, 
backup
=
True
)

262 ###Task 
funùiÚs
 #######################################################
 g‘_®l_sks(£lf):

264 
R‘uºs
 
li¡
 
of
 
®l
 
keys
 oà
aùive
 
sks


266 @ 
a
 
li¡
 
of
 
¡ršgs
:‡†i¡ oà
sk
 
ids


268  
£lf
.
_sks
.
	`g‘_maš_v›w
().
	$g‘_®l_nodes
()

270 
def
 
	$has_sk
(
£lf
, 
tid
):

272 
R‘uºs
 
Œue
 
the
 
tid
 
is
 
amÚg
h
aùive
 
Ü
 
şo£d
 
sks
 

273 
this
 
D©aStÜe
, 
F®£
 
Ùh”wi£
.

275 @
·¿m
 
tid
: 
Task
 
ID
 
to
 
£¬ch
 

276 @ 
boŞ
: 
True
 
the
 
sk
 
is
 
´e£Á


278  
£lf
.
_sks
.
	$has_node
(
tid
)

280 
def
 
	$g‘_sk
(
£lf
, 
tid
):

282 
R‘uºs
 
the
 
š‹º®
 
sk
 
objeù
 th
giv’
 
tid
, 
Ü
 
NÚe
 the

283 
tid
 
is
 
nÙ
 
´e£Á
 
š
 
this
 
D©aStÜe
.

285 @
·¿m
 
tid
: 
Task
 
ID
 
to
 
»Œ›ve


286 @
»tuºs
 
GTG
.
cÜe
.
sk
.
Task
 
Ü
 
NÚe
: 
wh‘h”
 
the
 Task 
is
 
´e£Á


287 
Ü
 
nÙ


289 
£lf
.
	$has_sk
(
tid
):

290  
£lf
.
_sks
.
	$g‘_node
(
tid
)

292 #Log.
	`”rÜ
("»que¡ed‚Ú-exi¡’ˆsk %s" % 
tid
)

293 #Thi 
is
 
nÙ
 
ª
 
”rÜ
: 
™
 i 
nÜm®
 
to
 
»que¡
 
a
 
sk
 
which


294 #mighˆ
nÙ
 
exi¡
 
y‘
.

295  
NÚe


297 
def
 
	$sk_çùÜy
(
£lf
, 
tid
, 
Ãwsk
=
F®£
):

299 
In¡ªtŸ‹s
 
the
 
giv’
 
sk
 
id
 
as
 
a
 
Task
 
objeù
.

301 @
·¿m
 
tid
: 
a
 
sk
 
id
. 
Mu¡
 
be
 
unique


302 @
·¿m
 
Ãwsk
: 
True
 
the
 
sk
 
has
 
Ãv”
 
b“n
 
£’
 
befÜe


303 @ 
Task
: 
a
 Task 
š¡ªû


305  
	$Task
(
tid
, 
£lf
.
»que¡”
, 
Ãwsk
)

307 
def
 
	$Ãw_sk
(
£lf
):

309 
C»©es
 
a
 
bÏnk
 
Ãw
 
sk
 
š
 
this
 
D©aStÜe
.

310 
New
 
sk
 
is
 
ü—‹d
 
š
 
®l
 
the
 
back’ds
 
th©
 
cŞËù
‡Î 
	`sks
 (
amÚg


311 
them
, 
the
  
back’d
). 
The
  back’d 
u£s
h
§me
 
sk
 
id


312 
š
 
™s
 
own
 
š‹º®
 
»´e£Á©iÚ
.

314 @: 
The
 
sk
 
objeù
 
th©
 
was
 
ü—‹d
.

316 
sk
 = 
£lf
.
	`sk_çùÜy
(
	`¡r
(
uuid
.
	`uuid4
()), 
True
)

317 
£lf
.
_sks
.
	$add_node
(
sk
)

318  
sk


320 
def
 
	$push_sk
(
£lf
, 
sk
):

322 
Adds
 
the
 
giv’
 
sk
 
objeù
 
to
hsk 
Œ“
. 
In
 
Ùh”
 
wÜds
, 
»gi¡”s


323 
the
 
giv’
 
sk
 
š
h
GTG
ask 
£t
.

324 
This
 
funùiÚ
 
is
 
u£d
 
š
 
mutu®
 
exşusiÚ
: 
Úly
 
a
 
back’d
 
©
‡ 
time
 is

325 
®lowed
 
to
 
push
 
sks
.

327 @
·¿m
 
sk
: 
A
 
v®id
ask 
	`objeù
 (
a
 
GTG
.
cÜe
.sk.
Task
)

328 @ 
boŞ
: 
True
 
the
 
sk
 
has
 
b“n
 
acû±ed


331 
def
 
	$addšg
(
sk
):

332 
£lf
.
_sks
.
	$add_node
(
sk
)

333 
sk
.
	$£t_lßded
()

334 
£lf
.
is_deçuÉ_back’d_lßded
:

335 
sk
.
	$sync
()

336 
£lf
.
	`has_sk
(
sk
.
	$g‘_id
()):

337  
F®£


339 #Th»ad 
´ÙeùiÚ


340 
	$addšg
(
sk
)

341  
True


344 ###Back’d 
funùiÚs


346 
def
 
	$g‘_®l_back’ds
(
£lf
, 
di§bËd
=
F®£
):

348 
»tuºs
 
li¡
 
of
 
®l
 
»gi¡”ed
 
back’ds
 
this
 
D©aStÜe
.

350 @
·¿m
 
di§bËd
: 
If
 di§bËd 
is
 
True
, 
©ches
 
®so
 
the
 
li¡
 
of


351 
di§bËd
 
back’ds


352 @ 
li¡
: 
a
†i¡ 
of
 
TaskSourû
 
objeùs


354 
»suÉ
 = []

355 
back’d
 
š
 
£lf
.
back’ds
.
	$v®ues
():

356 
back’d
.
	$is_’abËd
(è
Ü
 
di§bËd
:

357 
»suÉ
.
	$­³nd
(
back’d
)

358  
»suÉ


360 
def
 
	$g‘_back’d
(
£lf
, 
back’d_id
):

362 
R‘uºs
 
a
 
back’d
 
giv’
 
™s
 
id
.

364 @
·¿m
 
back’d_id
: 
a
 
back’d
 
id


365 @
»tuºs
 
GTG
.
cÜe
.
d©a¡Üe
.
TaskSourû
 
Ü
 
NÚe
: 
the
 
»que¡ed
 
back’d
,

366 
Ü
 
NÚe


368 
back’d_id
 
š
 
£lf
.
back’ds
:

369  
£lf
.
back’ds
[
back’d_id
]

371  
NÚe


373 
def
 
	$»gi¡”_back’d
(
£lf
, 
back’d_dic
):

375 
Regi¡”s
 
a
 
TaskSourû
 
as
‡ 
back’d
 
this
 
D©aStÜe


377 @
·¿m
 
back’d_dic
: 
DiùiÚ¬y
 
objeù
 
cÚššg
 
®l
 
the


378 
·¿m‘”s
 
to
 
š™Ÿlize
 
the
 
back’d


379 (
f’ame
...). 
It
 
should
 
®so
 
cÚš
 
the


380 
back’d
 
	`şass
 (
und”
 "back’d"), 
ªd
 
™s


381 
unique
 
	`id
 (
und”
 "pid")

383 "back’d" 
š
 
back’d_dic
:

384 "pid" 
nÙ
 
š
 
back’d_dic
:

385 
Log
.
	`”rÜ
("registering‡ backend without…id.")

386  
NÚe


387 
back’d
 = 
back’d_dic
["backend"]

388 #Checkšg 
th©
 
is
 
a
 
Ãw
 
back’d


389 
back’d
.
	$g‘_id
(è
š
 
£lf
.
back’ds
:

390 
Log
.
	`”rÜ
("registering‡lready„egistered backend")

391  
NÚe


392 #ü—tšg 
the
 
TaskSourû
 
which
 
wl
 
w¿p
h
back’d
,

393 #f‹ršg 
the
 
sks
 
th©
 
should
 
h™
h
back’d
.

394 
sourû
 = 
	$TaskSourû
(
»que¡”
=
£lf
.requester,

395 
back’d
=backend,

396 
d©a¡Üe
=
£lf
.
f‹»d_d©a¡Üe
)

397 
£lf
.
back’ds
[
back’d
.
	`g‘_id
()] = 
sourû


398 #w
nÙify
 
th©
 
a
 
Ãw
 
back’d
 
is
 
´e£Á


399 
£lf
.
_back’d_sigÇls
.
	`back’d_added
(
back’d
.
	$g‘_id
())

400 #§všg 
the
 
back’d
 
š
h
cÜ»ù
 
	`diùiÚ¬y
 (
back’ds
 

401 #’abËd 
back’ds
, 
di§bËd_back’ds
 
the
 
di§bËd
 
Úes
)

402 #thi 
is
 
u£ful
 
»Œo
-
com·tib™y


403 
nÙ
 
G’”icBack’d
.
KEY_ENABLED
 
š
 
back’d_dic
:

404 
sourû
.
	$£t_·¿m‘”
(
G’”icBack’d
.
KEY_ENABLED
, 
True
)

405 
nÙ
 
G’”icBack’d
.
KEY_DEFAULT_BACKEND
 
š
 
back’d_dic
:

406 
sourû
.
	$£t_·¿m‘”
(
G’”icBack’d
.
KEY_DEFAULT_BACKEND
, 
True
)

407 #ià
™
'sƒnabled, we initialize it

408 
sourû
.
	$is_’abËd
(è
ªd
 \

409 (
£lf
.
is_deçuÉ_back’d_lßded
 
Ü
 
sourû
.
	$is_deçuÉ
()):

410 
sourû
.
	$š™Ÿlize
(
cÚÃù_sigÇls
=
F®£
)

411 #Flšg 
the
 
back’d


412 #Došg 
this
 
©
 
¡¬t
 
is
 
mÜe
 
effic›Á
 
thª


413 #aá” 
the
 
GUI
 
is
 
Ïunched


414 
sourû
.
	$¡¬t_g‘_sks
()

415  
sourû


417 
Log
.
	`”rÜ
("Triedo„egister‡ backend without‡…id")

419 
def
 
	$_aùiv©e_nÚ_deçuÉ_back’ds
(
£lf
, 
£nd”
=
NÚe
):

421 
NÚ
- 
back’ds
 
have
 
to
 
wa™
 
uÁ
 
the
  
lßds
 
befÜe


422 
bešg
 
aùiv©ed
. 
This
 
funùiÚ
 
is
 
ÿÎed
 
aá”
 
the
 
fœ¡
 

423 
back’d
 
has
 
lßded
 
®l
 
™s
 
sks
.

425 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
ju¡
 
h”e
 
sigÇl
 
com·tib™y


427 
£lf
.
is_deçuÉ_back’d_lßded
:

428 
Log
.
	`debug
("spurious call")

431 
£lf
.
is_deçuÉ_back’d_lßded
 = 
True


432 
back’d
 
š
 
£lf
.
back’ds
.
	$v®ues
():

433 
back’d
.
	$is_’abËd
(è
ªd
 
nÙ
 
back’d
.
	$is_deçuÉ
():

434 
£lf
.
	$_back’d_¡¬tup
(
back’d
)

436 
def
 
	$_back’d_¡¬tup
(
£lf
, 
back’d
):

438 
H–³r
 
funùiÚ
 
to
 
Ïunch
 
a
 
th»ad
 
th©
 
¡¬ts
‡ 
back’d
.

440 @
·¿m
 
back’d
: 
the
 back’d 
objeù


443 
def
 
	$__back’d_¡¬tup
(
£lf
, 
back’d
):

445 
H–³r
 
funùiÚ
 
to
 
¡¬t
 
a
 
back’d


447 @
·¿m
 
back’d
: 
the
 back’d 
objeù


449 
back’d
.
	$š™Ÿlize
()

450 
back’d
.
	$¡¬t_g‘_sks
()

451 
£lf
.
	`æush_®l_sks
(
back’d
.
	$g‘_id
())

453 
th»ad
 = 
th»adšg
.
	`Th»ad
(
rg‘
=
__back’d_¡¬tup
,

454 
¬gs
=(
£lf
, 
back’d
))

455 
th»ad
.
	$£tD«mÚ
(
True
)

456 
th»ad
.
	$¡¬t
()

458 
def
 
	$£t_back’d_’abËd
(
£lf
, 
back’d_id
, 
¡©e
):

460 
The
 
back’d
 
cÜ»¥Údšg
 
to
 
back’d_id
 
is
 
’abËd
 
Ü
 
di§bËd


461 
accÜdšg
 
to
 "state".

462 
Di§bË
:

463 
Qu™s
 
a
 
back’d
 
ªd
 
di§bËs
 
	`™
 (
which
 
m—ns
 
™
 
wÚ
't be

464 
autom©iÿÎy
 
lßded
 
Ãxt
 
time
 
GTG
 
is
 
¡¬‹d
)

465 
EÇbË
:

466 
R–ßds
 
a
 
di§bËd
 
back’d
. 
Back’d
 
mu¡
 
be
 
®»ady
 
known
 
by
 
the


467 
D©a¡Üe


469 @
·¿m
 
back’d_id
: 
a
 
back’d
 
id


470 @
·¿m
 
¡©e
: 
True
 
to
 
’abË
, 
F®£
Ø
di§bË


472 
back’d_id
 
š
 
£lf
.
back’ds
:

473 
back’d
 = 
£lf
.
back’ds
[
back’d_id
]

474 
cu¼’t_¡©e
 = 
back’d
.
	$is_’abËd
()

475 
cu¼’t_¡©e
 
is
 
True
 
ªd
 
¡©e
 i 
F®£
:

476 #w
di§bË
 
the
 
back’d


478 
th»adšg
.
	`Th»ad
(
rg‘
=
back’d
.
qu™
,

479 
kw¬gs
={'di§bË': 
True
}).¡¬t()

480 
–if
 
cu¼’t_¡©e
 
is
 
F®£
 
ªd
 
¡©e
 i 
True
:

481 
£lf
.
is_deçuÉ_back’d_lßded
 
is
 
True
:

482 
£lf
.
	$_back’d_¡¬tup
(
back’d
)

484 #wÈ
be
 
aùiv©ed
 
aá”w¬ds


485 
back’d
.
	$£t_·¿m‘”
(
G’”icBack’d
.
KEY_ENABLED
,

486 
True
)

488 
def
 
	$»move_back’d
(
£lf
, 
back’d_id
):

490 
Removes
 
a
 
back’d
, 
ªd
 
fÜg‘s
 
™
 
ev”
 
exi¡ed
.

492 @
·¿m
 
back’d_id
: 
a
 
back’d
 
id


494 
back’d_id
 
š
 
£lf
.
back’ds
:

495 
back’d
 = 
£lf
.
back’ds
[
back’d_id
]

496 
back’d
.
	$is_’abËd
():

497 
£lf
.
	$£t_back’d_’abËd
(
back’d_id
, 
F®£
)

498 #FIXME: 
to
 
k“p
 
thšgs
 
sim¶e
, 
back’ds
 
¬e
 
nÙ
 
nÙif›d
 
th©
 
they


499 #¬
com¶‘–y
 
	`»moved
 (
they
 
thšk
hey're just

500 #d—ùiv©ed). 
We
 
should
 
add
 
a
 "purge" 
ÿÎ
 
to
 
back’d
o

501 #Ëˆ
them
 
know
 
th©
 
they
're„emoved, sohathey can

502 #»mov
®l
 
the
 
v¬ious
 
fes
 
they
've created. (invernizzi)

504 #w
nÙify
 
th©
 
the
 
back’d
 
has
 
b“n
 
d–‘ed


505 
£lf
.
_back’d_sigÇls
.
	`back’d_»moved
(
back’d
.
	$g‘_id
())

506 
d–
 
£lf
.
back’ds
[
back’d_id
]

508 
def
 
	$back’d_chªge_©ched_gs
(
£lf
, 
back’d_id
, 
g_Çmes
):

510 
Chªges
 
the
 
gs
 
which
 
a
 
back’d
 
should
 
¡Üe
‡ 
sk


512 @
·¿m
 
back’d_id
: 
a
 backend_id

513 @
·¿m
 
g_Çmes
: 
the
 
Ãw
 
£t
 
of
 
gs
. 
This
 
should
 
nÙ
 
be
 
a
 
g
 
objeù
,

514 
ju¡
 
the
 
g
 
Çme
.

516 
back’d
 = 
£lf
.
back’ds
[
back’d_id
]

517 
back’d
.
	$£t_©ched_gs
(
g_Çmes
)

519 
def
 
	$æush_®l_sks
(
£lf
, 
back’d_id
):

521 
This
 
funùiÚ
 
wl
 
ÿu£
 
®l
 
sks
 
to
 
be
 
checked
 
agaš¡
 
the
 
back’d


522 
id’tif›d
 
w™h
 
back’d_id
. 
If
 
sks
 
Ãed
 
to
 
be
 
added
 
Ü
 
»moved
, 
™


523 
wl
 
be
 
dÚe
 
h”e
.

524 
It
 
has
 
to
 
be
 
run
 
aá”
 
the
 
ü—tiÚ
 
of
 
a
 
Ãw
 
	`back’d
 (
Ü
 
ª
 
®‹¿tiÚ


525 
of
 
™s
 "©chedags"), 
so
 
th©
 
the
 
sks
 
which
 
¬e
 
®»ady
 
lßded
 
š


526 
the
 
T»e
 
wl
 
be
 
§ved
 
š
h
´İ”
 
back’ds


528 @
·¿m
 
back’d_id
: 
a
 
back’d
 
id


531 
def
 
	$_š‹º®_æush_®l_sks
():

532 
back’d
 = 
£lf
.
back’ds
[
back’d_id
]

533 
sk_id
 
š
 
£lf
.
	$g‘_®l_sks
():

534 
£lf
.
¶—£_qu™
:

536 
back’d
.
	$queue_£t_sk
(
sk_id
)

537 
t
 = 
th»adšg
.
	$Th»ad
(
rg‘
=
_š‹º®_æush_®l_sks
)

538 
t
.
	$¡¬t
()

539 
£lf
.
back’ds
[
back’d_id
].
	$¡¬t_g‘_sks
()

541 
def
 
	$§ve
(
£lf
, 
qu™
=
F®£
):

543 
Saves
 
the
 
back’ds
 
·¿m‘”s
.

545 @
·¿m
 
qu™
: 
If
 qu™ 
is
 
Œue
, 
back’ds
 
¬e
 
shut
 
down


547 
Œy
:

548 
£lf
.
¡¬t_g‘_sks_th»ad
.
	$još
()

549 
exû±
 
Exû±iÚ
:

550 
·ss


551 
doc
, 
xmlcÚfig
 = 
ş—nxml
.
	`em±ydoc
("config")

552 #w
ask
 
®l
 
the
 
back’ds
 
to
 
qu™
 
fœ¡
.

553 
qu™
:

554 #w
qu™
 
back’ds
 
š
 
·¿Î–


555 
th»ads_dic
 = {
	}
}

556 
b
 
š
 
£lf
.
	$g‘_®l_back’ds
():

557 
th»ad
 = 
th»adšg
.
	$Th»ad
(
rg‘
=
b
.
qu™
)

558 
th»ads_dic
[
b
.
	`g‘_id
()] = 
th»ad


559 
th»ad
.
	$¡¬t
()

560 
back’d_id
, 
th»ad
 
š
 
th»ads_dic
.
	$™ems
():

561 #aá” 20 
£cÚds
, 
we
 
give
 
up


562 
th»ad
.
	$još
(20)

563 
th»ad
.
	$isAlive
():

564 
Log
.
	`”rÜ
("The %s backend stalled while quitting",

565 
back’d_id
)

566 #w
§ve
 
the
 
·¿m‘”s


567 
b
 
š
 
£lf
.
	$g‘_®l_back’ds
(
di§bËd
=
True
):

568 
t_xml
 = 
doc
.
	`ü—‹EËm’t
("backend")

569 
key
, 
v®ue
 
š
 
b
.
	`g‘_·¿m‘”s
().
	$™ems
():

570 
key
 
š
 ["backend", "xmlobject"]:

571 #W
dÚ
't want…arameters, backend, xmlobject:

574 
·¿m_ty³
 = 
b
.
	$g‘_·¿m‘”_ty³
(
key
)

575 
v®ue
 = 
b
.
	$ÿ¡_·¿m_ty³_to_¡ršg
(
·¿m_ty³
, 
v®ue
)

576 
t_xml
.
	`£tA‰ribu‹
(
	`¡r
(
key
), 
v®ue
)

577 #Savšg 
®l
 
the
 
´ojeùs
 
©
 
şo£


578 
xmlcÚfig
.
	$­³ndChd
(
t_xml
)

579 
d©adœ
 = 
	`CÜeCÚfig
().
	$g‘_d©a_dœ
()

580 
d©afe
 = 
os
.
·th
.
	$još
(
d©adœ
, 
CÜeCÚfig
.
DATA_FILE
)

581 
ş—nxml
.
	$§vexml
(
d©afe
, 
doc
, 
backup
=
True
)

582 #Savšg 
the
 
g¡Üe


583 
£lf
.
	$§ve_gŒ“
()

585 
def
 
	$»que¡_sk_d–‘iÚ
(
£lf
, 
tid
):

587 
This
 
is
 
a
 
´oxy
 
funùiÚ
 
to
 
»que¡
‡ 
sk
 
d–‘iÚ
 
äom
‡ 
back’d


589 @
·¿m
 
tid
: 
the
id 
of
h
sk
 
to
 
»move


591 
£lf
.
»que¡”
.
	$d–‘e_sk
(
tid
)

593 
def
 
	$g‘_back’d_mu‹x
(
£lf
):

595 
R‘uºs
 
the
 
mu‹x
 
objeù
 
u£d
 
by
 
back’ds
 
to
 
avoid
 
modifyšg
 
a
 
sk


596 
©
 
the
 
§me
 
time
.

598 @
»tuºs
: 
th»adšg
.
Lock


600  
£lf
.
_back’d_mu‹x


603 
şass
 
	$TaskSourû
():

605 
T¿n¥¬’t
 
š‹rçû
 
b‘w“n
 
the
 
»®
 
back’d
 
ªd
h
D©aStÜe
.

606 
Is
 
š
 
ch¬ge
 
of
 
cÚÃùšg
 
ªd
 
discÚÃùšg
 
to
 
sigÇls


609 
def
 
	$__š™__
(
£lf
, 
»que¡”
, 
back’d
, 
d©a¡Üe
):

611 
In¡ªtŸ‹s
 
a
 
TaskSourû
 
objeù
.

613 @
·¿m
 
»que¡”
: 
a
 
Reque¡”


614 @
·¿m
 
back’d
: 
the
 back’d 
bešg
 
w¿µed


615 @
·¿m
 
d©a¡Üe
: 
a
 
F‹»dD©a¡Üe


617 
£lf
.
back’d
 = backend

618 
£lf
.
»q
 = 
»que¡”


619 
£lf
.
back’d
.
	$»gi¡”_d©a¡Üe
(
d©a¡Üe
)

620 
£lf
.
skŒ“
 = 
d©a¡Üe
.
	`g‘_sks_Œ“
().
	$g‘_maš_v›w
()

621 
£lf
.
to_£t
 = 
	$deque
()

622 
£lf
.
to_»move
 = 
	$deque
()

623 
£lf
.
¶—£_qu™
 = 
F®£


624 
£lf
.
sk_f‹r
 = s–f.
	$g‘_sk_f‹r_fÜ_back’d
()

625 
Log
.
	$is_debuggšg_mode
():

626 
£lf
.
tim”_time¡•
 = 5

628 
£lf
.
tim”_time¡•
 = 1

629 
£lf
.
add_sk_hªdË
 = 
NÚe


630 
£lf
.
£t_sk_hªdË
 = 
NÚe


631 
£lf
.
»move_sk_hªdË
 = 
NÚe


632 
£lf
.
to_£t_tim”
 = 
NÚe


634 
def
 
	$¡¬t_g‘_sks
(
£lf
):

636 
aá”w¬ds
. """

637 
£lf
.
back’d
.
	$¡¬t_g‘_sks
()

638 
£lf
.
	$_cÚÃù_sigÇls
()

639 
£lf
.
back’d
.
	$is_deçuÉ
():

640 
	`Back’dSigÇls
().
	$deçuÉ_back’d_lßded
()

642 
def
 
	$g‘_sk_f‹r_fÜ_back’d
(
£lf
):

644 
F‹r
 
th©
 
checks
 
the
 
sk
 
should
 
be
 
¡Üed
 
š
 
this
 
back’d
.

646 @
»tuºs
 
funùiÚ
: 
a
 funùiÚ 
th©
 
acû±s
‡ 
sk
 
ªd
„eturns

647 
True
/
F®£
 
wh‘h”
 
the
 
sk
 
should
 
be
 
¡Üed
 
Ü
 
nÙ


650 
def
 
	$back’d_f‹r
(
»q
, 
sk
, 
·¿m‘”s
):

652 
F‹r
 
th©
 
checks
 
two
 
gs
 
£ts
 
š‹r£ù
. 
It
 
is
 
u£d
 
to
 
check


653 
a
 
sk
 
should
 
be
 
¡Üed
 
šside
‡ 
back’d


654 @
·¿m
 
sk
: 
a
ask 
objeù


655 @
·¿m
 
gs_to_m©ch_£t
: 
a
 *
£t
* 
of
 
g
 
Çmes


657 
Œy
:

658 
gs_to_m©ch_£t
 = 
·¿m‘”s
['tags']

659 
exû±
 
KeyE¼Ü
:

661 
®l_sks_g
 = 
»q
.
	`g‘_®Éag_g
().
	$g‘_Çme
()

662 
®l_sks_g
 
š
 
gs_to_m©ch_£t
:

663  
True


664 
sk_gs
 = 
	`£t
(
sk
.
	$g‘_gs_Çme
())

665  
sk_gs
.
	$š‹r£ùiÚ
(
gs_to_m©ch_£t
)

667 
©ched_gs
 = 
£lf
.
back’d
.
	$g‘_©ched_gs
()

668  
Ïmbda
 
sk
: 
	`back’d_f‹r
(
£lf
.
»que¡”
,ask,

669 {"gs": 
	`£t
(
©ched_gs
)
	}
})

671 
def
 
	$should_sk_id_be_¡Üed
(
£lf
, 
sk_id
):

673 
H–³r
 
funùiÚ
: 
Checks
 
a
 
sk
 
should
 
be
 
¡Üed
 
š
 
this
 
back’d


675 @
·¿m
 
sk_id
: 
a
 
sk
 
id


676 @
»tuºs
 
boŞ
: 
True
 
the
 
sk
 
should
 
be
 
¡Üed


678 #sk = 
£lf
.
»q
.
	`g‘_sk
(
sk_id
)

679 #FIXME: 
™
 
wl
 
be
 
a
 
lÙ
 
—s›r
 
to
 
add
, 
š¡—d
,

680 #¨
f‹r
 
to
 
a
 
Œ“
 
ªd
 
check
 
th©
 
this
 
sk
 
is
 
w–l
 
š
 
the
ree

681 #»tuº 
£lf
.
	`sk_f‹r
(
sk
)

682  
True


684 
def
 
	$queue_£t_sk
(
£lf
, 
tid
, 
·th
=
NÚe
):

686 
Upd©es
 
the
 
sk
 
š
h
D©aStÜe
. 
Aùu®ly
, 
™
 
adds
hsk 
to
 
a


687 
queue
 
to
 
be
 
upd©ed
 
asynchrÚou¦y
.

689 @
·¿m
 
sk
: 
The
 
Task
 
objeù
 
to
 
be
 
upd©ed
.

690 @
·¿m
 
·th
: 
™s
…©h 
š
 
T»eV›w
 
widg‘
 => 
nÙ
 
u£d
 
th”e


692 
£lf
.
	$should_sk_id_be_¡Üed
(
tid
):

693 
tid
 
nÙ
 
š
 
£lf
.
to_£t
 
ªd
id‚Ù iÀ£lf.
to_»move
:

694 
£lf
.
to_£t
.
	$­³ndËá
(
tid
)

695 
£lf
.
	$__Œy_Ïunch_£‰šg_th»ad
()

697 
£lf
.
	$queue_»move_sk
(
tid
, 
·th
)

699 
def
 
	$Ïunch_£‰šg_th»ad
(
£lf
, 
by·ss_¶—£_qu™
=
F®£
):

701 
O³¿‹s
 
the
 
th»ads
 
to
 
£t
 
ªd
 
»move
 
sks
.

702 
R–—£s
 
the
 
lock
 
wh’
 
™
 
is
 
dÚe
.

704 @
·¿m
 
by·ss_¶—£_qu™
: 
True
, 
the
 
£lf
.
¶—£_qu™


705 "qu™ cÚd™iÚ" 
is
 
ignÜed
. 
Cu¼’y
,

706 
™
'surnedorue‡fterhe quit

707 
cÚd™iÚ
 
has
 
b“n
 
issued
, 
to
 
execu‹


708 
ev’tu®
 
³ndšg
 
İ”©iÚs
.

710 
nÙ
 
£lf
.
¶—£_qu™
 
Ü
 
by·ss_¶—£_qu™
:

711 
Œy
:

712 
tid
 = 
£lf
.
to_£t
.
	$pİ
()

713 
exû±
 
IndexE¼Ü
:

715 #w
check
 
th©
 
the
 
sk
 
is
 
nÙ
 
®»ady
 
m¬ked
 
d–‘iÚ


716 #ªd 
th©
 
™
's stillo be stored inhis backend

717 #NOTE: 
no
 
Ãed
 
to
 
lock
, 
we
're„eading

718 
tid
 
nÙ
 
š
 
£lf
.
to_»move
 
ªd
 \

719 
£lf
.
	$should_sk_id_be_¡Üed
(
tid
è
ªd
 \

720 
£lf
.
»q
.
	$has_sk
(
tid
):

721 
sk
 = 
£lf
.
»q
.
	$g‘_sk
(
tid
)

722 
£lf
.
back’d
.
	$queue_£t_sk
(
sk
)

723 
nÙ
 
£lf
.
¶—£_qu™
 
Ü
 
by·ss_¶—£_qu™
:

724 
Œy
:

725 
tid
 = 
£lf
.
to_»move
.
	$pİ
()

726 
exû±
 
IndexE¼Ü
:

728 
£lf
.
back’d
.
	$queue_»move_sk
(
tid
)

729 #w
»Ëa£
 
the
 
w—k
 
lock


730 
£lf
.
to_£t_tim”
 = 
NÚe


732 
def
 
	$queue_»move_sk
(
£lf
, 
tid
, 
·th
=
NÚe
):

734 
Queues
 
sk
 
to
 
be
 
»moved
.

736 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
ªy
 
v®ue
 
wl
 do

737 @
·¿m
 
tid
: 
The
 
Task
 
ID
 
of
 
the
 
sk
 
to
 
be
 
»moved


739 
tid
 
nÙ
 
š
 
£lf
.
to_»move
:

740 
£lf
.
to_»move
.
	$­³ndËá
(
tid
)

741 
£lf
.
	$__Œy_Ïunch_£‰šg_th»ad
()

743 
def
 
	$__Œy_Ïunch_£‰šg_th»ad
(
£lf
):

745 
H–³r
 
funùiÚ
 
to
 
Ïunch
 
the
 
£‰šg
 
th»ad
, 
™
's‚ot„unning

747 
£lf
.
to_£t_tim”
 
is
 
NÚe
 
ªd
 
nÙ
 s–f.
¶—£_qu™
:

748 
£lf
.
to_£t_tim”
 = 
th»adšg
.
	$Tim”
(
£lf
.
tim”_time¡•
,

749 
£lf
.
Ïunch_£‰šg_th»ad
)

750 
£lf
.
to_£t_tim”
.
	$£tD«mÚ
(
True
)

751 
£lf
.
to_£t_tim”
.
	$¡¬t
()

753 
def
 
	$š™Ÿlize
(
£lf
, 
cÚÃù_sigÇls
=
True
):

755 
In™Ÿlizes
 
the
 
back’d
 
ªd
 
¡¬ts
 
lookšg
 
sigÇls
.

757 @
·¿m
 
cÚÃù_sigÇls
: 
True
, 
™
 
¡¬ts
 
li¡’šg
 
sigÇls


759 
£lf
.
back’d
.
	$š™Ÿlize
()

760 
cÚÃù_sigÇls
:

761 
£lf
.
	$_cÚÃù_sigÇls
()

763 
def
 
	$_cÚÃù_sigÇls
(
£lf
):

765 
H–³r
 
funùiÚ
 
to
 
cÚÃù
 
sigÇls


767 
nÙ
 
£lf
.
add_sk_hªdË
:

768 
£lf
.
add_sk_hªdË
 = s–f.
skŒ“
.
	`»gi¡”_şlbck
(

769 'node-added', 
£lf
.
queue_£t_sk
)

770 
nÙ
 
£lf
.
£t_sk_hªdË
:

771 
£lf
.
£t_sk_hªdË
 = s–f.
skŒ“
.
	`»gi¡”_şlbck
(

772 'node-modif›d', 
£lf
.
queue_£t_sk
)

773 
nÙ
 
£lf
.
»move_sk_hªdË
:

774 
£lf
.
»move_sk_hªdË
 = s–f.
skŒ“
.
	`»gi¡”_şlbck
(

775 'node-d–‘ed', 
£lf
.
queue_»move_sk
)

777 
def
 
	$_discÚÃù_sigÇls
(
£lf
):

779 
H–³r
 
funùiÚ
 
to
 
discÚÃù
 
sigÇls


781 
£lf
.
add_sk_hªdË
:

782 
£lf
.
skŒ“
.
	`d”egi¡”_şlbck
('node-added',

783 
£lf
.
£t_sk_hªdË
)

784 
£lf
.
add_sk_hªdË
 = 
NÚe


785 
£lf
.
£t_sk_hªdË
:

786 
£lf
.
skŒ“
.
	`d”egi¡”_şlbck
('node-modified',

787 
£lf
.
£t_sk_hªdË
)

788 
£lf
.
£t_sk_hªdË
 = 
NÚe


789 
£lf
.
»move_sk_hªdË
:

790 
£lf
.
skŒ“
.
	`d”egi¡”_şlbck
('node-deleted',

791 
£lf
.
»move_sk_hªdË
)

792 
£lf
.
»move_sk_hªdË
 = 
NÚe


794 
def
 
	$sync
(
£lf
):

796 
FÜûs
 
the
 
TaskSourû
 
to
 
sync
 
®l
h
³ndšg
 
sks


798 
Œy
:

799 
£lf
.
to_£t_tim”
.
	$ÿnûl
()

800 
exû±
 
Exû±iÚ
:

801 
·ss


802 
Œy
:

803 
£lf
.
to_£t_tim”
.
	$još
(3)

804 
exû±
 
Exû±iÚ
:

805 
·ss


806 
Œy
:

807 
£lf
.
¡¬t_g‘_sks_th»ad
.
	$još
(3)

808 
exû±
 
Exû±iÚ
:

809 
·ss


810 
£lf
.
	$Ïunch_£‰šg_th»ad
(
by·ss_¶—£_qu™
=
True
)

812 
def
 
	$qu™
(
£lf
, 
di§bË
=
F®£
):

814 
Qu™s
 
the
 
back’d
 
ªd
 
discÚÃù
h
sigÇls


816 @
·¿m
 
di§bË
: 
True
, 
the
 
back’d
 
is
 
di§bËd
.

818 
£lf
.
	$_discÚÃù_sigÇls
()

819 
£lf
.
¶—£_qu™
 = 
True


820 
£lf
.
	$sync
()

821 
£lf
.
back’d
.
	$qu™
(
di§bË
)

823 
def
 
	$__g‘©Œ__
(
£lf
, 
©Œ
):

825 
D–eg©es
 
®l
 
the
 
funùiÚs
 
nÙ
 
defšed
 
h”e
 
to
h
»®
 
back’d


826 (
¡ªd¬d
 
pythÚ
 
funùiÚ
)

828 @
·¿m
 
©Œ
: 
©Œibu‹
 
to
 
g‘


830 
©Œ
 
š
 
£lf
.
__diù__
:

831  
£lf
.
__diù__
[
©Œ
]

833  
	$g‘©Œ
(
£lf
.
back’d
, 
©Œ
)

836 
şass
 
	$F‹»dD©aStÜe
(
BÜg
):

838 
This
 
şass
 
aùs
 
as
 
ª
 
š‹rçû
 
to
 
the
 
D©a¡Üe
.

839 
It
 
is
 
u£d
 
to
 
hide
 
mo¡
 
of
 
the
 
m‘hods
 oàth
D©a¡Üe
.

840 
The
 
back’ds
 
ÿn
 
§ãly
 
u£
 
the
 
»maššg
 
m‘hods
.

843 
def
 
	$__š™__
(
£lf
, 
d©a¡Üe
):

844 
	`su³r
(
F‹»dD©aStÜe
, 
£lf
).
	$__š™__
()

845 
£lf
.
d©a¡Üe
 = datastore

847 
def
 
	$__g‘©Œ__
(
£lf
, 
©Œ
):

848 
©Œ
 
š
 ['task_factory',

857  
	$g‘©Œ
(
£lf
.
d©a¡Üe
, 
©Œ
)

858 
–if
 
©Œ
 
š
 ['get_all_tags']:

859  
£lf
.
d©a¡Üe
.
»que¡”
.
g‘_®l_gs


861 
¿i£
 
	`A‰ribu‹E¼Ü
("NØ©Œibu‹ %s" % 
©Œ
)

	@core/firstrun_tasks.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

19 
Tasks
 
should
 
£rve
 
as
 
a
 
quick
 
tutÜŸl
 
how
 
GTG
 
	gwÜks
 """

21 
äom
 
GTG
 
impÜt
 
_


22 
äom
 
	gGTG
.
toŞs
 
impÜt
 
ş—nxml


23 
äom
 
	gGTG
.
	gtoŞs
.
gs
 
impÜt
 
exŒaù_gs_äom_‹xt


26 
def
 
	$pİuÏ‹
():

28 
aù
 
as
 
a
 
GTG
 
tutÜŸl
."""

29 
doc
, 
roÙ
 = 
ş—nxml
.
	`em±ydoc
("project")

31 #Task 0@1: 
G‘tšg
 
¡¬‹d
 
w™h
 
GTG


32 
t™Ë1
 = 
	`_
("Getting Started With GTG")

33 
‹xt1
 = 
	`_
(

106 
sk1
 = 
	`addsk
(
doc
, "0@1", 
t™Ë1
, 
‹xt1
,

108 
roÙ
.
	$­³ndChd
(
sk1
)

110 #Task 1@1: 
L—º
 
to
 
u£
 
subsks


111 
t™Ë2
 = 
	`_
("Learn How To Use Subtasks")

112 
‹xt2
 = 
	`_
(

135 
sk2
 = 
	`addsk
(
doc
, "1@1", 
t™Ë2
, 
‹xt2
, [])

136 
roÙ
.
	$­³ndChd
(
sk2
)

138 #Task 2@1: 
L—º
 
to
 
u£
 
gs


139 
t™Ë3
 = 
	`_
("Learn How To Use Tags")

140 
‹xt3
 = 
	`_
(

167 
sk3
 = 
	`addsk
(
doc
, "2@1", 
t™Ë3
, 
‹xt3
, [])

168 
roÙ
.
	$­³ndChd
(
sk3
)

170 #Task 3@1: 
Usšg
 
the
 
WÜkv›w


171 
t™Ë4
 = 
	`_
("Learn How To Use The Work View")

172 
‹xt4
 = 
	`_
(

203 
sk4
 = 
	`addsk
(
doc
, "3@1", 
t™Ë4
, 
‹xt4
, [])

204 
roÙ
.
	$­³ndChd
(
sk4
)

206 #Task 5@1: 
Plugšs


207 
t™Ë5
 = 
	`_
("Learn How To Use Plugins")

208 
‹xt5
 = 
	`_
(

218 
sk5
 = 
	`addsk
(
doc
, "4@1", 
t™Ë5
, 
‹xt5
, [])

219 
roÙ
.
	$­³ndChd
(
sk5
)

221 #Task 5@1: 
R•Ütšg
 
bugs


222 
t™Ë6
 = 
	`_
("Reporting Bugs")

223 
‹xt6
 = 
	`_
(

235 
sk6
 = 
	`addsk
(
doc
, "5@1", 
t™Ë6
, 
‹xt6
, [])

236 
roÙ
.
	$­³ndChd
(
sk6
)

238 #Task 6@1: 
L—º
 
how
 
to
 
u£
 
the
 
QuickAdd
 
EÁry


239 
t™Ë7
 = 
	`_
("Learn How To Use The Quick Add Entry")

240 
‹xt7
 = 
	`_
(

282 
sk7
 = 
	`addsk
(
doc
, "6@1", 
t™Ë7
, 
‹xt7
, [])

283 
roÙ
.
	$­³ndChd
(
sk7
)

285 #Task 7@1: 
L—º
 
How
 
To
 
U£
 
SynchÚiz©iÚ
 
S”viûs


286 
t™Ë8
 = 
	`_
("Learn How To Use Synchronization Services")

287 
‹xt8
 = 
	`_
(

306 
sk8
 = 
	`addsk
(
doc
, "7@1", 
t™Ë8
, 
‹xt8
, [])

307 
roÙ
.
	$­³ndChd
(
sk8
)

309 #Task 8@1: 
L—º
 
How
 
To
 
S—rch
 
FÜ
 
Tasks


310 
t™Ë9
 = 
	`_
("Learn How To Search For Tasks")

311 
‹xt9
 = 
	`_
(

337 
sk9
 = 
	`addsk
(
doc
, "8@1", 
t™Ë9
, 
‹xt9
, [])

338 
roÙ
.
	$­³ndChd
(
sk9
)

340  
doc


343 
def
 
	$addsk
(
doc
, 
ze_id
, 
t™Ë
, 
‹xt
, 
chd»n
):

345 
t_xml
 = 
doc
.
	`ü—‹EËm’t
("task")

346 
t_xml
.
	`£tA‰ribu‹
("id", 
ze_id
)

347 
t_xml
.
	`£tA‰ribu‹
("status", "Active")

349 
gs
 = 
	$exŒaù_gs_äom_‹xt
(
‹xt
)

350 
t_xml
.
	`£tA‰ribu‹
("gs", ",".
	$još
(
gs
))

352 
ş—nxml
.
	`addTextNode
(
doc
, 
t_xml
, "t™Ë", 
t™Ë
)

353 
chd
 
š
 
chd»n
:

354 
ş—nxml
.
	`addTextNode
(
doc
, 
t_xml
, "subsk", 
chd
)

355 
ş—nxml
.
	`addTextNode
(
doc
, 
t_xml
, "cÚ‹Á", 
‹xt
)

356  
t_xml


	@core/plugins/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 #Thi 
is
 
the
 
toŞ
 
·ckage
. 
It
 
cÚšs
 
some
 
u£ful
 
funùiÚ
 
ªd
ool

19 #th© 
could
 
be
 
u£ful
 
ªy
 
·¹
 
of
 
GTG
.

21 
äom
 
GTG
 
impÜt
 
_


24 
şass
 
	gGnomeCÚfig
:

25 
CANLOAD
 = 
_
("Everything‚ecessaryo„unhis…lugin is‡vailable.")

26 
CANNOTLOAD
 = 
_
("The…lugin can‚ot be†oaded")

27 
miss1
 = 
_
("Some…ython modules‡re missing")

28 
miss2
 = 
_
("Please installhe following…ython modules:")

29 
MODULEMISSING
 = "% \n%s" % (
miss1
, 
	gmiss2
)

30 
	gdmiss1
 = 
_
("Some„emote dbus objects‡re missing.")

31 
dmiss2
 = 
_
("Please starthe following‡pplications:")

32 
DBUSMISSING
 = "% \n%s" % (
dmiss1
, 
	gdmiss2
)

33 
	gbmiss1
 = 
_
("Some modules‡nd„emote dbus objects‡re missing.")

34 
bmiss2
 = 
_
("Please install or starthe following components:")

35 
MODULANDDBUS
 = "% \n%s" % (
bmiss1
, 
	gbmiss2
)

36 
	gumiss1
 = 
_
("Unknownƒrror while†oadinghe…lugin.")

37 
umiss2
 = 
_
("Very helpful message, isn't it? Please„eport‡ bug.")

38 
UNKNOWN
 = "% \n%s" % (
umiss1
, 
	gumiss2
)

	@core/plugins/api.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
impÜt
 
os


18 
impÜt
 
pickË


19 
äom
 
	gxdg
.
Ba£DœeùÜy
 
impÜt
 
xdg_cÚfig_home


21 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


24 
şass
 
	gPlugšAPI
:

27 
L
{
PlugšAPI
} 
is
 
a
 
objeù
 
th©
 
´ovides
‡ 
niû
 
API
 

28 
¶ugšs
 
to
 
š‹¿ù
 
w™h
 
GTG
.

30 
MuÉË
 
L
{
PlugšAPI
}
s
 
ÿn
 
exi¡
. 
A
 
š¡ªû
 
is
 
ü—‹d
 
to
 
be
 
u£d


31 
w™h
 
the
 
sk
 
brow£r
 
ªd
 
ªÙh”
 
š¡ªû
 
is
 
ü—‹d
 
to
 
be
 
u£d


32 
w™h
 
the
 
sk
 
ed™Ü
.

35 
def
 
	$__š™__
(
£lf
,

36 
»que¡”
,

37 
v›w_mªag”
,

38 
sked™Ü
=
NÚe
):

40 
CÚ¡ruù
 
a
 
PlugšAPI
 
objeù
.

42 @
·¿m
 
»que¡”
: 
The
„equester.

43 @
·¿m
 
v›w_mªag”
: 
The
 
v›w
 
mªag”


44 @
·¿m
 
sk_id
: 
The
 
Ed™Ü
, 
we
 
¬e
 
š
 
Úe


45 
Ùh”wi£
.

47 
£lf
.
__»que¡”
 = 
»que¡”


48 
£lf
.
__v›w_mªag”
 = 
v›w_mªag”


49 
£lf
.
£ËùiÚ_chªged_ÿÎback_li¡’”s
 = []

50 
sked™Ü
:

51 
£lf
.
__ui
 = 
sked™Ü


52 
£lf
.
__bud”
 = s–f.
__ui
.
	$g‘_bud”
()

53 
£lf
.
__toŞb¬
 = s–f.
__bud”
.
	`g‘_objeù
('task_tb1')

54 
£lf
.
__sk_id
 = 
sked™Ü
.
	$g‘_sk
()

56 
£lf
.
__ui
 = s–f.
__v›w_mªag”
.
	$g‘_brow£r
()

57 
£lf
.
__bud”
 = s–f.
__ui
.
	$g‘_bud”
()

58 
£lf
.
__toŞb¬
 = s–f.
__bud”
.
	`g‘_objeù
('task_toolbar')

59 
£lf
.
__sk_id
 = 
NÚe


60 
£lf
.
__v›w_mªag”
.
brow£r
.
£ËùiÚ
.
	`cÚÃù
(

61 "chªged", 
£lf
.
__£ËùiÚ_chªged
)

62 
£lf
.
skwidg‘_id
 = 0

63 
£lf
.
skwidg‘_widg
 = []

65 
def
 
	$__£ËùiÚ_chªged
(
£lf
, 
£ËùiÚ
):

66 
func
 
š
 
£lf
.
£ËùiÚ_chªged_ÿÎback_li¡’”s
:

67 
	$func
(
£ËùiÚ
)

69 #==ğ
AcûssÜ
 
m‘hods
 ========================================================

70 
def
 
	$is_ed™Ü
(
£lf
):

72 
R‘uºs
 
Œue
 
this
 
is
 
ª
 
Ed™Ü
 
API


74  
	$boŞ
(
£lf
.
__sk_id
)

76 
def
 
	$is_brow£r
(
£lf
):

78 
R‘uºs
 
Œue
 
this
 
is
 
a
 
Brow£r
 
API


80  
nÙ
 
£lf
.
	$is_ed™Ü
()

82 
def
 
	$g‘_v›w_mªag”
(
£lf
):

84 
»tuºs
 
a
 
GTG
.
gtk
.
mªag”
.
Mªag”


86  
£lf
.
__v›w_mªag”


88 
def
 
	$g‘_»que¡”
(
£lf
):

90 
»tuºs
 
a
 
GTG
.
cÜe
.
»que¡”
.
Reque¡”


92  
£lf
.
__»que¡”


94 
def
 
	$g‘_gtk_bud”
(
£lf
):

96 
R‘uºs
 
the
 
gtk
 
bud”
 th
·»Á
 
wšdow


98  
£lf
.
__bud”


100 
def
 
	$g‘_ui
(
£lf
):

102 
R‘uºs
 
a
 
Brow£r
 
Ü
 
ª
 
Ed™Ü


104  
£lf
.
__ui


106 
def
 
	$g‘_brow£r
(
£lf
):

108 
R‘uºs
 
a
 
Brow£r


110  
£lf
.
__v›w_mªag”
.
	$g‘_brow£r
()

112 
def
 
	$g‘_£Ëùed
(
£lf
):

114 
R‘uºs
 
the
 
£Ëùed
 
sks
 
š
h
brow£r
 
Ü
h
sk
 
ID
 th
ed™Ü


116 
£lf
.
	$is_ed™Ü
():

117  
£lf
.
__sk_id


119  
£lf
.
__v›w_mªag”
.
brow£r
.
	$g‘_£Ëùed_sks
()

121 
def
 
	$£t_aùive_£ËùiÚ_chªged_ÿÎback
(
£lf
, 
func
):

122 
func
 
nÙ
 
š
 
£lf
.
£ËùiÚ_chªged_ÿÎback_li¡’”s
:

123 
£lf
.
£ËùiÚ_chªged_ÿÎback_li¡’”s
.
	$­³nd
(
func
)

125 
def
 
	$»move_aùive_£ËùiÚ_chªged_ÿÎback
(
£lf
, 
¶ugš_şass
):

126 
Ãw_li¡
 = [
func
 funø
š
 
£lf
.
£ËùiÚ_chªged_ÿÎback_li¡’”s


127 
func
.
__şass__
 !ğ
¶ugš_şass
]

128 
£lf
.
£ËùiÚ_chªged_ÿÎback_li¡’”s
 = 
Ãw_li¡


130 #==ğ
Chªgšg
 
the
 
UI
 =========================================================

131 
def
 
	$add_m’u_™em
(
£lf
, 
™em
):

133 (
sk
 
brow£r
).

135 @
·¿m
 
™em
: 
The
 
Gtk
.
M’uI‹m
 
th©
 
is
 
gošg
 
to
 
be
 
added
.

137 
widg‘
 = 
£lf
.
__bud”
.
	`g‘_objeù
('plugin_mi')

138 
widg‘
.
	`g‘_subm’u
().
	$­³nd
(
™em
)

139 
widg‘
.
	$show_®l
()

141 
def
 
	$»move_m’u_™em
(
£lf
, 
™em
):

143 (
sk
 
brow£r
).

145 @
·¿m
 
™em
: 
The
 
Gtk
.
M’uI‹m
 
th©
 
is
 
gošg
 
to
 
be
 
»moved
.

146 @: 
R‘uºs
 
C
{
True
} thİ”©iÚ ha suûs Ü c{F®£} ™

147 
çs
.

149 
m’u
 = 
£lf
.
__bud”
.
g‘_objeù
('plugin_mi')

150 
subm’u
 = 
m’u
.
	$g‘_subm’u
()

151 
Œy
:

152 
subm’u
.
	$»move
(
™em
)

153 
exû±
:

154 
·ss


155 
nÙ
 
subm’u
.
	$g‘_chd»n
():

156 
m’u
.
	$hide
()

158 
def
 
	$add_toŞb¬_™em
(
£lf
, 
widg‘
):

160 
toŞb¬
, 
d•’dšg
 
Ú
 
which
 
¶ugš
 
­i
 
™
's being used.

162 @
·¿m
 
widg‘
: 
The
 
Gtk
.
ToŞBu‰Ú
 
th©
 
is
 
gošg
 
to
 
be
 
added
Ø
the


163 
toŞb¬
.

165 #-1 
m—ns
 "appendoheƒnd"

166 
£lf
.
__toŞb¬
.
	`š£¹
(
widg‘
, -1)

168 
def
 
	$»move_toŞb¬_™em
(
£lf
, 
widg‘
):

170 
Remove
 
a
 
widg‘
 
äom
 
the
 
toŞb¬
.

172 
Œy
:

173 
£lf
.
__toŞb¬
.
	$»move
(
widg‘
)

174 
exû±
 
Exû±iÚ
 
as
 
e
:

175 
	`´št
("E¼Ü„emovšghtoŞb¬ i‹m iÀthTaskEd™Ü: %s" % 
e
)

177 
def
 
	$add_widg‘_to_sked™Ü
(
£lf
, 
widg‘
):

180 @
·¿m
 
widg‘
: 
The
 
Gtk
.
Widg‘
 
th©
 
is
 
gošg
 
to
 
be
 
added
.

182 
vbox
 = 
£lf
.
__bud”
.
	`g‘_objeù
('vbox4')

183 
vbox
:

184 
vbox
.
	$·ck_¡¬t
(
widg‘
, 
True
, True, 0)

185 
vbox
.
	`»Üd”_chd
(
widg‘
, -2)

186 
widg‘
.
	$show_®l
()

187 
£lf
.
skwidg‘_id
 += 1

188 
£lf
.
skwidg‘_widg
.
	$­³nd
(
widg‘
)

189  
£lf
.
skwidg‘_id


191  
NÚe


193 
def
 
	$»move_widg‘_äom_sked™Ü
(
£lf
, 
widg_id
):

196 @
·¿m
 
widg‘
: 
The
 
Gtk
.
Widg‘
 
th©
 
is
 
gošg
 
to
 
be
 
»moved


198 
£lf
.
	$is_ed™Ü
(è
ªd
 
widg_id
:

199 
Œy
:

200 
wi
 = 
£lf
.
__bud”
.
	`g‘_objeù
('vbox4')

201 
wi
 
ªd
 
widg_id
 
š
 
£lf
.
skwidg‘_widg
:

202 
wi
.
	`»move
(
£lf
.
skwidg‘_widg
.
	$pİ
(
widg_id
))

203 
exû±
 
Exû±iÚ
 
as
 
e
:

204 
Log
.
	`debug
("Error„emovingheoolbar item inhe TaskEditor:"

205 "%s" % 
e
)

207 
def
 
	$£t_bgcŞÜ_func
(
£lf
, 
func
=
NÚe
):

210 
NOTE
: 
This
 
funùiÚ
 
¡rÚglye
 
d•’d
 
Ú
 
brow£r
 
ªd
 
could
 
be
 
—sy


211 
brok’
 
by
 
chªges
 
š
 
brow£r
 
code


213 
brow£r
 = 
£lf
.
	$g‘_brow£r
()

215 #£ˆ 
bgcŞÜ
?

216 
func
 
is
 
NÚe
:

217 
func
 = 
brow£r
.
tv_çùÜy
.
sk_bg_cŞÜ


219 
·Ã
 
š
 
brow£r
.
vŒ“_·Ãs
.
	$v®ues
():

220 
·Ã
.
	`£t_bg_cŞÜ
(
func
, 'bg_color')

221 
·Ã
.
ba£Œ“
.
	`g‘_ba£Œ“
().
	$»äesh_®l
()

223 #==ğ
fe
 
§všg
/
lßdšg
 =====================================================

224 
def
 
	$lßd_cÚfigu¿tiÚ_objeù
(
£lf
, 
¶ugš_Çme
, 
f’ame
,

225 
ba£dœ
=
xdg_cÚfig_home
,

226 
deçuÉ_v®ues
=
NÚe
):

227 
deçuÉ_v®ues
 
is
 
nÙ
 
NÚe
:

228 
cÚfig
 = 
	$diù
(
deçuÉ_v®ues
)

230 
cÚfig
 = 
	$diù
()

232 
dœÇme
 = 
os
.
·th
.
	`još
(
ba£dœ
, 'gtg/¶ugšs', 
¶ugš_Çme
)

233 
·th
 = 
os
.·th.
	$još
(
dœÇme
, 
f’ame
)

234 
os
.
·th
.
	$isdœ
(
dœÇme
):

235 
os
.
·th
.
	$isfe
(
·th
):

236 
Œy
:

237 
w™h
 
	`İ’
(
·th
, 'r'è
as
 
fe
:

238 
™em
 = 
pickË
.
	$lßd
(
fe
)

239 
cÚfig
.
	$upd©e
(
™em
)

240 
exû±
:

241 
·ss


243 
os
.
	$makedœs
(
dœÇme
)

244  
cÚfig


246 
def
 
	$§ve_cÚfigu¿tiÚ_objeù
(
£lf
, 
¶ugš_Çme
, 
f’ame
, 
™em
,

247 
ba£dœ
=
xdg_cÚfig_home
):

248 
dœÇme
 = 
os
.
·th
.
	`još
(
ba£dœ
, 'gtg/¶ugšs', 
¶ugš_Çme
)

249 
·th
 = 
os
.·th.
	$još
(
dœÇme
, 
f’ame
)

250 
w™h
 
	`İ’
(
·th
, 'wb'è
as
 
fe
:

251 
pickË
.
	`dump
(
™em
, 
fe
)

	@core/plugins/engine.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

16 
impÜt
 
imp


17 
impÜt
 
os


18 
impÜt
 
cÚfig·r£r


20 
impÜt
 
dbus


22 
äom
 
	gGTG
.
	gtoŞs
.
bÜg
 
impÜt
 
BÜg


23 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


26 
şass
 
	$Plugš
(
objeù
):

29 #A 
»ã»nû
 
to
 
ª
 
š¡ªû
 
of
 
the
 
¶ugš
 
şass


30 
š¡ªû
 = 
NÚe


31 #Tru
the
 
¶ugš
 
has
 
b“n
 
’abËd
 
by
h
u£r
.

32 
’abËd
 = 
F®£


33 #Tru
some
 
”rÜ
 
´ev’ts
 
the
 
¶ugš
 
äom
 
bešg
 
aùiv©ed
.

34 
”rÜ
 = 
F®£


35 #Tru
the
 
¶ugš
 
is
 
aùu®ly
 
lßded
 
ªd
 
ruÂšg
.

36 
_aùive
 = 
F®£


37 
missšg_moduËs
 = []

38 
missšg_dbus
 = []

40 
def
 
	$__š™__
(
£lf
, 
šfo
, 
moduË_·th
):

42 
šfo_f›lds
 = {

51 
	}
}

52 
©Œ
, 
f›ld
 
š
 
	gšfo_f›lds
.
	$™ems
():

53 
Œy
:

54 
	$£‰r
(
£lf
, 
©Œ
, 
šfo
[
f›ld
])

55 
exû±
 
KeyE¼Ü
:

56 
	$£‰r
(
£lf
, 
©Œ
, [])

57 #tuº 
the
 
’abËd
 
©Œibu‹
 
što
 
a
 
boŞ


58 
£lf
.
’abËd
 = 
šfo
['’abËd'].
	`low”
() == "true"

59 #’su» 
the
 
moduË
 
d•’d’c›s
 
¬e
 
a
 
li¡


60 
	$isš¡ªû
(
£lf
.
moduË_d•’ds
, 
¡r
):

61 
£lf
.
moduË_d•’ds
 = s–f.moduË_d•’ds.
	`¥l™
(',')

62 
nÙ
 
£lf
.
moduË_d•’ds
[-1]:

63 
£lf
.
moduË_d•’ds
 = self.module_depends[:-1]

64 #’su» 
the
 
dbus
 
d•’d’c›s
 
¬e
 
a
 
li¡


65 
	$isš¡ªû
(
£lf
.
dbus_d•’ds
, 
¡r
):

66 
£lf
.
dbus_d•’ds
 = [self.dbus_depends]

67 
£lf
.
	$_lßd_moduË
(
moduË_·th
)

68 
£lf
.
	$_check_dbus_d•’ds
()

70 #'
aùive
'…roperty

71 
def
 
	$_g‘_aùive
(
£lf
):

72  
£lf
.
_aùive


74 
def
 
	$_£t_aùive
(
£lf
, 
v®ue
):

75 
v®ue
:

76 
£lf
.
š¡ªû
 = s–f.
	$¶ugš_şass
()

78 
£lf
.
š¡ªû
 = 
NÚe


79 
£lf
.
_aùive
 = 
v®ue


81 
aùive
 = 
	$´İ”ty
(
_g‘_aùive
, 
_£t_aùive
)

83 
def
 
	$_check_dbus_d•’ds
(
£lf
):

85 
£lf
.
missšg_dbus
 = []

86 
dbobj
 
š
 
£lf
.
dbus_d•’ds
:

87 
dbobj
.
	`fšd
(':'):

88 
bus
, 
obj_·th
 = 
dbobj
.
	`¥l™
(':')

89 
Œy
:

90 
dbus
.
	`SessiÚBus
().
	$g‘_objeù
(
bus
, 
obj_·th
)

91 
exû±
 
Exû±iÚ
:

92 
£lf
.
missšg_dbus
.
	`­³nd
(
dbobj
.
	`¥l™
(':'))

93 
£lf
.
”rÜ
 = 
True


95 
dbobj
:

96 
£lf
.
missšg_dbus
.
	$­³nd
(
dbobj
)

97 
£lf
.
”rÜ
 = 
True


99 
def
 
	$_check_moduË_d•’ds
(
£lf
):

101 
£lf
.
missšg_moduËs
 = []

102 
mod_Çme
 
š
 
£lf
.
moduË_d•’ds
:

103 
Œy
:

104 
	$__impÜt__
(
mod_Çme
)

105 
exû±
:

106 
£lf
.
missšg_moduËs
.
	$­³nd
(
mod_Çme
)

107 
£lf
.
”rÜ
 = 
True


109 
def
 
	$is_cÚfigu¿bË
(
£lf
):

111  
£lf
.
š¡ªû
 
ªd
 
	`ha§‰r
(self.instance, 'is_configurable')‡nd\

112 
£lf
.
š¡ªû
.
	$is_cÚfigu¿bË
()

114 
def
 
	$_lßd_moduË
(
£lf
, 
moduË_·th
):

116 
Œy
:

117 #impÜˆ
the
 
moduË
 
cÚššg
h
¶ugš


118 
f
, 
·thÇme
, 
desc
 = 
imp
.
	$fšd_moduË
(
£lf
.
moduË_Çme
, 
moduË_·th
)

119 
moduË
 = 
imp
.
	$lßd_moduË
(
£lf
.
moduË_Çme
, 
f
, 
·thÇme
, 
desc
)

120 #fšd 
the
 
şass
 
objeù
 th
aùu®
 
¶ugš


121 
key
, 
™em
 
š
 
moduË
.
__diù__
.
	$™ems
():

122 
	$isš¡ªû
(
™em
, 
ty³
):

123 
£lf
.
¶ugš_şass
 = 
™em


124 
£lf
.
şass_Çme
 = 
™em
.
__diù__
['__moduË__'].
	`¥l™
('.')[1]

126 
exû±
 
ImpÜtE¼Ü
 
as
 
e
:

127 #lßd_moduË(è
çed
, 
´obably
 
beÿu£
 
of
 
a
 
moduË
 
d•’d’cy


128 
	`Ën
(
£lf
.
moduË_d•’ds
) > 0:

129 
£lf
.
	$_check_moduË_d•’ds
()

131 #nØ
d•’d’c›s
 
š
 
šfo
 
fe
; 
u£
 
the
 
ImpÜtE¼Ü
 
š¡—d


132 
£lf
.
missšg_moduËs
.
	`­³nd
(
	`¡r
(
e
).
	`¥l™
(" ")[3])

133 
£lf
.
”rÜ
 = 
True


134 
exû±
 
Exû±iÚ
 
as
 
e
:

135 #lßd_moduË(è
çed
 
some
 
Ùh”
 
»asÚ


136 
Log
.
	$”rÜ
(
e
)

137 
£lf
.
”rÜ
 = 
True


139 
def
 
	$»lßd
(
£lf
, 
moduË_·th
):

140 
nÙ
 
£lf
.
aùive
:

141 
£lf
.
	$_lßd_moduË
(
moduË_·th
)

142 
£lf
.
	$_check_dbus_d•’ds
()

145 
şass
 
	$PlugšEngše
(
BÜg
):

147 
A
 
şass
 
to
 
mªage
 
¶ugšs
. 
OÆy
 
Úe
 
ÿn
 
exi¡
.

150 
def
 
	$__š™__
(
£lf
, 
¶ugš_·th
=
NÚe
):

153 
	`su³r
(
PlugšEngše
, 
£lf
).
	$__š™__
()

154 
	`ha§‰r
(
£lf
, "plugin_path"):

155 #BÜg 
has
 
®»ady
 
b“n
 
š™Ÿlized
, 
sk


158 
£lf
.
¶ugš_·th
 =…lugin_path

159 
£lf
.
š™Ÿlized_¶ugšs
 = []

160 
£lf
.
¶ugšs
 = {
	}
}

161 
£lf
.
¶ugš_­is
 = []

163 #fšd 
®l
 
¶ugš
 
šfo
 
fes
 (*.
gtg
-plugin)

164 
·th
 
š
 
£lf
.
¶ugš_·th
:

165 
f
 
š
 
os
.
	$li¡dœ
(
·th
):

166 
šfo_fe
 = 
os
.
·th
.
	$još
(
·th
, 
f
)

167 
os
.
·th
.
	$isfe
(
šfo_fe
è
ªd
 
f
.
	`’dsw™h
('.gtg-plugin'):

168 
šfo
 = 
cÚfig·r£r
.
	$CÚfigP¬£r
()

169 
šfo
.
	$»ad
(
šfo_fe
)

170 
šfo
 = 
	`diù
(šfo.
	`™ems
("GTG Plugš", 
True
))

171 
p
 = 
	$Plugš
(
šfo
, 
£lf
.
¶ugš_·th
)

172 
£lf
.
¶ugšs
[
p
.
moduË_Çme
] =…

174 
def
 
	$g‘_¶ugš
(
£lf
, 
moduË_Çme
):

175  
£lf
.
¶ugšs
[
moduË_Çme
]

177 
def
 
	`g‘_¶ugšs
(
£lf
, 
kšd_of_¶ugšs
="all"):

179 
R‘uºs
 
a
 
li¡
 
of
 
¶ugšs


180 
f‹ršg
 
Úly
 
a
 
kšd
 
of
 
¶ugš


181 @
·¿m
 
kšd_of_¶ugšs
: 
Úe
 
of
 "active",

187 
®l_¶ugšs
 = 
	`™”
(
£lf
.
¶ugšs
.
	$v®ues
())

188 
kšd_of_¶ugšs
 == "all":

189  
®l_¶ugšs


191 
def
 
	$f‹r_fun
(
¶ugš
):

192  ((
kšd_of_¶ugšs
 =ğ"aùive" 
ªd
 
¶ugš
.
aùive
è
Ü


193 (
kšd_of_¶ugšs
 =ğ"šaùive" 
ªd
 
nÙ
 
¶ugš
.
aùive
è
Ü


194 (
kšd_of_¶ugšs
 =ğ"’abËd" 
ªd
 
¶ugš
.
’abËd
è
Ü


195 (
kšd_of_¶ugšs
 =ğ"di§bËd" 
ªd
 
nÙ
 
¶ugš
.
’abËd
))

196  
	`li¡
(
	$f‹r
(
f‹r_fun
, 
®l_¶ugšs
))

198 
def
 
	$»gi¡”_­i
(
£lf
, 
­i
):

200 
£lf
.
¶ugš_­is
.
	$­³nd
(
­i
)

202 
def
 
	$»move_­i
(
£lf
, 
­i
):

203 
£lf
.
¶ugš_­is
.
	$»move
(
­i
)

205 
def
 
	$aùiv©e_¶ugšs
(
£lf
, 
¶ugšs
=[]):

207 
	`as£¹
(
	$isš¡ªû
(
¶ugšs
, 
li¡
))

208 
nÙ
 
¶ugšs
:

209 
¶ugšs
 = 
£lf
.
	`g‘_¶ugšs
("inactive")

210 
¶ugš
 
š
 
¶ugšs
:

211 #aùiv©
’abËd
 
¶ugšs
 
w™hout
 
”rÜs


212 
¶ugš
.
’abËd
 
ªd
 
nÙ
…lugš.
”rÜ
:

213 #aùiv©
the
 
¶ugš


214 
¶ugš
.
aùive
 = 
True


215 
­i
 
š
 
£lf
.
¶ugš_­is
:

216 
	`ha§‰r
(
¶ugš
.
š¡ªû
, "activate"):

217 
¶ugš
.
š¡ªû
.
	$aùiv©e
(
­i
)

218 
­i
.
	$is_ed™Ü
():

219 
	`ha§‰r
(
¶ugš
.
š¡ªû
, "onTaskOpened"):

220 
¶ugš
.
š¡ªû
.
	$ÚTaskO³Ãd
(
­i
)

221 #®sØ
»äesh
 
the
 
cÚ‹Á
 
of
h
sk


222 
tv
 = 
­i
.
	`g‘_ui
().
	$g‘_‹xtv›w
()

223 
tv
:

224 
tv
.
	$modif›d
(
»äeshed™Ü
=
F®£
)

226 
def
 
	$d—ùiv©e_¶ugšs
(
£lf
, 
¶ugšs
=[]):

228 
	`as£¹
(
	$isš¡ªû
(
¶ugšs
, 
li¡
))

229 
nÙ
 
¶ugšs
:

230 
¶ugšs
 = 
£lf
.
	`g‘_¶ugšs
("active")

231 
¶ugš
 
š
 
¶ugšs
:

232 #d—ùiv©
di§bËd
 
¶ugšs


233 
nÙ
 
¶ugš
.
’abËd
:

234 
­i
 
š
 
£lf
.
¶ugš_­is
:

235 
	`ha§‰r
(
¶ugš
.
š¡ªû
, "deactivate"):

236 
¶ugš
.
š¡ªû
.
	$d—ùiv©e
(
­i
)

237 
şas¢ame
 = 
¶ugš
.
š¡ªû
.
d—ùiv©e
.
__şass__


238 
­i
.
	$»move_aùive_£ËùiÚ_chªged_ÿÎback
(
şas¢ame
)

239 
­i
.
	$is_ed™Ü
():

240 
	`ha§‰r
(
¶ugš
.
š¡ªû
, "onTaskClosed"):

241 
¶ugš
.
š¡ªû
.
	$ÚTaskClo£d
(
­i
)

242 #®sØ
»äesh
 
the
 
cÚ‹Á
 
of
h
sk


243 
tv
 = 
­i
.
	`g‘_ui
().
	$g‘_‹xtv›w
()

244 
tv
:

245 
tv
.
	$modif›d
(
»äeshed™Ü
=
F®£
)

246 
¶ugš
.
aùive
 = 
F®£


247 #ià
¶ugš
 
is
 
’abËd
 
ªd
 
has
 
ÚQu™
 
memb”
, 
execu‹
 
™


249 
­i
 
š
 
£lf
.
¶ugš_­is
:

250 
	`ha§‰r
(
¶ugš
.
š¡ªû
, "onQuit"):

251 
¶ugš
.
š¡ªû
.
	$ÚQu™
(
­i
)

253 
def
 
	$ÚTaskLßd
(
£lf
, 
¶ugš_­i
):

255 
¶ugš
 
š
 
£lf
.
	`g‘_¶ugšs
("active"):

256 
	`ha§‰r
(
¶ugš
.
š¡ªû
, "onTaskOpened"):

257 
¶ugš
.
š¡ªû
.
	$ÚTaskO³Ãd
(
¶ugš_­i
)

259 
def
 
	$ÚTaskClo£
(
£lf
, 
¶ugš_­i
):

261 
¶ugš
 
š
 
£lf
.
	`g‘_¶ugšs
("active"):

262 
	`ha§‰r
(
¶ugš
.
š¡ªû
, 'onTaskClosed'):

263 
¶ugš
.
š¡ªû
.
	$ÚTaskClo£d
(
¶ugš_­i
)

265 #FIXME: 
Wh©
 
¬e
 
the£
 ? 
mu¡
 
check
 
someday
! (
šv”nizzi
)

266 
def
 
	$»check_¶ugšs
(
£lf
, 
¶ugš_­is
):

269 
TODO
: 
somehow
 
make
 
this
 
uÂeûs§ry
?

271 
¶ugš
 
š
 
£lf
.
	$g‘_¶ugšs
():

272 
Œy
:

273 
¶ugš
.
š¡ªû
 
ªd
…lugš.
’abËd
‡nd…lugš.
aùive
:

274 
£lf
.
	$d—ùiv©e_¶ugšs
(
£lf
.
¶ugš_­is
, [
¶ugš
])

275 
–if
 
¶ugš
.
š¡ªû
 
is
 
NÚe
 
ªd
…lugš.
’abËd
‡nd \

276 (
nÙ
 
¶ugš
.
aùive
):

277 
¶ugš
.
”rÜ
:

278 
¶ugš
.
’abËd
 = 
F®£


280 
£lf
.
	$aùiv©e_¶ugšs
(
£lf
.
¶ugš_­is
, [
¶ugš
])

281 
–if
 
¶ugš
.
š¡ªû
 
ªd
…lugš.
’abËd
‡nd 
nÙ
…lugš.
aùive
:

282 
¶ugš
.
”rÜ
:

283 
¶ugš
.
’abËd
 = 
F®£


285 
£lf
.
	$aùiv©e_¶gušs
(
£lf
.
¶ugš_­is
, [
¶ugš
])

286 
exû±
 
Exû±iÚ
 
as
 
e
:

287 
	`´št
("E¼Ü: %s" % 
e
)

289 
def
 
	$»check_¶ugš_”rÜs
(
£lf
, 
check_®l
=
F®£
):

291 
¶ugš
 
š
 
£lf
.
	$g‘_¶ugšs
():

292 
check_®l
 
Ü
 
¶ugš
.
”rÜ
:

293 
¶ugš
.
	`»lßd
(
£lf
.
¶ugš_·th
)

	@core/requester.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
A
 
niû
 
g’”®
 
pu½o£
 
š‹rçû
 
the
 
d©a¡Üe
 
ªd
 
	gg¡Üe


21 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
GObjeù


23 
äom
 
	gGTG
.
	gcÜe
.
g
 
impÜt
 
Tag


24 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


27 
şass
 
	$Reque¡”
(
GObjeù
.GObject):

30 
L
{
Reque¡”
} i ¨¡©–es objeùh© sim¶y…rovide ¨niû API 

31 
u£r
 
š‹rçûs
 
to
 
u£
 
d©a¡Üe
 
İ”©iÚs
.

33 
MuÉË
 
L
{
Reque¡”
}
s
 
ÿn
 
exi¡
 
Ú
 
the
 
§me
 
d©a¡Üe
, 
so
 
they
 
should


34 
Ãv”
 
have
 
¡©e
 
of
 
theœ
 
	gown
.

37 
def
 
	$__š™__
(
£lf
, 
d©a¡Üe
, 
glob®_cÚf
):

39 
GObjeù
.GObjeù.
	$__š™__
(
£lf
)

40 
£lf
.
ds
 = 
d©a¡Üe


41 
£lf
.
__cÚfig
 = 
glob®_cÚf


42 
£lf
.
__ba£Œ“
 = s–f.
ds
.
	$g‘_sks_Œ“
()

44 ############ 
Tasks
 
T»e
 ######################

45 #By , 
we
  
the
 
sk
 
Œ“
 
of
h
maš
 
wšdow


46 
def
 
	`g‘_sks_Œ“
(
£lf
, 
Çme
='aùive', 
»äesh
=
True
):

47  
£lf
.
__ba£Œ“
.
	$g‘_v›wŒ“
(
Çme
òame, 
»äesh
=refresh)

49 
def
 
	$g‘_maš_v›w
(
£lf
):

50  
£lf
.
__ba£Œ“
.
	$g‘_maš_v›w
()

52 
def
 
	$is_di¥Ïyed
(
£lf
, 
sk
):

53  
£lf
.
__ba£Œ“
.
	`g‘_v›wŒ“
(
Çme
='aùive').
	$is_di¥Ïyed
(
sk
)

55 
def
 
	$g‘_ba£Œ“
(
£lf
):

56  
£lf
.
__ba£Œ“


58 #thi 
m‘hod
 
®so
 
upd©e
 
the
 
v›wcouÁ
 
of
 
gs


59 
def
 
	$­¶y_glob®_f‹r
(
£lf
, 
Œ“
, 
f‹ºame
):

60 
Œ“
.
	$­¶y_f‹r
(
f‹ºame
)

61 
t
 
š
 
£lf
.
	$g‘_®l_gs
():

62 

 = 
£lf
.
	$g‘_g
(
t
)

63 

.
	$­¶y_f‹r
(
f‹ºame
)

65 
def
 
	$uÇµly_glob®_f‹r
(
£lf
, 
Œ“
, 
f‹ºame
):

66 
Œ“
.
	$uÇµly_f‹r
(
f‹ºame
)

67 
t
 
š
 
£lf
.
	$g‘_®l_gs
():

68 

 = 
£lf
.
	$g‘_g
(
t
)

69 

.
	$uÇµly_f‹r
(
f‹ºame
)

71 #########F‹r 
bªk
 #######################
#Li¡, 
by
 
Çme
, 
®l
 
avaabË
 
f‹rs


72 
def
 
	$li¡_f‹rs
(
£lf
):

73  
£lf
.
__ba£Œ“
.
	$li¡_f‹rs
()

75 #Add 
a
 
f‹r
 
to
 
the
 f‹¸
bªk


76 #R‘uº 
True
 
the
 
f‹r
 
was
 
added


77 #R‘uº 
F®£
 
the
 
f‹r_Çme
 
was
 
®»ady
 
š
h
bªk


78 
def
 
	$add_f‹r
(
£lf
, 
f‹r_Çme
, 
f‹r_func
):

79  
£lf
.
__ba£Œ“
.
	$add_f‹r
(
f‹r_Çme
, 
f‹r_func
)

81 #Remov
a
 
f‹r
 
äom
 
the
 
bªk
.

82 #OÆy 
cu¡om
 
f‹rs
 
th©
 
w”e
 
added
 
h”e
 
ÿn
 
be
 
»moved


83 #R‘uº 
F®£
 
the
 
f‹r
 
was
 
nÙ
 
»moved


84 
def
 
	$»move_f‹r
(
£lf
, 
f‹r_Çme
):

85  
£lf
.
__ba£Œ“
.
	$»move_f‹r
(
f‹r_Çme
)

87 ############## 
Tasks
 ##########################

88 ###############################################
 has_sk(£lf,id):

90  
£lf
.
ds
.
	$has_sk
(
tid
)

92 
def
 
	$g‘_sk
(
£lf
, 
tid
):

95 
If
 
no
 
such
 
sk
 
exi¡s
, 
ü—‹
 
™
 
ªd
 
fÜû
 
the
 
tid
 
to
 
be
 
C
{
	}
tid}.

97 @
·¿m
 
	gtid
: 
The
 
sk
 
id
.

98 @: 
A
 
sk
.

100 
sk
 = 
£lf
.
ds
.
	$g‘_sk
(
tid
)

101  
sk


103 #FIXME 
unu£d
 
·¿m‘”
 
	`Ãwsk
 (
maybe
 
com·tib™y
?)

104 
def
 
	$Ãw_sk
(
£lf
, 
gs
=
NÚe
, 
Ãwsk
=
True
):

107 
NÙe
: 
this
 
modif›s
 
the
 
d©a¡Üe
.

109 @
·¿m
 
pid
: 
The
 
´ojeù
 
wh”e
 
the
 
Ãw
 
sk
 
wl
 
be
 
ü—‹d
.

110 @
·¿m
 
gs
: 
The
ag 
the
 
Ãw
 
sk
. 
If
 
nÙ
 
´ovided
, 
th’
he

111 
sk
 
wl
 
have
 
no
 
gs
. 
Tags
 
mu¡
 
be
 
ª
 
™”©Ü
 
ty³
 
cÚššg


112 
the
 
gs
 
tids


113 @
·¿m
 
Ãwsk
: 
C
{
True
} thi i ü—tšg‡‚ewaskh©‚ev”

114 
exi¡ed
, 
	gC
{
	gF®£
} 
impÜtšg
 
ª
 
exi¡šg
 
sk
 
äom
 
a
 
	gback’d
.

115 @: 
A
 
sk
 
äom
 
the
 
d©a
 
¡Üe


117 
sk
 = 
£lf
.
ds
.
	$Ãw_sk
()

118 
gs
:

119 
t
 
š
 
gs
:

120 
	`as£¹
(
nÙ
 
	$isš¡ªû
(
t
, 
Tag
))

121 
sk
.
	$g_added
(
t
)

122  
sk


124 
def
 
	$d–‘e_sk
(
£lf
, 
tid
, 
»cursive
=
True
):

126 
®l
 
the
 
chd»ns
.

128 
NÙe
: 
this
 
modif›s
 
the
 
d©a¡Üe
.

130 @
·¿m
 
tid
: 
The
 
id
 
of
 
the
 
sk
 
to
 
be
 
d–‘ed
.

132 #£nd 
the
 
sigÇl
 
befÜe
 
aùu®ly
 
d–‘šg
h
sk
 !

133 
Log
.
	`debug
("d–‘šgask %s" % 
tid
)

134  
£lf
.
__ba£Œ“
.
	$d–_node
(
tid
, 
»cursive
=recursive)

136 
def
 
	$g‘_sk_id
(
£lf
, 
sk_t™Ë
):

139 
R‘uº
 
a
 
fœ¡
 
sk
 
which
 
has
 
sim¬
 
t™Ë
 """

141 
sk_t™Ë
 =ask_t™Ë.
	$low”
()

142 
sks
 = 
£lf
.
	`g‘_sks_Œ“
('aùive', 
F®£
).
	$g‘_®l_nodes
()

143 
skŒ“
 = 
£lf
.
	$g‘_maš_v›w
()

144 
sk_id
 
š
 
sks
:

145 
sk
 = 
skŒ“
.
	$g‘_node
(
sk_id
)

146 
sk_t™Ë
 =ğ
sk
.
	`g‘_t™Ë
().
	$low”
():

147  
sk_id


149  
NÚe


152 ###############################################
 g‘_g_Œ“(£lf):

153  
£lf
.
ds
.
	`g‘_g¡Üe
().
	`g‘_v›wŒ“
(
Çme
='activetags')

155 
def
 
	$Ãw_g
(
£lf
, 
gÇme
):

158 
NÙe
: 
this
 
modif›s
 
the
 
d©a¡Üe
.

160 @
·¿m
 
gÇme
: 
The
 
Çme
 
of
 
the
 
Ãw
 
g
.

161 @: 
The
 
Ãwly
-
ü—‹d
 
g
.

163  
£lf
.
ds
.
	$Ãw_g
(
gÇme
)

165 
def
 
	$Ãw_£¬ch_g
(
£lf
, 
Çme
, 
qu”y
):

167 
C»©e
 
a
 
Ãw
 
£¬ch
 
g
 
äom
 s—rch 
qu”y


169 
NÙe
: 
this
 
modif›s
 
the
 
d©a¡Üe
.

171 @
·¿m
 
Çme
:‚am
of
 
the
 
Ãw
 
£¬ch
 
g


172 @
·¿m
 
qu”y
: 
Qu”y
 
wl
 
be
 
·r£d
 
usšg
 
£¬ch
 
·r£r


173 @: 
Ãw
 
g


175  
£lf
.
ds
.
	$Ãw_£¬ch_g
(
Çme
, 
qu”y
)

177 
def
 
	$»move_g
(
£lf
, 
Çme
):

179 
£lf
.
ds
.
	$»move_g
(
Çme
)

181 
def
 
	$»Çme_g
(
£lf
, 
ŞdÇme
, 
ÃwÇme
):

182 
£lf
.
ds
.
	$»Çme_g
(
ŞdÇme
, 
ÃwÇme
)

184 
def
 
	$g‘_g
(
£lf
, 
gÇme
):

185  
£lf
.
ds
.
	$g‘_g
(
gÇme
)

187 
def
 
	$g‘_u£d_gs
(
£lf
):

190 @: 
A
 
li¡
 
of
 
g
 
Çmes
 
u£d
 
by
 
a
 
sk
.

192 
g¡Üe
 = 
£lf
.
ds
.
	$g‘_g¡Üe
()

193 
v›w
 = 
g¡Üe
.
	`g‘_v›wŒ“
(
Çme
='g_com¶‘iÚ', 
»äesh
=
F®£
)

194 
gs
 = 
v›w
.
	$g‘_®l_nodes
()

195 
gs
.
	$sÜt
(
key
=
¡r
.
low”
)

196  
gs


198 
def
 
	$g‘_®l_gs
(
£lf
):

200 
G‘s
 
®l
 
gs
 
äom
‡Î 
sks


202  
£lf
.
ds
.
	`g‘_g¡Üe
().
	`g‘_maš_v›w
().
	$g‘_®l_nodes
()

204 
def
 
	$d–‘e_g
(
£lf
, 
gÇme
):

205 
my_g
 = 
£lf
.
	$g‘_g
(
gÇme
)

206 
sk_id
 
š
 
my_g
.
	$g‘_»Ï‹d_sks
():

207 
my_sk
 = 
£lf
.
	$g‘_sk
(
sk_id
)

208 
my_sk
.
	`»move_g
(
my_g
.
	$g‘_Çme
())

210 ############## 
Back’ds
 #######################
###############################################
 g‘_®l_back’ds(£lf, di§bËd=F®£):

211  
£lf
.
ds
.
	$g‘_®l_back’ds
(
di§bËd
)

213 
def
 
	$»gi¡”_back’d
(
£lf
, 
dic
):

214  
£lf
.
ds
.
	$»gi¡”_back’d
(
dic
)

216 
def
 
	$æush_®l_sks
(
£lf
, 
back’d_id
):

217  
£lf
.
ds
.
	$æush_®l_sks
(
back’d_id
)

219 
def
 
	$g‘_back’d
(
£lf
, 
back’d_id
):

220  
£lf
.
ds
.
	$g‘_back’d
(
back’d_id
)

222 
def
 
	$£t_back’d_’abËd
(
£lf
, 
back’d_id
, 
¡©e
):

223  
£lf
.
ds
.
	$£t_back’d_’abËd
(
back’d_id
, 
¡©e
)

225 
def
 
	$»move_back’d
(
£lf
, 
back’d_id
):

226  
£lf
.
ds
.
	$»move_back’d
(
back’d_id
)

228 
def
 
	$back’d_chªge_©ched_gs
(
£lf
, 
back’d_id
, 
gs
):

229  
£lf
.
ds
.
	$back’d_chªge_©ched_gs
(
back’d_id
, 
gs
)

231 
def
 
	$§ve_d©a¡Üe
(
£lf
):

232  
£lf
.
ds
.
	$§ve
()

234 ############## 
CÚfig
 ############################

236 
def
 
	$g‘_glob®_cÚfig
(
£lf
):

237  
£lf
.
__cÚfig


239 
def
 
	$g‘_cÚfig
(
£lf
, 
Çme
):

240  
£lf
.
__cÚfig
.
	$g‘_subcÚfig
(
Çme
)

242 
def
 
	$§ve_cÚfig
(
£lf
):

243 
£lf
.
__cÚfig
.
	`§ve
()

	@core/search.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
S—rch
 
ã©u»
 
GTG


20 
C»©ed
 
	gby
:

21 - 
Jo
Ã£
o
 
Asûnso
, 
	gGSoC
 2011

22 - 
IzidÜ
 
	gM©u
Å¡
	gov
, 
	gJª
/
	gFeb
 2012

24 
You
 
ÿn
 
£¬ch
 
by
 
’Œšg
 
a
 
qu”y
 
š
‡ 
sim¶e
 
	gÏnguage
. 
FunùiÚ


25 
	$·r£_£¬ch_qu”y
(è
·r£
 
the
 
qu”y
 
ªd
  
š‹º®
 
»´e£Á©iÚ
 
which


26 
is
 
u£d
 
f‹ršg
 
š
 
	$£¬ch_f‹r
(è
funùiÚ
. 
If
 
the
 
qu”y
 
is
 
m®fÜmed
,

27 
the
 
exû±iÚ
 
Inv®idQu”y
 
is
 
¿i£d
.

29 
The
 
qu”y
 
Ïnguage
 
cÚsi¡s
 
of
 
£v”®
 
–em’ts
:

30 - 
commªds


31 - !
nÙ
 <
–em
> -- 
the
 
Ãxt
 
–em’t
 
wl
 
be
 
Ãg©ed


32 - <
–em
> !
Ü
 <–em> --  
True
 
©
 
Ëa¡
 
Ú
 
of
 
–em’ts
 
is
 
Œue


33 - !
aá”
 <
d©e
> -- 
show
 
sks
 
which
 
could
 
be
 
dÚe
‡á” 
this
 date

34 - !
befÜe
 <
d©e
> -- 
show
 
sks
 
which
 
mu¡
 
be
 
dÚe
 befÜ
this
 date

35 - !
today
 -- 
show
 
sks
 
w™h
 
due_d©e
 ==oday

36 - !
tomÜrow
 -- 
show
 
sks
 
w™h
 
due_d©e
 ==omorrow

37 - !
nod©e
 -- 
show
 
sks
 
w™hout
 
due_d©e


38 - !
now
 -- 
show
 
sks
 
w™h
 
due_d©e
 ==‚ow

39 - !
soÚ
 -- 
show
 
sks
 
w™h
 
due_d©e
 == soon

40 - !
someday
 -- 
show
 
sks
 
w™h
 
due_d©e
 == someday

41 - !
nÙag
 -- 
show
 
sks
 
w™hout
 
gs


42 - 
gs
 -- 
show
 
sks
 
w™h
 
this
 
g


43 - 
wÜd
 -- 
show
 
sks
 
which
 
cÚšs
 
this
 word

44 - "l™”®" -- 
basiÿÎy
 
the
 
§me
 
as
 
wÜd
 
but
 
®lows
h
¥aû
 
ªd
 
¥ecŸl


45 
ch¬aù”s
 
šside
. 
L™”®
 
mu¡
 
be
 inside "quotes".

46 - 
d©e
 -- d©
which
 
could
 
be
 
·r£d
 
w™h
 
D©e
.
	$·r£
()

48 
EËm’ts
 
¬e
 
suµo£d
 
to
 
be
 
š
 
cÚjuùiÚ
, 
i
.
e
. 
they
‡» 
š‹½»‹d
 
as
::

49 
E1
 
AND
 
E2
 AND 
E3
 AND 
E4
 
	$AND
 ( 
E5
 
OR
 
E6
 OR 
E7
 ) 
AND
 
E8
 ...

51 
Exam¶es
 
of
 
qu”›s
:

52 '!tomÜrow !Ü !today' => 
show
 
sks
 
which
 
¬e
 
today
 
Ü
 
tomÜrow


53 '@gtg @wr™šg' => 
show
 
sks
 
w™h
 
bÙh
 
of
 
the
 
gs
 @
gtg
, @
wr™šg


54 '@gtg !befÜ2012-03-01' => 
show
 
GTG
 
sks
 
w™h
 
due_d©e
 
befÜe
 
M¬ch
 1

55 'buy @”¿nds' => 
show
 
”¿nds
 
wh”e
 
I
 
have
 
to
 
buy
 
som‘hšg


56 '!nÙ buy @”¿nds' => 
show
 
”¿nds
 
w™hout
 
keywÜd
 
buy


57 '!aá” "ÃxˆmÚth"' => 
show
 
sks
 
aá”
 
this
 
mÚth


60 
	$£¬ch_f‹r
(è
ex³ù
 
·¿m‘”
 'q' 
which
 
is
 
a
 
li¡
 
of
 
commªds
 
š
 
the
 
fÜm


61 (
Çme_of_commªd
, 
should_be_pos™ive
, 
¬gum’ts
). 
If
::

62 
should_be_pos™ive
 =ğ
True
 => 
sk
 
has
 
to
 
§tisfy
 
this
 
commªd


63 
should_be_pos™ive
 =ğ
F®£
 => 
sk
 
mu¡
 
nÙ
 
§tisfy
 
this
 
commªd


65 
A
 
¥ecŸl
 
commªd
 
is
 "Ü" 
which
 
cÚšs
 
subcommªds
 
ªd
 
»tuºs
 
Tu»
 

66 
©
 
Ëa¡
 
Úe
 
subcommªd
 
»tuºs
 
True
.

68 
	$£¬ch_f‹r
(è
could
 
be
 
—sy
 
¶ugged
 
š
 
LibÏrch
 
ªd
 
f‹r
 
Úly
 
su™abË


69 
sks
.

71 
FÜ
 
mÜe
 
šfÜm©iÚ
 
£e
 
un™‹¡s
:

72 - 
GTG
/
‹¡s
/
‹¡_£¬ch_qu”y
.
py
 -- 
·rsšg
 
qu”y


73 - 
GTG
/
‹¡s
/
‹¡_£¬ch_f‹r
.
py
 -- 
f‹ršg
 
a
 
sk


76 
impÜt
 
»


78 
äom
 
GTG
 
impÜt
 
_


79 
äom
 
GTG
.
toŞs
.
d©es
 
impÜt
 
D©e


81 #G’”©
keywÜds
 
ªd
 
theœ
 
possibË
 
Œª¦©iÚs


82 #They 
mu¡
 
be
 
li¡ed
 
beÿu£
 
of
 
g‘‹xt


83 
KEYWORDS
 = {

84 "nÙ": 
	`_
("not"),

85 "Ü": 
	`_
("or"),

86 "aá”": 
	`_
("after"),

87 "befÜe": 
	`_
("before"),

88 "today": 
	`_
("today"),

89 "tomÜrow": 
	`_
("tomorrow"),

90 "nod©e": 
	`_
("nodate"),

91 "now": 
	`_
("now"),

92 "soÚ": 
	`_
("soon"),

93 "someday": 
	`_
("someday"),

94 "nÙag": 
	`_
("notag"),

95 
	}
}

97 #ŒªsfÜm 
keywÜds
 
ªd
 
theœ
 
Œª¦©iÚs
 
što
 
a
 
li¡
 
of
 
possibË
 
commªds


98 
key
 
š
 
KEYWORDS
:

99 " " 
nÙ
 
š
 
KEYWORDS
[
key
] 
ªd
 KEYWORDS[key].
low”
(è!ğkey.
	$low”
():

100 
possibË_wÜds
 = [
key
.
	`low”
(), 
KEYWORDS
[key].lower()]

102 
possibË_wÜds
 = [
key
.
	`low”
()]

103 
KEYWORDS
[
key
] = 
possibË_wÜds


105 #G’”©
li¡
 
of
 
possibË
 
commªds


106 
SEARCH_COMMANDS
 = []

107 
key
 
š
 
KEYWORDS
:

108 
key_commªd
 
š
 
KEYWORDS
[
key
]:

109 
key_commªd
 = '!' + key_command

110 
key_commªd
 
nÙ
 
š
 
SEARCH_COMMANDS
:

111 
SEARCH_COMMANDS
.
	$­³nd
(
key_commªd
)

114 
şass
 
	$Inv®idQu”y
(
Exû±iÚ
):

116 
£¬ch
 
qu”y
 
™
 
is
 
šv®id
 """

117 
·ss


119 
TOKENS_RE
 = 
»
.
	`compe
(
r
"""

120 (?
P
<
commªd
>!\
S
+(?=\
s
)?) |

121 (?
P
<
g
>@\
S
+(?=\
s
)?) |

122 (?
P
<
d©e
>\
d
{4
	}
}-\d{2}-\d{2}|\d{8}|\d{4}) |

123 (?
P
<
l™”®
>".+?") |

124 (?
P
<
wÜd
>(?![!"@])\S+(?=\s)?) |

125 (?
P
<
¥aû
>(\
s
+))

129 
def
 
	$_tok’ize_qu”y
(
qu”y
):

132 
This
 
is
 
š¥œed
 
by
 
fŞlowšg
 
tok’iz”
:

133 
h‰p
:

134 
by
 
M©t
 
And”sÚ


135 (
™
 
is
 
liûn£d
 
und”
 
CC
 
©ributiÚ
 
»quœed
)

137 
pos
 = 0

138 
True
:

139 
m©ch
 = 
TOKENS_RE
.
	$m©ch
(
qu”y
, 
pos
)

140 
nÙ
 
m©ch
:

142 
pos
 = 
m©ch
.
	$’d
()

143 
tok’_ty³
 = 
m©ch
.
Ï¡group


144 
tok’_v®ue
 = 
m©ch
.
	$group
(
tok’_ty³
)

145 
tok’_ty³
 != 'space':

146 
y›ld
 
tok’_ty³
, 
tok’_v®ue


147 
pos
 !ğ
	$Ën
(
qu”y
):

148 
¿i£
 
	`Inv®idQu”y
('tokenizer stopped‡t…os %r of %r†eft of "%s"' % (

149 
pos
, 
	`Ën
(
qu”y
), query[pos:pos + 10]))

152 
def
 
	$·r£_£¬ch_qu”y
(
qu”y
):

155 
If
 
qu”y
 
is
 
nÙ
 
cÜ»ù
, 
exû±iÚ
 
Inv®idQu”y
 i 
¿i£d
.

158 
	`Ën
(
qu”y
.
	`¡r
()) == 0:

159 
¿i£
 
	`Inv®idQu”y
("Query isƒmpty")

161 
qu”y
.
	`couÁ
('"') % 2 != 0:

162 
¿i£
 
	`Inv®idQu”y
("Query has odd‚umber of quotes")

164 
commªds
 = []

166 
nÙ_couÁ
, 
aá”_Ü
 = 0, 
F®£


167 
»quœe_d©e
 = 
NÚe


168 
tok’
, 
v®ue
 
š
 
	$_tok’ize_qu”y
(
qu”y
):

169 
cmd
 = 
NÚe


171 
»quœe_d©e
:

172 
tok’
 
nÙ
 
š
 ['date', 'word', 'literal']:

173 
¿i£
 
	`Inv®idQu”y
("Unexpectedoken '%s'‡fter '%s'" % (

174 
tok’
, 
»quœe_d©e
))

176 
v®ue
 = v®ue.
	`¡r
('"')

177 
Œy
:

178 
d©e
 = 
D©e
.
	$·r£
(
v®ue
)

179 
exû±
 
V®ueE¼Ü
:

180 
¿i£
 
	`Inv®idQu”y
("D©'%s' iÀwrÚg fÜm©" % (
v®ue
))

182 
cmd
 = (
»quœe_d©e
, 
nÙ_couÁ
 % 2 =ğ0, 
d©e
)

183 
»quœe_d©e
 = 
NÚe


185 
–if
 
tok’
 == 'command':

186 
v®ue
 = v®ue.
	`low”
()[1:]

188 
found
 = 
F®£


189 
keywÜd
 
š
 
KEYWORDS
:

190 
v®ue
 
nÙ
 
š
 
KEYWORDS
[
keywÜd
]:

193 
keywÜd
 == 'not':

194 
nÙ_couÁ
 += 1

195 
–if
 
keywÜd
 == 'or':

196 
nÙ_couÁ
 > 0:

197 
¿i£
 
	`Inv®idQu”y
("!or cann't follow !not")

199 
commªds
 == []:

200 
¿i£
 
	`Inv®idQu”y
(

203 
commªds
[-1][0] != "or":

204 
commªds
.
	`­³nd
(("Ü", 
True
, [commªds.
	`pİ
()]))

206 
aá”_Ü
 = 
True


207 
–if
 
keywÜd
 
š
 ['after', 'before']:

208 
»quœe_d©e
 = 
keywÜd


210 
cmd
 = (
keywÜd
, 
nÙ_couÁ
 % 2 == 0)

211 
found
 = 
True


213 
nÙ
 
found
:

214 
¿i£
 
	`Inv®idQu”y
("UnknowÀcommªd !%s" % 
v®ue
)

216 
–if
 
tok’
 == 'tag':

217 
cmd
 = (
tok’
, 
nÙ_couÁ
 % 2 =ğ0, 
v®ue
)

218 
–if
 
tok’
 
š
 ['literal', 'word']:

219 
cmd
 = ('wÜd', 
nÙ_couÁ
 % 2 =ğ0, 
v®ue
.
	`¡r
('"').
	$low”
())

221 
cmd
 
is
 
nÙ
 
NÚe
:

222 
aá”_Ü
:

223 
commªds
[-1][2].
	$­³nd
(
cmd
)

225 
commªds
.
	$­³nd
(
cmd
)

227 
nÙ_couÁ
, 
aá”_Ü
 = 0, 
F®£


229 
nÙ_couÁ
 > 0:

230 
¿i£
 
	`Inv®idQu”y
("Query cannotƒnd with !not (Forgot something?)")

232 
aá”_Ü
:

233 
¿i£
 
	`Inv®idQu”y
("Or is‚ot‡llowed‡theƒnd of query")

235 
»quœe_d©e
:

236 
¿i£
 
	`Inv®idQu”y
("Requœed d©aá” '%s'" % 
»quœe_d©e
)

238  {'q': 
commªds
}

241 
def
 
	$£¬ch_f‹r
(
sk
, 
·¿m‘”s
=
NÚe
):

244 
·¿m‘”s
 
is
 
NÚe
 
Ü
 'q' 
nÙ
 
š
…arameters:

245  
F®£


247 
def
 
	$check_commªds
(
commªds_li¡
):

250 
This
 
m‘hod
 
is
 
»cursive
 !
Ü
 
ªd
 !and """

252 
def
 
	$fuÎ‹xt_£¬ch
(
sk
, 
wÜd
):

254 
wÜd
 = wÜd.
	$low”
()

255 
‹xt
 = 
sk
.
	`g‘_exû½t
(
¡r_gs
=
F®£
).
	$low”
()

256 
t™Ë
 = 
sk
.
	`g‘_t™Ë
().
	$low”
()

258  
wÜd
 
š
 
‹xt
 
Ü
 wÜd iÀ
t™Ë


260 
v®ue_checks
 = {

261 'aá”': 
Ïmbda
 
t
, 
v
: 
sk
.
	`g‘_due_d©e
() > v,

262 'befÜe': 
Ïmbda
 
t
, 
v
: 
sk
.
	`g‘_due_d©e
() < v,

263 'g': 
Ïmbda
 
t
, 
v
: v 
š
 
sk
.
	`g‘_gs_Çme
(),

264 'wÜd': 
fuÎ‹xt_£¬ch
,

265 'today': 
Ïmbda
 
sk
, 
v
:ask.
	`g‘_due_d©e
(è=ğ
D©e
.
	`today
(),

266 'tomÜrow': 
Ïmbda
 
sk
, 
v
:ask.
	`g‘_due_d©e
(è=ğ
D©e
.
	`tomÜrow
(),

267 'nod©e': 
Ïmbda
 
sk
, 
v
:ask.
	`g‘_due_d©e
(è=ğ
D©e
.
	`no_d©e
(),

268 'now': 
Ïmbda
 
sk
, 
v
:ask.
	`g‘_due_d©e
(è=ğ
D©e
.
	`now
(),

269 'soÚ': 
Ïmbda
 
sk
, 
v
:ask.
	`g‘_due_d©e
(è=ğ
D©e
.
	`soÚ
(),

270 'someday': 
Ïmbda
 
sk
, 
v
:ask.
	`g‘_due_d©e
(è=ğ
D©e
.
	`someday
(),

271 'nÙag': 
Ïmbda
 
sk
, 
v
:ask.
	`g‘_gs
() == [],

272 
	}
}

274 
commªd
 
š
 
	gcommªds_li¡
:

275 
cmd
, 
	gpos™ive
, 
	g¬gs
 = 
commªd
[0], 
	gcommªd
[1], command[2:]

276 
»suÉ
 = 
F®£


278 
cmd
 == 'or':

279 
sub_cmd
 
š
 
¬gs
[0]:

280 
	$check_commªds
([
sub_cmd
]):

281 
»suÉ
 = 
True


283 
–if
 
v®ue_checks
.
	$g‘
(
cmd
, 
NÚe
):

284 
	`Ën
(
¬gs
) > 0:

285 
¬gs
 =‡rgs[0]

286 
»suÉ
 = 
v®ue_checks
[
cmd
](
sk
, 
¬gs
)

288 ià(
pos™ive
 
ªd
 
nÙ
 
»suÉ
è
	$Ü
 (
nÙ
 
pos™ive
 
ªd
 
»suÉ
):

289  
F®£


291  
True


293  
	`check_commªds
(
·¿m‘”s
['q'])

	@core/tag.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
g¡Üe
 
is
 
wh”e
 
the
 
g
 
objeùs
 
¬e
 
	ghªdËd
. 
Also
 
defšes
h
Tag
 
	gobjeù
.

20 
Tag¡Üe
 
is
 
to
 
g
 
as
 
d©a¡Üe
 i tØ
	gsk
. 
Of
 
	gcour£
, 
the
 
g¡Üe
 is

21 
	g—s›r
. 
S“
 
the
 
’d
 
of
 
this
 
fe
 th
Tag
 
objeù
 
	gim¶em’tiÚ
.

24 
impÜt
 
	gxml
.
	g§x
.
§xuts
 
as
 saxutils

26 
äom
 
	gGTG
.
cÜe
 
impÜt
 
CÜeCÚfig


27 
äom
 
libÏrch
 
impÜt
 
T»eNode


28 
äom
 
funùoŞs
 
impÜt
 
»duû


31 
şass
 
	$Tag
(
T»eNode
):

34 
I
 
m—n
, 
su»ly
 
you
 
mu¡
 
know
 
wh©
 
a
 
g
 
is
 
by
 
now
. 
Thšk
 
Gma
,

35 
d–
.
icio
.
us
, 
Flickr
 
‘
 
®
.

37 
A
 
g
 
is
 
defšed
 
by
 
™s
 
Çme
, 
which
 
š
 
mo¡
 
ÿ£s
 i 
C
{@
som‘hšg
}. Aag

38 
ÿn
 
®so
 
have
 
muÉË
 
¬b™¿ry
 
	g©Œibu‹s
. 
The
 
Úly
 
©Œibu‹
 
’fÜûd


39 
gs
 
is
 
	gC
{
	gÇme
}, 
which
 
®ways
 
m©ches
 
	gL
{
	gTag
.
g‘_Çme
()}.

42 
def
 
__š™__
(
£lf
, 
Çme
, 
»q
, 
©Œibu‹s
={}):

45 @
·¿m
 
Çme
: 
The
‚am
of
 
the
 
g
. 
Should
 
be
 
a
 
¡ršg
, 
g’”®ly


46 
a
 
	gÚe
.

47 @
·¿m
 
	g©Œibu‹s
: 
AÎow
 
havšg
 
š™Ÿl
 
£t
 
of
 
©Œibu‹s
 
w™hout


48 
ÿÎšg
 
_§ve
 
ÿÎback


50 
T»eNode
.
	$__š™__
(
£lf
, 
Çme
)

51 
£lf
.
_Çme
 = 
§xuts
.
	`uÃsÿ³
(
	$¡r
(
Çme
))

52 
£lf
.
»q
 =„eq

53 
£lf
.
_§ve
 = 
NÚe


54 
£lf
.
_©Œibu‹s
 = {'Çme': s–f.
_Çme
}

55 
key
, 
v®ue
 
š
 
	g©Œibu‹s
.
	$™ems
():

56 
£lf
.
	$£t_©Œibu‹
(
key
, 
v®ue
)

58 
£lf
.
v›wcouÁ
 = 
NÚe


60 
def
 
	$__g‘_v›wcouÁ
(
£lf
):

61 
nÙ
 
£lf
.
v›wcouÁ
 
ªd
 s–f.
	`g‘_Çme
() != "gtg-tags-sep":

62 
ba£Œ“
 = 
£lf
.
»q
.
	$g‘_ba£Œ“
()

63 
£lf
.
v›wcouÁ
 = 
ba£Œ“
.
	`g‘_v›wcouÁ
(£lf.
	`g‘_Çme
(), 
F®£
)

65 
¥_id
 = 
£lf
.
	`g‘_©Œibu‹
("special")

66 
¥_id
 == "all":

67 
·ss


68 
¥_id
 == "notag":

69 
£lf
.
v›wcouÁ
.
	`­¶y_f‹r
('nÙag', 
»äesh
=
F®£
)

70 #NØ
¥ecŸl
 
m—ns
 
a
 
nÜm®
 
g


72 
£lf
.
v›wcouÁ
.
	`­¶y_f‹r
(£lf.
	`g‘_Çme
(), 
»äesh
=
F®£
)

73 
£lf
.
v›wcouÁ
.
	`­¶y_f‹r
('active')

74 
£lf
.
v›wcouÁ
.
	$»gi¡”_şlbck
(
£lf
.
modif›d
)

75  
£lf
.
v›wcouÁ


77 
def
 
	$­¶y_f‹r
(
£lf
, 
f‹ºame
):

78 
£lf
.
v›wcouÁ
:

79 
£lf
.
v›wcouÁ
.
	$­¶y_f‹r
(
f‹ºame
)

81 
def
 
	$uÇµly_f‹r
(
£lf
, 
f‹ºame
):

82 
£lf
.
v›wcouÁ
:

83 
£lf
.
v›wcouÁ
.
	$uÇµly_f‹r
(
f‹ºame
)

85 #Wh’ 
a
 
sk
 
chªge
‡ 
g
, 
we
 
may
 
wªt
 
to
 
mªu®ly
 
upd©e


86 #TØ
’su»
 
th©
 
the
 
sk
 
is
 
w–l
 
couÁed
/
uncouÁed
 th© 
g


87 
def
 
	$upd©e_sk
(
£lf
, 
sk_id
):

88 
vc
 = 
£lf
.
	$__g‘_v›wcouÁ
()

89 
vc
.
	$modify
(
sk_id
)

91 #ov”idšg 
some
 
funùiÚs
 
to
 
nÙ
 
®low
 
dnd
 
of
 
¥ecŸl
 
gs


92 
def
 
	$add_·»Á
(
£lf
, 
·»Á_id
):

93 
p
 = 
£lf
.
»q
.
	$g‘_g
(
·»Á_id
)

94 
p
 
ªd
 
nÙ
 
£lf
.
	$is_¥ecŸl
(è
ªd
 
nÙ
 
p
.
	$is_¥ecŸl
():

95 
T»eNode
.
	$add_·»Á
(
£lf
, 
·»Á_id
)

97 
def
 
	$add_chd
(
£lf
, 
chd_id
):

98 
¥ecŸl_chd
 = 
£lf
.
»q
.
	`g‘_g
(
chd_id
).
	$is_¥ecŸl
()

99 
nÙ
 
£lf
.
	$is_¥ecŸl
(è
ªd
 
nÙ
 
¥ecŸl_chd
:

100 
T»eNode
.
	$add_chd
(
£lf
, 
chd_id
)

102 
def
 
	$g‘_Çme
(
£lf
):

104  
£lf
.
	`g‘_©Œibu‹
("name")

106 
def
 
	$£t_§ve_ÿÎback
(
£lf
, 
§ve
):

107 
£lf
.
_§ve
 = 
§ve


109 
def
 
	$£t_©Œibu‹
(
£lf
, 
©t_Çme
, 
©t_v®ue
):

112 
This
 
wl
 
ÿÎ
 
the
 
C
{
§ve_şlbk
} c®lback…as£dØthcÚ¡ruùÜ.

114 @
·¿m
 
©t_Çme
: 
The
 
Çme
 
of
 
the
 
©Œibu‹
.

115 @
·¿m
 
©t_v®ue
: 
The
 
v®ue
 
of
 
the
 
©Œibu‹
. 
Wl
 
be
 
cÚv”‹d
 
to
 
a


116 
¡ršg
.

118 
modif›d
 = 
F®£


119 
©t_Çme
 == "name":

120 
¿i£
 
KeyE¼Ü
(

122 
–if
 
©t_Çme
 == "parent":

123 
£lf
.
	$add_·»Á
(
©t_v®ue
)

124 
modif›d
 = 
True


126 #A‰ribu‹ 
should
 
®l
 
be
 
¡ršgs
.

127 
v®
 = 
	$¡r
(
©t_v®ue
)

128 
£lf
.
_©Œibu‹s
[
©t_Çme
] = 
v®


129 
£lf
.
_§ve
:

130 
£lf
.
	$_§ve
()

131 
modif›d
 = 
True


132 
modif›d
:

133 
£lf
.
	$modif›d
()

134 
£lf
.
	$nÙify_»Ï‹d_sks
()

136 
def
 
	$g‘_©Œibu‹
(
£lf
, 
©t_Çme
):

139 
R‘uºs
 
C
{
NÚe
} th”i nØ©Œibu‹ m©chšg C{©t_Çme}.

141 
to_»tuº
 = 
NÚe


142 
©t_Çme
 == 'parent':

143 
£lf
.
	$has_·»Á
():

144 
·»Ás_id
 = 
£lf
.
	$g‘_·»Ás
()

145 
	`Ën
(
·»Ás_id
) > 0:

146 
to_»tuº
 = 
	`»duû
(
Ïmbda
 
a
, 
b
: "%s,%s" % (a, b),

147 
·»Ás_id
)

148 
–if
 
©t_Çme
 == 'label':

149 
to_»tuº
 = 
£lf
.
_©Œibu‹s
.
	`g‘
(
©t_Çme
, s–f.
	$g‘_id
())

151 
to_»tuº
 = 
£lf
.
_©Œibu‹s
.
	$g‘
(
©t_Çme
, 
NÚe
)

152  
to_»tuº


154 
def
 
	$d–_©Œibu‹
(
£lf
, 
©t_Çme
):

157 
nÙ
 
©t_Çme
 
š
 
£lf
.
_©Œibu‹s
:

159 
–if
 
©t_Çme
 
š
 ['name', 'parent']:

162 
d–
 
£lf
.
_©Œibu‹s
[
©t_Çme
]

163 
£lf
.
_§ve
:

164 
£lf
.
	$_§ve
()

165 
£lf
.
	$modif›d
()

166 
£lf
.
	$nÙify_»Ï‹d_sks
()

168 
def
 
	$g‘_®l_©Œibu‹s
(
£lf
, 
buŠame
=
F®£
, 
w™h·»Á
=False):

171 @
·¿m
 
buŠame
: 
If
 
True
, 
exşude
 
C
{
Çme
} fromhli¡ oà©Œibu‹

172 
	gÇmes
.

173 @
·¿m
 
	gw™h·»Á
: 
If
 
True
, 
	gthe
 "·»Á" 
©Œibu‹
 
is
 
	g©ched


175 
	g©Œibu‹s
 = 
li¡
(
£lf
.
_©Œibu‹s
.
	$keys
())

176 
buŠame
:

177 
©Œibu‹s
.
	`»move
('name')

178 
w™h·»Á
:

179 
·»Á_id
 = 
£lf
.
	`g‘_©Œibu‹
("parent")

180 
·»Á_id
:

181 
©Œibu‹s
.
	`­³nd
("parent")

182  
©Œibu‹s


184 ###TASK 
»ÏtiÚ
 ####

185 
def
 
	$g‘_aùive_sks_couÁ
(
£lf
):

186 
couÁ
 = 
£lf
.
	$__g‘_couÁ
()

187  
couÁ


189 
def
 
	$g‘_tÙ®_sks_couÁ
(
£lf
):

190  
£lf
.
	$__g‘_couÁ
()

192 
def
 
	$__g‘_couÁ
(
£lf
, 
skŒ“
=
NÚe
):

194 #thi 
m‘hod
 
pu½o£fuÎy
 
dÛ¢
't„ely on get_related_tasks()

195 #which 
dÛs
 
a
 
sim¬
 
job
, 
š
 
Üd”
 
to
 
b’ef™
 
äom
 
libÏrch


197 
vc
 = 
£lf
.
	$__g‘_v›wcouÁ
()

198 
vc
:

199  
vc
.
	$g‘_n_nodes
()

203 
def
 
	$g‘_»Ï‹d_sks
(
£lf
, 
skŒ“
=
NÚe
):

205 
nÙ
 
skŒ“
:

206 
skŒ“
 = 
£lf
.
»q
.
	$g‘_sks_Œ“
()

207 
¥_id
 = 
£lf
.
	`g‘_©Œibu‹
("special")

208 
¥_id
 == "all":

209 
tÜ‘uº
 = 
skŒ“
.
	`g‘_nodes
(
w™hf‹rs
=['active'])

210 
–if
 
¥_id
 == "notag":

211 
tÜ‘uº
 = 
skŒ“
.
	`g‘_nodes
(
w™hf‹rs
=['notag'])

212 
–if
 
¥_id
 == "sep":

213 
tÜ‘uº
 = []

215 
Šame
 = 
£lf
.
	$g‘_Çme
()

216 
tÜ‘uº
 = 
skŒ“
.
	$g‘_nodes
(
w™hf‹rs
=[
Šame
])

217  
tÜ‘uº


219 
def
 
	$nÙify_»Ï‹d_sks
(
£lf
):

221 
sk_id
 
š
 
£lf
.
	$g‘_»Ï‹d_sks
():

222 
my_sk
 = 
£lf
.
»q
.
	$g‘_sk
(
sk_id
)

223 
my_sk
.
	$modif›d
()

225 #i 
™
 
u£ful
 
to
 
k“p
 
the
 
g
 
š
h
g¡Üe
.

226 #ià
no
 
©Œibu‹s
 
ªd
‚Ø
sks
, 
™
 
is
 
nÙ
 
u£ful
.

227 
def
 
	$is_»movabË
(
£lf
):

228 
©Œ
 = 
£lf
.
	$g‘_®l_©Œibu‹s
(
buŠame
=
True
, 
w™h·»Á
=True)

229  (
	`Ën
(
©Œ
è<ğ0 
ªd
 
nÙ
 
£lf
.
	$is_u£d
())

231 
def
 
	$is_¥ecŸl
(
£lf
):

232  
	`boŞ
(
£lf
.
	`g‘_©Œibu‹
('special'))

234 
def
 
	$is_£¬ch_g
(
£lf
):

235  
CÜeCÚfig
.
SEARCH_TAG
 
š
 
£lf
.
	$g‘_·»Ás
()

237 
def
 
	$is_u£d
(
£lf
):

238  
£lf
.
	`g‘_tÙ®_sks_couÁ
() > 0

240 
def
 
	$is_aùiv–y_u£d
(
£lf
):

241  
£lf
.
	$is_£¬ch_g
(è
Ü
 
£lf
.
	$is_¥ecŸl
(è
Ü
\

242 
£lf
.
	`g‘_aùive_sks_couÁ
() > 0

244 
def
 
	$__¡r__
(
£lf
):

245  "Tag: %s" % 
£lf
.
	`g‘_Çme
()

	@core/task.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
	gsk
.
py
 
cÚšs
 
the
 
Task
 
şass
 
which
 
	$»´e£Ás
 (
guess
 
wh©
è
a
 
sk


20 
äom
 
d©‘ime
 
impÜt
 datetime

21 
impÜt
 
cgi


22 
impÜt
 
»


23 
impÜt
 
uuid


24 
impÜt
 
xml
.
dom
.
mšidom


25 
impÜt
 
xml
.
§x
.
§xuts
 
as
 saxutils

27 
äom
 
GTG
 
impÜt
 
_


28 
äom
 
GTG
.
toŞs
.
d©es
 
impÜt
 
D©e


29 
äom
 
GTG
.
toŞs
.
logg”
 
impÜt
 
Log


30 
äom
 
libÏrch
 
impÜt
 
T»eNode


31 
äom
 
GTG
.
toŞs
.
gs
 
impÜt
 
exŒaù_gs_äom_‹xt


34 
şass
 
	$Task
(
T»eNode
):

36 
You
 
should
 
Ãv”
 
ü—‹
 
a
 
Task
 
dœeùly
. 
U£
 
the
 
d©a¡Üe
.
	$Ãw_sk
()

37 
funùiÚ
."""

39 
STA_ACTIVE
 = "Active"

40 
STA_DISMISSED
 = "Dismiss"

41 
STA_DONE
 = "Done"

43 
def
 
	$__š™__
(
£lf
, 
ze_id
, 
»que¡”
, 
Ãwsk
=
F®£
):

44 
T»eNode
.
	$__š™__
(
£lf
, 
ze_id
)

45 #th
id
 
of
 
this
 
sk
 
š
 
the
 
´ojeù
 
should
 
be
 
£t


46 #tid 
is
 
a
 
¡ršg
 ! (
we
 
have
 
to
 
choo£
‡ 
ty³
 
ªd
 
¡ick
Ø
™
)

47 
	`as£¹
(
	$isš¡ªû
(
ze_id
, 
¡r
è
Ü
 
	$isš¡ªû
(
ze_id
, 
¡r
))

48 
£lf
.
tid
 = 
	$¡r
(
ze_id
)

49 
£lf
.
	`£t_uuid
(
uuid
.
	$uuid4
())

50 
£lf
.
»mÙe_ids
 = {
	}
}

51 
£lf
.
cÚ‹Á
 = ""

52 
£lf
.
t™Ë
 = 
_
("My‚ewask")

53 #avaabË 
¡©us
 
¬e
: 
Aùive
 - 
DÚe
 - 
Dismiss
 - 
NÙe


54 
£lf
.
¡©us
 = s–f.
STA_ACTIVE


55 
£lf
.
şo£d_d©e
 = 
D©e
.
	$no_d©e
()

56 
£lf
.
due_d©e
 = 
D©e
.
	$no_d©e
()

57 
£lf
.
¡¬t_d©e
 = 
D©e
.
	$no_d©e
()

58 
£lf
.
ÿn_be_d–‘ed
 = 
Ãwsk


60 
£lf
.
gs
 = []

61 
£lf
.
»q
 = 
»que¡”


62 
£lf
.
__maš_Œ“v›w
 = 
»que¡”
.
	$g‘_maš_v›w
()

63 #Ià
we
 
dÚ
't have‡‚ewtask, we will haveo†oad it.

64 
£lf
.
lßded
 = 
Ãwsk


65 #Should 
nÙ
 
be
 
Ãûs§ry
 
w™h
 
the
 
Ãw
 
back’ds


66 #ià
£lf
.
lßded
:

67 #£lf.
»q
.
	`_sk_lßded
(
£lf
.
tid
)

68 
£lf
.
©Œibu‹s
 = {
	}
}

69 
£lf
.
	$_modif›d_upd©e
()

71 
def
 
	$is_lßded
(
£lf
):

72  
£lf
.
lßded


74 
def
 
	$£t_lßded
(
£lf
, 
sigÇl
=
True
):

75 #avoid 
došg
 
™
 
muÉË
 
times


76 
nÙ
 
£lf
.
lßded
:

77 
£lf
.
lßded
 = 
True


79 
def
 
	$£t_to_k“p
(
£lf
):

80 
£lf
.
ÿn_be_d–‘ed
 = 
F®£


82 
def
 
	$is_Ãw
(
£lf
):

83  
£lf
.
ÿn_be_d–‘ed


85 
def
 
	$g‘_id
(
£lf
):

86  
	$¡r
(
£lf
.
tid
)

88 
def
 
	$£t_uuid
(
£lf
, 
v®ue
):

89 
£lf
.
uuid
 = 
	$¡r
(
v®ue
)

91 
def
 
	$g‘_uuid
(
£lf
):

92 #NOTE: 
T¿ns™iÚ®
 , 
Ãeded
 
to
 
add


93 #th
uuid
 
f›ld
 
to
 
sks
 
ü—‹d
 
befÜe


94 #addšg 
this
 
f›ld
 
to
 
the
 
sk
 
desütiÚ
.

95 
£lf
.
uuid
 == "":

96 
£lf
.
	`£t_uuid
(
uuid
.
	$uuid4
())

97 
£lf
.
	$sync
()

98  
	$¡r
(
£lf
.
uuid
)

100 
def
 
	$g‘_»mÙe_ids
(
£lf
):

102 
A
 
sk
 
usu®ly
 
has
 
a
 
difã»Á
 
id
 
š
 
®l
 
the
 difã»Á 
back’ds
.

103 
This
 
funùiÚ
 
»tuºs
 
a
 
diùiÚ¬y
 
back’d_id
->
the
 
id
h
sk
 
has


104 
š
 
th©
 
back’d


105 @
»tuºs
 
diù
: 
diùiÚ¬y
 
back’d_id
->
sk
 
»mÙe
 
id


107  
£lf
.
»mÙe_ids


109 
def
 
	$add_»mÙe_id
(
£lf
, 
back’d_id
, 
sk_»mÙe_id
):

111 
A
 
sk
 
usu®ly
 
has
 
a
 
difã»Á
 
id
 
š
 
®l
 
the
 difã»Á 
back’ds
.

112 
This
 
funùiÚ
 
adds
 
a
 
»ÏtiÚsh
 
back’d_id
-> 
»mÙe_id
 
th©
 
ÿn
 
be


113 
»Œ›ved
 
usšg
 
g‘_»mÙe_ids


114 @
·¿m
 
back’d_id
: 
¡ršg
 
»´e£Ášg
 
the
 
back’d
 
id


115 @
·¿m
 
sk_»mÙe_id
: 
the
 
id
 
this
 
sk
 
š
h
back’d
 
back’d_id


117 
£lf
.
»mÙe_ids
[
	`¡r
(
back’d_id
)] = 
	$¡r
(
sk_»mÙe_id
)

119 
def
 
	$g‘_t™Ë
(
£lf
):

120  
£lf
.
t™Ë


122 #R‘uº 
True
 
the
 
t™Ë
 
was
 
chªged
.

123 #F®£ 
the
 
t™Ë
 
was
 
®»ady
h
§me
.

124 
def
 
	$£t_t™Ë
(
£lf
, 
t™Ë
):

125 #W
should
 
check
 
Ùh”
 
sk
 
w™h
 
the
 
§me
 
t™Ë


126 #IÀ
th©
 , 
we
 
should
 
add
 
a
 
	`numb”
 (
like
 
Tomboy
 
dÛs
)

127 
Şd_t™Ë
 = 
£lf
.
t™Ë


128 
t™Ë
:

129 
£lf
.
t™Ë
 =™Ë.
	`¡r
('\t\n')

131 
£lf
.
t™Ë
 = "(noitleask)"

132 #Avoid 
uÂeûs§ry
 
sync


133 
£lf
.
t™Ë
 !ğ
Şd_t™Ë
:

134 
£lf
.
	$sync
()

135  
True


137  
F®£


139 #TODOÂ : 
should
 
we
 
m”ge
 
this
 
funùiÚ
 
w™h
 
£t_t™Ë
 ?

140 
def
 
	$£t_com¶ex_t™Ë
(
£lf
, 
‹xt
, 
gs
=[]):

141 
gs
:

142 
	`as£¹
(
	$isš¡ªû
(
gs
[0], 
¡r
))

143 
due_d©e
 = 
D©e
.
	$no_d©e
()

144 
deãr_d©e
 = 
D©e
.
	$no_d©e
()

145 
‹xt
:

146 #G‘ 
gs
 
š
 
the
 
t™Ë


147 
m©ch
 
š
 
	$exŒaù_gs_äom_‹xt
(
‹xt
):

148 
gs
.
	$­³nd
(
m©ch
)

149 #G‘ 
©Œibu‹s


150 
»gexp
 = 
r
'([\s]*)([\w-]+):\s*([^\s]+)'

151 
m©ches
 = 
»
.
	$fšd®l
(
»gexp
, 
‹xt
, 
»
.
UNICODE
)

152 
¥aûs
, 
©Œibu‹
, 
¬gs
 
š
 
m©ches
:

153 
v®id_©Œibu‹
 = 
True


154 
©Œibu‹
.
	$low”
(è
š
 ["gs", 
	`_
("tags"), "tag", _("tag")]:

155 
g
 
š
 
¬gs
.
	`¥l™
(","):

156 
nÙ
 
g
.
	`¡r
(è=ğ"@" 
ªd
‚otag.strip() == "":

157 
nÙ
 
g
.
	`¡¬tsw™h
("@"):

158 
g
 = "@" +ag

159 
gs
.
	$­³nd
(
g
)

160 
–if
 
©Œibu‹
.
	$low”
(è
š
 ["deãr", 
	`_
("defer"), "start",

161 
	`_
("start")]:

162 
Œy
:

163 
deãr_d©e
 = 
D©e
.
	$·r£
(
¬gs
)

164 
exû±
 
V®ueE¼Ü
:

165 
v®id_©Œibu‹
 = 
F®£


166 
–if
 
©Œibu‹
.
	`low”
(è=ğ"due" 
Ü
 \

167 
©Œibu‹
.
	`low”
(è=ğ
	`_
("due"):

168 
Œy
:

169 
due_d©e
 = 
D©e
.
	$·r£
(
¬gs
)

170 
exû±
:

171 
v®id_©Œibu‹
 = 
F®£


173 #©Œibu‹ 
is
 
unknown


174 
v®id_©Œibu‹
 = 
F®£


176 
v®id_©Œibu‹
:

177 #»mov
v®id
 
©Œibu‹
 
äom
 
the
 
sk
 
t™Ë


178 
‹xt
 = \

179 
‹xt
.
	`»¶aû
("%s%s:%s" % (
¥aûs
, 
©Œibu‹
, 
¬gs
), "")

181 
t
 
š
 
gs
:

182 
£lf
.
	$add_g
(
t
)

184 
‹xt
 != "":

185 
£lf
.
	`£t_t™Ë
(
‹xt
.
	$¡r
())

186 
£lf
.
	$£t_to_k“p
()

188 
£lf
.
	$£t_due_d©e
(
due_d©e
)

189 
£lf
.
	$£t_¡¬t_d©e
(
deãr_d©e
)

191 
def
 
	$£t_¡©us
(
£lf
, 
¡©us
, 
dÚed©e
=
NÚe
):

192 
Şd_¡©us
 = 
£lf
.
¡©us


193 
£lf
.
ÿn_be_d–‘ed
 = 
F®£


194 #NØ
Ãed
 
to
 
upd©e
 
chd»n
 
Ü
 
wh©ev”
 
the
 
sk
 
is
 
nÙ
 
lßded


195 
¡©us
 
ªd
 
£lf
.
	$is_lßded
():

196 #w
fœ¡
 
modify
 
the
 
¡©us
 
of
h
chd»n


197 #Ià
DÚe
, 
we
 
£t
 
the
 
dÚe
 
d©e


198 
¡©us
 
š
 [
£lf
.
STA_DONE
, s–f.
STA_DISMISSED
]:

199 
c
 
š
 
£lf
.
	$g‘_subsks
():

200 
c
.
	$g‘_¡©us
(è
š
 [
£lf
.
STA_ACTIVE
]:

201 
c
.
	$£t_¡©us
(
¡©us
, 
dÚed©e
=donedate)

202 #Ià
we
 
m¬k
 
a
 
sk
 
as
 
Aùive
 
ªd
 
th©
 
some
 
·»Á
 
¬e
 
nÙ


203 #Aùive, 
we
  
the
 
·»Á
/
chd
 
»ÏtiÚ


204 #Iˆ
has
 
no
 
£n£
 
to
 
have
 
ª
 
aùive
 
subsk
 
of
 
a
 
dÚe
 
·»Á
.

205 #(
Şd_¡©us
 
check
 
is
 
Ãûs§ry
 
to
 
avoid
 
çl£
 
pos™ive
 
a
 
¡¬t
)

206 
–if
 
¡©us
 
š
 [
£lf
.
STA_ACTIVE
] 
ªd
\

207 
Şd_¡©us
 
š
 [
£lf
.
STA_DONE
, s–f.
STA_DISMISSED
]:

208 
£lf
.
	$has_·»Á
():

209 
p_tid
 
š
 
£lf
.
	$g‘_·»Ás
():

210 
·r
 = 
£lf
.
»q
.
	$g‘_sk
(
p_tid
)

211 
·r
.
	$is_lßded
(è
ªd
 
·r
.
	$g‘_¡©us
(è
š
\

212 [
£lf
.
STA_DONE
, s–f.
STA_DISMISSED
]:

213 #w
ÿn
 
e™h”
  
the
 
·»Á
/
chd
 
»ÏtiÚsh


214 #£lf.
	`»move_·»Á
(
p_tid
)

215 #Ü 
»¡Üe
 
the
 
·»Á
 
too


216 
·r
.
	$£t_¡©us
(
£lf
.
STA_ACTIVE
)

217 #W
dÚt
 
m¬k
 
the
 
chd»n
 
as
 
Aùive
 
beÿu£


218 #They 
might
 
be
 
®»ady
 
com¶‘ed
 
aá”
 
®l


220 #th’ 
the
 
sk
 
™£lf


221 
¡©us
:

222 
£lf
.
¡©us
 = status

224 #S‘ 
şosšg
 
d©e


225 
¡©us
 
ªd
 stu 
š
 [
£lf
.
STA_DONE
, s–f.
STA_DISMISSED
]:

226 #tØ
the
 
¥ecif›d
 
	`d©e
 (
ªy
)

227 
dÚed©e
:

228 
£lf
.
şo£d_d©e
 = 
dÚed©e


229 #Ü 
to
 
today


231 
£lf
.
şo£d_d©e
 = 
D©e
.
	$today
()

232 
£lf
.
	$sync
()

234 
def
 
	$g‘_¡©us
(
£lf
):

235  
£lf
.
¡©us


237 
def
 
	$g‘_modif›d
(
£lf
):

238  
£lf
.
Ï¡_modif›d


240 
def
 
	$g‘_modif›d_¡ršg
(
£lf
):

241  
£lf
.
Ï¡_modif›d
.
	`¡ráime
("%Y-%m-%dT%H:%M:%S")

243 
def
 
	$£t_modif›d
(
£lf
, 
modif›d
):

244 
£lf
.
Ï¡_modif›d
 = 
modif›d


246 
def
 
	$»cursive_sync
(
£lf
):

248 
£lf
.
	$sync
()

249 
sub_id
 
š
 
£lf
.
chd»n
:

250 
sub
 = 
£lf
.
»q
.
	$g‘_sk
(
sub_id
)

251 
sub
.
	$»cursive_sync
()

253 #ABOUT 
DUE
 
DATES


254 #
#PLEASE 
READ
 
THIS
: 
®though
 
sim¶e
 
š
 
­³¬ªû
, 
hªdlšg
 
sk
 
d©es
 
ÿn


255 #aùu®ly 
be
 
sube
. 
Take
 
the
 
time
 
to
 
und”¡ªd
 
this
 
you
 
¶ª
Ø
wÜk


256 #Ú 
the
 
m‘hods
 
b–ow
.

257 #
#Du
d©e
 
is
 
the
 d©
©
 
which
 
a
 
sk
 
mu¡
 
be
 
accom¶ished
. 
CÚ¡¿šts


258 #exi¡ 
b‘w“n
 
a
 
sk
' dud©ªd it ªû¡Ü/chd»n'
s
 
due
 
d©es
.

259 #
#D©
cÚ¡¿šts


260 #
#Tho£ 
¬e
 
the
 
fŞlowšg
:

261 #- 
chd»n
 
of
 
a
 
sk
 
ÿÂÙ
 
have
‡ask 
due
 
d©e
 
th©
 
h­³ns
 
Ï‹r


262 #thª 
the
 
sk
's due date

263 #- 
ªû¡Üs
 
of
 
a
 
sk
 
ÿÂÙ
 
have
‡ 
due
 
th©
 
h­³ns
 
befÜe
 
the


265 #- 
a
 
sk
' ¡¬ˆd©ÿÂÙ h­³ÀÏ‹¸thªhi sk'
s
 
due
 
d©e


266 #
#Task 
w™h
 
undefšed
 
Ü
 
fuzzy
 
due
 
d©es


267 #
#Task 
w™h
 
no
 
due
 
	`d©e
 (="undefšed" 
sks
è
Ü
ask w™h 
fuzzy
 
¡¬t
/due

268 #d©e 
¬e
 
nÙ
 
subjeù
 
to
 
cÚ¡¿šts
. 
Fu¹h”mÜe
, 
they
‡re

269 #"
Œª¥¬’t
". Meaninghathey†ethe constraints coming fromheir

270 #chd»n/
·»Ás
 
·ss
 
through
 
them
. 
So
, 
š¡ªû
, 
a
 
chd»n
 
of


271 #¨
sk
 
w™h
 
ª
 
undefšed
 
Ü
 
fuzzy
ask 
would
 
be
 
cÚ¡¿šed
 
by
 
this


272 #Ï‰” 
sk
's‡ncestors. Equally,he‡n‡ncestor fromhe same

273 #undefšed/
fuzzy
 
sk
 
would
 
be
 
cÚ¡¿šed
 
by
 
the
 
chd»n
 
due
 
d©es
.

274 #
#Upd©šg 
a
 
sk
 
due
 
d©e


275 #
#Wh’ev” 
a
 
sk
 
due
 
d©e
 
is
 
chªged
, 
®l
 
ªû¡Ü
/
chld»n
 
of
 
this
ask

276 #*
mu¡
* 
be
 
upd©ed
 
accÜdšg
 
to
 
the
 
cÚ¡¿ššg
 
ruËs
. 
As
 
§id
 
above
,

277 #cÚ¡¿št 
mu¡
 
go
 
through
 
sks
 
w™h
 
undefšed
/
fuzzy
 
due
 
d©es
 
too
!

278 #
#Undefšed/
fuzzy
 
sk
 
d©es
 
¬e
 
NEVER
 
to
 
be
 
upd©ed
. 
They
‡» 
nÙ


279 #£ns™iv
to
 
cÚ¡¿št
. 
If
 
you
 
wªt
Ø
now
 
wh©
 cÚ¡¿šˆ
th”e
 
is


280 #Ú 
this
 
sk
's due datehough, you can obtain it by using

281 #g‘_due_d©e_cÚ¡¿šˆ
m‘hod
.

282 
def
 
	$£t_due_d©e
(
£lf
, 
Ãw_dued©e
):

285 
def
 
	$__g‘_defšed_·»Á_li¡
(
sk
):

287 
which
 
is
 
nÙ
 
fuzzy
"""

288 
·»Á_li¡
 = []

289 
·r_id
 
š
 
sk
.
·»Ás
:

290 
·r
 = 
£lf
.
»q
.
	$g‘_sk
(
·r_id
)

291 
·r
.
	`g‘_due_d©e
().
	$is_fuzzy
():

292 
·»Á_li¡
 +ğ
	$__g‘_defšed_·»Á_li¡
(
·r
)

294 
·»Á_li¡
.
	$­³nd
(
·r
)

295  
·»Á_li¡


297 
def
 
	$__g‘_defšed_chd_li¡
(
sk
):

299 
due
 
d©e
 
which
 
is
 
nÙ
 
fuzzy
"""

300 
chd_li¡
 = []

301 
chd_id
 
š
 
sk
.
chd»n
:

302 
chd
 = 
£lf
.
»q
.
	$g‘_sk
(
chd_id
)

303 
chd
.
	`g‘_due_d©e
().
	$is_fuzzy
():

304 
chd_li¡
 +ğ
	$__g‘_defšed_chd_li¡
(
chd
)

306 
chd_li¡
.
	$­³nd
(
chd
)

307  
chd_li¡


309 
Şd_due_d©e
 = 
£lf
.
due_d©e


310 
Ãw_dued©e_obj
 = 
	$D©e
(
Ãw_dued©e
è#ÿchšg 
the
 
cÚv”siÚ


311 
£lf
.
due_d©e
 = 
Ãw_dued©e_obj


312 #Ià
the
 
Ãw
 
d©e
 
is
 
fuzzy
 
Ü
 
undefšed
, 
we
 
dÚ
't update„elatedasks

313 
nÙ
 
Ãw_dued©e_obj
.
	$is_fuzzy
():

314 #ià
the
 
sk
's start date happens†aterhanhe

315 #Ãw 
due
 
d©e
, 
we
 
upd©e
 
	`™
 (
exû±
 
fuzzy
 
d©es
)

316 
nÙ
 
£lf
.
	`g‘_¡¬t_d©e
().
	$is_fuzzy
(è
ªd
 \

317 
£lf
.
	`g‘_¡¬t_d©e
(è> 
Ãw_dued©e_obj
:

318 
£lf
.
	$£t_¡¬t_d©e
(
Ãw_dued©e
)

319 #ià
some
 
ªû¡Üs
' dud©e h­³ÀbefÜthsk'
s
 
Ãw


320 #du
d©e
, 
we
 
upd©e
 
	`them
 (
exû±
 
fuzzy
 
d©es
)

321 
·r
 
š
 
	$__g‘_defšed_·»Á_li¡
(
£lf
):

322 
·r
.
	`g‘_due_d©e
(è< 
Ãw_dued©e_obj
:

323 
·r
.
	$£t_due_d©e
(
Ãw_dued©e
)

324 #w
mu¡
 
­¶y
 
the
 
cÚ¡¿šts
 
to
h
defšed
 & 
nÚ
-
fuzzy
 
chd»n


325 #a 
w–l


326 
sub
 
š
 
	$__g‘_defšed_chd_li¡
(
£lf
):

327 
sub_dued©e
 = 
sub
.
	$g‘_due_d©e
()

328 #ià
the
 
chd
' dud©h­³n Ï‹¸thªhsk'
s
: 
we


329 #upd©
™
 
to
 
the
 
sk
's‚ew due date

330 
sub_dued©e
 > 
Ãw_dued©e_obj
:

331 
sub
.
	$£t_due_d©e
(
Ãw_dued©e
)

332 #ià
the
 
chd
's start date happens†aterhan

333 #th
sk
's‚ew due date, we update it

334 #(
exû±
 
fuzzy
 
¡¬t
 
d©es
)

335 
sub_¡¬td©e
 = 
sub
.
	$g‘_¡¬t_d©e
()

336 
nÙ
 
sub_¡¬td©e
.
	$is_fuzzy
(è
ªd
 \

337 
sub_¡¬td©e
 > 
Ãw_dued©e_obj
:

338 
sub
.
	$£t_¡¬t_d©e
(
Ãw_dued©e
)

339 #Ià
the
 
d©e
 
chªged
, 
we
 
nÙify
h
chªge
 th
chd»n
 
sšû
he

340 #cÚ¡¿št 
might
 
have
 
chªged


341 
Şd_due_d©e
 !ğ
Ãw_dued©e_obj
:

342 
£lf
.
	$»cursive_sync
()

344 
def
 
	$g‘_due_d©e
(
£lf
):

346  
£lf
.
due_d©e


348 
def
 
	$g‘_urg’t_d©e
(
£lf
):

351 
urg_d©e
 = 
£lf
.
due_d©e


352 
sub
 
š
 
£lf
.
	$g‘_subsks
():

353 
sub_urg_d©e
 = 
sub
.
	$g‘_urg’t_d©e
()

354 
urg_d©e
 >ğ
sub_urg_d©e
:

355 
urg_d©e
 = 
sub_urg_d©e


356  
urg_d©e


358 
def
 
	$g‘_due_d©e_cÚ¡¿št
(
£lf
):

360 
·»Ás
' due dates. Return Date.no_date() if‚o constraint

361 
is
 
­¶›d
. """

362 #Check 
out
 
cÚ¡¿šts
 
d•’dšg
 
Ú
 
d©e
 
defš™iÚ
/
fuzzšess
.

363 
¡rÚge¡_cÚ¡_d©e
 = 
£lf
.
due_d©e


364 
¡rÚge¡_cÚ¡_d©e
.
	$is_fuzzy
():

365 
·r_id
 
š
 
£lf
.
·»Ás
:

366 
·r
 = 
£lf
.
»q
.
	$g‘_sk
(
·r_id
)

367 
·r_dued©e
 = 
·r
.
	$g‘_due_d©e
()

368 #ià
·»Á
 
d©e
 
is
 
undefšed
 
Ü
 
fuzzy
, 
look
 
fu¹h”
 
up


369 
·r_dued©e
.
	$is_fuzzy
():

370 
·r_dued©e
 = 
·r
.
	$g‘_due_d©e_cÚ¡¿št
()

371 #ià
·r_dued©e
 
is
 
¡l
 
undefšed
/
fuzzy
, 
®l
 
·»Ás
' due

372 #d©e 
¬e
 
undefšed
 
Ü
 
fuzzy
: 
¡rÚge¡_cÚ¡_d©e
 
is
 
th’


373 #th
be¡
 
choiû
 
so
 
çr
, 
we
 
dÚ
't update it.

374 
·r_dued©e
.
	$is_fuzzy
():

376 #·r_dued©
is
 
nÙ
 
undefšed
/
fuzzy
. 
If
 
¡rÚge¡_cÚ¡_d©e


377 #i 
¡l
 
undefšed
 
Ü
 
fuzzy
, 
·»Á_dued©e
 
is
 
the
 
be¡


379 
¡rÚge¡_cÚ¡_d©e
.
	$is_fuzzy
():

380 
¡rÚge¡_cÚ¡_d©e
 = 
·r_dued©e


382 #¡rÚge¡_cÚ¡_d©
ªd
 
·r_d©e
 
¬e
 
defšed
‡nd 
nÙ
 
fuzzy
:

383 #w
com·»
 
the
 
d©es


384 
·r_dued©e
 < 
¡rÚge¡_cÚ¡_d©e
:

385 
¡rÚge¡_cÚ¡_d©e
 = 
·r_dued©e


386  
¡rÚge¡_cÚ¡_d©e


388 #ABOUT 
START
 
DATE


389 #
#S¹ 
d©e
 
is
 
the
 d©
©
 
which
h
u£r
 
has
 
decided
 
to
 
wÜk
 
Ü
 
cÚsid”


390 #wÜkšg 
Ú
 
this
 
sk
.

391 #
#Th
Úly
 
cÚ¡¿št
 
­¶›d
 
to
 
¡¬t
 
d©es
 
is
 
th©
 s¹ d©e 
ÿÂÙ


392 #h­³À
Ï‹r
 
thª
 
the
 
sk
 
due
 
d©e
.

393 #
#Th
sk
 
due
 
	`d©e
 (
ªd
 
ªy
 
cÚ¡¿šed
 
»Ïtives
è
is
 
upd©ed
 
a
 
Ãw


394 #sk 
¡¬t
 
d©e
 
is
 
cho£n
 
th©
 
dÛs
 
nÙ
 
»¥eù
 
this
 
ruË
.

395 #
#Undefšed/
fizzy
 
¡¬t
 
d©es
 
dÚ
't constraintheask due date.

396 
def
 
	$£t_¡¬t_d©e
(
£lf
, 
fuÎd©e
):

397 
£lf
.
¡¬t_d©e
 = 
	$D©e
(
fuÎd©e
)

398 
nÙ
 
	`D©e
(
fuÎd©e
).
	$is_fuzzy
(è
ªd
 \

399 
nÙ
 
£lf
.
due_d©e
.
	$is_fuzzy
(è
ªd
 \

400 
	`D©e
(
fuÎd©e
è> 
£lf
.
due_d©e
:

401 
£lf
.
	$£t_due_d©e
(
fuÎd©e
)

402 
£lf
.
	$sync
()

404 
def
 
	$g‘_¡¬t_d©e
(
£lf
):

405  
£lf
.
¡¬t_d©e


407 #ABOUT 
CLOSED
 
DATE


408 #
#Clo£d 
d©e
 
is
 
the
 d©
©
 
which
h
sk
 
has
 
b“n
 
	`şo£d
 (
dÚe
 
Ü


409 #dismis£d). 
Clo£d
 
d©e
 
is
 
nÙ
 
cÚ¡¿šed
 
ªd
 
dÛ¢
't constrain other

411 
def
 
	$£t_şo£d_d©e
(
£lf
, 
fuÎd©e
):

412 
£lf
.
şo£d_d©e
 = 
	$D©e
(
fuÎd©e
)

413 
£lf
.
	$sync
()

415 
def
 
	$g‘_şo£d_d©e
(
£lf
):

416  
£lf
.
şo£d_d©e


418 
def
 
	$g‘_days_Ëá
(
£lf
):

419  
£lf
.
	`g‘_due_d©e
().
	$days_Ëá
()

421 
def
 
	$g‘_days_Ï‹
(
£lf
):

422 
due_d©e
 = 
£lf
.
	$g‘_due_d©e
()

423 
due_d©e
 =ğ
D©e
.
	$no_d©e
():

424  
NÚe


425 
şo£d_d©e
 = 
£lf
.
	$g‘_şo£d_d©e
()

426  (
şo£d_d©e
 - 
due_d©e
).
days


428 
def
 
	$g‘_‹xt
(
£lf
):

430 
£lf
.
cÚ‹Á
:

431  
	$¡r
(
£lf
.
cÚ‹Á
)

435 
def
 
	$g‘_exû½t
(
£lf
, 
lšes
=0, =0, 
¡r_gs
=
F®£
,

436 
¡r_subsks
=
True
):

438 
g‘_exû½t
  
the
 
begšnšg
 
of
h
cÚ‹Á
 oàth
sk
.

439 
If
 "lšes" 
is
 
´ovided
 
ªd
 
difã»Á
 
thª
 0, 
™
  
the
 
numb”
 
X


440 
of
 
	$lše
 (
Ü
 
the
 
whŞe
 
cÚ‹Á
 
™
 
cÚšs
 
Ëss
 
lšes
)

441 
If
 "ch¬" 
is
 
´ovided
, 
™
 
»tuºs
 
the
 
X
 
fœ¡
 
ch¬s
 
of
 
	$cÚ‹Á
 (
Ü
 
the


442 
whŞe
 
cÚ‹Ás
 
™
 
cÚšs
 
Ëss
 )

443 
If
 
bÙh
 
ªd
 
lšes
 
¬e
 
´ovided
, 
the
 
shÜ‹r
 
Úe
 
is
 
»tuºed
.

444 
If
 
nÚe
 
of
 
them
 
¬e
 
	`´ovided
 (
Ü
 
they
‡» 0), 
this
 
funùiÚ
 
is


445 
equiv®’t
 
to
 
g‘_‹xt
 
w™h
 w™h 
®l
 
XML
 
¡r³d
 
down
.

446 
W¬nšg
: 
®l
 
m¬kup
 
šfÜm©iÚs
 
¬e
 
¡r³d
 
down
. 
Em±y
 
lšes
‡re

447 
®so
 
»moved


449 #deãnsiv
´og¿mm©iÚ
 
to
 
avoid
 
»tuºšg
 
NÚe


450 
£lf
.
cÚ‹Á
:

451 
txt
 = 
£lf
.
cÚ‹Á


452 
¡r_gs
:

453 
g
 
š
 
£lf
.
	$g‘_gs_Çme
():

454 
txt
 = 
£lf
.
	$_¡r_g
(
txt
, 
g
)

455 
–em’t
 = 
xml
.
dom
.
mšidom
.
	$·r£SŒšg
(
txt
)

456 
txt
 = 
£lf
.
	$__¡r_cÚ‹Á
(
–em’t
, 
¡r_subsks
=strip_subtasks)

457 
txt
 =xt.
	$¡r
()

458 #W
k“p
 
the
 
desœed
 
numb”
 
of
 
lšes


459 
lšes
 > 0:

460 
li¡e
 = 
txt
.
	$¥l™lšes
()

461 
i
 
š
 
li¡e
:

462 
i
.
	`¡r
() == "":

463 
li¡e
.
	$»move
(
i
)

464 
to_k“p
 = 
li¡e
[:
lšes
]

465 
txt
 = '\n'.
	$još
(
to_k“p
)

466 #W
k“p
 
the
 
desœed
 
numb”
 
of
 

468 
txt
 =xt[:]

469  
txt


473 
def
 
	$__¡r_cÚ‹Á
(
£lf
, 
–em’t
, 
¡r_subsks
=
F®£
):

474 
txt
 = ""

475 
–em’t
:

476 
n
 
š
 
–em’t
.
chdNodes
:

477 
n
.
nodeTy³
 =ğn.
ELEMENT_NODE
:

478 
¡r_subsks
 
ªd
 
n
.
gName
 == 'subtask':

479 
txt
[-2:] == 'â†’ ':

480 
txt
 =xt[:-2]

482 
txt
 +ğ
£lf
.
	$__¡r_cÚ‹Á
(
n
, 
¡r_subsks
)

483 
–if
 
n
.
nodeTy³
 =ğn.
TEXT_NODE
:

484 
txt
 +ğ
n
.
nodeV®ue


485  
txt


487 
def
 
	$£t_‹xt
(
£lf
, 
‹x‹
):

488 
£lf
.
ÿn_be_d–‘ed
 = 
F®£


489 
‹x‹
 != "<content/>":

490 #deãnsiv
´og¿mm©iÚ
 
to
 
f‹r
 
bad
 
fÜm©‹d
 
sks


491 
nÙ
 
‹x‹
.
	`¡¬tsw™h
("<content>"):

492 
‹x‹
 = 
cgi
.
	$esÿ³
(
‹x‹
, 
quÙe
=
True
)

493 
‹x‹
 = "<content>%s" %exte

494 
nÙ
 
‹x‹
.
	`’dsw™h
("</content>"):

495 
‹x‹
 = "%s</content>" %exte

496 
£lf
.
cÚ‹Á
 = 
	$¡r
(
‹x‹
)

498 
£lf
.
cÚ‹Á
 = ''

500 ###SUBTASKS #############################################################
#
‚ew_subsk(£lf):

502 
a
 
subsk


504 
subt
 = 
£lf
.
»q
.
	$Ãw_sk
(
Ãwsk
=
True
)

505 #w
u£
 
the
 
šh”™ed
 
chd»ns


506 
£lf
.
	`add_chd
(
subt
.
	$g‘_id
())

507  
subt


509 
def
 
	$add_chd
(
£lf
, 
tid
):

512 @
·¿m
 
chd
: 
the
 
added
 
sk


514 
Log
.
	`debug
("addšg chd % tØsk %s" % (
tid
, 
£lf
.
	$g‘_id
()))

515 
£lf
.
ÿn_be_d–‘ed
 = 
F®£


516 #th
cÜe
 
of
 
the
 
m‘hod
 
is
 
š
h
T»eNode
 
objeù


517 
T»eNode
.
	$add_chd
(
£lf
, 
tid
)

518 #now 
we
 
£t
 
šh”™ed
 
©Œibu‹s
 
Úly
 
™
's‡‚ewask

519 
chd
 = 
£lf
.
»q
.
	$g‘_sk
(
tid
)

520 
£lf
.
	$is_lßded
(è
ªd
 
chd
‡nd chd.
ÿn_be_d–‘ed
:

521 
chd
.
	`£t_¡¬t_d©e
(
£lf
.
	$g‘_¡¬t_d©e
())

522 
chd
.
	`£t_due_d©e
(
£lf
.
	$g‘_due_d©e
())

523 
t
 
š
 
£lf
.
	$g‘_gs
():

524 
chd
.
	`add_g
(
t
.
	$g‘_Çme
())

525 
£lf
.
	$sync
()

526  
True


528 
def
 
	$»move_chd
(
£lf
, 
tid
):

531 @
·¿m
 
tid
: 
the
 
ID
 
of
h
sk
 
to
 
»move


533 
c
 = 
£lf
.
»q
.
	$g‘_sk
(
tid
)

534 
c
.
	`»move_·»Á
(
£lf
.
	$g‘_id
())

535 
c
.
ÿn_be_d–‘ed
:

536 
£lf
.
»q
.
	$d–‘e_sk
(
tid
)

537 
£lf
.
	$sync
()

538  
True


540  
F®£


542 #FIXME: 
»move
 
this
 
funùiÚ
 
ªd
 
u£
 
libÏrch
 
š¡—d
.

543 
def
 
	$g‘_subsks
(
£lf
):

544 
Œ“
 = 
£lf
.
	$g‘_Œ“
()

545  [
Œ“
.
	$g‘_node
(
node_id
ènode_id 
š
 
£lf
.
	`g‘_chd»n
()]

547 #FIXME : 
why
 
is
 
this
 
funùiÚ
 
u£d
 ? 
It
's higly specific. Remove it?

548 #(
LiÚ–
)

549 #Ag»ed. 
™
's only used byhe "addago‡ll subtasks" widget.

550 
def
 
	$g‘_£lf_ªd_®l_subsks
(
£lf
, 
aùive_Úly
=
F®£
, 
sks
=[]):

551 
	`´št
("DEPRECATED FUNCTION: get_self_and_all_subtasks")

552 
sks
.
	$­³nd
(
£lf
)

553 
tid
 
š
 
£lf
.
	$g‘_chd»n
():

554 
i
 = 
£lf
.
»q
.
	$g‘_sk
(
tid
)

555 
i
:

556 
nÙ
 
aùive_Úly
 
Ü
 
i
.
¡©us
 =ğ
£lf
.
STA_ACTIVE
:

557 
i
.
	$g‘_£lf_ªd_®l_subsks
(
aùive_Úly
, 
sks
)

558  
sks


560 
def
 
	$g‘_subsk
(
£lf
, 
tid
):

561 #FIXMEÂ : 
»move
 
this
 
funùiÚ
. 
This
 
is
 
nÙ
 
u£ful


562 
	`´št
("DEPRECATED: get_subtask")

565 @
·¿m
 
tid
: 
the
 
ID
 
of
h
sk
 
to
 .

567  
£lf
.
»q
.
	$g‘_sk
(
tid
)

569 
def
 
	$£t_·»Á
(
£lf
, 
·»Á_id
):

571 
T»eNode
.
	$£t_·»Á
(
£lf
, 
·»Á_id
)

572 
·»Á_id
 
is
 
nÙ
 
NÚe
:

573 
·r
 = 
£lf
.
»q
.
	$g‘_sk
(
·»Á_id
)

574 
·r_dued©e
 = 
·r
.
	$g‘_due_d©e_cÚ¡¿št
()

575 
nÙ
 
·r_dued©e
.
	$is_fuzzy
(è
ªd
 \

576 
nÙ
 
£lf
.
due_d©e
.
	$is_fuzzy
(è
ªd
 \

577 
·r_dued©e
 < 
£lf
.
due_d©e
:

578 
£lf
.
	$£t_due_d©e
(
·r_dued©e
)

579 
£lf
.
	$»cursive_sync
()

581 
def
 
	`£t_©Œibu‹
(
£lf
, 
©t_Çme
, 
©t_v®ue
, 
Çme¥aû
=""):

584 @
·¿m
 
©t_Çme
: 
The
 
Çme
 
of
 
the
 
©Œibu‹
.

585 @
·¿m
 
©t_v®ue
: 
The
 
v®ue
 
of
 
the
 
©Œibu‹
. 
Wl
 
be
 
cÚv”‹d
 
to
 
a


586 
¡ršg
.

588 
v®
 = 
	$¡r
(
©t_v®ue
)

589 
£lf
.
©Œibu‹s
[(
Çme¥aû
, 
©t_Çme
)] = 
v®


590 
£lf
.
	$sync
()

592 
def
 
	`g‘_©Œibu‹
(
£lf
, 
©t_Çme
, 
Çme¥aû
=""):

595 
R‘uºs
 
C
{
NÚe
} th”i nØ©Œibu‹ m©chšg C{©t_Çme}.

597  
£lf
.
©Œibu‹s
.
g‘
((
Çme¥aû
, 
©t_Çme
), 
NÚe
)

599 
def
 
	$sync
(
£lf
):

600 
£lf
.
	$_modif›d_upd©e
()

601 
£lf
.
	$is_lßded
():

602 #Thi 
is
 
a
 
libÏrch
 
ÿÎ
 
to
 
the
 
T»eNode
 
ªû¡Ü


603 
£lf
.
	$modif›d
()

604  
True


606  
F®£


608 
def
 
	$_modif›d_upd©e
(
£lf
):

610 
Upd©es
 
the
 
modif›d
 
time¡amp


612 
£lf
.
Ï¡_modif›d
 = 
d©‘ime
.
	$now
()

614 ###TAG 
FUNCTIONS
 ############################################################

615 #
 g‘_gs_Çme(£lf):

616 #R‘uº 
a
 
cİy
 
of
 
the
 
li¡
 oà
gs
. 
NÙ
h
Üigš®
 
objeù
.

617  
	$li¡
(
£lf
.
gs
)

619 #»tuº 
a
 
cİy
 
of
 
the
 
li¡
 oà
g
 
objeùs


620 
def
 
	$g‘_gs
(
£lf
):

621 
l
 = []

622 
Šame
 
š
 
£lf
.
gs
:

623 
g
 = 
£lf
.
»q
.
	$g‘_g
(
Šame
)

624 
nÙ
 
g
:

625 
g
 = 
£lf
.
»q
.
	$Ãw_g
(
Šame
)

626 
l
.
	$­³nd
(
g
)

627  
l


629 
def
 
	$»Çme_g
(
£lf
, 
Şd
, 
Ãw
):

630 
eŞd
 = 
§xuts
.
	`esÿ³
(§xuts.
	$uÃsÿ³
(
Şd
))

631 
’ew
 = 
§xuts
.
	`esÿ³
(§xuts.
	$uÃsÿ³
(
Ãw
))

632 
£lf
.
cÚ‹Á
 = s–f.cÚ‹Á.
	$»¶aû
(
eŞd
, 
’ew
)

633 
Şdt
 = 
£lf
.
»q
.
	$g‘_g
(
Şd
)

634 
£lf
.
	$»move_g
(
Şd
)

635 
Şdt
.
	$modif›d
()

636 
£lf
.
	$g_added
(
Ãw
)

637 
£lf
.
»q
.
	`g‘_g
(
Ãw
).
	$modif›d
()

638 
£lf
.
	$sync
()

640 
def
 
	$g_added
(
£lf
, 
gÇme
):

642 
Adds
 
a
 
g
. 
DÛs
 
nÙ
 
add
 '@g' 
to
 
the
 
cÚ‹Ás
. 
S“
 
add_g


644 #DØ
nÙ
 
add
 
the
 
§me
 
g
 
twiû


645 
nÙ
 
gÇme
 
š
 
£lf
.
gs
:

646 
£lf
.
gs
.
	$­³nd
(
gÇme
)

647 
£lf
.
	$is_lßded
():

648 
chd
 
š
 
£lf
.
	$g‘_subsks
():

649 
chd
.
ÿn_be_d–‘ed
:

650 
chd
.
	$add_g
(
gÇme
)

652 
g
 = 
£lf
.
»q
.
	$g‘_g
(
gÇme
)

653 
nÙ
 
g
:

654 
g
 = 
£lf
.
»q
.
	$Ãw_g
(
gÇme
)

655 
g
.
	$modif›d
()

656  
True


658 
def
 
	$add_g
(
£lf
, 
gÇme
):

660 
£lf
.
	$g_added
(
gÇme
):

661 
c
 = 
£lf
.
cÚ‹Á


663 #¡r <
cÚ‹Á
>...</cÚ‹Á> 
gs


664 
c
.
	`¡¬tsw™h
('<content>'):

665 
c
 = c[
	`Ën
('<content>'):]

666 
c
.
	`’dsw™h
('</content>'):

667 
c
 = c[:-
	`Ën
('</content>')]

669 
nÙ
 
c
:

670 #dÚ'ˆÃed‡ s•¬©Ü ià™'
s
 
the
 
Úly
 
‹xt


671 
£p
 = ''

672 
–if
 
c
.
	`¡¬tsw™h
('<tag>'):

673 #ià
cÚ‹Á
 
¡¬ts
 
w™h
 
a
 
g
, 
make
‡ 
comma
-
£·¿‹d
 
li¡


674 
£p
 = ', '

676 #Ùh” 
‹xt
 
©
 
the
 
begšnšg
, 
so
 
put
h
g
 
Ú
 
™s
 
own
 
lše


677 
£p
 = '\n\n'

679 
£lf
.
cÚ‹Á
 = "<content><tag>%s</tag>%s%s</content>" % (

680 
cgi
.
	`esÿ³
(
gÇme
), 
£p
, 
c
)

681 #w
modify
 
the
 
sk
 
š‹º®
 
¡©e
, 
thus
 
we
 
have
 
to
 
ÿÎ
 
a


683 
£lf
.
	$sync
()

685 #»mov
by
 
gÇme


686 
def
 
	$»move_g
(
£lf
, 
gÇme
):

687 
modif›d
 = 
F®£


688 
gÇme
 
š
 
£lf
.
gs
:

689 
£lf
.
gs
.
	$»move
(
gÇme
)

690 
modif›d
 = 
True


691 
chd
 
š
 
£lf
.
	$g‘_subsks
():

692 
chd
.
ÿn_be_d–‘ed
:

693 
chd
.
	$»move_g
(
gÇme
)

694 
£lf
.
cÚ‹Á
 = s–f.
	$_¡r_g
(
£lf
.
cÚ‹Á
, 
gÇme
)

695 
£lf
.
	$sync
()

696 
modif›d
:

697 
g
 = 
£lf
.
»q
.
	$g‘_g
(
gÇme
)

698 #Th
V›wCouÁ
 
of
 
the
 
g
 
¡l
 
dÛ¢
't knowhat

699 #th
sk
 
was
 
»moved
. 
We
 
Ãed
 
to
 
upd©e
 
mªu®ly


700 
g
.
	`upd©e_sk
(
£lf
.
	$g‘_id
())

701 
g
:

702 
g
.
	$modif›d
()

704 
def
 
	$£t_Úly_the£_gs
(
£lf
, 
gs_li¡
):

706 
Giv’
 
a
 
li¡
 
of
 
¡ršgs
 
»´e£Ášg
 
gs
, 
™
 
makes
 
su»
 
th©


707 
this
 
sk
 
has
 
tho£
 
ªd
 
Úly
ho£ 
gs
.

709 
g
 
š
 
£lf
.
	$g‘_gs_Çme
():

710 
Œy
:

711 
gs_li¡
.
	$»move
(
g
)

712 
exû±
:

713 
£lf
.
	$»move_g
(
g
)

714 
g
 
š
 
gs_li¡
:

715 
£lf
.
	$add_g
(
g
)

717 
def
 
	`_¡r_g
(
£lf
, 
‹xt
, 
gÇme
, 
Ãwg
=''):

718 
šlše_g
 = 
gÇme
[1:]

719  (
‹xt


720 .
	`»¶aû
('<g>%s</g>\n\n' % (
gÇme
), 
Ãwg
è#Œa \
n


721 #Œa 
comma


722 .
	`»¶aû
('<g>%s</g>, ' % (
gÇme
), 
Ãwg
)

723 .
	`»¶aû
('<g>%s</g>,' % (
gÇme
), 
šlše_g
)

724 .
	`»¶aû
('<g>%s</g>' % (
gÇme
), 
šlše_g
)

725 #š 
XML
 
is
 
	`missšg
 (
bug
 #504899)

726 .
	`»¶aû
('%s\n\n' % (
gÇme
), 
Ãwg
)

727 .
	`»¶aû
('%s, ' % (
gÇme
), 
Ãwg
)

728 .
	`»¶aû
('%s,' % (
gÇme
), 
šlše_g
)

730 .
	`»¶aû
('%s' % (
gÇme
), 
šlše_g
))

732 #g_li¡ 
is
 
a
 
li¡
 
of
 
gs
 
Çmes


733 #»tuº 
Œue
 
©
 
Ëa¡
 
Úe
 
of
 
the
 
li¡
 
is
 
š
h
sk


734 
def
 
	$has_gs
(
£lf
, 
g_li¡
=
NÚe
, 
nÙag_Úly
=
F®£
):

735 #»cursiv
funùiÚ
 
to
 
ex¶Üe
 
the
 
gs
 
ªd
 
™s
 
chd»n


736 
def
 
	$chd»n_g
(
gÇme
):

737 
tÜ‘uº
 = 
F®£


738 
gÇme
 
š
 
£lf
.
gs
:

739 
tÜ‘uº
 = 
True


741 
g
 = 
£lf
.
»q
.
	$g‘_g
(
gÇme
)

742 
gc_Çme
 
š
 
g
.
	$g‘_chd»n
():

743 
nÙ
 
tÜ‘uº
:

744 
tÜ‘uº
 = 
	$chd»n_g
(
gc_Çme
)

745  
tÜ‘uº


747 #W
wªt
 
to
 
£e
 
the
 
sk
 
has
 
no
 
gs


748 
tÜ‘uº
 = 
F®£


749 
nÙag_Úly
:

750 
tÜ‘uº
 = 
£lf
.
gs
 == []

751 #H”e, 
the
 
u£r
 
ask
 th"em±y" 
g


752 #And 
vœtu®ly
 
ev”y
 
sk
 
has
 
™
.

753 
–if
 
g_li¡
 =ğ[] 
Ü
ag_li¡ 
is
 
NÚe
:

754 
tÜ‘uº
 = 
True


755 
–if
 
g_li¡
:

756 
gÇme
 
š
 
g_li¡
:

757 
nÙ
 
tÜ‘uº
:

758 
tÜ‘uº
 = 
	$chd»n_g
(
gÇme
)

760 #W–l, 
we
 
dÚ
'ˆf‹¸Úag Ü‚Ùag, it'
s
 
Œue
, 
of
 
cour£


761 
tÜ‘uº
 = 
True


762  
tÜ‘uº


764 
def
 
	$__¡r__
(
£lf
):

765 
s
 = ""

766 
s
 = s + "Task Object\n"

767 
s
 = s + "T™Ë: " + 
£lf
.
t™Ë
 + "\n"

768 
s
 = s + "Id: " + 
£lf
.
tid
 + "\n"

769 
s
 = s + "Stus: " + 
£lf
.
¡©us
 + "\n"

770 
s
 = s + "Tags: " + 
	$¡r
(
£lf
.
gs
)

771  
s


	@core/treefactory.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
d©‘ime
 
impÜt
 datetime

19 
äom
 
GTG
 
impÜt
 
_


20 
äom
 
libÏrch
 
impÜt
 
T»e


21 
äom
 
	gGTG
.
	gcÜe
.
sk
 
impÜt
 
Task


22 
äom
 
	gGTG
.
	gcÜe
.
g
 
impÜt
 
Tag


23 
äom
 
	gGTG
.
cÜe
 
impÜt
 
CÜeCÚfig


24 
äom
 
	gGTG
.
	gcÜe
.
£¬ch
 
impÜt
 
£¬ch_f‹r


25 
äom
 
	gGTG
.
	gtoŞs
.
d©es
 
impÜt
 
D©e


28 
şass
 
	gT»eFaùÜy
:

30 
def
 
	$__š™__
(
£lf
):

31 #K“°
the
 
Œ“
 
š
 
memÜy
 
jus
 iÀ
we
 
have
 
to
 
u£
 
™
 
f‹rs
.

32 
£lf
.
skŒ“
 = 
NÚe


33 
£lf
.
gŒ“
 = 
NÚe


35 
def
 
	$g‘_sks_Œ“
(
£lf
):

37 
šşudšg
  
f‹rs


38 
FÜ
 
gs
, 
f‹r
 
¬e
 
dyÇmiÿÎy
 
ü—‹d
 
©
 
Tag
 
š£¹iÚ
.

40 
skŒ“
 = 
	$T»e
()

41 
f_dic
 = {

42 'wÜkv›w': [
£lf
.
wÜkv›w
],

43 'aùive': [
£lf
.
aùive
],

44 'şo£d': [
£lf
.
şo£d
, {'æ©': 
True
}],

45 'nÙag': [
£lf
.
nÙag
],

46 'wÜkabË': [
£lf
.
is_wÜkabË
],

47 '¡¬‹d': [
£lf
.
is_¡¬‹d
],

48 'wÜkdue': [
£lf
.
wÜkdue
],

49 'wÜk¡¬‹d': [
£lf
.
wÜk¡¬‹d
],

50 'wÜkto¡¬t': [
£lf
.
wÜkto¡¬t
],

51 'wÜkÏ‹': [
£lf
.
wÜkÏ‹
],

52 'no_di§bËd_g': [
£lf
.
no_di§bËd_g
],

53 
	}
}

55 
f
 
š
 
f_dic
:

56 
ft
 = 
f_dic
[
f
]

57 
Ën
(
ft
) > 1:

58 
·¿m
 = 
ft
[1]

60 
·¿m
 = 
NÚe


61 
skŒ“
.
	$add_f‹r
(
f
, 
ft
[0], 
·¿m
)

62 
£lf
.
skŒ“
 =asktree

63  
skŒ“


65 
def
 
	$g‘_gs_Œ“
(
£lf
, 
»q
):

67 
šşudšg
 
the
 
®l_gs_g
 
ªd
 
nÙag_g
.

69 
gŒ“
 = 
	$T»e
()

71 ###budšg 
the
 
š™Ÿl
 
gs


72 #Bud 
the
 "allasksag"

73 
®Éag
 = 
	$Tag
(
CÜeCÚfig
.
ALLTASKS_TAG
, 
»q
=req)

74 
®Éag
.
	`£t_©Œibu‹
("special", "all")

75 
®Éag
.
	`£t_©Œibu‹
("label", "<span weight='bold'>%s</span>"

76 % 
	`_
("Allasks"))

77 
®Éag
.
	`£t_©Œibu‹
("icon", "gtg-tags-all")

78 
®Éag
.
	`£t_©Œibu‹
("order", 0)

79 
gŒ“
.
	$add_node
(
®Éag
)

80 
p
 = {
	}
}

81 
£lf
.
skŒ“
.
	$add_f‹r
(
CÜeCÚfig
.
ALLTASKS_TAG
,

82 
£lf
.
®Éag
, 
·¿m‘”s
=
p
)

83 #Bud 
the
 "withoutagag"

84 
nÙag_g
 = 
	$Tag
(
CÜeCÚfig
.
NOTAG_TAG
, 
»q
=req)

85 
nÙag_g
.
	`£t_©Œibu‹
("special", "notag")

86 
nÙag_g
.
	`£t_©Œibu‹
("label", "<span weight='bold'>%s</span>"

87 % 
	`_
("Tasks with‚oags"))

88 
nÙag_g
.
	`£t_©Œibu‹
("icon", "gtg-tags-none")

89 
nÙag_g
.
	`£t_©Œibu‹
("order", 2)

90 
gŒ“
.
	$add_node
(
nÙag_g
)

91 
p
 = {
	}
}

92 
£lf
.
skŒ“
.
	$add_f‹r
(
CÜeCÚfig
.
NOTAG_TAG
,

93 
£lf
.
nÙag
, 
·¿m‘”s
=
p
)

95 #Bud 
the
 
£¬ch
 
g


96 
£¬ch_g
 = 
	$Tag
(
CÜeCÚfig
.
SEARCH_TAG
, 
»q
=req)

97 
£¬ch_g
.
	`£t_©Œibu‹
("special", "search")

98 
£¬ch_g
.
	`£t_©Œibu‹
("label",

99 "<¥ª weight='bŞd'>%s</¥ª>" % 
	`_
("Search"))

100 
£¬ch_g
.
	`£t_©Œibu‹
("icon", "search")

101 
£¬ch_g
.
	`£t_©Œibu‹
("order", 1)

102 
gŒ“
.
	$add_node
(
£¬ch_g
)

103 
p
 = {
	}
}

104 
£lf
.
skŒ“
.
	$add_f‹r
(
CÜeCÚfig
.
SEARCH_TAG
,

105 
£¬ch_f‹r
, 
·¿m‘”s
=
p
)

107 #Bud 
the
 
£·¿tÜ


108 
£p_g
 = 
	$Tag
(
CÜeCÚfig
.
SEP_TAG
, 
»q
=req)

109 
£p_g
.
	`£t_©Œibu‹
("special", "sep")

110 
£p_g
.
	`£t_©Œibu‹
("order", 3)

111 
gŒ“
.
	$add_node
(
£p_g
)

113 #### 
F‹rs


114 
gŒ“
.
	`add_f‹r
('aùiv‘ag', 
£lf
.
aùiv–y_u£d_g
)

115 
gŒ“
.
	`add_f‹r
('u£dg', 
£lf
.
u£d_g
)

117 
aùivev›w
 = 
gŒ“
.
	`g‘_v›wŒ“
(
Çme
='aùiv‘ags', 
»äesh
=
F®£
)

118 
aùivev›w
.
	`­¶y_f‹r
('activetag')

120 #Thi 
v›w
 
dÛ¢
'ˆ£emØbu£d. SØ™'
s
 
nÙ
 
u£ful
 
to
 
bud
 
™
 
now


121 #u£dv›w = 
gŒ“
.
	`g‘_v›wŒ“
(
Çme
='u£dgs',
»äesh
=
F®£
)

122 #u£dv›w.
	`­¶y_f‹r
('usedtag')

124 
£lf
.
gŒ“
 =agtree

125 
£lf
.
gŒ“_lßded
 = 
True


126  
gŒ“


128 #################Tag 
F‹rs
 ##########################################

130 #f‹¸
to
 
di¥Ïy
 
Úly
 
gs
 
w™h
 
aùive
 
sks


131 
def
 
	$aùiv–y_u£d_g
(
£lf
, 
node
, 
·¿m‘”s
=
NÚe
):

132 
tÜ‘uº
 = 
node
.
	$is_aùiv–y_u£d
()

133  
tÜ‘uº


135 
def
 
	$u£d_g
(
£lf
, 
node
, 
·¿m‘”s
=
NÚe
):

136  
node
.
	$is_u£d
()

138 #################Task 
F‹rs
 #########################################
#Th© 
Úe
 
is
 
u£d
 
to
 
f‹rs
 
g
. 
Is
 
™
 
but
 
dyÇmiÿÎy
 
—ch
 
times


139 #¨
g
 
is
 
added
 
to
 
the
 
g¡Üe


140 
def
 
	$g_f‹r
(
£lf
, 
node
, 
·¿m‘”s
):

141 
g
 = 
·¿m‘”s
['tag']

142  
node
.
	$has_gs
([
g
])

144 
def
 
	$®Éag
(
£lf
, 
sk
, 
·¿m‘”s
=
NÚe
):

145  
True


147 
def
 
	$nÙag
(
£lf
, 
sk
, 
·¿m‘”s
=
NÚe
):

149  
sk
.
	$has_gs
(
nÙag_Úly
=
True
)

151 
def
 
	$is_Ëaf
(
£lf
, 
sk
, 
·¿m‘”s
=
NÚe
):

153  
nÙ
 
sk
.
	$has_chd
()

155 
def
 
	$is_wÜkabË
(
£lf
, 
sk
, 
·¿m‘”s
=
NÚe
):

157 
Œ“
 = 
sk
.
	$g‘_Œ“
()

158 
chd_id
 
š
 
sk
.
	$g‘_chd»n
():

159 
nÙ
 
Œ“
.
	$has_node
(
chd_id
):

162 
chd
 = 
Œ“
.
	$g‘_node
(
chd_id
)

163 
chd
.
	`g‘_¡©us
(è=ğ
Task
.
STA_ACTIVE
:

164  
F®£


166  
True


168 
def
 
	$is_¡¬‹d
(
£lf
, 
sk
, 
·¿m‘”s
=
NÚe
):

170 
days_Ëá
 = 
sk
.
	`g‘_¡¬t_d©e
().
	$days_Ëá
()

172 
days_Ëá
 
is
 
NÚe
:

173 #w™houˆ
¡¬td©e


174  
True


175 
–if
 
days_Ëá
 == 0:

176 #DÚ'ˆcouÁoday'
s
 
sks
 
¡¬‹d
 
uÁ
 
mÜnšg


177  
d©‘ime
.
	`now
().
hour
 > 4

179  
days_Ëá
 < 0

181 
def
 
	$wÜkv›w
(
£lf
, 
sk
, 
·¿m‘”s
=
NÚe
):

182 
wv
 = (
£lf
.
	$aùive
(
sk
è
ªd


183 
£lf
.
	$is_¡¬‹d
(
sk
è
ªd


184 
£lf
.
	$is_wÜkabË
(
sk
è
ªd


185 
£lf
.
	$no_di§bËd_g
(
sk
è
ªd


186 
sk
.
	`g‘_due_d©e
(è!ğ
D©e
.
	$someday
())

187  
wv


189 
def
 
	$wÜkdue
(
£lf
, 
sk
):

191 
wv
 = (
£lf
.
	$wÜkv›w
(
sk
è
ªd


192 
sk
.
	$g‘_due_d©e
(è
ªd


193 
sk
.
	`g‘_days_Ëá
() < 2)

194  
wv


196 
def
 
	$wÜkÏ‹
(
£lf
, 
sk
):

198 
wv
 = (
£lf
.
	$wÜkv›w
(
sk
è
ªd


199 
sk
.
	$g‘_due_d©e
(è
ªd


200 
sk
.
	`g‘_days_Ï‹
() > 0)

201  
wv


203 
def
 
	$wÜk¡¬‹d
(
£lf
, 
sk
):

205 
wv
 = 
£lf
.
	$wÜkv›w
(
sk
è
ªd
 \

206 
sk
.
¡¬t_d©e


207  
wv


209 
def
 
	$wÜkto¡¬t
(
£lf
, 
sk
):

211 
wv
 = 
£lf
.
	$wÜkv›w
(
sk
è
ªd
 \

212 
nÙ
 
sk
.
¡¬t_d©e


213  
wv


215 
def
 
	$aùive
(
£lf
, 
sk
, 
·¿m‘”s
=
NÚe
):

217  
sk
.
	`g‘_¡©us
(è=ğ
Task
.
STA_ACTIVE


219 
def
 
	$şo£d
(
£lf
, 
sk
, 
·¿m‘”s
=
NÚe
):

221 
»t
 = 
sk
.
	$g‘_¡©us
(è
š
 [
Task
.
STA_DISMISSED
, Task.
STA_DONE
]

222  
»t


224 
def
 
	$no_di§bËd_g
(
£lf
, 
sk
, 
·¿m‘”s
=
NÚe
):

226 
tÜ‘uº
 = 
True


227 
t
 
š
 
sk
.
	$g‘_gs
():

228 
t
.
	`g‘_©Œibu‹
("nonworkview") == "True":

229 
tÜ‘uº
 = 
F®£


230  
tÜ‘uº


	@gtk/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

19 
impÜt
 
os


22 
şass
 
	$V›wCÚfig
(
objeù
):

23 
cu¼’t_»p
 = 
os
.
·th
.
	`dœÇme
(os.·th.
	$ab¥©h
(
__fe__
))

24 
DELETE_UI_FILE
 = 
os
.
·th
.
	`još
(
cu¼’t_»p
, "deletion.ui")

25 
PREFERENCES_UI_FILE
 = 
os
.
·th
.
	`još
(
cu¼’t_»p
, "preferences.ui")

26 
PLUGINS_UI_FILE
 = 
os
.
·th
.
	`još
(
cu¼’t_»p
, "plugins.ui")

27 
BACKENDS_UI_FILE
 = 
os
.
·th
.
	`još
(
cu¼’t_»p
, "backends_dialog.ui")

	@gtk/backends_dialog/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
This
 
fe
 
cÚšs
 
	gBack’dsDŸlog
, 
a
 
şass
 
th©
 
mªages
 
the
 
wšdow
hat

19 
Ëts
 
you
 
add
 
ªd
 
cÚfigu»
 
	gback’ds
.

20 
This
 
wšdow
 
is
 
divided
 
š
 
	gtwo
:

21 - 
a
 
Œ“v›w
 
of
 
the
 
cu¼’y
 
lßded
 
back’ds
 (th
Úes
 
added
 
by
h
u£r
)

22 - 
a
 
big
 
¥aû
, 
th©
 
ÿn
 
be
 
fËd
 
by
 
the
 
cÚfigu¿tiÚ
 
·Ãl
 
Ü
h
add


23 
·Ãl
 (
the£
 
¬e
 
ÿÎed
 
®so
 "v›ws" 
š
 
this
 
şass
)

26 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


28 
äom
 
	gGTG
.
gtk
 
impÜt
 
V›wCÚfig


29 
äom
 
	gGTG
.
cÜe
 
impÜt
 
CÜeCÚfig


30 
äom
 
	gGTG
.
	ggtk
.
	gback’ds_dŸlog
.
back’d¡»e
 
impÜt
 
Back’dsT»e


31 
äom
 
	gGTG
.
	ggtk
.
	gback’ds_dŸlog
.
add·Ãl
 
impÜt
 
AddPª–


32 
äom
 
	gGTG
.
	ggtk
.
	gback’ds_dŸlog
.
cÚfigu»·Ãl
 
impÜt
 
CÚfigu»Pª–


33 
äom
 
	gGTG
.
back’ds
 
impÜt
 
Back’dFaùÜy


34 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


35 
äom
 
GTG
 
impÜt
 
_


36 
äom
 
	gGTG
.
	gback’ds
.
g’”icback’d
 
impÜt
 
G’”icBack’d


37 
äom
 
GTG
 
impÜt
 
šfo


38 
äom
 
	gGTG
.
gtk
 
impÜt
 
h–p


41 
şass
 
	$Back’dsDŸlog
(
objeù
):

43 
Back’dsDŸlog
 
mªages
 
a
 
wšdow
 
th©
 
Ëts
 
you
 
mªage
 
ªd
 
cÚfigu»


44 
synchrÚiz©iÚ
 
£rviû
.

45 
It
 
ÿn
 
di¥Ïy
 
two
 "v›ws", 
Ü
 "panels":

46 - 
the
 
back’d
 
cÚfigu¿tiÚ
 
v›w


47 - 
the
 
back’d
 
addšg
 
v›w


50 
def
 
	$__š™__
(
£lf
, 
»q
):

52 
In™Ÿlizes
 
the
 
gtk
 
objeùs
 
ªd
 
sigÇls
.

53 @
·¿m
 
»q
: 
a
 
Reque¡”
 
objeù


55 
£lf
.
»q
 =„eq

56 
£lf
.
icÚ_theme
 = 
NÚe


57 
£lf
.
	$_cÚfigu»_icÚ_theme
()

58 #Deş¬
sub£qu’y
 
lßded
 
widg‘


59 
£lf
.
dŸlog
 = 
NÚe


60 
£lf
.
Œ“v›w_wšdow
 = 
NÚe


61 
£lf
.
ûÁ¿l_·Ã
 = 
NÚe


62 
£lf
.
add_bu‰Ú
 = 
NÚe


63 
£lf
.
»move_bu‰Ú
 = 
NÚe


64 
£lf
.
back’ds_tv
 = 
NÚe


65 
£lf
.
cÚfig_·Ãl
 = 
NÚe


66 
£lf
.
add_·Ãl
 = 
NÚe


67 
bud”
 = 
Gtk
.
	$Bud”
()

68 
£lf
.
	$_lßd_widg‘s_äom_bud”
(
bud”
)

69 #Lßd 
ªd
 
£tup
 
Ùh”
 
widg‘s


70 
£lf
.
dŸlog
.
	`£t_t™Ë
(
	`_
("SynchrÚiz©iÚ S”viû - %s" % 
šfo
.
NAME
))

71 
£lf
.
	$_ü—‹_widg‘s_fÜ_add_·Ãl
()

72 
£lf
.
	$_ü—‹_widg‘s_fÜ_cÚf_·Ãl
()

73 
£lf
.
	$_£tup_sigÇl_cÚÃùiÚs
(
bud”
)

74 
£lf
.
	$_ü—‹_widg‘s_fÜ_Œ“v›w
()

75 
h–p
.
	`add_h–p_shÜtcut
(
£lf
.
dŸlog
, "sync")

78 ###INTERFACE 
WITH
 
THE
 
VIEWMANAGER
 #####
########################################

79 
def
 
	$aùiv©e
(
£lf
):

81 
£lf
.
dŸlog
.
	$show_®l
()

82 
£lf
.
back’ds_tv
.
	$»äesh
()

83 
£lf
.
back’ds_tv
.
	$£Ëù_back’d
()

84 
£lf
.
dŸlog
.
	$´e£Á
()

86 
def
 
	$Ú_şo£
(
£lf
, 
widg‘
, 
d©a
=
NÚe
):

88 
Hides
 
this
 
wšdow
, 
§všg
 
the
 
back’ds
 
cÚfigu¿tiÚ
.

90 @
·¿m
 
widg‘
: 
nÙ
 
u£d
, 
h”e
 
Úly
 
usšg
 
this
 
as
 
sigÇl
 
ÿÎback


91 @
·¿m
 
d©a
: 
§me
 
as
 
widg‘
, 
di¤eg¬d
 
the
 
cÚ‹Á


93 
£lf
.
dŸlog
.
	$hide
()

94 
£lf
.
»q
.
	$§ve_d©a¡Üe
()

95  
True


98 ###HELPER 
FUNCTIONS
 ###################
########################################

99 
def
 
	$g‘_»que¡”
(
£lf
):

101 
H–³r
 
funùiÚ
: 
»tuºs
 
the
 
»que¡”
.

102 
It
's used byhe "views" displayed byhis class (backendƒditing‡nd

103 
addšg
 
v›ws
è
to
 
acûss
 
the
 
»que¡”


105  
£lf
.
»q


107 
def
 
	$g‘_pixbuf_äom_icÚ_Çme
(
£lf
, 
Çme
, 
height
):

109 
H–³r
 
funùiÚ
: 
»tuºs
 
a
 
pixbuf
 
of
 
ª
 
icÚ
 
giv’
 
™s
 
Çme
 
š
 
the


110 
lßded
 
icÚ
 
theme


112 @
·¿m
 
Çme
: 
the
‚am
of
h
icÚ


113 @
·¿m
 
height
: 
the
 heighˆ
of
h
»tuºed
 
pixbuf


114 @
·¿m
 
width
: 
the
 width 
of
h
»tuºed
 
pixbuf


116 @
»tuºs
 
GdkPixbuf
: 
a
 
pixbuf
 
cÚššg
 
the
 
wª‹d
 
icÚ
, 
Ü
 
NÚe


117 (
the
 
icÚ
 
is
 
nÙ
 
´e£Á
)

119 
icÚ_šfo
 = 
£lf
.
icÚ_theme
.
	$lookup_icÚ
(
Çme
, 
height
, 0)

120 
icÚ_šfo
 
is
 
NÚe
:

121  
NÚe


123  
Gtk
.
IcÚTheme
.
	`g‘_deçuÉ
().
	$lßd_icÚ
(
Çme
, 
height
, 0)

125 
def
 
	$_show_·Ãl
(
£lf
, 
·Ãl_Çme
):

127 
H–³r
 
funùiÚ
 
to
 
b‘w“n
 
·Ãls
.

129 @
·¿m
 
·Ãl_Çme
: 
the
 
Çme
 
of
h
wª‹d
 
·Ãl
. 
Choo£
 
b‘w“n


130 "cÚfigu¿tiÚ" 
Ü
 "add"

132 
·Ãl_Çme
 == "configuration":

133 
·Ãl_to_»move
 = 
£lf
.
add_·Ãl


134 
·Ãl_to_add
 = 
£lf
.
cÚfig_·Ãl


135 
side_is_’abËd
 = 
True


136 
–if
 
·Ãl_Çme
 == "add":

137 
·Ãl_to_»move
 = 
£lf
.
cÚfig_·Ãl


138 
·Ãl_to_add
 = 
£lf
.
add_·Ãl


139 
side_is_’abËd
 = 
F®£


141 
Log
.
	`”rÜ
("panel‚ame unknown")

143 #C’Œ® 
·Ã


144 #NOTE: 
£lf
.
ûÁ¿l_·Ã
 
is
 
the
 
Gtk
.
CÚš”
 
š
 
which
 
we
 
lßd
 
·Ãls


145 
·Ãl_to_»move
 
š
 
£lf
.
ûÁ¿l_·Ã
:

146 
£lf
.
ûÁ¿l_·Ã
.
	$»move
(
·Ãl_to_»move
)

147 
nÙ
 
·Ãl_to_add
 
š
 
£lf
.
ûÁ¿l_·Ã
:

148 
£lf
.
ûÁ¿l_·Ã
.
	$add
(
·Ãl_to_add
)

149 
£lf
.
ûÁ¿l_·Ã
.
	$show_®l
()

150 #Sid
Œ“v›w


151 #di§bËd 
we
're‡dding‡‚ew backend

152 
Œy
:

153 #wh’ 
this
 
is
 
ÿÎed
 
upÚ
 
š™Ÿliz©iÚ
 
of
hi 
şass
, 
the


154 #back’ds_tv 
objeù
 
has
 
nÙ
 
b“n
 
ü—‹d
 
y‘
.

155 
£lf
.
add_bu‰Ú
.
	$£t_£ns™ive
(
side_is_’abËd
)

156 
£lf
.
»move_bu‰Ú
.
	$£t_£ns™ive
(
side_is_’abËd
)

157 
£lf
.
back’ds_tv
.
	$£t_£ns™ive
(
side_is_’abËd
)

158 
exû±
 
A‰ribu‹E¼Ü
:

159 
·ss


162 ###WIDGETS 
AND
 
SIGNALS
 ################

164 
def
 
	$_lßd_widg‘s_äom_bud”
(
£lf
, 
bud”
):

166 
Lßds
 
widg‘s
 
äom
 
the
 
bud”
 .
ui
 
fe


168 @
·¿m
 
bud”
: 
a
 
Gtk
.
Bud”


170 
bud”
.
	$add_äom_fe
(
V›wCÚfig
.
BACKENDS_UI_FILE
)

171 
widg‘s
 = {

177 
	}
}

178 
©Œ
, 
widg‘
 
š
 
	gwidg‘s
.
	$™ems
():

179 
	`£‰r
(
£lf
, 
©Œ
, 
bud”
.
	$g‘_objeù
(
widg‘
))

181 
def
 
	$_£tup_sigÇl_cÚÃùiÚs
(
£lf
, 
bud”
):

183 
C»©es
 
some
 
GTK
 
sigÇls
 
cÚÃùiÚs


185 @
·¿m
 
bud”
: 
a
 
Gtk
.
Bud”


187 
sigÇls
 = {

188 'Ú_add_bu‰Ú_şicked': 
£lf
.
Ú_add_bu‰Ú
,

189 'Ú_Back’dsDŸlog_d–‘e_ev’t': 
£lf
.
Ú_şo£
,

190 'Ú_şo£_bu‰Ú_şicked': 
£lf
.
Ú_şo£
,

191 'Ú_»move_bu‰Ú_şicked': 
£lf
.
Ú_»move_bu‰Ú
,

192 'Ú_h–p_bu‰Ú_şicked': 
£lf
.
Ú_h–p
,

193 
	}
}

194 
bud”
.
	$cÚÃù_sigÇls
(
sigÇls
)

196 
def
 
	$_cÚfigu»_icÚ_theme
(
£lf
):

198 
InfÜm
 
gtk
 
Ú
 
the
 
loÿtiÚ
 
of
h
back’ds
 
	`icÚs
 (
which
 
is
 
š


199 
the
 
GTG
 
dœeùÜy
 
Œ“
, 
ªd
 
nÙ
 
š
h 
loÿtiÚ
 
icÚs


201 
£lf
.
icÚ_theme
 = 
Gtk
.
IcÚTheme
.
	$g‘_deçuÉ
()

202 
dœeùÜy
 
š
 
	`CÜeCÚfig
().
	$g‘_icÚs_dœeùÜ›s
():

203 
£lf
.
icÚ_theme
.
	$´•’d_£¬ch_·th
(
dœeùÜy
)

205 
def
 
	$_ü—‹_widg‘s_fÜ_Œ“v›w
(
£lf
):

207 
C»©es
 
the
 
widg‘s
 th
Ï‹¿l
 
Œ“v›w
 
di¥Ïyšg
he

208 
back’ds
 
the
 
u£r
 
has
 
added


210 
£lf
.
back’ds_tv
 = 
	$Back’dsT»e
(
£lf
)

211 
£lf
.
Œ“v›w_wšdow
.
	$add
(
£lf
.
back’ds_tv
)

213 
def
 
	$_ü—‹_widg‘s_fÜ_cÚf_·Ãl
(
£lf
):

215 
£lf
.
cÚfig_·Ãl
 = 
	$CÚfigu»Pª–
(
£lf
)

217 
def
 
	$_ü—‹_widg‘s_fÜ_add_·Ãl
(
£lf
):

219 
£lf
.
add_·Ãl
 = 
	$AddPª–
(
£lf
)

222 ###EVENT 
HANDLING
 #####################
########################################

223 
def
 
	$Ú_h–p
(
şs
, 
widg‘
):

225 
h–p
.
	`show_h–p
("sync")

226  
True


228 
def
 
	$Ú_back’d_£Ëùed
(
£lf
, 
back’d_id
):

230 
Wh’
 
a
 
back’d
 
š
 
the
 
Œ“v›w
 
g‘s
 
£Ëùed
, 
show


231 
™s
 
cÚfigu¿tiÚ
 
·Ã


233 @
·¿m
 
back’d_id
: 
the
 
id
 
of
h
£Ëùed
 
back’d


235 
back’d_id
:

236 
£lf
.
	`_show_·Ãl
("configuration")

237 
£lf
.
cÚfig_·Ãl
.
	$£t_back’d
(
back’d_id
)

238 
back’d
 = 
£lf
.
»q
.
	$g‘_back’d
(
back’d_id
)

239 
£lf
.
»move_bu‰Ú
.
	`£t_£ns™ive
(
nÙ
 
back’d
.
	$is_deçuÉ
())

241 
def
 
	$Ú_add_bu‰Ú
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

243 
Wh’
 
the
 
add
 
bu‰Ú
 
is
 
´es£d
,hadd 
·Ãl
 i 
shown


245 @
·¿m
 
widg‘
: 
nÙ
 
u£d
, 
h”e
 
Úly
 
usšg
 
this
 
as
 
sigÇl
 
ÿÎback


246 @
·¿m
 
d©a
: 
§me
 
as
 
widg‘
, 
di¤eg¬d
 
the
 
cÚ‹Á


248 
£lf
.
	`_show_·Ãl
("add")

249 
£lf
.
add_·Ãl
.
	$»äesh_back’ds
()

251 
def
 
	$Ú_back’d_added
(
£lf
, 
back’d_Çme
):

253 
Wh’
 
a
 
back’d
 
is
 
added
, 
™
 i 
ü—‹d
 
ªd
 
»gi¡”ed
 
š
 
the
 
D©a¡Üe
.

254 
Also
, 
the
 
cÚfigu¿tiÚ
 
·Ãl
 
is
 
shown
.

256 @
·¿m
 
back’d_Çme
: 
the
 
Çme
 
of
h
ty³
 oàth
back’d
 
to
 
add


257 (
id’tif›d
 
as
 
BACKEND_NAME
 
š
 
the
 
Back’d
 
şass
)

259 #C»©
Back’d


260 
back’d_dic
 = 
	`Back’dFaùÜy
().
	$g‘_Ãw_back’d_diù
(
back’d_Çme
)

261 
back’d_dic
:

262 
back’d_dic
[
G’”icBack’d
.
KEY_ENABLED
] = 
F®£


263 
£lf
.
»q
.
	$»gi¡”_back’d
(
back’d_dic
)

264 #Re¡Ü
UI


265 
£lf
.
	`_show_·Ãl
("configuration")

267 
def
 
	$show_cÚfig_fÜ_back’d
(
£lf
, 
back’d_id
):

269 
S–eùs
 
a
 
back’d
 
š
 
the
 
Ï‹¿l
 
Œ“v›w


271 @
·¿m
 
back’d_id
: 
the
 
id
 
of
h
back’d
 
th©
 
mu¡
 
be
 
£Ëùed


273 
£lf
.
back’ds_tv
.
	$£Ëù_back’d
(
back’d_id
)

275 
def
 
	$Ú_»move_bu‰Ú
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

277 
Wh’
 
the
 
»move
 
bu‰Ú
 
is
 
´es£d
, 
a
 
cÚfœm©iÚ
 
dŸlog
 i 
shown
,

278 
ªd
 
the
 
ªsw”
 
is
 
pos™ive
,h
back’d
 i 
d–‘ed
.

280 
back’d_id
 = 
£lf
.
back’ds_tv
.
	$g‘_£Ëùed_back’d_id
()

281 
back’d_id
 
is
 
NÚe
:

282 #nØ
back’d
 
£Ëùed


284 
back’d
 = 
£lf
.
»q
.
	$g‘_back’d
(
back’d_id
)

285 
dŸlog
 = 
Gtk
.
	`Mes§geDŸlog
(

286 
·»Á
=
£lf
.
dŸlog
,

287 
æags
=
Gtk
.
DŸlogFÏgs
.
DESTROY_WITH_PARENT
,

288 
ty³
=
Gtk
.
Mes§geTy³
.
QUESTION
,

289 
bu‰Ús
=
Gtk
.
Bu‰ÚsTy³
.
YES_NO
,

290 
mes§ge_fÜm©
=
	`_
("Do you„eally wanto„emovehe '%s' "

292 
back’d
.
	$g‘_humª_Çme
())

293 
»¥Ú£
 = 
dŸlog
.
	$run
()

294 
dŸlog
.
	$de¡roy
()

295 
»¥Ú£
 =ğ
Gtk
.
Re¥Ú£Ty³
.
YES
:

296 #d–‘
the
 
back’d
 
ªd
 
»move
 
™
 
äom
h
Ï‹¿l
 
Œ“v›w


297 
£lf
.
»q
.
	$»move_back’d
(
back’d_id
)

298 
£lf
.
back’ds_tv
.
	`»move_back’d
(
back’d_id
)

	@gtk/backends_dialog/addpanel.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


19 
äom
 
	gGTG
.
	ggtk
.
	gback’ds_dŸlog
.
back’dscombo
 
impÜt
 
Back’dsCombo


20 
äom
 
	gGTG
.
back’ds
 
impÜt
 
Back’dFaùÜy


21 
äom
 
GTG
 
impÜt
 
	g_
, 
ng‘‹xt


22 
äom
 
funùoŞs
 
impÜt
 
»duû


25 
şass
 
	$AddPª–
(
Gtk
.
Box
):

27 
A
 
v”tiÿl
 
Box
 
fËd
 
w™h
 
gtk
 
widg‘s
 
to
 
Ët
 
the
 
u£r
 
choo£
 
a
 
Ãw


28 
back’d
.

31 
def
 
	$__š™__
(
£lf
, 
back’ds_dŸlog
):

33 
CÚ¡ruùÜ
, 
ju¡
 
š™Ÿlizes
 
the
 
gtk
 
widg‘s


35 @
·¿m
 
back’ds_dŸlog
: 
a
 
»ã»nû
 
to
 
the
 
dŸlog
 
š
 
which
 
this
 
is


36 
lßded


38 
	`su³r
(
AddPª–
, 
£lf
).
	$__š™__
(
Ü›Á©iÚ
=
Gtk
.
Or›Á©iÚ
.
VERTICAL
)

39 
£lf
.
dŸlog
 = 
back’ds_dŸlog


40 
£lf
.
	$_ü—‹_widg‘s
()

42 
def
 
	$_ü—‹_widg‘s
(
£lf
):

44 
gtk
 
widg‘s
 
š™Ÿliz©iÚ


46 #DivisiÚ 
of
 
the
 
avaabË
 
¥aû
 
š
 
th»e
 
£gm’ts
:

47 #tİ, 
middË
 
ªd
 
bÙtom
.

48 
tİ
 = 
Gtk
.
	$Box
()

49 
tİ
.
	$£t_¥acšg
(6)

50 
middË
 = 
Gtk
.
	$Box
()

51 
bÙtom
 = 
Gtk
.
	$Box
()

52 
£lf
.
	$_fl_tİ_box
(
tİ
)

53 
£lf
.
	$_fl_middË_box
(
middË
)

54 
£lf
.
	$_fl_bÙtom_box
(
bÙtom
)

55 
£lf
.
	$·ck_¡¬t
(
tİ
, 
F®£
, 
True
, 0)

56 
£lf
.
	$·ck_¡¬t
(
middË
, 
True
, True, 0)

57 
£lf
.
	$·ck_¡¬t
(
bÙtom
, 
True
, True, 0)

58 
£lf
.
	$£t_bÜd”_width
(12)

60 
def
 
	$_fl_tİ_box
(
£lf
, 
box
):

62 
H–³r
 
funùiÚ
 
to
 
fl
 
ªd
 
box
 
w™h
 
a
 
combobox
 
th©
 
li¡s
 
the


63 
avaabË
 
back’ds
 
ªd
 
a
 
Gtk
.
Lab–
.

65 @
·¿m
 
box
: 
the
 
Gtk
.
Box
 
to
 
fl


67 
Ïb–
 = 
Gtk
.
	`Lab–
Öab–=
	`_
("Select synchronization service:"))

68 
Ïb–
.
	$£t_®ignm’t
(0, 0.5)

69 
£lf
.
combo_ty³s
 = 
	$Back’dsCombo
(
£lf
.
dŸlog
)

71 #£lf.
combo_ty³s
.
	`g‘_chd
().
	`cÚÃù
('chªged', 
£lf
.
Ú_combo_chªged
)

72 
£lf
.
combo_ty³s
.
	`cÚÃù
('chªged', s–f.
Ú_combo_chªged
)

73 
box
.
	$·ck_¡¬t
(
Ïb–
, 
F®£
, 
True
, 0)

74 
box
.
	$·ck_¡¬t
(
£lf
.
combo_ty³s
, 
F®£
, 
True
, 0)

76 
def
 
	$_fl_middË_box
(
£lf
, 
box
):

78 
H–³r
 
funùiÚ
 
to
 
fl
 
ª
 
box
 
w™h
 
a
 
Ïb–
 
desüibšg
 
the
 
back’d


79 
ªd
 
a
 
Gtk
.
	`Image
 (
th©
 
lßds
 
the
 
back’d
 
image
)

81 @
·¿m
 
box
: 
the
 
Gtk
.
Box
 
to
 
fl


83 
£lf
.
Ïb–_Çme
 = 
Gtk
.
	`Lab–
(
Ïb–
="name")

84 
£lf
.
Ïb–_Çme
.
	$£t_®ignm’t
(
x®ign
=0.5, 
y®ign
=1)

85 
£lf
.
Ïb–_desütiÚ
 = 
Gtk
.
	$Lab–
()

86 
£lf
.
Ïb–_desütiÚ
.
	$£t_ju¡ify
(
Gtk
.
Ju¡ifiÿtiÚ
.
FILL
)

87 
£lf
.
Ïb–_desütiÚ
.
	$£t_lše_w¿p
(
True
)

88 
£lf
.
Ïb–_desütiÚ
.
	`£t_size_»que¡
(300, -1)

89 
£lf
.
Ïb–_desütiÚ
.
	$£t_®ignm’t
(
x®ign
=0, 
y®ign
=0.5)

90 
£lf
.
Ïb–_authÜ
 = 
Gtk
.
	`Lab–
(
Ïb–
="")

91 
£lf
.
Ïb–_authÜ
.
	$£t_lše_w¿p
(
True
)

92 
£lf
.
Ïb–_authÜ
.
	$£t_®ignm’t
(
x®ign
=0, 
y®ign
=0)

93 
£lf
.
Ïb–_moduËs
 = 
Gtk
.
	`Lab–
(
Ïb–
="")

94 
£lf
.
Ïb–_moduËs
.
	$£t_lše_w¿p
(
True
)

95 
£lf
.
Ïb–_moduËs
.
	$£t_®ignm’t
(
x®ign
=0, 
y®ign
=0)

96 
£lf
.
image_icÚ
 = 
Gtk
.
	$Image
()

97 
£lf
.
image_icÚ
.
	$£t_size_»que¡
(128, 128)

98 
®ign_image
 = 
Gtk
.
Alignm’t
.
	$Ãw
(1, 0, 0, 0)

99 
®ign_image
.
	$add
(
£lf
.
image_icÚ
)

100 
Ïb–s_vbox
 = 
Gtk
.
	$Box
(
Ü›Á©iÚ
=
Gtk
.
Or›Á©iÚ
.
VERTICAL
)

101 
Ïb–s_vbox
.
	$·ck_¡¬t
(
£lf
.
Ïb–_desütiÚ
, 
True
, True, 10)

102 
Ïb–s_vbox
.
	$·ck_¡¬t
(
£lf
.
Ïb–_authÜ
, 
True
, True, 0)

103 
Ïb–s_vbox
.
	$·ck_¡¬t
(
£lf
.
Ïb–_moduËs
, 
True
, True, 0)

104 
low_box
 = 
Gtk
.
	$Box
()

105 
low_box
.
	$·ck_¡¬t
(
Ïb–s_vbox
, 
True
, True, 0)

106 
low_box
.
	$·ck_¡¬t
(
®ign_image
, 
True
, True, 0)

107 
vbox
 = 
Gtk
.
	$Box
(
Ü›Á©iÚ
=
Gtk
.
Or›Á©iÚ
.
VERTICAL
)

108 
vbox
.
	$·ck_¡¬t
(
£lf
.
Ïb–_Çme
, 
True
, True, 0)

109 
vbox
.
	$·ck_¡¬t
(
low_box
, 
True
, True, 0)

110 
box
.
	$·ck_¡¬t
(
vbox
, 
True
, True, 0)

112 
def
 
	$_fl_bÙtom_box
(
£lf
, 
box
):

114 
H–³r
 
funùiÚ
 
to
 
fl
 
ªd
 
box
 
w™h
 
a
 
bu‰Úbox
, 
ã©uršg


115 
ªd
 
ok
‡nd 
ÿnûl
 
bu‰Ús
.

117 @
·¿m
 
box
: 
the
 
Gtk
.
Box
 
to
 
fl


119 
ÿnûl_bu‰Ú
 = 
Gtk
.
	$Bu‰Ú
(
¡ock
=
Gtk
.
STOCK_CANCEL
)

120 
ÿnûl_bu‰Ú
.
	`cÚÃù
('şicked', 
£lf
.
Ú_ÿnûl
)

121 
£lf
.
ok_bu‰Ú
 = 
Gtk
.
	$Bu‰Ú
(
¡ock
=
Gtk
.
STOCK_OK
)

122 
£lf
.
ok_bu‰Ú
.
	`cÚÃù
('şicked', s–f.
Ú_cÚfœm
)

123 
®ign
 = 
Gtk
.
Alignm’t
.
	$Ãw
(0.5, 1, 1, 0)

124 
®ign
.
	$£t_·ddšg
(0, 10, 0, 0)

125 
bu‰Úbox
 = 
Gtk
.
	$Bu‰ÚBox
()

126 
bu‰Úbox
.
	$£t_Ïyout
(
Gtk
.
Bu‰ÚBoxStyË
.
EDGE
)

127 
bu‰Úbox
.
	$add
(
ÿnûl_bu‰Ú
)

128 
bu‰Úbox
.
	$£t_chd_£cÚd¬y
(
ÿnûl_bu‰Ú
, 
F®£
)

129 
bu‰Úbox
.
	$add
(
£lf
.
ok_bu‰Ú
)

130 
®ign
.
	$add
(
bu‰Úbox
)

131 
box
.
	$·ck_¡¬t
(
®ign
, 
True
, True, 0)

133 
def
 
	$»äesh_back’ds
(
£lf
):

135 
£lf
.
combo_ty³s
.
	$»äesh
()

137 
def
 
	$Ú_cÚfœm
(
£lf
, 
widg‘
=
NÚe
):

139 
NÙif›s
 
the
 
dŸlog
 
hŞdšg
 
this
 
Box
 
th©
 
a
 
back’d
 
has
 
b“n


140 
cho£n


142 @
·¿m
 
widg‘
: 
ju¡
 
to
 
make
 
this
 
funùiÚ
 
u§bË
 
as
 
a
 
sigÇl
 
ÿÎback
.

143 
NÙ
 
u£d
.

145 
back’d_Çme
 = 
£lf
.
combo_ty³s
.
	$g‘_£Ëùed
()

146 
£lf
.
dŸlog
.
	$Ú_back’d_added
(
back’d_Çme
)

148 
def
 
	$Ú_ÿnûl
(
£lf
, 
widg‘
=
NÚe
):

150 
AbÜts
 
the
 
add™iÚ
 
of
 
a
 
Ãw
 
back’d
. 
Shows
h
cÚfigu¿tiÚ
 
·Ãl


151 
´eviou¦y
 
lßded
.

153 @
·¿m
 
widg‘
: 
ju¡
 
to
 
make
 
this
 
funùiÚ
 
u§bË
 
as
 
a
 
sigÇl
 
ÿÎback
.

154 
NÙ
 
u£d
.

156 
£lf
.
dŸlog
.
	$show_cÚfig_fÜ_back’d
(
NÚe
)

158 
def
 
	$Ú_combo_chªged
(
£lf
, 
widg‘
=
NÚe
):

160 
Upd©es
 
the
 
back’d
 
desütiÚ
 
ªd
 
icÚ
.

162 @
·¿m
 
widg‘
: 
ju¡
 
to
 
make
 
this
 
funùiÚ
 
u§bË
 
as
 
a
 
sigÇl
 
ÿÎback
.

163 
NÙ
 
u£d
.

165 
back’d_Çme
 = 
£lf
.
combo_ty³s
.
	$g‘_£Ëùed
()

166 
back’d_Çme
 
is
 
NÚe
:

168 
back’d
 = 
	`Back’dFaùÜy
().
	$g‘_back’d
(
back’d_Çme
)

169 
£lf
.
Ïb–_desütiÚ
.
	`£t_m¬kup
(
back’d
.
Back’d
.
	$g‘_desütiÚ
())

171 
m¬kup
 = '<big><big><big><b>%s</b></big></big></big>' % \

172 
back’d
.
Back’d
.
	$g‘_humª_deçuÉ_Çme
()

173 
£lf
.
Ïb–_Çme
.
	$£t_m¬kup
(
m¬kup
)

174 
authÜs
 = 
back’d
.
Back’d
.
	$g‘_authÜs
()

175 
authÜ_txt
 = '<b>%s</b>:\n - %s' % \

176 (
	`ng‘‹xt
("AuthÜ", "AuthÜs", 
	`Ën
(
authÜs
)),

177 
	`»duû
(
Ïmbda
 
a
, 
b
:‡ + "\n" + " - " + b, 
authÜs
))

178 
£lf
.
Ïb–_authÜ
.
	$£t_m¬kup
(
authÜ_txt
)

179 
pixbuf
 = 
£lf
.
dŸlog
.
	$g‘_pixbuf_äom_icÚ_Çme
(
back’d_Çme
, 128)

180 
£lf
.
image_icÚ
.
	$£t_äom_pixbuf
(
pixbuf
)

181 
£lf
.
	`show_®l
()

	@gtk/backends_dialog/backendscombo.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


18 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
GdkPixbuf


20 
äom
 
	gGTG
.
back’ds
 
impÜt
 
Back’dFaùÜy


23 
şass
 
	$Back’dsCombo
(
Gtk
.
ComboBox
):

25 
A
 
combobox
 
li¡šg
 
®l
 
the
 
avaabË
 
back’ds
 
ty³s


28 
COLUMN_NAME
 = 0 #uniqu
Çme
 
the
 
back’d
 
ty³
. 
It
's‚ever

29 #di¥Ïyed, 
™
's usedo find which backend has

30 #b“À
£Ëùed


31 
COLUMN_HUMAN_NAME
 = 1 #humª 
ä›ndly
 
	`Çme
 (
which
 
is
 
loÿlized
).

32 
COLUMN_ICON
 = 2

34 
def
 
	$__š™__
(
£lf
, 
back’ds_dŸlog
):

36 
CÚ¡ruùÜ
, 
™Ÿlizes
 
gtk
 
widg‘s
.

37 @
·¿m
 
back’ds_dŸlog
: 
»ã»nû
 
to
 
the
 
dŸlog
 
š
 
which
 
this
 
combo
 
is


38 
lßded
.

40 
Gtk
.
ComboBox
.
	$__š™__
(
£lf
)

41 
£lf
.
dŸlog
 = 
back’ds_dŸlog


42 
£lf
.
	$_li¡¡Üe_š™
()

43 
£lf
.
	$_»nd””s_š™
()

44 
£lf
.
	`£t_size_»que¡
(-1, 30)

45 
£lf
.
	$show_®l
()

47 
def
 
	$_li¡¡Üe_š™
(
£lf
):

49 
£lf
.
li¡¡Üe
 = 
Gtk
.
	$Li¡StÜe
(
¡r
, sŒ, 
GdkPixbuf
.
Pixbuf
)

50 
£lf
.
	$£t_mod–
(
£lf
.
li¡¡Üe
)

52 
def
 
	$_»nd””s_š™
(
£lf
):

54 #Texˆ
»nd””


55 
‹xt_ûÎ
 = 
Gtk
.
	$C–lR’d””Text
()

56 
£lf
.
	$·ck_¡¬t
(
‹xt_ûÎ
, 
F®£
)

57 
£lf
.
	`add_©Œibu‹
(
‹xt_ûÎ
, 'text', 1)

58 #IcÚ 
»nd””


59 
pixbuf_ûÎ
 = 
Gtk
.
	$C–lR’d””Pixbuf
()

60 
£lf
.
	$·ck_¡¬t
(
pixbuf_ûÎ
, 
F®£
)

61 
£lf
.
	`add_©Œibu‹
(
pixbuf_ûÎ
, "pixbuf", s–f.
COLUMN_ICON
)

63 
def
 
	$»äesh
(
£lf
):

65 
PİuÏ‹s
 
the
 
combo
 
box
 
w™h
h
avaabË
 
back’ds


67 
£lf
.
li¡¡Üe
.
	$ş—r
()

68 
back’d_ty³s
 = 
	`Back’dFaùÜy
().
	$g‘_®l_back’ds
()

69 
Çme
, 
moduË
 
š
 
back’d_ty³s
.
	$™ems
():

70 #FIXME: 
Di§bË
 
addšg
 
ªÙh”
 
loÿlfe
 
back’d
.

71 #Iˆ
ju¡
 
´oduû
 
mªy
 
w¬nšgs
, 
´ovides
 
no
 
u£
 

72 #S“ 
LP
 
bug
 #940917 (
IzidÜ
)

73 
Çme
 == "backend_localfile":

75 
pixbuf
 = 
£lf
.
dŸlog
.
	$g‘_pixbuf_äom_icÚ_Çme
(
Çme
, 16)

76 
£lf
.
li¡¡Üe
.
	`­³nd
((
Çme
,

77 
moduË
.
Back’d
.
	`g‘_humª_deçuÉ_Çme
(),

78 
pixbuf
))

79 
back’d_ty³s
:

80 #Œigg” 
a
 "chªged" 
sigÇl
, 
which
 
is
 
u£d
 
š
 
the
 
AddPª–
 
to


81 #»äesh 
the
 
back’d
 
desütiÚ
 
ªd
 
icÚ


82 
£lf
.
	$£t_aùive
(0)

84 
def
 
	$g‘_£Ëùed
(
£lf
):

86 
R‘uºs
 
the
 
Çme
 
of
h
£Ëùed
 
back’d
, 
Ü
 
NÚe


88 
£Ëùed_™”
 = 
£lf
.
	$g‘_aùive_™”
()

89 
£Ëùed_™”
:

90 
cŞumn_Çme
 = 
Back’dsCombo
.
COLUMN_NAME


91  
£lf
.
li¡¡Üe
.
	$g‘_v®ue
(
£Ëùed_™”
, 
cŞumn_Çme
)

93  
NÚe


	@gtk/backends_dialog/backendstree.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


18 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
GdkPixbuf


20 
äom
 
	gGTG
.
	ggtk
.
cŞÜs
 
impÜt
 
g‘_cŞÜed_gs_m¬kup


21 
äom
 
	gGTG
.
	gback’ds
.
g’”icback’d
 
impÜt
 
G’”icBack’d


22 
äom
 
	gGTG
.
	gback’ds
.
back’dsigÇls
 
impÜt
 
Back’dSigÇls


25 
şass
 
	$Back’dsT»e
(
Gtk
.
T»eV›w
):

27 
Gtk
.
T»eV›w
 
th©
 
shows
 
the
 
cu¼’y
 
lßded
 
back’ds
.

30 
COLUMN_BACKEND_ID
 = 0 #Ãv” 
shown
, 
u£d
 
š‹º®
 
lookup
.

31 
COLUMN_ICON
 = 1

32 
COLUMN_TEXT
 = 2 #hŞd 
the
 
back’d
 "humª-»adabË" 
Çme


33 
COLUMN_TAGS
 = 3

35 
def
 
	$__š™__
(
£lf
, 
back’dsdŸlog
):

37 
CÚ¡ruùÜ
, 
ju¡
 
š™Ÿlizes
 
the
 
gtk
 
widg‘s


39 @
·¿m
 
back’ds_dŸlog
: 
a
 
»ã»nû
 
to
 
the
 
dŸlog
 
š
 
which
 
this
 
is


40 
lßded


42 
	`su³r
(
Back’dsT»e
, 
£lf
).
	$__š™__
()

43 
£lf
.
dŸlog
 = 
back’dsdŸlog


44 
£lf
.
»q
 = 
back’dsdŸlog
.
	$g‘_»que¡”
()

45 
£lf
.
	$_š™_li¡¡Üe
()

46 
£lf
.
	$_š™_»nd””s
()

47 
£lf
.
	$_š™_sigÇls
()

48 
£lf
.
	$»äesh
()

50 
def
 
	$»äesh
(
£lf
):

52 
£lf
.
back’did_to_™”
 = {
	}
}

53 
£lf
.
li¡¡Üe
.
	$ş—r
()

55 #SÜˆ
back’ds


56 #1, 
put
  
back’d
 
Ú
 
tİ


57 #2, 
sÜt
 
back’ds
 
by
 
humª
 
Çme


58 
back’ds
 = 
	`li¡
(
£lf
.
»q
.
	$g‘_®l_back’ds
(
di§bËd
=
True
))

59 
back’ds
 = 
	`sÜ‹d
(backends,

60 
key
=
Ïmbda
 
back’d
: (
nÙ
 back’d.
	`is_deçuÉ
(),

61 
back’d
.
	$g‘_humª_Çme
()))

63 
back’d
 
š
 
back’ds
:

64 
£lf
.
	$add_back’d
(
back’d
)

65 
£lf
.
	`Ú_back’d_¡©e_chªged
(
NÚe
, 
back’d
.
	$g‘_id
())

67 
def
 
	$Ú_back’d_added
(
£lf
, 
£nd”
, 
back’d_id
):

69 
SigÇl
 
ÿÎback
 
execu‹d
 
wh’
 
a
 
Ãw
 
back’d
 
is
 
lßded


71 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
Úly
 
h”e
 
to
 
Ët
 
this
 
funùiÚ
 
be
 u£d 
as
 
a


72 
ÿÎback


73 @
·¿m
 
back’d_id
: 
the
 
id
 
of
h
back’d
 
to
 
add


76 
back’d
 = 
£lf
.
»q
.
	$g‘_back’d
(
back’d_id
)

77 
nÙ
 
back’d
:

79 
£lf
.
	$add_back’d
(
back’d
)

80 
£lf
.
	$»äesh
()

82 
£lf
.
	$£Ëù_back’d
(
back’d_id
)

83 #Upd©
™
'sƒnabled state

84 
£lf
.
	`Ú_back’d_¡©e_chªged
(
NÚe
, 
back’d
.
	$g‘_id
())

86 
def
 
	$add_back’d
(
£lf
, 
back’d
):

88 
Adds
 
a
 
Ãw
 
back’d
 
to
 
the
 
li¡


90 @
·¿m
 
back’d_id
: 
the
 
id
 
of
h
back’d
 
to
 
add


92 
back’d
:

93 
back’d_™”
 = 
£lf
.
li¡¡Üe
.
	`­³nd
([

94 
back’d
.
	`g‘_id
(),

95 
£lf
.
dŸlog
.
	`g‘_pixbuf_äom_icÚ_Çme
(
back’d
.
	`g‘_Çme
(),

97 
back’d
.
	`g‘_humª_Çme
(),

98 
£lf
.
	`_g‘_m¬kup_fÜ_gs
(
back’d
.
	`g‘_©ched_gs
()),

100 
£lf
.
back’did_to_™”
[
back’d
.
	`g‘_id
()] = 
back’d_™”


102 
def
 
	$Ú_back’d_¡©e_chªged
(
£lf
, 
£nd”
, 
back’d_id
):

104 
SigÇl
 
ÿÎback
 
execu‹d
 
wh’
 
a
 
back’d
 
is
 
’abËd
/
di§bËd
.

106 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
Úly
 
h”e
 
to
 
Ët
 
this
 
funùiÚ
 
be
 u£d 
as
 
a


107 
ÿÎback


108 @
·¿m
 
back’d_id
: 
the
 
id
 
of
h
back’d
 
to
 
add


110 
back’d_id
 
š
 
£lf
.
back’did_to_™”
:

111 
b_™”
 = 
£lf
.
back’did_to_™”
[
back’d_id
]

112 
b_·th
 = 
£lf
.
li¡¡Üe
.
	$g‘_·th
(
b_™”
)

113 
back’d
 = 
£lf
.
»q
.
	$g‘_back’d
(
back’d_id
)

114 
back’d_Çme
 = 
back’d
.
	$g‘_humª_Çme
()

115 
back’d
.
	$is_’abËd
():

116 
‹xt
 = 
back’d_Çme


118 #FIXME 
This
 
¢³t
 
is
 
Ú
 
mÜe
 
thª
 2 
¶aûs
!!!

119 #FIXME 
ü—‹
 
a
 
funùiÚ
 
which
 
kes
‡ 
widg‘
 
ªd


120 #æag 
ªd
 
»tuºs
 
cŞÜ
 
as
 #RRGGBB

121 
¡yË_cÚ‹xt
 = 
£lf
.
	$g‘_¡yË_cÚ‹xt
()

122 
cŞÜ
 = 
¡yË_cÚ‹xt
.
	$g‘_cŞÜ
(
Gtk
.
S‹FÏgs
.
INSENSITIVE
)

123 
cŞÜ
 = cŞÜ.
	`to_cŞÜ
().
	$to_¡ršg
()

124 
‹xt
 = "<span color='%s'>%s</span>" % \

125 (
cŞÜ
, 
back’d_Çme
)

126 
£lf
.
li¡¡Üe
[
b_·th
][£lf.
COLUMN_TEXT
] = 
‹xt


128 #AlsØ
»äesh
 
the
 
gs


129 
Ãw_gs
 = 
£lf
.
	`_g‘_m¬kup_fÜ_gs
(
back’d
.
	$g‘_©ched_gs
())

130 
£lf
.
li¡¡Üe
[
b_·th
][£lf.
COLUMN_TAGS
] = 
Ãw_gs


132 
def
 
	$_g‘_m¬kup_fÜ_gs
(
£lf
, 
g_Çmes
):

134 
th©
 
li¡
 
w™h
 
the
 
g
 
cŞÜs
 
u£d
 
š
 
GTG


136 @
·¿m
 
g_Çmes
: 
the
 
li¡
 
of
h
	`gs
 (
¡ršgs
)

137 @ 
¡r
: 
the
 
·ngo
 
m¬kup
 
¡ršg


139 
G’”icBack’d
.
ALLTASKS_TAG
 
š
 
g_Çmes
:

140 
gs_txt
 = ""

142 
gs_txt
 = 
	$g‘_cŞÜed_gs_m¬kup
(
£lf
.
»q
, 
g_Çmes
)

143  "<sm®l>" + 
gs_txt
 + "</small>"

145 
def
 
	$»move_back’d
(
£lf
, 
back’d_id
):

147 
som‘hšg
 
š
 
the
 
cÚfigu¿tiÚ
 
·Ãl


149 @
·¿m
 
back’d_id
: 
the
 
id
 
of
h
back’d
 
to
 
»move


151 
back’d_id
 
š
 
£lf
.
back’did_to_™”
:

152 
£lf
.
li¡¡Üe
.
	$»move
(
£lf
.
back’did_to_™”
[
back’d_id
])

153 
d–
 
£lf
.
back’did_to_™”
[
back’d_id
]

154 
£lf
.
	$£Ëù_back’d
()

156 
def
 
	$_š™_li¡¡Üe
(
£lf
):

158 
£lf
.
li¡¡Üe
 = 
Gtk
.
	$Li¡StÜe
(
objeù
, 
GdkPixbuf
.
Pixbuf
, 
¡r
, str)

159 
£lf
.
	$£t_mod–
(
£lf
.
li¡¡Üe
)

161 
def
 
	$_š™_»nd””s
(
£lf
):

163 #W
hide
 
the
 
cŞumns
 
h—d”s


164 
£lf
.
	$£t_h—d”s_visibË
(
F®£
)

165 #FÜ 
the
 
back’d
 
icÚ


166 
pixbuf_ûÎ
 = 
Gtk
.
	$C–lR’d””Pixbuf
()

167 
tvcŞumn_pixbuf
 = 
Gtk
.
	`T»eV›wCŞumn
('IcÚ', 
pixbuf_ûÎ
)

168 
tvcŞumn_pixbuf
.
	`add_©Œibu‹
(
pixbuf_ûÎ
, 'pixbuf', 
£lf
.
COLUMN_ICON
)

169 
£lf
.
	$­³nd_cŞumn
(
tvcŞumn_pixbuf
)

170 #FÜ 
the
 
back’d
 
Çme


171 
‹xt_ûÎ
 = 
Gtk
.
	$C–lR’d””Text
()

172 
tvcŞumn_‹xt
 = 
Gtk
.
	`T»eV›wCŞumn
('Name', 
‹xt_ûÎ
)

173 
tvcŞumn_‹xt
.
	`add_©Œibu‹
(
‹xt_ûÎ
, 'm¬kup', 
£lf
.
COLUMN_TEXT
)

174 
£lf
.
	$­³nd_cŞumn
(
tvcŞumn_‹xt
)

175 
‹xt_ûÎ
.
	`cÚÃù
('ed™ed', 
£lf
.
ûÎ_ed™ed_ÿÎback
)

176 
‹xt_ûÎ
.
	`£t_´İ”ty
('ed™abË', 
True
)

177 #FÜ 
the
 
back’d
 
gs


178 
gs_ûÎ
 = 
Gtk
.
	$C–lR’d””Text
()

179 
tvcŞumn_gs
 = 
Gtk
.
	`T»eV›wCŞumn
('Tags', 
gs_ûÎ
)

180 
tvcŞumn_gs
.
	`add_©Œibu‹
(
gs_ûÎ
, 'm¬kup', 
£lf
.
COLUMN_TAGS
)

181 
£lf
.
	$­³nd_cŞumn
(
tvcŞumn_gs
)

183 
def
 
	$ûÎ_ed™ed_ÿÎback
(
£lf
, 
‹xt_ûÎ
, 
·th
, 
Ãw_‹xt
):

186 @
·¿m
 
‹xt_ûÎ
: 
nÙ
 
u£d
. 
The
 
Gtk
.
C–lR’d””Text
 
th©
 
em™‹d
 
the


187 
sigÇl
. 
OÆy
 
h”e
 
beÿu£
 
™
's…assed byhe signal

188 @
·¿m
 
·th
: 
the
 
Gtk
.
T»eP©h
 
of
h
ed™ed
 
ûÎ


189 @
·¿m
 
Ãw_‹xt
: 
the
 
Ãw
 
Çme
 
of
h
back’d


191 #w
¡r
 
ev”ythšg
 
nÙ
 
³rm™‹d
 
š
 
back’d
 
Çmes


192 
Ãw_‹xt
 = ''.
	`još
(
c
 ø
š
‚ew_‹xˆià(c.
	$i§Êum
(è
Ü


193 
c
 
š
 [" ", "-", "_"]))

194 
£Ëùed_™”
 = 
£lf
.
li¡¡Üe
.
	$g‘_™”
(
·th
)

195 #upd©
the
 
back’d
 
Çme


196 
back’d_id
 = 
£lf
.
li¡¡Üe
.
	$g‘_v®ue
(
£Ëùed_™”
,

197 
£lf
.
COLUMN_BACKEND_ID
)

198 
back’d
 = 
£lf
.
dŸlog
.
	`g‘_»que¡”
().
	$g‘_back’d
(
back’d_id
)

199 
back’d
:

200 
back’d
.
	$£t_humª_Çme
(
Ãw_‹xt
)

201 #upd©
the
 
‹xt
 
š
h
li¡¡Üe


202 
£lf
.
li¡¡Üe
.
	$£t
(
£Ëùed_™”
, 
£lf
.
COLUMN_TEXT
, 
Ãw_‹xt
)

204 
def
 
	$_š™_sigÇls
(
£lf
):

206 
£lf
.
	`cÚÃù
("cursÜ-chªged", s–f.
Ú_£Ëù_row
)

207 
_sigÇls
 = 
	$Back’dSigÇls
()

208 
_sigÇls
.
	$cÚÃù
(
_sigÇls
.
BACKEND_ADDED
, 
£lf
.
Ú_back’d_added
)

209 
_sigÇls
.
	$cÚÃù
(
_sigÇls
.
BACKEND_STATE_TOGGLED
,

210 
£lf
.
Ú_back’d_¡©e_chªged
)

212 
def
 
	$Ú_£Ëù_row
(
£lf
, 
Œ“v›w
=
NÚe
):

215 @
v¬
 
Œ“v›w
: 
nÙ
 
u£d


217 
£lf
.
dŸlog
.
	`Ú_back’d_£Ëùed
(£lf.
	$g‘_£Ëùed_back’d_id
())

219 
def
 
	$_g‘_£Ëùed_·th
(
£lf
):

221 
H–³r
 
funùiÚ
 
to
 
g‘
 
the
 
£Ëùed
 
·th


223 @ 
Gtk
.
T»eP©h
 : 
»tuºs
 
exaùly
 
Úe
 
·th
 
the
 
£Ëùed
 
objeù


224 
Ü
 
NÚe


226 
£ËùiÚ
 = 
£lf
.
	$g‘_£ËùiÚ
()

227 
£ËùiÚ
:

228 
mod–
, 
£Ëùed_·ths
 = 
£lf
.
	`g‘_£ËùiÚ
().
	$g‘_£Ëùed_rows
()

229 
£Ëùed_·ths
:

230  
£Ëùed_·ths
[0]

231  
NÚe


233 
def
 
	$£Ëù_back’d
(
£lf
, 
back’d_id
=
NÚe
):

235 
S–eùs
 
the
 
back’d
 
cÜ»¥Údšg
 
to
 
back’d_id
.

236 
If
 
back’d_id
 
is
 
nÚe
, 
»äeshes
 
the
 
cu¼’t
 
cÚfigu¿tiÚ
 
·Ãl
.

238 @
·¿m
 
back’d_id
: 
the
 
id
 
of
h
back’d
 
to
 
£Ëù


240 
£ËùiÚ
 = 
£lf
.
	$g‘_£ËùiÚ
()

241 
back’d_id
 
š
 
£lf
.
back’did_to_™”
:

242 
back’d_™”
 = 
£lf
.
back’did_to_™”
[
back’d_id
]

243 
£ËùiÚ
:

244 
£ËùiÚ
.
	$£Ëù_™”
(
back’d_™”
)

246 
£lf
.
	$_g‘_£Ëùed_·th
():

247 #W
ju¡
 
»£Ëù
 
the
 
cu¼’y
 
£Ëùed
 
’Œy


248 
£lf
.
	$Ú_£Ëù_row
()

250 #Ià
nÙhšg
 
is
 
£Ëùed
, 
we
 
£Ëù
 
the
 
fœ¡
 
’Œy


251 
£ËùiÚ
:

252 
£ËùiÚ
.
	`£Ëù_·th
("0")

253 
£lf
.
dŸlog
.
	`Ú_back’d_£Ëùed
(£lf.
	$g‘_£Ëùed_back’d_id
())

255 
def
 
	$g‘_£Ëùed_back’d_id
(
£lf
):

257 
»tuºs
 
the
 
£Ëùed
 
back’d
 
id
, 
Ü
 
nÚe


259 @ 
¡ršg
: 
the
 
£Ëùed
 
back’d
 
	`id
 (
Ü
 
NÚe
)

261 
£Ëùed_·th
 = 
£lf
.
	$_g‘_£Ëùed_·th
()

262 
nÙ
 
£Ëùed_·th
:

263  
NÚe


264 
£Ëùed_™”
 = 
£lf
.
li¡¡Üe
.
	$g‘_™”
(
£Ëùed_·th
)

265  
£lf
.
li¡¡Üe
.
	`g‘_v®ue
(
£Ëùed_™”
, s–f.
COLUMN_BACKEND_ID
)

	@gtk/backends_dialog/configurepanel.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


19 
äom
 
GTG
 
impÜt
 
_


20 
äom
 
	gGTG
.
	ggtk
.
	gback’ds_dŸlog
.
·¿m‘”s_ui
 
impÜt
 
P¬am‘”sUI


21 
äom
 
	gGTG
.
	gback’ds
.
back’dsigÇls
 
impÜt
 
Back’dSigÇls


24 
şass
 
	$CÚfigu»Pª–
(
Gtk
.
Box
):

26 
A
 
v”tiÿl
 
Box
 
th©
 
Ëts
 
you
 
cÚfigu»
 
a
 
back’d


29 
def
 
	$__š™__
(
£lf
, 
back’ds_dŸlog
):

31 
CÚ¡ruùÜ
, 
ü—tšg
 
®l
 
the
 
gtk
 
widg‘s


33 @
·¿m
 
back’ds_dŸlog
: 
a
 
»ã»nû
 
to
 
the
 
dŸlog
 
š
 
which
 
this
 
is


34 
lßded


36 
	`su³r
(
CÚfigu»Pª–
, 
£lf
).
	$__š™__
(

37 
Ü›Á©iÚ
=
Gtk
.
Or›Á©iÚ
.
VERTICAL
)

38 
£lf
.
dŸlog
 = 
back’ds_dŸlog


39 
£lf
.
should_¥šÃr_be_shown
 = 
F®£


40 
£lf
.
sk_d–‘ed_hªdË
 = 
NÚe


41 
£lf
.
sk_added_hªdË
 = 
NÚe


42 
£lf
.
»q
 = 
back’ds_dŸlog
.
	$g‘_»que¡”
()

43 
£lf
.
	$_ü—‹_widg‘s
()

44 
£lf
.
	$_cÚÃù_sigÇls
()

46 
def
 
	$_cÚÃù_sigÇls
(
£lf
):

48 
_sigÇls
 = 
	$Back’dSigÇls
()

49 
_sigÇls
.
	$cÚÃù
(
_sigÇls
.
BACKEND_RENAMED
, 
£lf
.
»äesh_t™Ë
)

50 
_sigÇls
.
	$cÚÃù
(
_sigÇls
.
BACKEND_STATE_TOGGLED
,

51 
£lf
.
»äesh_sync_¡©us
)

52 
_sigÇls
.
	$cÚÃù
(
_sigÇls
.
BACKEND_SYNC_STARTED
, 
£lf
.
Ú_sync_¡¬‹d
)

53 
_sigÇls
.
	$cÚÃù
(
_sigÇls
.
BACKEND_SYNC_ENDED
, 
£lf
.
Ú_sync_’ded
)

55 
def
 
	$_ü—‹_widg‘s
(
£lf
):

57 
This
 
funùiÚ
 
fls
 
this
 
box
 
w™h
 
widg‘s


59 #DivisiÚ 
of
 
the
 
avaabË
 
¥aû
 
š
 
th»e
 
£gm’ts
:

60 #tİ, 
middË
 
ªd
 
bÙtom


61 
tİ
 = 
Gtk
.
	$Box
()

62 
middË
 = 
Gtk
.
	$Box
()

63 
£lf
.
	$_fl_tİ_box
(
tİ
)

64 
£lf
.
	$_fl_middË_box
(
middË
)

65 
£lf
.
	$·ck_¡¬t
(
tİ
, 
F®£
, 
True
, 0)

66 
£lf
.
	$·ck_¡¬t
(
middË
, 
F®£
, 
True
, 0)

67 
®ign
 = 
Gtk
.
Alignm’t
.
	$Ãw
(0, 0, 1, 0)

68 
®ign
.
	$£t_·ddšg
(10, 0, 0, 0)

69 
£lf
.
·¿m‘”s_ui
 = 
	$P¬am‘”sUI
(
£lf
.
»q
)

70 
®ign
.
	$add
(
£lf
.
·¿m‘”s_ui
)

71 
£lf
.
	$·ck_¡¬t
(
®ign
, 
F®£
, 
True
, 0)

73 
def
 
	$_fl_tİ_box
(
£lf
, 
box
):

75 
šidÿtiÚ
 
of
 
wÜk
.

77 
box
.
	$£t_¥acšg
(10)

78 
£lf
.
image_icÚ
 = 
Gtk
.
	$Image
()

79 
£lf
.
image_icÚ
.
	$£t_size_»que¡
(48, 48)

81 
£lf
.
humª_Çme_Ïb–
 = 
Gtk
.
	$Lab–
()

82 
£lf
.
humª_Çme_Ïb–
.
	$£t_®ignm’t
(
x®ign
=0, 
y®ign
=0.5)

84 #FIXME 
š
 
the
 
Ãw”
 
v”siÚs
 
of
 
GTK3
 
th”e
 
®ways
 
be
 
SpšÃr
!

85 
Œy
:

86 
£lf
.
¥šÃr
 = 
Gtk
.
	$SpšÃr
()

87 
exû±
 
A‰ribu‹E¼Ü
:

88 #wÜ¬kound 
¬chlšux
: 
bug
 #624204

89 
£lf
.
¥šÃr
 = 
Gtk
.
	$Box
()

90 
£lf
.
¥šÃr
.
	`cÚÃù
("show", s–f.
Ú_¥šÃr_show
)

91 
£lf
.
¥šÃr
.
	$£t_size_»que¡
(32, 32)

92 
®ign_¥š
 = 
Gtk
.
Alignm’t
.
	$Ãw
(1, 0, 0, 0)

93 
®ign_¥š
.
	$add
(
£lf
.
¥šÃr
)

95 
box
.
	$£t_¥acšg
(10)

96 
box
.
	$·ck_¡¬t
(
£lf
.
image_icÚ
, 
F®£
, 
True
, 0)

97 
box
.
	$·ck_¡¬t
(
£lf
.
humª_Çme_Ïb–
, 
True
, True, 0)

98 
box
.
	$·ck_¡¬t
(
®ign_¥š
, 
F®£
, 
True
, 0)

100 
def
 
	$_fl_middË_box
(
£lf
, 
box
):

102 
H–³r
 
funùiÚ
 
to
 
fl
 
ª
 
box
 
w™h
 
a
 
Ïb–
 
ªd
‡ 
bu‰Ú


104 @
·¿m
 
box
: 
the
 
Gtk
.
Box
 
to
 
fl


106 
£lf
.
sync_¡©us_Ïb–
 = 
Gtk
.
	$Lab–
()

107 
£lf
.
sync_¡©us_Ïb–
.
	$£t_®ignm’t
(
x®ign
=0.8, 
y®ign
=0.5)

108 
£lf
.
sync_bu‰Ú
 = 
Gtk
.
	$Bu‰Ú
()

109 
£lf
.
sync_bu‰Ú
.
	`cÚÃù
("şicked", s–f.
Ú_sync_bu‰Ú_şicked
)

110 
box
.
	$·ck_¡¬t
(
£lf
.
sync_¡©us_Ïb–
, 
True
, True, 0)

111 
box
.
	$·ck_¡¬t
(
£lf
.
sync_bu‰Ú
, 
True
, True, 0)

113 
def
 
	$£t_back’d
(
£lf
, 
back’d_id
):

116 @
·¿m
 
back’d_id
: 
the
 
id
 
of
h
back’d
 
to
 
cÚfigu»


118 
£lf
.
back’d
 = s–f.
dŸlog
.
	`g‘_»que¡”
().
	$g‘_back’d
(
back’d_id
)

119 
£lf
.
	$»äesh_t™Ë
()

120 
£lf
.
	$»äesh_sync_¡©us
()

121 
£lf
.
·¿m‘”s_ui
.
	$»äesh
(
£lf
.
back’d
)

122 
£lf
.
image_icÚ
.
	`£t_äom_pixbuf
(£lf.
dŸlog
.
	`g‘_pixbuf_äom_icÚ_Çme
(

123 
£lf
.
back’d
.
	`g‘_Çme
(), 48))

125 
def
 
	$»äesh_t™Ë
(
£lf
, 
£nd”
=
NÚe
, 
d©a
=None):

127 
C®lback
 
the
 
sigÇl
 
th©
 
nÙif›s
 
back’ds
 
Çme
 
chªges
. 
It
 changes

128 
the
 
t™Ë
 
of
 
this
 
v›w


130 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
h”e
 
Úly
 
sigÇl
 
ÿÎback
 
com·tib™y


131 @
·¿m
 
d©a
: 
nÙ
 
u£d
, 
h”e
 
Úly
 
sigÇl
 
ÿÎback
 
com·tib™y


133 
m¬kup
 = "<big><big><big><b>%s</b></big></big></big>" % \

134 
£lf
.
back’d
.
	$g‘_humª_Çme
()

135 
£lf
.
humª_Çme_Ïb–
.
	$£t_m¬kup
(
m¬kup
)

137 
def
 
	$»äesh_sync_bu‰Ú
(
£lf
):

139 
Reäeshes
 
the
 
¡©e
 
of
h
bu‰Ú
 
th©
 
’abËs
h
back’d


141 
£lf
.
sync_bu‰Ú
.
	`£t_£ns™ive
(
nÙ
 s–f.
back’d
.
	$is_deçuÉ
())

142 
£lf
.
back’d
.
	$is_’abËd
():

143 
Ïb–
 = 
	`_
("Disable syncing")

145 
Ïb–
 = 
	`_
("Enable syncing")

146 
£lf
.
sync_bu‰Ú
.
	$£t_Ïb–
(
Ïb–
)

148 
def
 
	$»äesh_sync_¡©us_Ïb–
(
£lf
):

150 
Reäeshes
 
the
 
Gtk
.
Lab–
 
th©
 
shows
h
cu¼’t
 
¡©e
 
of
 
this
 
back’d


152 
£lf
.
back’d
.
	$is_deçuÉ
():

153 
Ïb–
 = 
	`_
("This ishe default synchronization service")

155 
£lf
.
back’d
.
	$is_’abËd
():

156 
Ïb–
 = 
	`_
("Syncing isƒnabled.")

158 
Ïb–
 = 
	`_
('Syncing is <span color="red">disabled</span>.')

159 
£lf
.
sync_¡©us_Ïb–
.
	$£t_m¬kup
(
Ïb–
)

161 
def
 
	$»äesh_sync_¡©us
(
£lf
, 
£nd”
=
F®£
, 
d©a
=False):

163 (
’abËd
/
di§bËd
è
chªges
. 
Reäeshes
 
this
 
v›w
.

165 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
h”e
 
Úly
 
sigÇl
 
ÿÎback
 
com·tib™y


166 @
·¿m
 
d©a
: 
nÙ
 
u£d
, 
h”e
 
Úly
 
sigÇl
 
ÿÎback
 
com·tib™y


168 
£lf
.
	$»äesh_sync_bu‰Ú
()

169 
£lf
.
	$»äesh_sync_¡©us_Ïb–
()

171 
def
 
	$Ú_sync_bu‰Ú_şicked
(
£lf
, 
£nd”
):

173 
SigÇl
 
ÿÎback
 
wh’
 
a
 
back’d
 
is
 
’abËd
/
di§bËd
 
vŸ
 
the
 
UI
 
bu‰Ú


175 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
h”e
 
Úly
 
sigÇl
 
ÿÎback
 
com·tib™y


177 
£lf
.
·¿m‘”s_ui
.
	$comm™_chªges
()

178 
£lf
.
»q
.
	`£t_back’d_’abËd
(£lf.
back’d
.
	`g‘_id
(),

179 
nÙ
 
£lf
.
back’d
.
	$is_’abËd
())

181 
def
 
	$Ú_sync_¡¬‹d
(
£lf
, 
£nd”
, 
back’d_id
):

183 
If
 
the
 
back’d
 
has
 
¡¬‹d
 
syncšg
 
sks
, 
upd©e
h
¡©e
 
of
he

184 
Gtk
.
SpšÃr


186 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
h”e
 
Úly
 
sigÇl
 
ÿÎback
 
com·tib™y


187 @
·¿m
 
back’d_id
: 
the
 
id
 
of
h
back’d
 
th©
 
em™‹d
 
this
 
sigÇl


189 
back’d_id
 =ğ
£lf
.
back’d
.
	$g‘_id
():

190 
£lf
.
	$¥šÃr_£t_aùive
(
True
)

192 
def
 
	$Ú_sync_’ded
(
£lf
, 
£nd”
, 
back’d_id
):

194 
If
 
the
 
back’d
 
has
 
¡İ³d
 
syncšg
 
sks
, 
upd©e
h
¡©e
 
of
he

195 
Gtk
.
SpšÃr


197 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
h”e
 
Úly
 
sigÇl
 
ÿÎback
 
com·tib™y


198 @
·¿m
 
back’d_id
: 
the
 
id
 
of
h
back’d
 
th©
 
em™‹d
 
this
 
sigÇl


201 
back’d_id
 =ğ
£lf
.
back’d
.
	$g‘_id
():

202 
£lf
.
	$¥šÃr_£t_aùive
(
F®£
)

204 
def
 
	$Ú_¥šÃr_show
(
£lf
, 
£nd”
):

205 '''Thi sigÇÈÿÎback hide th¥šÃ¸ià™'
s
 
nÙ
 
suµo£d
 
to
 
be


206 
£’
. 
It
's‡ workaroundo†et us call show_all onhe whole window

207 
k“pšg
 
this
 
	`hidd’
 (
™
'she only widgethat„equires special

208 
©‹ÁiÚ
)

210 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
h”e
 
Úly
 
sigÇl
 
ÿÎback
 
com·tib™y


212 
nÙ
 
£lf
.
should_¥šÃr_be_shown
:

213 
£lf
.
¥šÃr
.
	$hide
()

215 
def
 
	$¥šÃr_£t_aùive
(
£lf
, 
aùive
):

217 
EÇbËs
/
di§bËs
 
the
 
Gtk
.
SpšÃr
, 
showšg
/
hidšg
 
™
 
©
h
§me


218 
time


220 @
·¿m
 
aùive
: 
True
 
the
 
¥šÃr
 
should
 
¥š


222 
£lf
.
should_¥šÃr_be_shown
 = 
aùive


223 
aùive
:

224 
	$isš¡ªû
(
£lf
.
¥šÃr
, 
Gtk
.
SpšÃr
):

225 
£lf
.
¥šÃr
.
	$¡¬t
()

226 
£lf
.
¥šÃr
.
	$show
()

228 
£lf
.
¥šÃr
.
	$hide
()

229 
	$isš¡ªû
(
£lf
.
¥šÃr
, 
Gtk
.
SpšÃr
):

230 
£lf
.
¥šÃr
.
	`¡İ
()

	@gtk/backends_dialog/parameters_ui/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
This
 
moduË
 
»ads
 
a
 
bakú
 
cÚfigu¿tiÚ
 
ªd
 
g’”©es
‡ 
£r›s
 
of
 
widg‘s
 
to


18 
Ët
 
the
 
u£r
 
£e
h
cÚfigu¿tiÚ
 
ªd
 
modify
 
	g™
.

19 
In
 
this
 
	gmªÃr
, 
back’ds
 dØ
nÙ
 
Ãed
 
to
 
know
 
ªythšg
 
about
 
theœ
 
UI
 
sšû
 
	g™
's

20 
but
 
	gthem
: 
™
 
should
 
¶ay
 
®Úg
 
the
 
lšes
 
of
h
£·¿tiÚ
 
b‘w“n
 
GTG


21 
£rv”
 
ªd
 
ş›Á


24 
äom
 
gi
.
»pos™Üy
 
impÜt
 
Gtk


25 
impÜt
 
funùoŞs


27 
äom
 
GTG
 
impÜt
 
_


28 
äom
 
GTG
.
back’ds
.
g’”icback’d
 
impÜt
 
G’”icBack’d


29 
äom
 
GTG
.
gtk
.
back’ds_dŸlog
.
·¿m‘”s_ui
.
impÜ‰agsui
 
impÜt
 
ImpÜtTagsUI


30 
äom
 
GTG
.
gtk
.
back’ds_dŸlog
.
·¿m‘”s_ui
.
‹xtui
 
impÜt
 
TextUI


31 
äom
 
GTG
.
gtk
.
back’ds_dŸlog
.
·¿m‘”s_ui
.
·sswÜdui
 
impÜt
 
PasswÜdUI


32 
äom
 
GTG
.
gtk
.
back’ds_dŸlog
.
·¿m‘”s_ui
.
³riodui
 
impÜt
 
P”iodUI


33 
äom
 
GTG
.
gtk
.
back’ds_dŸlog
.
·¿m‘”s_ui
.
checkboxui
 
impÜt
 
CheckBoxUI


34 
äom
 
GTG
.
gtk
.
back’ds_dŸlog
.
·¿m‘”s_ui
.
·thui
 
impÜt
 
P©hUI


37 
şass
 
	$P¬am‘”sUI
(
Gtk
.
Box
):

39 
Giv’
 
a
 
bakûnd
, 
this
 
v”tiÿl
 
Gtk
.
Box
 
pİuÏ‹s
 
™£lf
 
w™h
 
®l
 
the


40 
Ãûs§ry


41 
widg‘s
 
to
 
v›w
 
ªd
 
ed™
 
a
 
back’d
 
cÚfigu¿tiÚ


44 
COMMON_WIDTH
 = 170

46 
def
 
	$__š™__
(
£lf
, 
»que¡”
):

49 @
·¿m
 
»que¡”
: 
a
 
GTG
.
cÜe
.»que¡”.
Reque¡”
 
objeù


51 
	`su³r
(
P¬am‘”sUI
, 
£lf
).
	$__š™__
(

52 
F®£
, 
Ü›Á©iÚ
=
Gtk
.
Or›Á©iÚ
.
VERTICAL
)

53 
£lf
.
»q
 = 
»que¡”


54 
£lf
.
	$£t_¥acšg
(10)

56 #bud 
a
 
li¡
 
of
 
widg‘
 
g’”©Üs
. 
MÜe
 
´eci£ly
, 
™
's‡

57 #li¡ 
of
 
tu¶es
: (
back’d_·¿m‘”_Çme
, 
widg‘_g’”©Ü
)

58 
£lf
.
·¿m‘”_widg‘s
 = (

59 ("impÜt-gs", 
£lf
.
	`UI_g’”©Ü
(
ImpÜtTagsUI
, {

60 "t™Ë": 
	`_
("Importags"),

61 "ªybox_‹xt": 
	`_
("Allags"),

62 "somebox_‹xt": 
	`_
("Justheseags:"),

64 
	}
})),

65 ("©ched-gs", 
	g£lf
.
UI_g’”©Ü
(
ImpÜtTagsUI
, {

66 "t™Ë": 
_
("Tagso sync"),

67 "ªybox_‹xt": 
_
("Allasks"),

68 "somebox_‹xt": 
_
("Tasks withheseags:"),

71 ("·th", 
	g£lf
.
UI_g’”©Ü
(
P©hUI
)),

72 ("u£ºame", 
	g£lf
.
UI_g’”©Ü
(
TextUI
, {

73 "desütiÚ": 
_
("Username"),

76 ("·sswÜd", 
	g£lf
.
UI_g’”©Ü
(
PasswÜdUI
)),

77 ("³riod", 
	g£lf
.
UI_g’”©Ü
(
P”iodUI
)),

78 ("£rviû-u¾", 
	g£lf
.
UI_g’”©Ü
(
TextUI
, {

79 "desütiÚ": 
_
("Service URL"),

82 ("impÜt-äom-»¶›s", 
	g£lf
.
UI_g’”©Ü
(
CheckBoxUI
, {

83 "‹xt": 
_
("Importasks from @„eplies directedo you"),

86 ("impÜt-äom-dœeù-mes§ges", 
	g£lf
.
UI_g’”©Ü
(
CheckBoxUI
, {

87 "‹xt": 
_
("Importasks from direct messages"),

90 ("impÜt-äom-my-tw“ts", 
	g£lf
.
UI_g’”©Ü
(
CheckBoxUI
, {

91 "‹xt": 
_
("Importasks from yourweets"),

94 ("impÜt-bug-gs", 
	g£lf
.
UI_g’”©Ü
(
CheckBoxUI
, {

95 "‹xt": 
_
("Tag your GTGasks withhe bugags"),

98 ("g-w™h-´ojeù-Çme", 
	g£lf
.
UI_g’”©Ü
(
CheckBoxUI
, {

99 "‹xt": 
_
("Tag your GTGasks withhe…roject "

105 
def
 
UI_g’”©Ü
(
£lf
, 
·¿m_ty³
, 
¥ecŸl_¬gum’ts
={}):

107 
It
 
·s£s
 
to
 
the
 
ü—‹d
 
widg‘
 
g’”©Ü
 
a
 
£r›s
 
of
 
commÚ


108 
·¿m‘”s
, 
¶us
 
the
 
Úes
 
Ãeded
 
to
 
¥ecŸlize
h
giv’
 
	g‹m¶©e


110 @
·¿m
 
	g·¿m_ty³
: 
the
 
‹m¶©e
 
to
 
¥ecŸlize


111 @
·¿m
 
¥ecŸl_¬gum’ts
: 
the
 
¬gum’ts
 
u£d
 
this
 
·¹icuÏr
 
widg‘


112 
g’”©Ü
.

114 @ 
funùiÚ
:  
a
 
widg‘
 
g’”©Ü
, 
nÙ
‡ 
	gwidg‘
. 
the
 widget

115 
ÿn
 
be
 
obšed
 
by
 
ÿÎšg
 
widg‘_g’”©Ü
(
back’d
)

117  
Ïmbda
 
	gback’d
: 
	$·¿m_ty³
(
»q
=
£lf
.req,

118 
back’d
=backend,

119 
width
=
£lf
.
COMMON_WIDTH
,

120 **
¥ecŸl_¬gum’ts
)

122 
def
 
	$»äesh
(
£lf
, 
back’d
):

123 '''Bud thwidg‘ Ãûs§ryØcÚfigu»hback’d. Ià™ dÛ¢'
t


124 
know
 
how
 
to
 
»nd”
 
a
 
widg‘
, 
™
 
sim¶y
 
sks
 it.

126 @
·¿m
 
back’d
: 
the
 back’d 
th©
 
is
 
bešg
 
cÚfigu»d


128 #»mov
the
 
Şd
 
·¿m‘”s
 
UIs


129 
def
 
	$_»move_chd
(
£lf
, 
chd
, 
d©a
=
NÚe
):

130 
£lf
.
	$»move
(
chd
)

131 
£lf
.
	`fÜ—ch
(
funùoŞs
.
	`·¹Ÿl
(
_»move_chd
, s–f), 
NÚe
)

132 #add 
Ãw
 
widg‘s


133 
back’d_·¿m‘”s
 = 
back’d
.
	$g‘_·¿m‘”s
()

134 
back’d_·¿m‘”s
[
G’”icBack’d
.
KEY_DEFAULT_BACKEND
]:

135 #ià
™
'she default backend,he user should‚ot mess with it

137 
·¿m‘”_Çme
, 
widg‘
 
š
 
£lf
.
·¿m‘”_widg‘s
:

138 
·¿m‘”_Çme
 
š
 
back’d_·¿m‘”s
:

139 #FIXME 
I
 
am
 
nÙ
 100% 
about
 
this
 
chªge


140 
£lf
.
	`·ck_¡¬t
(
	`widg‘
(
back’d
), 
True
, True, 0)

141 
£lf
.
	$show_®l
()

143 
def
 
	$comm™_chªges
(
£lf
):

145 
Saves
 
®l
 
the
 
·¿m‘”s
 
©
 
theœ
 
cu¼’t
 
	`¡©e
 (th
u£r
 
may
 
have


146 
modif›d
 
them
)

149 
def
 
	$_comm™_chªges
(
chd
, 
d©a
=
NÚe
):

150 
chd
.
	$comm™_chªges
()

151 
£lf
.
	`fÜ—ch
(
_comm™_chªges
, 
NÚe
)

	@gtk/backends_dialog/parameters_ui/checkboxui.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


20 
şass
 
	$CheckBoxUI
(
Gtk
.
Box
):

22 
It
's‡ widget displaying‡ simple checkbox, with someextoƒxplain its

23 
m—nšg


26 
def
 
	$__š™__
(
£lf
, 
»q
, 
back’d
, 
width
, 
‹xt
, 
·¿m‘”
):

28 
C»©es
 
the
 
checkbox
 
ªd
h
»Ï‹d
 
Ïb–
.

30 @
·¿m
 
»q
: 
a
 
Reque¡”


31 @
·¿m
 
back’d
: 
a
 back’d 
objeù


32 @
·¿m
 
width
: 
the
 width 
of
h
gtk
.
Lab–
 
objeù


33 @
·¿m
 
·¿m‘”
: 
the
 
back’d
…¬am‘” 
this
 
checkbox
 
should
 
di¥Ïy


34 
ªd
 
modify


36 
	`su³r
(
CheckBoxUI
, 
£lf
).
	$__š™__
()

37 
£lf
.
back’d
 = backend

38 
£lf
.
»q
 =„eq

39 
£lf
.
‹xt
 =ext

40 
£lf
.
·¿m‘”
 =…arameter

41 
£lf
.
	$_pİuÏ‹_gtk
(
width
)

43 
def
 
	$_pİuÏ‹_gtk
(
£lf
, 
width
):

46 @
·¿m
 
width
: 
the
 width 
of
h
Gtk
.
Lab–
 
objeù


48 
£lf
.
checkbu‰Ú
 = 
Gtk
.
	$CheckBu‰Ú
(
Ïb–
=
£lf
.
‹xt
)

49 
back’d_·¿m‘”s
 = 
£lf
.
back’d
.
	`g‘_·¿m‘”s
()[£lf.
·¿m‘”
]

50 
£lf
.
checkbu‰Ú
.
	$£t_aùive
(
back’d_·¿m‘”s
)

51 
£lf
.
checkbu‰Ú
.
	`cÚÃù
("toggËd", s–f.
Ú_modif›d
)

52 
£lf
.
	$·ck_¡¬t
(
£lf
.
checkbu‰Ú
, 
F®£
, 
True
, 0)

54 
def
 
	$comm™_chªges
(
£lf
):

56 
£lf
.
back’d
.
	`£t_·¿m‘”
(£lf.
·¿m‘”
,

57 
£lf
.
checkbu‰Ú
.
	$g‘_aùive
())

59 
def
 
	$Ú_modif›d
(
£lf
, 
£nd”
=
NÚe
):

61 
Di§bËs
 
the
 
back’d
. 
The
 
u£r
 
wl
 
»
-
’abË
 
™
 
to
 
cÚfœm
h
chªges


62 (
s
)
he
 
made
.

64 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
Úly
 
h”e
 
sigÇl
 
com·tib™y


66 
£lf
.
back’d
.
	$is_’abËd
(è
ªd
 
nÙ
 
£lf
.
back’d
.
	$is_deçuÉ
():

67 
£lf
.
»q
.
	`£t_back’d_’abËd
(£lf.
back’d
.
	`g‘_id
(), 
F®£
)

	@gtk/backends_dialog/parameters_ui/importtagsui.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


19 
äom
 
	gGTG
.
	gback’ds
.
g’”icback’d
 
impÜt
 
G’”icBack’d


20 
äom
 
funùoŞs
 
impÜt
 
»duû


23 
şass
 
	$ImpÜtTagsUI
(
Gtk
.
Box
):

25 
It
's‡ widget displaying‡ couple of„adio buttons,‡†abel‡nd‡extbox

26 
to
 
Ët
 
the
 
u£r
 
chªge
h
©ched
 
	`gs
 (
Ü
 
impÜ‹d
)

29 
def
 
	$__š™__
(
£lf
, 
»q
, 
back’d
, 
width
, 
t™Ë
, 
ªybox_‹xt
, 
somebox_‹xt
,

30 
·¿m‘”_Çme
):

33 @
·¿m
 
»q
: 
a
 
»que¡”


34 @
·¿m
 
back’d
: 
the
 back’d 
to
 
cÚfigu»


35 @
·¿m
 
width
: 
the
 
Ëngth
 
of
h
¿dio
 
bu‰Ús


36 @
·¿m
 
t™Ë
: 
the
 
‹xt
 th
Ïb–
 
desüibšg
 
wh©
 
this
 
cŞËùiÚ


37 
of
 
gtk
 
widg‘s
 
is
 
u£d
 

38 @
·¿m
 
ªybox_‹xt
: 
the
 
‹xt
 th"Anyag m©ches" 
¿dio
 
bu‰Ú


39 @
·¿m
 
somebox_‹xt
: 
the
 
‹xt
 the "onlyhis set ofags matches"

40 
¿dio
 
bu‰Ú


41 @
·¿m
 
·¿m‘”_Çme
: 
the
 
back’d
 
·¿m‘”
 
this
 
widg‘
 
should
 
modify


43 
	`su³r
(
ImpÜtTagsUI
, 
£lf
).
	$__š™__
(

44 
Ü›Á©iÚ
=
Gtk
.
Or›Á©iÚ
.
VERTICAL
)

45 
£lf
.
back’d
 = backend

46 
£lf
.
»q
 =„eq

47 
£lf
.
t™Ë
 =itle

48 
£lf
.
ªybox_‹xt
 =‡nybox_text

49 
£lf
.
somebox_‹xt
 = somebox_text

50 
£lf
.
·¿m‘”_Çme
 =…arameter_name

51 
£lf
.
	$_pİuÏ‹_gtk
(
width
)

52 
£lf
.
	$_»äesh_gs
()

53 
£lf
.
	$_cÚÃù_sigÇls
()

55 
def
 
	$_pİuÏ‹_gtk
(
£lf
, 
width
):

57 
PİuÏ‹s
 
the
 
widg‘s


59 @
·¿m
 
width
: 
the
 
Ëngth
 
of
h
¿dio
 
bu‰Ús


61 
t™Ë_Ïb–
 = 
Gtk
.
	$Lab–
()

62 
t™Ë_Ïb–
.
	$£t_®ignm’t
(
x®ign
=0, 
y®ign
=0)

63 
t™Ë_Ïb–
.
	`£t_m¬kup
("<big><b>%s</b></big>" % 
£lf
.
t™Ë
)

64 
£lf
.
	$·ck_¡¬t
(
t™Ë_Ïb–
, 
True
, True, 0)

65 
®ign
 = 
Gtk
.
Alignm’t
.
	$Ãw
(0, 0, 1, 0)

66 
®ign
.
	$£t_·ddšg
(0, 0, 10, 0)

67 
£lf
.
	$·ck_¡¬t
(
®ign
, 
True
, True, 0)

68 
vbox
 = 
Gtk
.
	$Box
(
Ü›Á©iÚ
=
Gtk
.
Or›Á©iÚ
.
VERTICAL
)

69 
®ign
.
	$add
(
vbox
)

70 
£lf
.
®l_gs_¿dio
 = 
Gtk
.
	$RadioBu‰Ú
(
group
=
NÚe
,

71 
Ïb–
=
£lf
.
ªybox_‹xt
)

72 
vbox
.
	$·ck_¡¬t
(
£lf
.
®l_gs_¿dio
, 
True
, True, 0)

73 
£lf
.
some_gs_¿dio
 = 
Gtk
.
	$RadioBu‰Ú
(
group
=
£lf
.
®l_gs_¿dio
,

74 
Ïb–
=
£lf
.
somebox_‹xt
)

75 
£lf
.
some_gs_¿dio
.
	`£t_size_»que¡
(
width
=width, 
height
=-1)

76 
box
 = 
Gtk
.
	$Box
()

77 
vbox
.
	$·ck_¡¬t
(
box
, 
True
, True, 0)

78 
box
.
	$·ck_¡¬t
(
£lf
.
some_gs_¿dio
, 
F®£
, 
True
, 0)

79 
£lf
.
gs_’Œy
 = 
Gtk
.
	$EÁry
()

80 
box
.
	$·ck_¡¬t
(
£lf
.
gs_’Œy
, 
True
, True, 0)

82 
def
 
	$Ú_chªged
(
£lf
, 
¿dio
, 
d©a
=
NÚe
):

84 
Di§bËs
 
the
 
back’d
. 
The
 
u£r
 
wl
 
»
-
’abË
 
™
 
to
 
cÚfœm
h
chªges


85 (
s
)
he
 
made
.

87 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
Úly
 
h”e
 
sigÇl
 
com·tib™y


88 @
·¿m
 
d©a
: 
nÙ
 
u£d
, 
Úly
 
h”e
 
sigÇl
 
com·tib™y


90 #ev”y 
chªge
 
š
 
the
 
cÚfig
 
di§bËs
h
back’d


91 
£lf
.
»q
.
	`£t_back’d_’abËd
(£lf.
back’d
.
	`g‘_id
(), 
F®£
)

92 
£lf
.
	$_»äesh_‹xtbox_¡©e
()

94 
def
 
	$comm™_chªges
(
£lf
):

96 
£lf
.
®l_gs_¿dio
.
	$g‘_aùive
():

97 
gs
 = [
G’”icBack’d
.
ALLTASKS_TAG
]

99 
gs
 = 
£lf
.
gs_’Œy
.
	`g‘_‹xt
().
	`¥l™
(",")

100 #¡rpšg 
¥aûs


101 
gs
 = [
t
.
	$¡r
(è
t
 
š
 
gs
]

102 #»movšg 
em±y
 
gs


103 
gs
 = [
t
 ˆ
š
ags t]

105 
£lf
.
back’d
.
	$£t_·¿m‘”
(
£lf
.
·¿m‘”_Çme
, 
gs
)

107 
def
 
	$_»äesh_‹xtbox_¡©e
(
£lf
):

109 
£lf
.
gs_’Œy
.
	`£t_£ns™ive
(£lf.
some_gs_¿dio
.
	$g‘_aùive
())

111 
def
 
	$_»äesh_gs
(
£lf
):

113 
Reäeshes
 
the
 
li¡
 
of
 
gs
 
to
 
di¥Ïy
 
š
h
‹xtbox
, 
ªd
 
£Ëùs


114 
the
 
cÜ»ù
 
¿dio
 
bu‰Ú


116 
gs_li¡
 = 
£lf
.
back’d
.
	`g‘_·¿m‘”s
()[£lf.
·¿m‘”_Çme
]

117 
has_®l_sks
 = 
G’”icBack’d
.
ALLTASKS_TAG
 
š
 
gs_li¡


118 
£lf
.
®l_gs_¿dio
.
	$£t_aùive
(
has_®l_sks
)

119 
£lf
.
some_gs_¿dio
.
	$£t_aùive
(
nÙ
 
has_®l_sks
)

120 
£lf
.
	$_»äesh_‹xtbox_¡©e
()

121 
nÙ
 
has_®l_sks
:

122 
gs_‹xt
 = ""

123 
gs_li¡
:

124 
gs_‹xt
 = 
	`»duû
(
Ïmbda
 
a
, 
b
:‡ + ", " + b, 
gs_li¡
)

125 
£lf
.
gs_’Œy
.
	$£t_‹xt
(
gs_‹xt
)

127 
def
 
	$_cÚÃù_sigÇls
(
£lf
):

129 
£lf
.
some_gs_¿dio
.
	`cÚÃù
("toggËd", s–f.
Ú_chªged
)

130 
£lf
.
®l_gs_¿dio
.
	`cÚÃù
("toggËd", s–f.
Ú_chªged
)

131 
£lf
.
gs_’Œy
.
	`cÚÃù
("chªged", s–f.
Ú_chªged
)

	@gtk/backends_dialog/parameters_ui/passwordui.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


19 
äom
 
GTG
 
impÜt
 
_


22 
şass
 
	$PasswÜdUI
(
Gtk
.
Box
):

25 
def
 
	$__š™__
(
£lf
, 
»q
, 
back’d
, 
width
):

27 
f›ld


29 @
·¿m
 
»q
: 
a
 
Reque¡”


30 @
·¿m
 
back’d
: 
a
 back’d 
objeù


31 @
·¿m
 
width
: 
the
 width 
of
h
Gtk
.
Lab–
 
objeù


33 
	`su³r
(
PasswÜdUI
, 
£lf
).
	$__š™__
()

34 
£lf
.
back’d
 = backend

35 
£lf
.
»q
 =„eq

36 
£lf
.
	$_pİuÏ‹_gtk
(
width
)

37 
£lf
.
	$_lßd_·sswÜd
()

38 
£lf
.
	$_cÚÃù_sigÇls
()

40 
def
 
	$_pİuÏ‹_gtk
(
£lf
, 
width
):

43 @
·¿m
 
width
: 
the
 width 
of
h
Gtk
.
Lab–
 
objeù


45 
·sswÜd_Ïb–
 = 
Gtk
.
	`Lab–
(
Ïb–
=
	`_
("Password:"))

46 
·sswÜd_Ïb–
.
	$£t_®ignm’t
(
x®ign
=0, 
y®ign
=0.5)

47 
·sswÜd_Ïb–
.
	`£t_size_»que¡
(
width
=width, 
height
=-1)

48 
£lf
.
	$·ck_¡¬t
(
·sswÜd_Ïb–
, 
F®£
, 
True
, 0)

49 
®ign
 = 
Gtk
.
Alignm’t
.
	$Ãw
(0, 0.5, 1, 0)

50 
®ign
.
	$£t_·ddšg
(0, 0, 10, 0)

51 
£lf
.
	$·ck_¡¬t
(
®ign
, 
True
, True, 0)

52 
£lf
.
·sswÜd_‹xtbox
 = 
Gtk
.
	$EÁry
()

53 
®ign
.
	$add
(
£lf
.
·sswÜd_‹xtbox
)

55 
def
 
	$_lßd_·sswÜd
(
£lf
):

57 
·sswÜd
 = 
£lf
.
back’d
.
	`g‘_·¿m‘”s
()['password']

58 
£lf
.
·sswÜd_‹xtbox
.
	`£t_švisibË_ch¬
('*')

59 
£lf
.
·sswÜd_‹xtbox
.
	$£t_visib™y
(
F®£
)

60 
£lf
.
·sswÜd_‹xtbox
.
	$£t_‹xt
(
·sswÜd
)

62 
def
 
	$_cÚÃù_sigÇls
(
£lf
):

64 
£lf
.
·sswÜd_‹xtbox
.
	`cÚÃù
('chªged', s–f.
Ú_·sswÜd_modif›d
)

66 
def
 
	$comm™_chªges
(
£lf
):

67 '''Save thchªge tØthback’d…¬am‘” ('
·sswÜd
')'''

68 
·sswÜd
 = 
£lf
.
·sswÜd_‹xtbox
.
	$g‘_‹xt
()

69 
£lf
.
back’d
.
	`£t_·¿m‘”
('·sswÜd', 
·sswÜd
)

71 
def
 
	$Ú_·sswÜd_modif›d
(
£lf
, 
£nd”
):

73 
Di§bËs
 
the
 
back’d
. 
The
 
u£r
 
wl
 
»
-
’abË
 
™
 
to
 
cÚfœm
h
chªges


74 (
s
)
he
 
made
.

76 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
Úly
 
h”e
 
sigÇl
 
com·tib™y


78 
£lf
.
back’d
.
	$is_’abËd
(è
ªd
 
nÙ
 
£lf
.
back’d
.
	$is_deçuÉ
():

79 
£lf
.
»q
.
	`£t_back’d_’abËd
(£lf.
back’d
.
	`g‘_id
(), 
F®£
)

	@gtk/backends_dialog/parameters_ui/pathui.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


18 
impÜt
 
	gos
.
·th


20 
äom
 
GTG
 
impÜt
 
_


23 
şass
 
	$P©hUI
(
Gtk
.
Box
):

25 
fesy¡em
 
ex¶Ü”
 
to
 
modify
 
th©
 
	`·th
 (
®so
, 
a
 
Ïb–
Ø
desüibe
 
tho£
)

28 
def
 
	$__š™__
(
£lf
, 
»q
, 
back’d
, 
width
):

30 
C»©es
 
the
 
‹xtbox
,h
bu‰Ú
 
ªd
 
lßds
h
cu¼’t
 
·th
.

32 @
·¿m
 
»q
: 
a
 
Reque¡”


33 @
·¿m
 
back’d
: 
a
 back’d 
objeù


34 @
·¿m
 
width
: 
the
 width 
of
h
Gtk
.
Lab–
 
objeù


36 
	`su³r
(
P©hUI
, 
£lf
).
	$__š™__
()

37 
£lf
.
back’d
 = backend

38 
£lf
.
»q
 =„eq

39 
£lf
.
	$_pİuÏ‹_gtk
(
width
)

41 
def
 
	$_pİuÏ‹_gtk
(
£lf
, 
width
):

44 @
·¿m
 
width
: 
the
 width 
of
h
Gtk
.
Lab–
 
objeù


46 
Ïb–
 = 
Gtk
.
	`Lab–
Öab–=
	`_
("Filename:"))

47 
Ïb–
.
	$£t_lše_w¿p
(
True
)

48 
Ïb–
.
	$£t_®ignm’t
(
x®ign
=0, 
y®ign
=0.5)

49 
Ïb–
.
	`£t_size_»que¡
(
width
=width, 
height
=-1)

50 
£lf
.
	$·ck_¡¬t
(
Ïb–
, 
F®£
, 
True
, 0)

51 
®ign
 = 
Gtk
.
Alignm’t
.
	$Ãw
(0, 0.5, 1, 0)

52 
®ign
.
	$£t_·ddšg
(0, 0, 10, 0)

53 
£lf
.
	$·ck_¡¬t
(
®ign
, 
True
, True, 0)

54 
£lf
.
‹xtbox
 = 
Gtk
.
	$EÁry
()

55 
£lf
.
‹xtbox
.
	`£t_‹xt
(£lf.
back’d
.
	`g‘_·¿m‘”s
()['path'])

56 
£lf
.
‹xtbox
.
	`cÚÃù
('chªged', s–f.
Ú_·th_modif›d
)

57 
®ign
.
	$add
(
£lf
.
‹xtbox
)

58 
£lf
.
bu‰Ú
 = 
Gtk
.
	$Bu‰Ú
(
¡ock
=
Gtk
.
STOCK_EDIT
)

59 
£lf
.
bu‰Ú
.
	`cÚÃù
('şicked', s–f.
Ú_bu‰Ú_şicked
)

60 
£lf
.
	$·ck_¡¬t
(
£lf
.
bu‰Ú
, 
F®£
, 
True
, 0)

62 
def
 
	$comm™_chªges
(
£lf
):

64 
£lf
.
back’d
.
	`£t_·¿m‘”
('·th', s–f.
‹xtbox
.
	$g‘_‹xt
())

66 
def
 
	$Ú_·th_modif›d
(
£lf
, 
£nd”
):

68 
Di§bËs
 
the
 
back’d
. 
The
 
u£r
 
wl
 
»
-
’abË
 
™
 
to
 
cÚfœm
h
chªges


69 (
s
)
he
 
made
.

71 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
Úly
 
h”e
 
sigÇl
 
com·tib™y


73 
£lf
.
back’d
.
	$is_’abËd
(è
ªd
 
nÙ
 
£lf
.
back’d
.
	$is_deçuÉ
():

74 
£lf
.
»q
.
	`£t_back’d_’abËd
(£lf.
back’d
.
	`g‘_id
(), 
F®£
)

76 
def
 
	$Ú_bu‰Ú_şicked
(
£lf
, 
£nd”
):

79 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
Úly
 
h”e
 
sigÇl
 
com·tib™y


81 
£lf
.
choo£r
 = 
Gtk
.
	`FeChoo£rDŸlog
(

82 
t™Ë
=
NÚe
,

83 
aùiÚ
=
Gtk
.
FeChoo£rAùiÚ
.
SAVE
,

84 
bu‰Ús
=(
Gtk
.
STOCK_CANCEL
,

85 
Gtk
.
Re¥Ú£Ty³
.
CANCEL
,

86 
Gtk
.
STOCK_OK
,

87 
Gtk
.
Re¥Ú£Ty³
.
OK
))

88 
£lf
.
choo£r
.
	$£t_deçuÉ_»¥Ú£
(
Gtk
.
Re¥Ú£Ty³
.
OK
)

89 #£ˆ 
fe
 
as
 
the
 
cu¼’t
 
£lf
.
·th


90 
dœÇme
, 
ba£Çme
 = 
os
.
·th
.
	`¥l™
(
£lf
.
‹xtbox
.
	$g‘_‹xt
())

91 
£lf
.
choo£r
.
	$£t_cu¼’t_Çme
(
ba£Çme
)

92 
£lf
.
chos£r
.
	$£t_cu¼’t_fŞd”
(
dœÇme
)

94 #f‹¸
fes


95 
af‹r
 = 
Gtk
.
	$FeF‹r
()

96 
af‹r
.
	`£t_Çme
("All files")

97 
af‹r
.
	`add_·‰”n
("*")

98 
£lf
.
choo£r
.
	$add_f‹r
(
af‹r
)

99 
af‹r
 = 
Gtk
.
	$FeF‹r
()

100 
af‹r
.
	`£t_Çme
("XML files")

101 
af‹r
.
	`add_mime_ty³
("text/plain")

102 
af‹r
.
	`add_·‰”n
("*.xml")

103 
£lf
.
choo£r
.
	$add_f‹r
(
af‹r
)

104 
»¥Ú£
 = 
£lf
.
choo£r
.
	$run
()

105 
»¥Ú£
 =ğ
Gtk
.
Re¥Ú£Ty³
.
OK
:

106 
£lf
.
‹xtbox
.
	`£t_‹xt
(£lf.
choo£r
.
	$g‘_f’ame
())

107 
£lf
.
choo£r
.
	`de¡roy
()

	@gtk/backends_dialog/parameters_ui/periodui.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


19 
äom
 
GTG
 
impÜt
 
	g_
, 
ng‘‹xt


22 
şass
 
	$P”iodUI
(
Gtk
.
Box
):

26 
def
 
	$__š™__
(
£lf
, 
»q
, 
back’d
, 
width
):

28 
C»©es
 
the
 
Gtk
.
Adju¡m’t
 
ªd
h
»Ï‹d
 
Ïb–
. 
Lßds
h
cu¼’t


29 
³riod
.

31 @
·¿m
 
»q
: 
a
 
Reque¡”


32 @
·¿m
 
back’d
: 
a
 back’d 
objeù


33 @
·¿m
 
width
: 
the
 width 
of
h
Gtk
.
Lab–
 
objeù


35 
	`su³r
(
P”iodUI
, 
£lf
).
	$__š™__
()

36 
£lf
.
back’d
 = backend

37 
£lf
.
»q
 =„eq

38 
£lf
.
	$_pİuÏ‹_gtk
(
width
)

39 
£lf
.
	$_cÚÃù_sigÇls
()

41 
def
 
	$_pİuÏ‹_gtk
(
£lf
, 
width
):

44 @
·¿m
 
width
: 
the
 width 
of
h
Gtk
.
Lab–
 
objeù


46 
³riod_Ïb–
 = 
Gtk
.
	`Lab–
(
Ïb–
=
	`_
("Check for‚ewasksƒvery"))

47 
³riod_Ïb–
.
	$£t_®ignm’t
(
x®ign
=0, 
y®ign
=0.5)

48 
³riod_Ïb–
.
	$£t_lše_w¿p
(
True
)

49 
³riod_Ïb–
.
	`£t_size_»que¡
(
width
=width, 
height
=-1)

50 
£lf
.
	$·ck_¡¬t
(
³riod_Ïb–
, 
F®£
, 
True
, 0)

51 
®ign
 = 
Gtk
.
Alignm’t
.
	$Ãw
(0, 0.5, 1, 0)

52 
®ign
.
	$£t_·ddšg
(0, 0, 10, 0)

53 
£lf
.
	$·ck_¡¬t
(
®ign
, 
F®£
, 
True
, 0)

54 
³riod
 = 
£lf
.
back’d
.
	`g‘_·¿m‘”s
()['period']

55 
£lf
.
adju¡m’t
 = 
Gtk
.
	$Adju¡m’t
(
v®ue
=
³riod
,

56 
low”
=1,

57 
uµ”
=120,

58 
¡•_šü
=1,

59 
·ge_šü
=0,

60 
·ge_size
=0)

61 
£lf
.
³riod_¥š
 = 
Gtk
.
	$SpšBu‰Ú
(
adju¡m’t
=
£lf
.adjustment,

62 
şimb_¿‹
=0.3,

63 
dig™s
=0)

64 
£lf
.
mšu‹s_Ïb–
 = 
Gtk
.
	$Lab–
()

65 
£lf
.
	$upd©e_mšu‹s_Ïb–
()

66 
£lf
.
mšu‹s_Ïb–
.
	$£t_®ignm’t
(
x®ign
=0, 
y®ign
=0.5)

67 
£lf
.
	$·ck_¡¬t
(
£lf
.
mšu‹s_Ïb–
, 
F®£
, 
True
, 0)

68 
®ign
.
	$add
(
£lf
.
³riod_¥š
)

69 
£lf
.
	$show_®l
()

71 
def
 
	$_cÚÃù_sigÇls
(
£lf
):

73 
£lf
.
³riod_¥š
.
	`cÚÃù
('chªged', s–f.
Ú_¥š_chªged
)

75 
def
 
	$comm™_chªges
(
£lf
):

77 
£lf
.
back’d
.
	`£t_·¿m‘”
('³riod', (£lf.
adju¡m’t
.
	$g‘_v®ue
()))

79 
def
 
	$Ú_¥š_chªged
(
£lf
, 
£nd”
):

81 
Di§bËs
 
the
 
back’d
. 
The
 
u£r
 
wl
 
»
-
’abË
 
™
 
to
 
cÚfœm
h
chªges


82 (
s
)
he
 
made
.

84 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
Úly
 
h”e
 
sigÇl
 
com·tib™y


86 
£lf
.
	$upd©e_mšu‹s_Ïb–
()

87 
£lf
.
back’d
.
	$is_’abËd
(è
ªd
 
nÙ
 
£lf
.
back’d
.
	$is_deçuÉ
():

88 
£lf
.
»q
.
	`£t_back’d_’abËd
(£lf.
back’d
.
	`g‘_id
(), 
F®£
)

90 
def
 
	$upd©e_mšu‹s_Ïb–
(
£lf
):

91 
adju¡m’t
 = (
£lf
.adju¡m’t.
	$g‘_v®ue
())

92 
£lf
.
mšu‹s_Ïb–
.
	`£t_m¬kup
(
	`ng‘‹xt
(" minute", " minutes",

93 
adju¡m’t
))

	@gtk/backends_dialog/parameters_ui/textui.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


20 
şass
 
	$TextUI
(
Gtk
.
Box
):

24 
def
 
	$__š™__
(
£lf
, 
»q
, 
back’d
, 
width
, 
desütiÚ
, 
·¿m‘”_Çme
):

26 
C»©es
 
the
 
‹xtbox
 
ªd
h
»Ï‹d
 
Ïb–
. 
Lßds
h
cu¼’t


27 
cÚ‹Á
.

29 @
·¿m
 
»q
: 
a
 
Reque¡”


30 @
·¿m
 
back’d
: 
a
 back’d 
objeù


31 @
·¿m
 
width
: 
the
 width 
of
h
Gtk
.
Lab–
 
objeù


33 
	`su³r
(
TextUI
, 
£lf
).
	$__š™__
()

34 
£lf
.
back’d
 = backend

35 
£lf
.
»q
 =„eq

36 
£lf
.
·¿m‘”_Çme
 =…arameter_name

37 
£lf
.
desütiÚ
 = description

38 
£lf
.
	$_pİuÏ‹_gtk
(
width
)

40 
def
 
	$_pİuÏ‹_gtk
(
£lf
, 
width
):

43 @
·¿m
 
width
: 
the
 width 
of
h
Gtk
.
Lab–
 
objeù


45 
Ïb–
 = 
Gtk
.
	`Lab–
Öab–="%s:" % 
£lf
.
desütiÚ
)

46 
Ïb–
.
	$£t_lše_w¿p
(
True
)

47 
Ïb–
.
	$£t_®ignm’t
(
x®ign
=0, 
y®ign
=0.5)

48 
Ïb–
.
	`£t_size_»que¡
(
width
=width, 
height
=-1)

49 
£lf
.
	$·ck_¡¬t
(
Ïb–
, 
F®£
, 
True
, 0)

50 
®ign
 = 
Gtk
.
Alignm’t
.
	$Ãw
(0, 0.5, 1, 0)

51 
®ign
.
	$£t_·ddšg
(0, 0, 10, 0)

52 
£lf
.
	$·ck_¡¬t
(
®ign
, 
True
, True, 0)

53 
£lf
.
‹xtbox
 = 
Gtk
.
	$EÁry
()

54 
back’d_·¿m‘”s
 = 
£lf
.
back’d
.
	`g‘_·¿m‘”s
()[£lf.
·¿m‘”_Çme
]

55 
£lf
.
‹xtbox
.
	$£t_‹xt
(
back’d_·¿m‘”s
)

56 
£lf
.
‹xtbox
.
	`cÚÃù
('chªged', s–f.
Ú_‹xt_modif›d
)

57 
®ign
.
	$add
(
£lf
.
‹xtbox
)

59 
def
 
	$comm™_chªges
(
£lf
):

61 
£lf
.
back’d
.
	`£t_·¿m‘”
(£lf.
·¿m‘”_Çme
,

62 
£lf
.
‹xtbox
.
	$g‘_‹xt
())

64 
def
 
	$Ú_‹xt_modif›d
(
£lf
, 
£nd”
):

66 
Di§bËs
 
the
 
back’d
. 
The
 
u£r
 
wl
 
»
-
’abË
 
™
 
to
 
cÚfœm
h
chªges


67 (
s
)
he
 
made
.

69 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
Úly
 
h”e
 
sigÇl
 
com·tib™y


71 
£lf
.
back’d
.
	$is_’abËd
(è
ªd
 
nÙ
 
£lf
.
back’d
.
	$is_deçuÉ
():

72 
£lf
.
»q
.
	`£t_back’d_’abËd
(£lf.
back’d
.
	`g‘_id
(), 
F®£
)

	@gtk/browser/CellRendererTags.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 #==ğ
IMPORT
 ===================================================================

19 #sy¡em 
impÜts


20 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
	gGObjeù
, 
	gGLib
, 
	gGtk
, 
Gdk


21 
impÜt
 
ÿœo


22 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
	gLog


24 #==ğ
MAIN
 
CLASS
 ===============================================================

27 
şass
 
	$C–lR’d””Tags
(
Gtk
.
C–lR’d””
):

28 
__g´İ”t›s__
 = {

29 'g_li¡': (
GObjeù
.
TYPE_PYOBJECT
,

30 "Tag†i¡", "A†i¡ oàgs", 
GObjeù
.
PARAM_READWRITE
),

31 'g': (
GObjeù
.
TYPE_PYOBJECT
, "Tag",

32 "Tag", 
GObjeù
.
PARAM_READWRITE
),

33 
	}
}

35 #Priv©
m‘hods


36 
def
 
	$__rounded»c
(
£lf
, 
cÚ‹xt
, 
x
, 
y
, 
w
, 
h
, 
r
=10):

38 #A****
BQ


39 #H 
C


41 #G 
D


42 #F****
E


44 
cÚ‹xt
.
	`move_to
(
x
 + 
r
, 
y
è#Mov
to
 
A


45 
cÚ‹xt
.
	`lše_to
(

46 
x
 + 
w
 - 
r
, 
y
è#SŒaighˆ
lše
 
to
 
B


47 #Curv
to
 
C
, 
CÚŒŞ
 
pošts
 
¬e
 
bÙh
 
©
 
Q


48 
cÚ‹xt
.
	`curve_to
(
x
 + 
w
, 
y
, x + w, y, x + w, y + 
r
)

49 
cÚ‹xt
.
	`lše_to
(
x
 + 
w
, 
y
 + 
h
 - 
r
è#Mov
to
 
D


50 
cÚ‹xt
.
	`curve_to
(

51 
x
 + 
w
, 
y
 + 
h
, x + w, y + h, x + w - 
r
, y + hè#Curv
to
 
E


52 
cÚ‹xt
.
	`lše_to
(
x
 + 
r
, 
y
 + 
h
è#Lš
to
 
F


53 
cÚ‹xt
.
	`curve_to
(
x
, 
y
 + 
h
, x, y + h, x, y + h - 
r
è#Curv
to
 
G


54 
cÚ‹xt
.
	`lše_to
(
x
, 
y
 + 
r
è#Lš
to
 
H


55 
cÚ‹xt
.
	`curve_to
(
x
, 
y
, x, y, x + 
r
, yè#Curv
to
 
A


58 
def
 
	$__couÁ_v›wabË_gs
(
£lf
):

60 
couÁ
 = 0

61 
£lf
.
g_li¡
 
is
 
nÙ
 
NÚe
:

62 
my_g
 
š
 
£lf
.
g_li¡
:

63 
my_g_cŞÜ
 = 
my_g
.
	`g‘_©Œibu‹
("color")

64 
my_g_icÚ
 = 
my_g
.
	`g‘_©Œibu‹
("icon")

65 
my_g_cŞÜ
 
Ü
 
my_g_icÚ
:

66 
couÁ
 = count + 1

67 
–if
 
£lf
.
g
 
is
 
nÙ
 
NÚe
:

68 
couÁ
 = 1

70 
couÁ
 = 0

72  
couÁ


74 #CÏs 
m‘hods


75 
def
 
	$__š™__
(
£lf
):

76 
Gtk
.
C–lR’d””
.
	$__š™__
(
£lf
)

77 
£lf
.
g_li¡
 = 
NÚe


78 
£lf
.
g
 = 
NÚe


79 
£lf
.
x·d
 = 1

80 
£lf
.
y·d
 = 1

81 
£lf
.
PADDING
 = 1

83 
def
 
	$do_£t_´İ”ty
(
£lf
, 
p¥ec
, 
v®ue
):

84 
p¥ec
.
Çme
 == "tag-list":

85 
£lf
.
g_li¡
 = 
v®ue


87 
	$£‰r
(
£lf
, 
p¥ec
.
Çme
, 
v®ue
)

89 
def
 
	$do_g‘_´İ”ty
(
£lf
, 
p¥ec
):

90 
p¥ec
.
Çme
 == "tag-list":

91  
£lf
.
g_li¡


93  
	$g‘©Œ
(
£lf
, 
p¥ec
.
Çme
)

95 
def
 
	$do_»nd”
(
£lf
, 
ü
, 
widg‘
, 
background_¬—
, 
ûÎ_¬—
, 
æags
):

97 
vw_gs
 = 
£lf
.
	$__couÁ_v›wabË_gs
()

98 
couÁ
 = 0

100 #S–eù 
sourû


101 
£lf
.
g_li¡
 
is
 
nÙ
 
NÚe
:

102 
gs
 = 
£lf
.
g_li¡


103 
–if
 
£lf
.
g
 
is
 
nÙ
 
NÚe
:

104 
gs
 = [
£lf
.
g
]

108 #D¿wšg 
cÚ‹xt


109 #ü = 
wšdow
.
	`ÿœo_ü—‹
()

110 #gdkcÚ‹xˆğ
Gdk
.
	`CaœoCÚ‹xt
(
ü
)

111 
gdkcÚ‹xt
 = 
ü


112 
gdkcÚ‹xt
.
	$£t_ªtŸlŸs
(
ÿœo
.
ANTIALIAS_NONE
)

114 #CoÜdš©e 
of
 
the
 
Üigš
 
pošt


115 
x_®ign
 = 
£lf
.
	`g‘_´İ”ty
("xalign")

116 
y_®ign
 = 
£lf
.
	`g‘_´İ”ty
("yalign")

117 
·ddšg
 = 
£lf
.
PADDING


118 
Üig_x
 = 
ûÎ_¬—
.
x
 + ((ûÎ_¬—.
width
 - 16 * 
vw_gs
 -

119 
·ddšg
 * 2 * (
vw_gs
 - 1)è* 
x_®ign
)

120 
Üig_y
 = 
ûÎ_¬—
.
y
 + ((ûÎ_¬—.
height
 - 16è* 
y_®ign
)

122 #W
d¿w
 
the
 
icÚs
 & 
squ¬es


123 
my_g
 
š
 
gs
:

125 
my_g_icÚ
 = 
my_g
.
	`g‘_©Œibu‹
("icon")

126 
my_g_cŞÜ
 = 
my_g
.
	`g‘_©Œibu‹
("color")

128 
»ù_x
 = 
Üig_x
 + 
£lf
.
PADDING
 * 2 * 
couÁ
 + 16 * count

129 
»ù_y
 = 
Üig_y


131 
my_g_icÚ
:

132 
Œy
:

133 
pixbuf
 = 
Gtk
.
IcÚTheme
.
	`g‘_deçuÉ
().
	$lßd_icÚ
(

134 
my_g_icÚ
, 16, 0)

135 
Gdk
.
	$ÿœo_£t_sourû_pixbuf
(
gdkcÚ‹xt
, 
pixbuf
,

136 
»ù_x
, 
»ù_y
)

137 
gdkcÚ‹xt
.
	$·št
()

138 
couÁ
 = count + 1

139 
exû±
 
GLib
.
GE¼Ü
:

140 #IÀ
some
 
¿»
 
ÿ£s
 
ª
 
icÚ
 
could
 
nÙ
 
be
 
found


141 #(
e
.
g
. 
wrÚg
 
£t
 
icÚ
 
·th
, 
missšg
 icon)

142 #Raisšg 
ª
 
exû±iÚ
 
b»aks
 
UI
 
ªd
 
sigÇl
 
ÿtch”
 
badly


143 
Log
.
	`”rÜ
("Cª'ˆlßd icÚ '%s'" % 
my_g_icÚ
)

145 
–if
 
my_g_cŞÜ
:

147 #D¿w 
rounded
 
»ùªgË


148 
my_cŞÜ
 = 
Gdk
.
	$cŞÜ_·r£
(
my_g_cŞÜ
)

149 
Gdk
.
	$ÿœo_£t_sourû_cŞÜ
(
gdkcÚ‹xt
, 
my_cŞÜ
)

150 
£lf
.
	$__rounded»c
(
gdkcÚ‹xt
, 
»ù_x
, 
»ù_y
, 16, 16, 8)

151 
gdkcÚ‹xt
.
	$fl
()

152 
couÁ
 = count + 1

154 #Ou‹¸
lše


155 
Gdk
.
	`ÿœo_£t_sourû_rgba
(
gdkcÚ‹xt
, Gdk.
	$RGBA
(0, 0, 0, 0.20))

156 
gdkcÚ‹xt
.
	$£t_lše_width
(1.0)

157 
£lf
.
	$__rounded»c
(
gdkcÚ‹xt
, 
»ù_x
, 
»ù_y
, 16, 16, 8)

158 
gdkcÚ‹xt
.
	$¡roke
()

160 
£lf
.
g
 
ªd
 
my_g
:

162 
my_g_icÚ
 = 
my_g
.
	`g‘_©Œibu‹
("icon")

163 
my_g_cŞÜ
 = 
my_g
.
	`g‘_©Œibu‹
("color")

165 
nÙ
 
my_g_icÚ
 
ªd
‚Ù 
my_g_cŞÜ
:

166 #D¿w 
rounded
 
»ùªgË


167 
Gdk
.
	`ÿœo_£t_sourû_rgba
(
gdkcÚ‹xt
,

168 
Gdk
.
	$RGBA
(0.95, 0.95, 0.95, 1))

169 
£lf
.
	$__rounded»c
(
gdkcÚ‹xt
, 
»ù_x
, 
»ù_y
, 16, 16, 8)

170 
gdkcÚ‹xt
.
	$fl
()

172 #Ou‹¸
lše


173 
Gdk
.
	`ÿœo_£t_sourû_rgba
(
gdkcÚ‹xt
, Gdk.
	$RGBA
(0, 0, 0, 0.20))

174 
gdkcÚ‹xt
.
	$£t_lše_width
(1.0)

175 
£lf
.
	$__rounded»c
(
gdkcÚ‹xt
, 
»ù_x
, 
»ù_y
, 16, 16, 8)

176 
gdkcÚ‹xt
.
	$¡roke
()

178 
def
 
	$do_g‘_size
(
£lf
, 
widg‘
, 
ûÎ_¬—
=
NÚe
):

179 
couÁ
 = 
£lf
.
	$__couÁ_v›wabË_gs
()

181 
couÁ
 != 0:

182  (
£lf
.
x·d
, s–f.
y·d
,

183 
£lf
.
x·d
 * 2 + 16 * 
couÁ
 + 2 * couÁ * s–f.
PADDING
,

184 16 + 2 * 
£lf
.
y·d
)

186  (
£lf
.
x·d
, s–f.
y·d
, self.xpad * 2, self.ypad * 2)

188 
GObjeù
.
	`ty³_»gi¡”
(
C–lR’d””Tags
)

	@gtk/browser/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
The
 
GTK
 
äÚ‹nd
 
browsšg
 
cŞËùiÚs
 
of
 
	gsks
.

19 
This
 
is
 
the
 
gnome_äÚ‹nd
 
	g·ckage
. 
	gIt
's‡ GTK interfacehat wantso be

20 
	gsim¶e
, 
HIG
 
com¶ŸÁ
 
ªd
 
w–l
 
š‹g¿‹d
 
w™h
 
	gGnome
.

22 
impÜt
 
os


24 
äom
 
GTG
 
impÜt
 
_


27 
şass
 
	gGnomeCÚfig
:

28 
cu¼’t_»p
 = 
os
.
·th
.
dœÇme
(os.·th.
	$ab¥©h
(
__fe__
))

29 
BROWSER_UI_FILE
 = 
os
.
·th
.
	`još
(
cu¼’t_»p
, "taskbrowser.ui")

30 
MODIFYTAGS_UI_FILE
 = 
os
.
·th
.
	`još
(
cu¼’t_»p
, "modifytags_dialog.ui")

31 
GLADE_FILE
 = 
os
.
·th
.
	`još
(
cu¼’t_»p
, "taskbrowser.glade")

32 
MODIFYTAGS_GLADE_FILE
 = 
os
.
·th
.
	`još
(
cu¼’t_»p
,

34 
TAGEDITOR_GLADE_FILE
 = 
os
.
·th
.
	`još
(
cu¼’t_»p
, "tageditor.glade")

36 
MARK_DONE
 = 
	`_
("Mark‡s Done")

37 
MARK_DONE_TOOLTIP
 = 
	`_
("Markhe selectedask‡s done")

38 
MARK_UNDONE
 = 
	`_
("Mark‡s‚ot Done")

39 
MARK_UNDONE_TOOLTIP
 = 
	`_
("Markhe selectedask‡s‚ot done")

40 
MARK_DISMISS
 = 
	`_
("Dismiss")

41 
MARK_DISMISS_TOOLTIP
 = 
	`_
("Markheask‡s‚oto be done‡nymore")

42 
MARK_UNDISMISS
 = 
	`_
("Undismiss")

43 
MARK_UNDISMISS_TOOLTIP
 = 
	`_
("Markhe selectedask‡so be done")

44 
DELETE_TOOLTIP
 = 
	`_
("Permanently„emovehe selectedask")

45 
EDIT_TOOLTIP
 = 
	`_
("Edithe selectedask")

46 
NEW_TASK_TOOLTIP
 = 
	`_
("Create‡‚ewask")

47 
NEW_SUBTASK_TOOLTIP
 = 
	`_
("Create‡‚ew subtask")

48 
WORKVIEW_TOGGLE_TOOLTIP
 = 
	`_
("Display onlyhe currently‡ctionableasks")

49 
TAG_IN_WORKVIEW_TOGG
 = 
	`_
("Hidehisag fromhe workview")

50 
TAG_NOTIN_WORKVIEW_TOGG
 = 
	`_
("Showhisag inhe workview")

51 
QUICKADD_ENTRY_TOOLTIP
 = \

52 
	`_
("You can create, open or filter yourasks here")

53 
QUICKADD_ICON_TOOLTIP
 = 
	`_
("Clear")

	@gtk/browser/browser.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

19 #==ğ
IMPORT
 ===================================================================

20 #sy¡em 
impÜts


21 
impÜt
 
time


22 
impÜt
 
th»adšg


23 
äom
 
webbrow£r
 
impÜt
 
İ’
 
as
 
İ’u¾


25 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
	gGObjeù
, 
	gGtk
, 
	gGdk


27 #ou¸
own
 
impÜts


28 
äom
 
GTG
 
impÜt
 
	g_
, 
	gšfo
, 
ng‘‹xt


29 
äom
 
	gGTG
.
	gback’ds
.
back’dsigÇls
 
impÜt
 
Back’dSigÇls


30 
äom
 
	gGTG
.
cÜe
 
impÜt
 
CÜeCÚfig


31 
äom
 
	gGTG
.
	gcÜe
.
£¬ch
 
impÜt
 
	g·r£_£¬ch_qu”y
, 
	gSEARCH_COMMANDS
, 
Inv®idQu”y


32 
äom
 
	gGTG
.
	gcÜe
.
sk
 
impÜt
 
Task


33 
äom
 
	gGTG
.
	ggtk
.
g_com¶‘iÚ
 
impÜt
 
TagCom¶‘iÚ


34 
äom
 
	gGTG
.
	ggtk
.
brow£r
 
impÜt
 
GnomeCÚfig


35 
äom
 
	gGTG
.
	ggtk
.
	gbrow£r
.
cu¡omšfob¬
 
impÜt
 
Cu¡omInfoB¬


36 
äom
 
	gGTG
.
	ggtk
.
	gbrow£r
.
modifygs_dŸlog
 
impÜt
 
ModifyTagsDŸlog


37 
äom
 
	gGTG
.
	ggtk
.
	gbrow£r
.
g_cÚ‹xt_m’u
 
impÜt
 
TagCÚ‹xtM’u


38 
äom
 
	gGTG
.
	ggtk
.
	gbrow£r
.
Œ“v›w_çùÜy
 
impÜt
 
T»ev›wFaùÜy


39 
äom
 
	gGTG
.
	ggtk
.
	ged™Ü
.
ÿËnd¬
 
impÜt
 
GTGC®’d¬


40 
äom
 
	gGTG
.
	gtoŞs
.
d©es
 
impÜt
 
D©e


41 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


44 
şass
 
	gTim”
:

46 
def
 
	$__š™__
(
£lf
, 
Çme
):

47 
£lf
.
Çme
 =‚ame

49 
def
 
	$__’‹r__
(
£lf
):

50 
£lf
.
¡¬t
 = 
time
.
	$time
()

52 
def
 
	$__ex™__
(
£lf
, *
¬gs
):

53 
	`´št
(("{0} : {1}".
	`fÜm©
(
£lf
.
Çme
, 
time
.
	`time
(è- s–f.
¡¬t
)))

56 
şass
 
	$TaskBrow£r
(
GObjeù
.GObject):

58 
ªd
 
li¡šg
 
gs
 
š
 
a
 
Œ“
 """

60 
__¡ršg_sigÇl__
 = (
GObjeù
.
SigÇlFÏgs
.
RUN_FIRST
, 
NÚe
, (
¡r
, ))

61 
__nÚe_sigÇl__
 = (
GObjeù
.
SigÇlFÏgs
.
RUN_FIRST
, 
NÚe
, 
	$tu¶e
())

62 
__gsigÇls__
 = {'sk-added-vŸ-quick-add': 
__¡ršg_sigÇl__
,

63 'visib™y-toggËd': 
__nÚe_sigÇl__
,

64 
	}
}

66 
def
 
	$__š™__
(
£lf
, 
»que¡”
, 
vmªag”
):

67 
GObjeù
.GObjeù.
	$__š™__
(
£lf
)

68 #Objeù 
´ime
 
v¬ŸbËs


69 
£lf
.
»q
 = 
»que¡”


70 
£lf
.
vmªag”
 = vmanager

71 
£lf
.
cÚfig
 = s–f.
»q
.
	`g‘_cÚfig
('browser')

72 
£lf
.
g_aùive
 = 
F®£


73 
£lf
.
­¶›d_gs
 = []

75 #Œ“v›w 
hªdËrs


76 
£lf
.
vŒ“_·Ãs
 = {
	}
}

77 
£lf
.
tv_çùÜy
 = 
	$T»ev›wFaùÜy
(
£lf
.
»q
, s–f.
cÚfig
)

78 
£lf
.
aùiv‘»e
 = s–f.
»q
.
	`g‘_sks_Œ“
(
Çme
='aùive', 
»äesh
=
F®£
)

79 
£lf
.
vŒ“_·Ãs
['active'] = \

80 
£lf
.
tv_çùÜy
.
	$aùive_sks_Œ“v›w
(
£lf
.
aùiv‘»e
)

82 ###YOU 
CAN
 
DEFINE
 
YOUR
 
INTERNAL
 
MECHANICS
 
VARIABLES
 
BELOW


83 
£lf
.
š_toggË_wÜkv›w
 = 
F®£


85 #S‘u°
GTG
 
icÚ
 
theme


86 
£lf
.
	$_š™_icÚ_theme
()

88 #S‘ 
up
 
mod–s


89 #Aùiv
Tasks


90 
£lf
.
»q
.
	`­¶y_glob®_f‹r
(£lf.
aùiv‘»e
, 'active')

92 
£lf
.
gŒ“
 = 
NÚe


93 
£lf
.
gŒ“v›w
 = 
NÚe


95 #Lßd 
wšdow
 
Œ“


96 
£lf
.
bud”
 = 
Gtk
.
	$Bud”
()

97 
£lf
.
bud”
.
	$add_äom_fe
(
GnomeCÚfig
.
BROWSER_UI_FILE
)

99 #Defš
®Ÿ£s
 
¥ecific
 
widg‘s


100 
£lf
.
	$_š™_widg‘_®Ÿ£s
()

102 #In™ 
nÚ
-
GtkBud”
 
widg‘s


103 
£lf
.
	$_š™_ui_widg‘
()

105 #S‘ 
the
 
toŞt
 th
toŞb¬
 
bu‰Ús


106 
£lf
.
	$_š™_toŞb¬_toŞts
()

108 #In™Ÿliz"About" 
dŸlog


109 
£lf
.
	$_š™_about_dŸlog
()

111 #C»©
our
 
diùiÚ¬y
 
ªd
 
cÚÃù
 
™


112 
£lf
.
	$_š™_sigÇl_cÚÃùiÚs
()

114 #Defš
acûË¿tÜ
 
keys


115 
£lf
.
	$_š™_acûË¿tÜs
()

117 #In™Ÿliz
£¬ch
 
com¶‘iÚ


118 
£lf
.
	$_š™_£¬ch_com¶‘iÚ
()

120 
£lf
.
	$»¡Üe_¡©e_äom_cÚf
()

122 
£lf
.
	$Ú_£Ëù_g
()

123 
£lf
.
brow£r_shown
 = 
F®£


125 #Upd©
the
 
t™Ë
 
wh’
 
a
 
sk
 
chªge


126 
£lf
.
aùiv‘»e
.
	`»gi¡”_şlbck
('node-added-inview',

127 
£lf
.
_upd©e_wšdow_t™Ë
)

128 
£lf
.
aùiv‘»e
.
	`»gi¡”_şlbck
('node-deleted-inview',

129 
£lf
.
_upd©e_wšdow_t™Ë
)

130 
£lf
.
	$_upd©e_wšdow_t™Ë
()

132 ###INIT 
HELPER
 
FUNCTIONS
 #####################################################
#
 _š™_icÚ_theme(£lf):

134 
£ts
 
the
 
d—çuÉ
 
theme
 
icÚ
 
ªd
 
™s
 
dœeùÜy


136 
icÚ_dœs
 = 
	`CÜeCÚfig
().
	$g‘_icÚs_dœeùÜ›s
()

137 
i
 
š
 
icÚ_dœs
:

138 
Gtk
.
IcÚTheme
.
	`g‘_deçuÉ
().
	$´•’d_£¬ch_·th
(
i
)

139 
Gtk
.
Wšdow
.
	`£t_deçuÉ_icÚ_Çme
("gtg")

141 
def
 
	$_š™_widg‘_®Ÿ£s
(
£lf
):

143 
defšes
 
®Ÿ£s
 
UI
 
–em’ts
 
found
 
š
 
the
 
glide
 
fe


145 
£lf
.
wšdow
 = s–f.
bud”
.
	`g‘_objeù
("MainWindow")

146 
£lf
.
skpİup
 = s–f.
bud”
.
	`g‘_objeù
("task_context_menu")

147 
£lf
.
deã¹İİup
 = s–f.
bud”
.
	`g‘_objeù
("defer_to_context_menu")

148 
£lf
.
ùaskpİup
 = s–f.
bud”
.
	`g‘_objeù
("closed_task_context_menu")

149 
£lf
.
ed™bu‰Ú
 = s–f.
bud”
.
	`g‘_objeù
("edit_b")

150 
£lf
.
ed™_mi
 = s–f.
bud”
.
	`g‘_objeù
("edit_mi")

151 
£lf
.
dÚebu‰Ú
 = s–f.
bud”
.
	`g‘_objeù
("done_b")

152 
£lf
.
dÚe_mi
 = s–f.
bud”
.
	`g‘_objeù
("done_mi")

153 
£lf
.
d–‘ebu‰Ú
 = s–f.
bud”
.
	`g‘_objeù
("delete_b")

154 
£lf
.
d–‘e_mi
 = s–f.
bud”
.
	`g‘_objeù
("delete_mi")

155 
£lf
.
Ãwsk
 = s–f.
bud”
.
	`g‘_objeù
("new_task_b")

156 
£lf
.
Ãwsubsk
 = s–f.
bud”
.
	`g‘_objeù
("new_subtask_b")

157 
£lf
.
Ãw_subsk_mi
 = s–f.
bud”
.
	`g‘_objeù
("new_subtask_mi")

158 
£lf
.
dismissbu‰Ú
 = s–f.
bud”
.
	`g‘_objeù
("dismiss_b")

159 
£lf
.
dismiss_mi
 = s–f.
bud”
.
	`g‘_objeù
("dismiss_mi")

160 
£lf
.
about
 = s–f.
bud”
.
	`g‘_objeù
("about_dialog")

161 
£lf
.
maš_·Ã
 = s–f.
bud”
.
	`g‘_objeù
("main_pane")

162 
£lf
.
m’u_v›w_wÜkv›w
 = s–f.
bud”
.
	`g‘_objeù
("view_workview")

163 
£lf
.
toggË_wÜkv›w
 = s–f.
bud”
.
	`g‘_objeù
("workview_toggle")

164 
£lf
.
quickadd_’Œy
 = s–f.
bud”
.
	`g‘_objeù
("quickadd_field")

165 
£lf
.
toŞb¬
 = s–f.
bud”
.
	`g‘_objeù
("task_toolbar")

166 
£lf
.
quickadd_·Ã
 = s–f.
bud”
.
	`g‘_objeù
("quickadd_pane")

167 
£lf
.
sideb¬
 = s–f.
bud”
.
	`g‘_objeù
("sidebar_vbox")

168 
£lf
.
sideb¬_cÚš”
 = s–f.
bud”
.
	`g‘_objeù
("sidebar-scroll")

169 
£lf
.
sideb¬_nÙebook
 = s–f.
bud”
.
	`g‘_objeù
("sidebar_notebook")

170 
£lf
.
maš_nÙebook
 = s–f.
bud”
.
	`g‘_objeù
("main_notebook")

171 
£lf
.
acûssÜy_nÙebook
 = s–f.
bud”
.
	`g‘_objeù
("accessory_notebook")

172 
£lf
.
vbox_toŞb¬s
 = s–f.
bud”
.
	`g‘_objeù
("vbox_toolbars")

174 
£lf
.
şo£d_·Ã
 = 
NÚe


175 
£lf
.
gpİup
 = 
	$TagCÚ‹xtM’u
(
£lf
.
»q
, s–f.
vmªag”
)

177 
def
 
	$_š™_ui_widg‘
(
£lf
):

179 
ü—‹
 
ModifyTagsDŸlog
 & 
C®’d¬
 """

180 #Th
Aùive
 
sks
 
Œ“v›w


181 
£lf
.
maš_·Ã
.
	`add
(£lf.
vŒ“_·Ãs
['active'])

183 
g_com¶‘iÚ
 = 
	`TagCom¶‘iÚ
(
£lf
.
»q
.
	$g‘_g_Œ“
())

184 
£lf
.
modifygs_dŸlog
 = 
	$ModifyTagsDŸlog
(
g_com¶‘iÚ
, 
£lf
.
»q
)

185 
£lf
.
ÿËnd¬
 = 
	$GTGC®’d¬
()

186 
£lf
.
ÿËnd¬
.
	$£t_Œªs›Á_fÜ
(
£lf
.
wšdow
)

187 
£lf
.
ÿËnd¬
.
	`cÚÃù
("d©e-chªged", s–f.
Ú_d©e_chªged
)

189 
def
 
	$š™_gs_sideb¬
(
£lf
):

191 
š™Ÿlizes
 
the
 
	`gŒ“
 (
Ëá
 
¬—
 
w™h
 
gs
 
ªd
 
£¬ches
)

193 #Th
gs
 
Œ“v›w


194 
£lf
.
gŒ“
 = s–f.
»q
.
	$g‘_g_Œ“
()

195 
£lf
.
gŒ“v›w
 = s–f.
tv_çùÜy
.
	$gs_Œ“v›w
(
£lf
.
gŒ“
)

196 #Tag 
Œ“v›w


197 
£lf
.
gŒ“v›w
.
	`g‘_£ËùiÚ
().
	`cÚÃù
('changed',

198 
£lf
.
Ú_£Ëù_g
)

199 
£lf
.
gŒ“v›w
.
	`cÚÃù
('button-press-event',

200 
£lf
.
Ú_g_Œ“v›w_bu‰Ú_´ess_ev’t
)

201 
£lf
.
gŒ“v›w
.
	`cÚÃù
('key-press-event',

202 
£lf
.
Ú_g_Œ“v›w_key_´ess_ev’t
)

203 
£lf
.
gŒ“v›w
.
	`cÚÃù
('node-expanded',

204 
£lf
.
Ú_g_ex·nded
)

205 
£lf
.
gŒ“v›w
.
	`cÚÃù
('node-collapsed',

206 
£lf
.
Ú_g_cŞÏp£d
)

207 
£lf
.
sideb¬_cÚš”
.
	$add
(
£lf
.
gŒ“v›w
)

209 
·th_t
 
š
 
£lf
.
cÚfig
.
	`g‘
("expanded_tags"):

210 #th
tu¶e
 
was
 
¡Üed
 
as
 
a
 
¡ršg
. 
we
 
have
 
to
 
»cÚ¡ruù
 
™


211 
·th
 = ()

212 
p
 
š
 
·th_t
[1:-1].
	`¥l™
(","):

213 
p
 =….
	`¡r
(" '")

214 
·th
 +ğ(
p
, )

215 
·th
[-1] == '':

216 
·th
 =…ath[:-1]

217 
£lf
.
gŒ“v›w
.
	$ex·nd_node
(
·th
)

219 #ex·ndšg 
£¬ch
 
g
 
dÛs
 
nÙ
 
wÜk
 
autom©iÿÎy
, 
»que¡
 
™


220 
£lf
.
	$ex·nd_£¬ch_g
()

222 
def
 
	$_š™_toŞb¬_toŞts
(
£lf
):

224 
£ts
 
toŞts
 
widg‘s
 
Ú
 
toŞb¬s


226 
£lf
.
dÚebu‰Ú
.
	$£t_toŞt_‹xt
(
GnomeCÚfig
.
MARK_DONE_TOOLTIP
)

227 
£lf
.
ed™bu‰Ú
.
	$£t_toŞt_‹xt
(
GnomeCÚfig
.
EDIT_TOOLTIP
)

228 
£lf
.
dismissbu‰Ú
.
	$£t_toŞt_‹xt
(
GnomeCÚfig
.
MARK_DISMISS_TOOLTIP
)

229 
£lf
.
Ãwsk
.
	$£t_toŞt_‹xt
(
GnomeCÚfig
.
NEW_TASK_TOOLTIP
)

230 
£lf
.
Ãwsubsk
.
	$£t_toŞt_‹xt
(
GnomeCÚfig
.
NEW_SUBTASK_TOOLTIP
)

231 
£lf
.
toggË_wÜkv›w
.
	$£t_toŞt_‹xt
(

232 
GnomeCÚfig
.
WORKVIEW_TOGGLE_TOOLTIP
)

233 
£lf
.
quickadd_’Œy
.
	$£t_toŞt_‹xt
(

234 
GnomeCÚfig
.
QUICKADD_ENTRY_TOOLTIP
)

235 
quickadd_icÚ_toŞt
 = 
GnomeCÚfig
.
QUICKADD_ICON_TOOLTIP


236 
£lf
.
quickadd_’Œy
.
	$£t_icÚ_toŞt_‹xt
(1,

237 
quickadd_icÚ_toŞt
)

239 
def
 
	$_š™_about_dŸlog
(
£lf
):

241 
Show
 
the
 
about
 
dŸlog


243 
£lf
.
about
.
	$£t_webs™e
(
šfo
.
URL
)

244 
£lf
.
about
.
	$£t_webs™e_Ïb–
(
šfo
.
URL
)

245 
£lf
.
about
.
	$£t_v”siÚ
(
šfo
.
VERSION
)

246 
£lf
.
about
.
	$£t_authÜs
(
šfo
.
AUTHORS
)

247 
£lf
.
about
.
	$£t_¬ti¡s
(
šfo
.
ARTISTS
)

248 
£lf
.
about
.
	$£t_docum’‹rs
(
šfo
.
DOCUMENTERS
)

249 
£lf
.
about
.
	$£t_Œª¦©Ü_üed™s
(
šfo
.
TRANSLATORS
)

251 
def
 
	$_š™_sigÇl_cÚÃùiÚs
(
£lf
):

253 
cÚÃùs
 
sigÇls
 
Ú
 
UI
 
–em’ts


255 
SIGNAL_CONNECTIONS_DIC
 = {

257 
£lf
.
Ú_add_sk
,

259 
£lf
.
Ú_ed™_aùive_sk
,

261 
£lf
.
Ú_ed™_dÚe_sk
,

263 
£lf
.
Ú_d–‘e_sks
,

265 
£lf
.
Ú_modify_gs
,

267 
£lf
.
Ú_m¬k_as_dÚe
,

269 
£lf
.
Ú_m¬k_as_¡¬‹d
,

271 
£lf
.
Ú_¡¬t_fÜ_tomÜrow
,

273 
£lf
.
Ú_¡¬t_fÜ_Ãxt_w“k
,

275 
£lf
.
Ú_¡¬t_fÜ_Ãxt_mÚth
,

277 
£lf
.
Ú_¡¬t_fÜ_Ãxt_y—r
,

279 
£lf
.
Ú_¡¬t_fÜ_¥ecific_d©e
,

281 
£lf
.
Ú_¡¬t_ş—r
,

283 
£lf
.
Ú_£t_due_today
,

285 
£lf
.
Ú_£t_due_tomÜrow
,

287 
£lf
.
Ú_£t_due_Ãxt_w“k
,

289 
£lf
.
Ú_£t_due_Ãxt_mÚth
,

291 
£lf
.
Ú_£t_due_Ãxt_y—r
,

293 
£lf
.
Ú_£t_due_soÚ
,

295 
£lf
.
Ú_£t_due_someday
,

297 
£lf
.
Ú_£t_due_fÜ_¥ecific_d©e
,

299 
£lf
.
Ú_£t_due_ş—r
,

301 
£lf
.
Ú_dismiss_sk
,

303 
£lf
.
Ú_move
,

305 
£lf
.
Ú_size_®loÿ‹
,

307 
£lf
.
Ú_şo£
,

309 
£lf
.
Ú_add_subsk
,

311 
£lf
.
Ú_gcÚ‹xt_d—ùiv©e
,

313 
£lf
.
Ú_wÜkv›w_toggËd
,

315 
£lf
.
Ú_wÜkv›w_toggËd
,

317 
£lf
.
Ú_şo£d_toggËd
,

319 
£lf
.
Ú_sideb¬_toggËd
,

321 
£lf
.
Ú_quickadd_aùiv©e
,

323 
£lf
.
Ú_quickadd_icÚ´ess
,

325 
£lf
.
Ú_quickadd_chªged
,

327 
£lf
.
Ú_’Œycom¶‘iÚ_aùiÚ_aùiv©ed
,

329 
£lf
.
Ú_toggË_quickadd
,

331 
£lf
.
Ú_toŞb¬_toggËd
,

333 
£lf
.
Ú_about_şicked
,

335 
£lf
.
Ú_about_şo£
,

337 
£lf
.
Ú_about_şo£
,

339 
Ïmbda
 
w
: 
	`İ’u¾
(
šfo
.
HELP_URI
),

341 
Ïmbda
 
w
: 
	`İ’u¾
(
šfo
.
TRANSLATE_URL
),

343 
Ïmbda
 
w
: 
	`İ’u¾
(
šfo
.
REPORT_BUG_URL
),

345 
£lf
.
İ’_´eã»nûs
,

347 
£lf
.
İ’_¶ugšs
,

349 
£lf
.
İ’_ed™_back’ds
,

350 
	}
}

351 
£lf
.
bud”
.
	$cÚÃù_sigÇls
(
SIGNAL_CONNECTIONS_DIC
)

353 #Wh’ 
de¡royšg
 
this
 
wšdow
, 
qu™
 
GTG


354 
£lf
.
wšdow
.
	`cÚÃù
("de¡roy", s–f.
qu™
)

355 
£lf
.
wšdow
.
	`cÚÃù
("d–‘e-ev’t", s–f.
qu™
)

357 #Aùiv
sks
 
T»eV›w


358 
£lf
.
vŒ“_·Ãs
['aùive'].
	`cÚÃù
('row-activated',

359 
£lf
.
Ú_ed™_aùive_sk
)

360 
tsk_Œ“v›w_bŠ_´ess
 = 
£lf
.
Ú_sk_Œ“v›w_bu‰Ú_´ess_ev’t


361 
£lf
.
vŒ“_·Ãs
['aùive'].
	`cÚÃù
('button-press-event',

362 
tsk_Œ“v›w_bŠ_´ess
)

363 
sk_Œ“v›w_key_´ess
 = 
£lf
.
Ú_sk_Œ“v›w_key_´ess_ev’t


364 
£lf
.
vŒ“_·Ãs
['aùive'].
	`cÚÃù
('key-press-event',

365 
sk_Œ“v›w_key_´ess
)

366 
£lf
.
vŒ“_·Ãs
['aùive'].
	`cÚÃù
('node-expanded',

367 
£lf
.
Ú_sk_ex·nded
)

368 
£lf
.
vŒ“_·Ãs
['aùive'].
	`cÚÃù
('node-collapsed',

369 
£lf
.
Ú_sk_cŞÏp£d
)

371 
b_sigÇls
 = 
	$Back’dSigÇls
()

372 
b_sigÇls
.
	$cÚÃù
(
b_sigÇls
.
BACKEND_FAILED
, 
£lf
.
Ú_back’d_çed
)

373 
b_sigÇls
.
	$cÚÃù
(
b_sigÇls
.
BACKEND_STATE_TOGGLED
,

374 
£lf
.
»move_back’d_šfob¬
)

375 
b_sigÇls
.
	$cÚÃù
(
b_sigÇls
.
INTERACTION_REQUESTED
,

376 
£lf
.
Ú_back’d_Ãedšg_š‹¿ùiÚ
)

377 #S–eùiÚ 
chªges


378 
£lf
.
£ËùiÚ
 = s–f.
vŒ“_·Ãs
['aùive'].
	$g‘_£ËùiÚ
()

379 
£lf
.
£ËùiÚ
.
	`cÚÃù
("chªged", s–f.
Ú_sk_cursÜ_chªged
)

381 
def
 
	$_add_acûË¿tÜ_fÜ_widg‘
(
£lf
, 
agr
, 
Çme
, 
acûl
):

382 
widg‘
 = 
£lf
.
bud”
.
	$g‘_objeù
(
Çme
)

383 
key
, 
mod
 = 
Gtk
.
	$acûË¿tÜ_·r£
(
acûl
)

384 
widg‘
.
	`add_acûË¿tÜ
("aùiv©e", 
agr
, 
key
, 
mod
,

385 
Gtk
.
AcûlFÏgs
.
VISIBLE
)

387 
def
 
	$_š™_acûË¿tÜs
(
£lf
):

389 
š™Ÿlize
 
gtk
 
acûË¿tÜs
 
difã»Á
 
š‹rçû
 
–em’ts


391 
agr
 = 
Gtk
.
	$AcûlGroup
()

392 
£lf
.
bud”
.
	`g‘_objeù
("MašWšdow").
	$add_acûl_group
(
agr
)

394 
£lf
.
	`_add_acûË¿tÜ_fÜ_widg‘
(
agr
, "view_sidebar", "F9")

395 
£lf
.
	`_add_acûË¿tÜ_fÜ_widg‘
(
agr
, "file_quit", "<Control>q")

396 
£lf
.
	`_add_acûË¿tÜ_fÜ_widg‘
(
agr
, "edit_undo", "<Control>z")

397 
£lf
.
	`_add_acûË¿tÜ_fÜ_widg‘
(
agr
, "edit_redo", "<Control>y")

398 
£lf
.
	`_add_acûË¿tÜ_fÜ_widg‘
(
agr
, "new_task_mi", "<Control>n")

399 
£lf
.
	`_add_acûË¿tÜ_fÜ_widg‘
(
agr
, "new_subtask_mi",

401 
£lf
.
	`_add_acûË¿tÜ_fÜ_widg‘
(
agr
, "edit_mi", "Return")

402 
£lf
.
	`_add_acûË¿tÜ_fÜ_widg‘
(
agr
, "done_mi", "<Control>d")

403 
£lf
.
	`_add_acûË¿tÜ_fÜ_widg‘
(
agr
, "dismiss_mi", "<Control>i")

404 
£lf
.
	`_add_acûË¿tÜ_fÜ_widg‘
(
agr
, "tcm_modifytags", "<Control>t")

405 
£lf
.
	`_add_acûË¿tÜ_fÜ_widg‘
(
agr
, "view_closed", "<Control>F9")

406 
£lf
.
	`_add_acûË¿tÜ_fÜ_widg‘
(
agr
, "help_contents", "F1")

408 
quickadd_f›ld
 = 
£lf
.
bud”
.
	`g‘_objeù
("quickadd_field")

409 
key
, 
mod
 = 
Gtk
.
	`acûË¿tÜ_·r£
("<Control>l")

410 
quickadd_f›ld
.
	`add_acûË¿tÜ
("g¿b-focus", 
agr
, 
key
, 
mod
,

411 
Gtk
.
AcûlFÏgs
.
VISIBLE
)

413 ###HELPER 
FUNCTIONS
 ########################################################

414 
def
 
	$İ’_´eã»nûs
(
£lf
, 
widg‘
):

415 
£lf
.
vmªag”
.
	$İ’_´eã»nûs
(
£lf
.
cÚfig
)

417 
def
 
	$İ’_¶ugšs
(
£lf
, 
widg‘
):

418 
£lf
.
vmªag”
.
	$cÚfigu»_¶ugšs
()

420 
def
 
	$İ’_ed™_back’ds
(
£lf
, 
widg‘
):

421 
£lf
.
vmªag”
.
	$İ’_ed™_back’ds
()

423 
def
 
	$qu™
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

424 
£lf
.
vmªag”
.
	$şo£_brow£r
()

426 
def
 
	$Ú_wšdow_¡©e_ev’t
(
£lf
, 
widg‘
, 
ev’t
, 
d©a
=
NÚe
):

428 
ªd
 
¡Ües
 
the
 
¡©e
 
š
 
£lf
.
cÚfig
.
max


429 
This
 
is
 
u£d
 
to
 
check
 
the
 
wšdow
 
¡©e
 
aá”w¬ds


430 
ªd
 
maximize
 
™
 
Ãeded
 """

431 
mask
 = 
Gdk
.
WšdowS‹
.
MAXIMIZED


432 
is_maximized
 = 
widg‘
.
	`g‘_wšdow
().
	`g‘_¡©e
(è& 
mask
 == mask

433 
£lf
.
cÚfig
.
	`£t
("max", 
is_maximized
)

435 
def
 
	$»¡Üe_¡©e_äom_cÚf
(
£lf
):

437 ## 
ExŒaù
 
¡©e
 
äom
 
cÚfigu¿tiÚ
 
diùiÚ¬y


438 #ià
nÙ
 "brow£r" 
š
 
£lf
.
cÚfig
:

439 ##
Ãûs§ry
 
to
 
have
 
the
 
mšimum
 
width
 
of
h
g
 
·Ã


440 ## 
šãriÜ
 
to
 
the
 "fœ¡„un" 
width


441 #£lf.
bud”
.
	`g‘_objeù
("h·Ãd1").
	`£t_pos™iÚ
(250)

444 
width
 = 
£lf
.
cÚfig
.
	`g‘
('width')

445 
height
 = 
£lf
.
cÚfig
.
	`g‘
('height')

446 
width
 
ªd
 
height
:

447 
£lf
.
wšdow
.
	$»size
(
width
, 
height
)

449 #check 
maximum
 
size
 
of
 
wšdow


450 
£lf
.
wšdow
.
	`cÚÃù
('wšdow-¡©e-ev’t', s–f.
Ú_wšdow_¡©e_ev’t
)

451 
£lf
.
cÚfig
.
	`g‘
("max"):

452 
£lf
.
wšdow
.
	$maximize
()

454 
xpos
 = 
£lf
.
cÚfig
.
	`g‘
("x_pos")

455 
ypos
 = 
£lf
.
cÚfig
.
	`g‘
("y_pos")

456 
ypos
 
ªd
 
xpos
:

457 
£lf
.
wšdow
.
	$move
(
xpos
, 
ypos
)

459 
g_·Ã
 = 
£lf
.
cÚfig
.
	`g‘
("tag_pane")

460 
nÙ
 
g_·Ã
:

461 
£lf
.
bud”
.
	`g‘_objeù
("v›w_sideb¬").
	$£t_aùive
(
F®£
)

462 
£lf
.
sideb¬
.
	$hide
()

464 
£lf
.
bud”
.
	`g‘_objeù
("v›w_sideb¬").
	$£t_aùive
(
True
)

465 
nÙ
 
£lf
.
gŒ“v›w
:

466 
£lf
.
	$š™_gs_sideb¬
()

467 
£lf
.
sideb¬
.
	$show
()

469 
sideb¬_width
 = 
£lf
.
cÚfig
.
	`g‘
("sidebar_width")

470 
£lf
.
bud”
.
	`g‘_objeù
("h·Ãd1").
	$£t_pos™iÚ
(
sideb¬_width
)

471 
£lf
.
bud”
.
	`g‘_objeù
("h·Ãd1").
	`cÚÃù
('notify::position',

472 
£lf
.
Ú_sideb¬_width
)

474 
şo£d_sk_·Ã
 = 
£lf
.
cÚfig
.
	`g‘
("closed_task_pane")

475 
nÙ
 
şo£d_sk_·Ã
:

476 
£lf
.
	$hide_şo£d_·Ã
()

478 
£lf
.
	$show_şo£d_·Ã
()

480 
bÙpos
 = 
£lf
.
cÚfig
.
	`g‘
("bottom_pane_position")

481 
£lf
.
bud”
.
	`g‘_objeù
("v·Ãd1").
	$£t_pos™iÚ
(
bÙpos
)

482 
Ú_bÙtom_·n_pos™iÚ
 = 
£lf
.
Ú_bÙtom_·Ã_pos™iÚ


483 
£lf
.
bud”
.
	`g‘_objeù
("v·Ãd1").
	`cÚÃù
('notify::position',

484 
Ú_bÙtom_·n_pos™iÚ
)

486 
toŞb¬
 = 
£lf
.
cÚfig
.
	`g‘
("toolbar")

487 
toŞb¬
:

488 
£lf
.
bud”
.
	`g‘_objeù
("v›w_toŞb¬").
	$£t_aùive
(1)

490 
£lf
.
toŞb¬
.
	$hide
()

491 
£lf
.
bud”
.
	`g‘_objeù
("v›w_toŞb¬").
	$£t_aùive
(
F®£
)

493 
quickadd_·Ã
 = 
£lf
.
cÚfig
.
	`g‘
("quick_add")

494 
quickadd_·Ã
:

495 
£lf
.
bud”
.
	`g‘_objeù
("v›w_quickadd").
	$£t_aùive
(
True
)

497 
£lf
.
quickadd_·Ã
.
	$hide
()

498 
£lf
.
bud”
.
	`g‘_objeù
("v›w_quickadd").
	$£t_aùive
(
F®£
)

500 #C®lback 
sÜtšg
 
ªd
 
»¡Üšg
 
´evious
 
¡©e


501 
mod–
 = 
£lf
.
vŒ“_·Ãs
['aùive'].
	$g‘_mod–
()

502 
mod–
.
	`cÚÃù
('sÜt-cŞumn-chªged', 
£lf
.
Ú_sÜt_cŞumn_chªged
)

503 
sÜt_cŞumn
 = 
£lf
.
cÚfig
.
	`g‘
('tasklist_sort_column')

504 
sÜt_Üd”
 = 
£lf
.
cÚfig
.
	`g‘
('tasklist_sort_order')

506 
sÜt_cŞumn
 
ªd
 
sÜt_Üd”
:

507 
sÜt_cŞumn
, 
sÜt_Üd”
 = (sort_column), (sort_order)

508 
mod–
.
	$£t_sÜt_cŞumn_id
(
sÜt_cŞumn
, 
sÜt_Üd”
)

510 
·th_s
 
š
 
£lf
.
cÚfig
.
	`g‘
("collapsed_tasks"):

511 #th
tu¶e
 
was
 
¡Üed
 
as
 
a
 
¡ršg
. 
we
 
have
 
to
 
»cÚ¡ruù
 
™


512 
·th
 = ()

513 
p
 
š
 
·th_s
[1:-1].
	`¥l™
(","):

514 
p
 =….
	`¡r
(" '")

515 
·th
 +ğ(
p
, )

516 
·th
[-1] == '':

517 
·th
 =…ath[:-1]

518 
£lf
.
vŒ“_·Ãs
['aùive'].
	$cŞÏp£_node
(
·th
)

520 
£lf
.
	`£t_v›w
(£lf.
cÚfig
.
	`g‘
("view"))

522 
def
 
	$İ’_sk
(
»q
, 
t
):

524 
»q
.
	$has_sk
(
t
):

525 
£lf
.
vmªag”
.
	$İ’_sk
(
t
)

526  
F®£


528  
True


530 
t
 
š
 
£lf
.
cÚfig
.
	`g‘
("opened_tasks"):

531 
GObjeù
.
	$idË_add
(
İ’_sk
, 
£lf
.
»q
, 
t
)

533 
def
 
	$do_toggË_wÜkv›w
(
£lf
):

536 
Upd©šg
 
gs
 
is
 
di§bËd
 
chªgšg
 
v›w
. 
It
 
cÚsumes


537 
a
 
lÙ
 
of
 
CPU
 
cyşes
 
ªd
 
the
 
u£r
 
dÛs
 
nÙ
 
£e
 
™
. 
Aá”w¬ds
,

538 
upd©šg
 
of
 
gs
 
is
 
»
-
’abËd
 
ªd
 
®l
ag 
¬e
 
»äeshed
.

540 
Beÿu£
 
wÜkv›w
 
ÿn
 
be
 
sw™ched
 
äom
 
mÜe
 
thª
 
Úe
 
bu‰Ú


541 (
cu¼’y
 
toggË
 
bu‰Ú
 
ªd
 
check
 
m’u
 
™em
), 
we
 
Ãed
 
to
 
chªge


542 
¡©us
 
of
 
Ùh”s
 
®so
. 
It
 
švokes
 
agaš
 
this
 
m‘hod
 =>

543 
a
 
loİ
 
of
 
sigÇls
.

545 
It
 
is
 
mÜe
 
æexibË
 
to
 
have
 
a
 
dediÿ‹d
 
v¬ŸbË


546 (
£lf
.
š_toggË_wÜkv›w
è
which
 
´ev’ts
 
th©
 
»cursiÚ
. 
The
 
Ùh”
 
way


547 
how
 
to
 
sŞve
 
this
 
is
Ø
checkšg
 
¡©e
 
of
 
tho£
 
two
 
bu‰Ús
 
ªd
 
check


548 
they
 
¬e
 
nÙ
 
the
 
§me
. 
Addšg
 
ªÙh”
 
way
 
may
 
com¶iÿ‹
 
thšgs
...

551 
£lf
.
š_toggË_wÜkv›w
:

554 
£lf
.
š_toggË_wÜkv›w
 = 
True


556 
£lf
.
cÚfig
.
	`g‘
('view') == 'workview':

557 
£lf
.
	`£t_v›w
('default')

559 
£lf
.
	`£t_v›w
('workview')

561 
£lf
.
š_toggË_wÜkv›w
 = 
F®£


563 
def
 
	$£t_v›w
(
£lf
, 
v›wÇme
):

564 
v›wÇme
 == 'default':

565 
£lf
.
»q
.
	`uÇµly_glob®_f‹r
(£lf.
aùiv‘»e
, 'workview')

566 
wÜkv›w
 = 
F®£


567 
–if
 
v›wÇme
 == 'workview':

568 
£lf
.
»q
.
	`­¶y_glob®_f‹r
(£lf.
aùiv‘»e
, 'workview')

569 
wÜkv›w
 = 
True


571 
¿i£
 
	`Exû±iÚ
('CªnÙ s‘hv›w %s' % 
v›wÇme
)

572 
£lf
.
m’u_v›w_wÜkv›w
.
	$£t_aùive
(
wÜkv›w
)

573 
£lf
.
toggË_wÜkv›w
.
	$£t_aùive
(
wÜkv›w
)

574 #Th
cÚfig_£t
 
has
 
to
 
be
 
aá”
 
the
 
toggË
, 
you
 
wl
 
have
 
a
 
loİ


575 
£lf
.
cÚfig
.
	`£t
('v›w', 
v›wÇme
)

576 
£lf
.
vŒ“_·Ãs
['aùive'].
	`£t_cŞ_visibË
('¡¬td©e', 
nÙ
 
wÜkv›w
)

578 
def
 
	$_upd©e_wšdow_t™Ë
(
£lf
, 
nid
=
NÚe
, 
·th
=NÚe, 
¡©e_id
=None):

579 
couÁ
 = 
£lf
.
aùiv‘»e
.
	$g‘_n_nodes
()

580 #S‘ 
the
 
t™Ë
 
of
h
wšdow
:

581 
·»Áhesis
 = ""

582 
couÁ
 == 0:

583 
·»Áhesis
 = 
	`_
("no‡ctiveasks")

585 
·»Áhesis
 = 
	`ng‘‹xt
("%(tasks)d‡ctiveask",

587 
couÁ
è% {'sks': 
	}
count}

588 
£lf
.
wšdow
.
£t_t™Ë
("% - " % 
·»Áhesis
 + 
šfo
.
NAME
)

590 
def
 
	$_add_·ge
(
£lf
, 
nÙebook
, 
Ïb–
, 
·ge
):

591 
nÙebook
.
	$­³nd_·ge
(
·ge
, 
Ïb–
)

592 
nÙebook
.
	`g‘_n_·ges
() > 1:

593 
nÙebook
.
	$£t_show_bs
(
True
)

594 
·ge_num
 = 
nÙebook
.
	$·ge_num
(
·ge
)

595 
nÙebook
.
	$£t_b_d‘achabË
(
·ge
, 
True
)

596 
nÙebook
.
	$£t_b_»Üd”abË
(
·ge
, 
True
)

597 
nÙebook
.
	$£t_cu¼’t_·ge
(
·ge_num
)

598 
nÙebook
.
	$show_®l
()

599  
·ge_num


601 
def
 
	$_»move_·ge
(
£lf
, 
nÙebook
, 
·ge
):

602 
·ge
:

603 
·ge
.
	$hide
()

604 
nÙebook
.
	$»move
(
·ge
)

605 
nÙebook
.
	`g‘_n_·ges
() == 1:

606 
nÙebook
.
	$£t_show_bs
(
F®£
)

607 
–if
 
nÙebook
.
	`g‘_n_·ges
() == 0:

608 
nÙebook
.
	$hide
()

610 ###SIGNAL 
CALLBACKS
 ##########################################################

611 #TypiÿÎy, 
»aùiÚ
 
to
 
u£r
 
šput
 & 
š‹¿ùiÚs
 
w™h
 
the
 
GUI


612 #
 on_sÜt_cŞumn_chªged(£lf, mod–):

613 
sÜt_cŞumn
, 
sÜt_Üd”
 = 
mod–
.
	$g‘_sÜt_cŞumn_id
()

615 
sÜt_Üd”
 =ğ
Gtk
.
SÜtTy³
.
ASCENDING
:

616 
sÜt_Üd”
 = 0

618 
sÜt_Üd”
 = 1

620 
£lf
.
cÚfig
.
	`£t
('skli¡_sÜt_cŞumn', 
sÜt_cŞumn
)

621 
£lf
.
cÚfig
.
	`£t
('skli¡_sÜt_Üd”', 
sÜt_Üd”
)

623 
def
 
	$Ú_move
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

624 
xpos
, 
ypos
 = 
£lf
.
wšdow
.
	$g‘_pos™iÚ
()

625 
£lf
.
cÚfig
.
	`£t
('x_pos', 
xpos
)

626 
£lf
.
cÚfig
.
	`£t
('y_pos', 
ypos
)

628 
def
 
	$Ú_size_®loÿ‹
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

629 
width
, 
height
 = 
£lf
.
wšdow
.
	$g‘_size
()

630 
£lf
.
cÚfig
.
	`£t
('width', 
width
)

631 
£lf
.
cÚfig
.
	`£t
('height', 
height
)

633 
def
 
	$Ú_bÙtom_·Ã_pos™iÚ
(
£lf
, 
widg‘
, 
d©a
=
NÚe
):

634 
£lf
.
cÚfig
.
	`£t
('bÙtom_·Ã_pos™iÚ', 
widg‘
.
	$g‘_pos™iÚ
())

636 
def
 
	$Ú_sideb¬_width
(
£lf
, 
widg‘
, 
d©a
=
NÚe
):

637 
£lf
.
cÚfig
.
	`£t
('sideb¬_width', 
widg‘
.
	$g‘_pos™iÚ
())

639 
def
 
	$Ú_about_şicked
(
£lf
, 
widg‘
):

641 
show
 
the
 
about
 
dŸlog


643 
£lf
.
about
.
	$show
()

645 
def
 
	$Ú_about_şo£
(
£lf
, 
widg‘
, 
»¥Ú£
):

647 
şo£
 
the
 
about
 
dŸlog


649 
£lf
.
about
.
	$hide
()

650  
True


652 
def
 
	$Ú_gcÚ‹xt_d—ùiv©e
(
£lf
, 
m’ush–l
):

653 
£lf
.
	$»£t_cursÜ
()

655 
def
 
	$Ú_wÜkv›w_toggËd
(
£lf
, 
widg‘
):

656 
£lf
.
	$do_toggË_wÜkv›w
()

658 
def
 
	$Ú_sideb¬_toggËd
(
£lf
, 
widg‘
):

659 
v›w_sideb¬
 = 
£lf
.
bud”
.
	`g‘_objeù
("view_sidebar")

660 
£lf
.
sideb¬
.
	`g‘_´İ”ty
("visible"):

661 
v›w_sideb¬
.
	$£t_aùive
(
F®£
)

662 
£lf
.
cÚfig
.
	`£t
("g_·Ã", 
F®£
)

663 
£lf
.
sideb¬
.
	$hide
()

665 
v›w_sideb¬
.
	$£t_aùive
(
True
)

666 
nÙ
 
£lf
.
gŒ“v›w
:

667 
£lf
.
	$š™_gs_sideb¬
()

668 
£lf
.
sideb¬
.
	$show
()

669 
£lf
.
cÚfig
.
	`£t
("g_·Ã", 
True
)

671 
def
 
	$Ú_şo£d_toggËd
(
£lf
, 
widg‘
):

672 
widg‘
.
	$g‘_aùive
():

673 
£lf
.
	$show_şo£d_·Ã
()

675 
£lf
.
	$hide_şo£d_·Ã
()

677 
def
 
	$__ü—‹_şo£d_Œ“
(
£lf
):

678 
şo£dŒ“
 = 
£lf
.
»q
.
	`g‘_sks_Œ“
(
Çme
='şo£d', 
»äesh
=
F®£
)

679 
şo£dŒ“
.
	`­¶y_f‹r
('şo£d', 
»äesh
=
F®£
)

680  
şo£dŒ“


682 
def
 
	$show_şo£d_·Ã
(
£lf
):

683 #Th
dÚe
/
dismis£d
 
sks
 
Œ“v›w


684 
nÙ
 'şo£d' 
š
 
£lf
.
vŒ“_·Ãs
:

685 
ù»e
 = 
£lf
.
	$__ü—‹_şo£d_Œ“
()

686 
£lf
.
vŒ“_·Ãs
['closed'] = \

687 
£lf
.
tv_çùÜy
.
	$şo£d_sks_Œ“v›w
(
ù»e
)

688 #Clo£d 
sks
 
T»eV›w


689 
£lf
.
vŒ“_·Ãs
['şo£d'].
	`cÚÃù
('row-activated',

690 
£lf
.
Ú_ed™_dÚe_sk
)

691 #I 
did
 
nÙ
 
wªt
 
to
  
the
 
v¬ŸbË
 
ªd
 
th”e
 
was
 
no
 
Ùh”


692 #İtiÚ 
exû±
 
this
 
Çme
:(
Nim™
)

693 
şsd_tsk_bŠ_´s
 = 
£lf
.
Ú_şo£d_sk_Œ“v›w_bu‰Ú_´ess_ev’t


694 
£lf
.
vŒ“_·Ãs
['şo£d'].
	`cÚÃù
('button-press-event',

695 
şsd_tsk_bŠ_´s
)

696 
şsd_tsk_key_´s
 = 
£lf
.
Ú_şo£d_sk_Œ“v›w_key_´ess_ev’t


697 
£lf
.
vŒ“_·Ãs
['şo£d'].
	`cÚÃù
('key-press-event',

698 
şsd_tsk_key_´s
)

700 
£lf
.
şo£d_£ËùiÚ
 = s–f.
vŒ“_·Ãs
['şo£d'].
	$g‘_£ËùiÚ
()

701 
£lf
.
şo£d_£ËùiÚ
.
	`cÚÃù
("changed",

702 
£lf
.
Ú_skdÚe_cursÜ_chªged
)

703 
ù»e
.
	`­¶y_f‹r
(
£lf
.
	`g‘_£Ëùed_gs
()[0], 
»äesh
=
True
)

704 
nÙ
 
£lf
.
şo£d_·Ã
:

705 
£lf
.
şo£d_·Ã
 = 
Gtk
.
	$SüŞËdWšdow
()

706 
£lf
.
şo£d_·Ã
.
	`£t_size_»que¡
(-1, 100)

707 
£lf
.
şo£d_·Ã
.
	$£t_pŞicy
(
Gtk
.
PŞicyTy³
.
AUTOMATIC
,

708 
Gtk
.
PŞicyTy³
.
AUTOMATIC
)

709 
£lf
.
şo£d_·Ã
.
	`add
(£lf.
vŒ“_·Ãs
['closed'])

711 
–if
 
£lf
.
acûssÜy_nÙebook
.
	`·ge_num
(£lf.
şo£d_·Ã
) != -1:

712 #AÌ—dy 
cÚšs
 
the
 
şo£d
 
·Ã


715 
£lf
.
	`add_·ge_to_acûssÜy_nÙebook
("Clo£d", s–f.
şo£d_·Ã
)

716 
£lf
.
bud”
.
	`g‘_objeù
("v›w_şo£d").
	$£t_aùive
(
True
)

717 
£lf
.
cÚfig
.
	`£t
('şo£d_sk_·Ã', 
True
)

719 
def
 
	$hide_şo£d_·Ã
(
£lf
):

720 #Ià
we
 
de¡roy
 
com¶‘–y
 
the
 
vŒ“
, w
ÿÂÙ
 
di¥Ïy
 
™
 
ªymÜe


721 #Check 
is
 
to
 
hide
/
show
 
the
 
şo£d
 
sk
 
·Ã
 
muÉË
 
times
.

722 #I 
Ët
 
this
 
code
 
comm’‹d
 
now
 
beÿu£
 
™
 
might
 
be
 
u£ful


723 #fÜ 
³rfÜmªû
 
»asÚ
, 
to
 
»®ly
 
de¡roy
 
the
 
v›w
 
wh’
 
we
 
dÚ
't

724 #di¥Ïy 
™
. (
LiÚ–
, 17092010)

725 #ià
£lf
.
vŒ“_·Ãs
.
	`has_key
('closed'):

726 #£lf.
vŒ“_·Ãs
['şo£d'].
	`£t_mod–
(
NÚe
)

727 #d– 
£lf
.
vŒ“_·Ãs
['closed']

728 
£lf
.
	$»move_·ge_äom_acûssÜy_nÙebook
(
£lf
.
şo£d_·Ã
)

729 
£lf
.
bud”
.
	`g‘_objeù
("v›w_şo£d").
	$£t_aùive
(
F®£
)

730 
£lf
.
cÚfig
.
	`£t
('şo£d_sk_·Ã', 
F®£
)

732 
def
 
	$Ú_toŞb¬_toggËd
(
£lf
, 
widg‘
):

733 
widg‘
.
	$g‘_aùive
():

734 
£lf
.
toŞb¬
.
	$show
()

735 
£lf
.
cÚfig
.
	`£t
('toŞb¬', 
True
)

737 
£lf
.
toŞb¬
.
	$hide
()

738 
£lf
.
cÚfig
.
	`£t
('toŞb¬', 
F®£
)

740 
def
 
	$Ú_toggË_quickadd
(
£lf
, 
widg‘
):

741 
widg‘
.
	$g‘_aùive
():

742 
£lf
.
quickadd_·Ã
.
	$show
()

743 
£lf
.
cÚfig
.
	`£t
('quick_add', 
True
)

745 
£lf
.
quickadd_·Ã
.
	$hide
()

746 
£lf
.
cÚfig
.
	`£t
('quick_add', 
F®£
)

748 
def
 
	$_ex·nd_nÙ_cŞÏp£d
(
£lf
, 
mod–
, 
·th
, 
™”
, 
cŞt
):

751 
WÜk¬ound
 
¬ound
 
bug
 
š
 
Gtk
, 
£e
 
LP
 #1076909 """

752 #G’”©
tid
 
äom
 
Œ“v›w


753 
tid_bud
 = []

754 
cu¼’t_™”
 = 
™”


755 
cu¼’t_™”
 
is
 
nÙ
 
NÚe
:

756 
tid
 = 
	`¡r
(
mod–
.
	$g‘_v®ue
(
cu¼’t_™”
, 0))

757 
tid_bud
.
	$š£¹
(0, 
tid
)

758 
cu¼’t_™”
 = 
mod–
.
	$™”_·»Á
(
cu¼’t_™”
)

759 
tid
 = 
	`¡r
(
	$tu¶e
(
tid_bud
))

761 #ex·nd 
the
 
node
 
was
 
nÙ
 
¡Üed
 
as
 
cŞÏp£d


762 
tid
 
nÙ
 
š
 
cŞt
:

763 
£lf
.
vŒ“_·Ãs
['aùive'].
	$ex·nd_row
(
·th
, 
F®£
)

765 
def
 
	$Ú_sk_ex·nded
(
£lf
, 
£nd”
, 
tid
):

766 
cŞt
 = 
£lf
.
cÚfig
.
	`g‘
("collapsed_tasks")

767 
tid
 
š
 
cŞt
:

768 
cŞt
.
	$»move
(
tid
)

769 #»¡Ü
ex·nded
 
¡©e
 
of
 
subnodes


770 
£lf
.
vŒ“_·Ãs
['aùive'].
	`g‘_mod–
().
	$fÜ—ch
(

771 
£lf
.
_ex·nd_nÙ_cŞÏp£d
, 
cŞt
)

772 
£lf
.
cÚfig
.
	`£t
("cŞÏp£d_sks", 
cŞt
)

774 
def
 
	$Ú_sk_cŞÏp£d
(
£lf
, 
£nd”
, 
tid
):

775 
cŞt
 = 
£lf
.
cÚfig
.
	`g‘
("collapsed_tasks")

776 
tid
 
nÙ
 
š
 
cŞt
:

777 
cŞt
.
	`­³nd
(
	$¡r
(
tid
))

778 
£lf
.
cÚfig
.
	`£t
("cŞÏp£d_sks", 
cŞt
)

780 
def
 
	$Ú_g_ex·nded
(
£lf
, 
£nd”
, 
g
):

781 
cŞt
 = 
£lf
.
cÚfig
.
	`g‘
("expanded_tags")

783 #Dœeùly 
­³ndšg
 
g
 
to
 
cŞt
 
ÿu£s
 
GTG
Ø
fÜg‘
 
the
 
¡©e
 
of


784 #sub-
	`gs
 (
ex·nded
/
cŞÏp£d
è
š
 
¥ecific
 
sûÇrios
. 
B–ow
 
is
 
ª


785 #upd©ed 
way
 
which
 
checks
 
ªy
 
chd
 
of
 
the
 
g
 
is
 
š
 
cŞt
 
Ü
 
nÙ


786 #Ià
yes
, 
th’
 
the
 
g
 
is
 
š£¹ed
 
befÜe
h
fœ¡
 
chd
.

787 #Ià
no
, 
™
's‡ppendedo colt

788 
g
 
nÙ
 
š
 
cŞt
:

789 
g_has_b“n_š£¹ed
 = 
F®£


790 
šdex
, 
cŞt_g
 
š
 
	$’um”©e
(
cŞt
):

791 
g
[1:-1] 
š
 
cŞt_g
:

792 
cŞt
.
	$š£¹
(
šdex
, 
g
)

793 
g_has_b“n_š£¹ed
 = 
True


795 
nÙ
 
g_has_b“n_š£¹ed
:

796 
cŞt
.
	$­³nd
(
g
)

797 
£lf
.
cÚfig
.
	`£t
("ex·nded_gs", 
cŞt
)

799 
def
 
	$Ú_g_cŞÏp£d
(
£lf
, 
£nd”
, 
g
):

800 
cŞt
 = 
£lf
.
cÚfig
.
	`g‘
("expanded_tags")

802 #Wh’ 
a
 
g
 
is
 
cŞÏp£d
, 
we
 
should
 
®so
 
»move
 
™
's children

803 #äom 
cŞt
, 
Ùh”wi£
 
wh’
 
·»Á
 
g
 
is
 
ex·nded
, 
they
 
®so
 
g‘


804 #ex·nded (
unwª‹d
 
s™u©iÚ
)

805 
cŞt
 = [
cŞt_g
 cŞt_g 
š
 cŞˆ
g
[1:-1] 
nÙ
 in colt_tag]

806 
£lf
.
cÚfig
.
	`£t
("ex·nded_gs", 
cŞt
)

808 
def
 
	$Ú_quickadd_aùiv©e
(
£lf
, 
widg‘
):

810 
‹xt
 = 
	`¡r
(
£lf
.
quickadd_’Œy
.
	$g‘_‹xt
())

811 
‹xt
 =ext.
	$¡r
()

812 
‹xt
:

813 
gs
 = 
£lf
.
	$g‘_£Ëùed_gs
(
no¥ecŸl
=
True
)

815 #W
wl
 
£Ëù
 
quick
-
added
 
sk
 
š
 
brow£r
.

816 #Thi 
has
 
´ov’
 
to
 
be
 
qu™e
 
com¶ex
 
ªd
 
de£rves
 
ª
 
ex¶ª©iÚ
.

817 #W
a
 
ÿÎback
 
Ú
 
the
 
sÜ‹d
 
Œ“mod–
 
th©
 
we
're

818 #di¥Ïyšg, 
which
 
is
 
a
 
T»eMod–SÜt
. 
Wh’
‡ 
row
 
g‘s
 
added
,

820 #W
have
 
to
 
v”ify
 
th©
h© 
row
 
b–Úgs
Ø
the
 
sk
 
we
 
should


821 #£Ëù. 
So
, 
we
 
have
 
to
 
wa™
 
the
 
sk
Ø
be
 
ü—‹d
, 
ªd
 
th’


822 #wa™ 
™s
 
tid
 
to
 
show
 
	`up
 (
šv”nizzi
)

823 
def
 
	$£Ëù_Ãxt_added_sk_š_brow£r
(
Œ“mod–sÜt
, 
·th
,

824 
™”
, 
£lf
):

825 #cİy(è
is
 
»quœed
 
beÿu£
 
boxed
 
¡ruùu»s
 
¬e
 
nÙ
 
cİ›d


826 #wh’ 
·s£d
 
š
 
a
 
ÿÎback
 
w™hout
 
Œªsãr


827 #S“ 
h‰ps
:

828 
™”
 = i‹r.
	$cİy
()

830 
def
 
	$£Ëù”
(
Œ“mod–sÜt
, 
·th
, 
™”
, 
£lf
):

831 
£lf
.
__Ï¡_quick_added_tid_ev’t
.
	$wa™
()

832 
Œ“v›w
 = 
£lf
.
vŒ“_·Ãs
['active']

833 
Œ“mod–sÜt
.
	$discÚÃù
(

834 
£lf
.
__quick_add_£Ëù_hªdË
)

835 
£ËùiÚ
 = 
Œ“v›w
.
	$g‘_£ËùiÚ
()

836 
£ËùiÚ
.
	$un£Ëù_®l
()

837 #Sšû 
we
 
u£
 
™”
 
£ËùiÚ
,

838 #th
sk
 
£Ëùed
 
is
 
bound
 
to
 
be
 
cÜ»ù


839 
£ËùiÚ
.
	$£Ëù_™”
(
™”
)

841 #Iˆ
ÿÂÙ
 
be
 
ªÙh”
 
th»ad
 
thª
 
the
 
maš
 
gtk
hread !

842 
GObjeù
.
	$idË_add
(
£Ëù”
, 
Œ“mod–sÜt
, 
·th
, 
™”
, 
£lf
)

843 #ev’ˆ
th©
 
is
 
£t
 
wh’
 
the
 
Ãw
 
sk
 i 
ü—‹d


844 
£lf
.
__Ï¡_quick_added_tid_ev’t
 = 
th»adšg
.
	$Ev’t
()

845 
£lf
.
__quick_add_£Ëù_hªdË
 = \

846 
£lf
.
vŒ“_·Ãs
['aùive'].
	`g‘_mod–
().
	`cÚÃù
(

847 "row-š£¹ed", 
£Ëù_Ãxt_added_sk_š_brow£r
,

848 
£lf
)

849 
sk
 = 
£lf
.
»q
.
	$Ãw_sk
(
Ãwsk
=
True
)

850 
£lf
.
__Ï¡_quick_added_tid
 = 
sk
.
	$g‘_id
()

851 
£lf
.
__Ï¡_quick_added_tid_ev’t
.
	$£t
()

852 
sk
.
	$£t_com¶ex_t™Ë
(
‹xt
, 
gs
=tags)

853 
£lf
.
quickadd_’Œy
.
	`£t_‹xt
('')

855 #sigÇÈ
the
 
ev’t
 th
¶ugšs
 
to
 
ÿtch


856 
GObjeù
.
	`idË_add
(
£lf
.
em™
, "task-added-via-quick-add",

857 
sk
.
	$g‘_id
())

859 #ià
no
 
‹xt
 
is
 
£Ëùed
, 
we
 
İ’
 
the
 
cu¼’y
 s–eùed 
sk


860 
nids
 = 
£lf
.
vŒ“_·Ãs
['aùive'].
	$g‘_£Ëùed_nodes
()

861 
nid
 
š
 
nids
:

862 
£lf
.
vmªag”
.
	$İ’_sk
(
nid
)

864 
def
 
	$Ú_quickadd_icÚ´ess
(
£lf
, 
widg‘
, 
icÚ
, 
ev’t
):

866 
icÚ
 =ğ
Gtk
.
EÁryIcÚPos™iÚ
.
SECONDARY
:

867 
£lf
.
quickadd_’Œy
.
	`£t_‹xt
('')

869 
def
 
	$Ú_g_Œ“v›w_bu‰Ú_´ess_ev’t
(
£lf
, 
Œ“v›w
, 
ev’t
):

871 
d—ls
 
w™h
 
mou£
 
şick
 
ev’t
 
Ú
 
the
 
g
 
Œ“


873 
Log
.
	`debug
("Received buttonƒvent #%d‡t %d, %d" % (

874 
ev’t
.
bu‰Ú
,ƒv’t.
x
,ƒv’t.
y
))

875 
ev’t
.
bu‰Ú
 == 3:

876 
x
 = (
ev’t
.x)

877 
y
 = (
ev’t
.y)

878 
time
 = 
ev’t
.time

879 
±hšfo
 = 
Œ“v›w
.
	$g‘_·th_©_pos
(
x
, 
y
)

880 
±hšfo
 
is
 
nÙ
 
NÚe
:

881 
·th
, 
cŞ
, 
ûÎx
, 
ûÎy
 = 
±hšfo


882 
Œ“v›w
.
	$g¿b_focus
()

883 #Th
loÿtiÚ
 
we
 
wªt
 
the
 
cursÜ
 
to
 o

884 #aá” 
we
're done.

885 
£lf
.
´evious_cursÜ
 = 
Œ“v›w
.
	$g‘_cursÜ
()

886 #FÜ 
u£
 
š
 
is_sk_visibË


887 
£lf
.
´evious_g
 = s–f.
	$g‘_£Ëùed_gs
()

888 #L‘' u knowh© we'
»
 
wÜkšg
 
Ú
 
a
 
g
.

889 
£lf
.
g_aùive
 = 
True


891 #Thi 
loÿtiÚ
 
is
 
¡Üed
 
š
 
we
 
Ãed
 
to
 
wÜk
 
w™h
 
™


892 #Ï‹¸
Ú
.

893 
£lf
.
rg‘_cursÜ
 = 
·th
, 
cŞ


894 
Œ“v›w
.
	$£t_cursÜ
(
·th
, 
cŞ
, 0)

895 #th
no¥ecŸl
=
True
 
di§bË
 
right
 
şickšg
 
¥ecŸl
 
gs


896 
£Ëùed_gs
 = 
£lf
.
	$g‘_£Ëùed_gs
(
no¥ecŸl
=
True
)

897 
£Ëùed_£¬ch
 = 
£lf
.
	$g‘_£Ëùed_£¬ch
()

898 #pİu°
m’u
 
£¬ches


899 #FIXME 
thos
 
two
 
b¿nches
 
could
 
be
 
sim¶if›d


900 #(
th”e
 
is
 
no
 
difã»nû
 
b‘w“Â
 
£¬ch
 
ªd
 
nÜm®
 
g


901 
£Ëùed_£¬ch
 
is
 
nÙ
 
NÚe
:

902 
my_g
 = 
£lf
.
»q
.
	$g‘_g
(
£Ëùed_£¬ch
)

903 
£lf
.
gpİup
.
	$£t_g
(
my_g
)

904 
£lf
.
gpİup
.
	$pİup
(
NÚe
, NÚe, NÚe, NÚe, 
ev’t
.
bu‰Ú
,

905 
time
)

906 
–if
 
	`Ën
(
£Ëùed_gs
) > 0:

907 #Th’ 
we
 
¬e
 
lookšg
 
©
 
sšgË
, 
nÜm®
 
g
 
¿th”
 
thª


908 #th
¥ecŸl
 'AÎags' 
Ü
 'Task w™houˆgs'. 
We
 
Úly


909 #wªˆ
to
 
pİup
 
the
 
m’u
 
nÜm®
 
gs
.

910 
my_g
 = 
£lf
.
»q
.
	$g‘_g
(
£Ëùed_gs
[0])

911 
£lf
.
gpİup
.
	$£t_g
(
my_g
)

912 
£lf
.
gpİup
.
	$pİup
(
NÚe
, NÚe, NÚe, NÚe, 
ev’t
.
bu‰Ú
,

913 
time
)

915 
£lf
.
	$»£t_cursÜ
()

916  
True


918 
def
 
	$Ú_g_Œ“v›w_key_´ess_ev’t
(
£lf
, 
Œ“v›w
, 
ev’t
):

919 
keyÇme
 = 
Gdk
.
	$keyv®_Çme
(
ev’t
.
keyv®
)

920 
is_shiá_f10
 = (
keyÇme
 =ğ"F10" 
ªd


921 
ev’t
.
	`g‘_¡©e
(è& 
Gdk
.
Modif›rTy³
.
SHIFT_MASK
)

922 
is_shiá_f10
 
Ü
 
keyÇme
 == "Menu":

923 
£Ëùed_gs
 = 
£lf
.
	$g‘_£Ëùed_gs
(
no¥ecŸl
=
True
)

924 
£Ëùed_£¬ch
 = 
£lf
.
	$g‘_£Ëùed_£¬ch
()

925 #FIXME 
thos
 
two
 
b¿nches
 
could
 
be
 
	`sim¶if›d
 (
th”e
 
is


926 #nØ
difã»nû
 
b‘w“Â
 
£¬ch
 
ªd
 
nÜm®
 
g


927 #pİu°
m’u
 
£¬ches


928 
£Ëùed_£¬ch
 
is
 
nÙ
 
NÚe
:

929 
£lf
.
gpİup
.
	$£t_g
(
£Ëùed_£¬ch
)

930 
£lf
.
gpİup
.
	$pİup
(
NÚe
, NÚe, NÚe, 0, 
ev’t
.
time
)

931 
–if
 
	`Ën
(
£Ëùed_gs
) > 0:

932 #Th’ 
we
 
¬e
 
lookšg
 
©
 
sšgË
, 
nÜm®
 
g
 
¿th”
 
thª


933 #th
¥ecŸl
 'AÎags' 
Ü
 'Task w™houˆgs'. 
We
 
Úly


934 #wªˆ
to
 
pİup
 
the
 
m’u
 
nÜm®
 
gs
.

935 
£Ëùed_g
 = 
£lf
.
»q
.
	$g‘_g
(
£Ëùed_gs
[0])

936 
£lf
.
gpİup
.
	$£t_g
(
£Ëùed_g
)

937 
£lf
.
gpİup
.
	$pİup
(
NÚe
, NÚe, NÚe, NÚe, 0, 
ev’t
.
time
)

939 
£lf
.
	$»£t_cursÜ
()

940  
True


941 
keyÇme
 == "Delete":

942 
£lf
.
	$Ú_d–‘e_g
(
ev’t
)

943  
True


945 
def
 
	$Ú_d–‘e_g
(
£lf
, 
ev’t
):

946 
gs
 = 
£lf
.
	$g‘_£Ëùed_gs
()

947 
g
 
š
 
gs
:

948 
t
 
š
 
£lf
.
vmªag”
.
İ’ed_sk
:

949 
	`´št
 ("$$"+
t
)

950 
sk
 = 
£lf
.
»q
.
	$g‘_sk
(
t
)

951 
sk
.
	$»move_g
(
g
)

952 
	`´št
("%%%Cu¼’ˆcÚ‹Á:"+
sk
.
	$g‘_‹xt
())

953 
sk
.
	`£t_‹xt
Ñask.
	$g‘_‹xt
())

954 
sk
.
	$sync
()

955 
£lf
.
»q
.
	$d–‘e_g
(
g
)

956 
£lf
.
gŒ“v›w
.
	$£t_cursÜ
(0)

957 
£lf
.
	$Ú_£Ëù_g
()

959 
def
 
	$Ú_sk_Œ“v›w_bu‰Ú_´ess_ev’t
(
£lf
, 
Œ“v›w
, 
ev’t
):

961 
sk
 
Œ“
 
v›w
 """

962 
Log
.
	`debug
("Received buttonƒvent #%d‡t %d,%d" % (

963 
ev’t
.
bu‰Ú
,ƒv’t.
x
,ƒv’t.
y
))

964 
ev’t
.
bu‰Ú
 == 3:

965 
x
 = (
ev’t
.x)

966 
y
 = (
ev’t
.y)

967 
time
 = 
ev’t
.time

968 
±hšfo
 = 
Œ“v›w
.
	$g‘_·th_©_pos
(
x
, 
y
)

969 
±hšfo
 
is
 
nÙ
 
NÚe
:

970 
·th
, 
cŞ
, 
ûÎx
, 
ûÎy
 = 
±hšfo


971 
£ËùiÚ
 = 
Œ“v›w
.
	$g‘_£ËùiÚ
()

972 
£ËùiÚ
.
	`couÁ_£Ëùed_rows
() > 0:

973 
nÙ
 
£ËùiÚ
.
	$·th_is_£Ëùed
(
·th
):

974 
Œ“v›w
.
	$£t_cursÜ
(
·th
, 
cŞ
, 0)

976 
Œ“v›w
.
	$£t_cursÜ
(
·th
, 
cŞ
, 0)

977 
Œ“v›w
.
	$g¿b_focus
()

978 
£lf
.
skpİup
.
	$pİup
(
NÚe
, NÚe, NÚe, NÚe, 
ev’t
.
bu‰Ú
,

979 
time
)

980  
True


982 
def
 
	$Ú_sk_Œ“v›w_key_´ess_ev’t
(
£lf
, 
Œ“v›w
, 
ev’t
):

983 
keyÇme
 = 
Gdk
.
	$keyv®_Çme
(
ev’t
.
keyv®
)

984 
is_shiá_f10
 = (
keyÇme
 =ğ"F10" 
ªd


985 
ev’t
.
	`g‘_¡©e
(è& 
Gdk
.
Modif›rTy³
.
SHIFT_MASK
)

987 
keyÇme
 == "Delete":

988 
£lf
.
	$Ú_d–‘e_sks
()

989  
True


990 
–if
 
is_shiá_f10
 
Ü
 
keyÇme
 == "Menu":

991 
£lf
.
skpİup
.
	$pİup
(
NÚe
, NÚe, NÚe, 0, 
ev’t
.
time
)

992  
True


994 
def
 
	$Ú_şo£d_sk_Œ“v›w_bu‰Ú_´ess_ev’t
(
£lf
, 
Œ“v›w
, 
ev’t
):

995 
ev’t
.
bu‰Ú
 == 3:

996 
x
 = (
ev’t
.x)

997 
y
 = (
ev’t
.y)

998 
time
 = 
ev’t
.time

999 
±hšfo
 = 
Œ“v›w
.
	$g‘_·th_©_pos
(
x
, 
y
)

1000 
±hšfo
 
is
 
nÙ
 
NÚe
:

1001 
·th
, 
cŞ
, 
ûÎx
, 
ûÎy
 = 
±hšfo


1002 
Œ“v›w
.
	$g¿b_focus
()

1003 
Œ“v›w
.
	$£t_cursÜ
(
·th
, 
cŞ
, 0)

1004 
£lf
.
ùaskpİup
.
	$pİup
(
NÚe
, NÚe, NÚe, 
ev’t
.
bu‰Ú
, 
time
)

1005  
True


1007 
def
 
	$Ú_şo£d_sk_Œ“v›w_key_´ess_ev’t
(
£lf
, 
Œ“v›w
, 
ev’t
):

1008 
keyÇme
 = 
Gdk
.
	$keyv®_Çme
(
ev’t
.
keyv®
)

1009 
is_shiá_f10
 = (
keyÇme
 =ğ"F10" 
ªd


1010 
ev’t
.
	`g‘_¡©e
(è& 
Gdk
.
Modif›rTy³
.
SHIFT_MASK
)

1012 
keyÇme
 == "Delete":

1013 
£lf
.
	$Ú_d–‘e_sks
()

1014  
True


1015 
–if
 
is_shiá_f10
 
Ü
 
keyÇme
 == "Menu":

1016 
£lf
.
ùaskpİup
.
	$pİup
(
NÚe
, NÚe, NÚe, 0, 
ev’t
.
time
)

1017  
True


1019 
def
 
	$Ú_add_sk
(
£lf
, 
widg‘
, 
¡©us
=
NÚe
):

1020 
gs
 = [
g
 g 
š
 
£lf
.
	$g‘_£Ëùed_gs
(è
g
.
	`¡¬tsw™h
('@')]

1021 
sk
 = 
£lf
.
»q
.
	$Ãw_sk
(
gs
ñags, 
Ãwsk
=
True
)

1022 
uid
 = 
sk
.
	$g‘_id
()

1023 
¡©us
:

1024 
£lf
.
vmªag”
.
	$ask_£t_sk_¡©us
(
sk
, 
¡©us
)

1025 
£lf
.
vmªag”
.
	$İ’_sk
(
uid
, 
thisi¢ew
=
True
)

1027 
def
 
	$Ú_add_subsk
(
£lf
, 
widg‘
):

1028 
uid
 = 
£lf
.
	$g‘_£Ëùed_sk
()

1029 
uid
:

1030 
z‘ask
 = 
£lf
.
»q
.
	$g‘_sk
(
uid
)

1031 
gs
 = [
t
.
	$g‘_Çme
(è
t
 
š
 
z‘ask
.
	`g‘_gs
()]

1032 
sk
 = 
£lf
.
»q
.
	$Ãw_sk
(
gs
ñags, 
Ãwsk
=
True
)

1033 #sk.
	`add_·»Á
(
uid
)

1034 
z‘ask
.
	`add_chd
(
sk
.
	$g‘_id
())

1035 
£lf
.
vmªag”
.
	`İ’_sk
(
sk
.
	`g‘_id
(), 
thisi¢ew
=
True
)

1037 
def
 
	$Ú_ed™_aùive_sk
(
£lf
, 
widg‘
, 
row
=
NÚe
, 
cŞ
=None):

1038 
tid
 = 
£lf
.
	$g‘_£Ëùed_sk
()

1039 
tid
:

1040 
£lf
.
vmªag”
.
	$İ’_sk
(
tid
)

1042 
def
 
	$Ú_ed™_dÚe_sk
(
£lf
, 
widg‘
, 
row
=
NÚe
, 
cŞ
=None):

1043 
tid
 = 
£lf
.
	`g‘_£Ëùed_sk
('closed')

1044 
tid
:

1045 
£lf
.
vmªag”
.
	$İ’_sk
(
tid
)

1047 
def
 
	$Ú_d–‘e_sks
(
£lf
, 
widg‘
=
NÚe
, 
tid
=None):

1048 #Ià
we
 
dÚ
't have‡…arameter,henakehe selection inhe

1050 
nÙ
 
tid
:

1051 #tid_to_d–‘
is
 
a
 [
´ojeù
, 
sk
] 
tu¶e


1052 
tids_tod–‘e
 = 
£lf
.
	$g‘_£Ëùed_sks
()

1053 
nÙ
 
tids_tod–‘e
:

1056 
tids_tod–‘e
 = [
tid
]

1057 
Log
.
	`debug
("gošgØd–‘%s" % 
tids_tod–‘e
)

1058 
£lf
.
vmªag”
.
	$ask_d–‘e_sks
(
tids_tod–‘e
)

1060 
def
 
	$upd©e_¡¬t_d©e
(
£lf
, 
widg‘
, 
Ãw_¡¬t_d©e
):

1061 
sks
 = [
£lf
.
»q
.
	$g‘_sk
(
uid
)

1062 
uid
 
š
 
£lf
.
	$g‘_£Ëùed_sks
()

1063 
uid
 
is
 
nÙ
 
NÚe
]

1065 
¡¬t_d©e
 = 
D©e
.
	$·r£
(
Ãw_¡¬t_d©e
)

1067 #FIXME:
If
 
the
 
sk
 
dŸlog
 
is
 
di¥Ïyed
, 
»äesh
 
™s
 
¡¬t_d©e
 
widg‘


1068 
sk
 
š
 
sks
:

1069 
sk
.
	$£t_¡¬t_d©e
(
¡¬t_d©e
)

1071 
def
 
	$Ú_m¬k_as_¡¬‹d
(
£lf
, 
widg‘
):

1072 
£lf
.
	`upd©e_¡¬t_d©e
(
widg‘
, "today")

1074 
def
 
	$Ú_¡¬t_fÜ_tomÜrow
(
£lf
, 
widg‘
):

1075 
£lf
.
	`upd©e_¡¬t_d©e
(
widg‘
, "tomorrow")

1077 
def
 
	$Ú_¡¬t_fÜ_Ãxt_w“k
(
£lf
, 
widg‘
):

1078 
£lf
.
	`upd©e_¡¬t_d©e
(
widg‘
, "next week")

1080 
def
 
	$Ú_¡¬t_fÜ_Ãxt_mÚth
(
£lf
, 
widg‘
):

1081 
£lf
.
	`upd©e_¡¬t_d©e
(
widg‘
, "next month")

1083 
def
 
	$Ú_¡¬t_fÜ_Ãxt_y—r
(
£lf
, 
widg‘
):

1084 
£lf
.
	`upd©e_¡¬t_d©e
(
widg‘
, "next year")

1086 
def
 
	$Ú_¡¬t_ş—r
(
£lf
, 
widg‘
):

1087 
£lf
.
	$upd©e_¡¬t_d©e
(
widg‘
, 
NÚe
)

1089 
def
 
	$upd©e_due_d©e
(
£lf
, 
widg‘
, 
Ãw_due_d©e
):

1090 
sks
 = [
£lf
.
»q
.
	$g‘_sk
(
uid
)

1091 
uid
 
š
 
£lf
.
	$g‘_£Ëùed_sks
()

1092 
uid
 
is
 
nÙ
 
NÚe
]

1094 
due_d©e
 = 
D©e
.
	$·r£
(
Ãw_due_d©e
)

1096 #FIXME: 
If
 
the
 
sk
 
dŸlog
 
is
 
di¥Ïyed
, 
»äesh
 
™s
 
due_d©e
 
widg‘


1097 
sk
 
š
 
sks
:

1098 
sk
.
	$£t_due_d©e
(
due_d©e
)

1100 
def
 
	$Ú_£t_due_today
(
£lf
, 
widg‘
):

1101 
£lf
.
	`upd©e_due_d©e
(
widg‘
, "today")

1103 
def
 
	$Ú_£t_due_tomÜrow
(
£lf
, 
widg‘
):

1104 
£lf
.
	`upd©e_due_d©e
(
widg‘
, "tomorrow")

1106 
def
 
	$Ú_£t_due_Ãxt_w“k
(
£lf
, 
widg‘
):

1107 
£lf
.
	`upd©e_due_d©e
(
widg‘
, "next week")

1109 
def
 
	$Ú_£t_due_Ãxt_mÚth
(
£lf
, 
widg‘
):

1110 
£lf
.
	`upd©e_due_d©e
(
widg‘
, "next month")

1112 
def
 
	$Ú_£t_due_Ãxt_y—r
(
£lf
, 
widg‘
):

1113 
£lf
.
	`upd©e_due_d©e
(
widg‘
, "next year")

1115 
def
 
	$Ú_£t_due_soÚ
(
£lf
, 
widg‘
):

1116 
£lf
.
	`upd©e_due_d©e
(
widg‘
, "soon")

1118 
def
 
	$Ú_£t_due_someday
(
£lf
, 
widg‘
):

1119 
£lf
.
	`upd©e_due_d©e
(
widg‘
, "someday")

1121 
def
 
	$Ú_£t_due_ş—r
(
£lf
, 
widg‘
):

1122 
£lf
.
	$upd©e_due_d©e
(
widg‘
, 
NÚe
)

1124 
def
 
	$Ú_¡¬t_fÜ_¥ecific_d©e
(
£lf
, 
widg‘
):

1126 
£lf
.
ÿËnd¬
.
	`£t_t™Ë
("Set Start Date")

1127 #G‘ 
sk
 
äom
ask 
Çme


1128 
sk
 = 
£lf
.
»q
.
	`g‘_sk
(£lf.
	`g‘_£Ëùed_sks
()[0])

1129 
d©e
 = 
sk
.
	$g‘_¡¬t_d©e
()

1130 
£lf
.
ÿËnd¬
.
	$£t_d©e
(
d©e
, 
GTGC®’d¬
.
DATE_KIND_START
)

1131 #Show 
the
 
ÿËnd¬
 
ju¡
 
above
h
mou£
 
Ú
 
widg‘
's†ine of symmetry

1132 
»ù
 = 
widg‘
.
	$g‘_®loÿtiÚ
()

1133 
»suÉ
, 
x
, 
y
 = 
widg‘
.
	`g‘_wšdow
().
	$g‘_Üigš
()

1134 
£lf
.
ÿËnd¬
.
	`show_©_pos™iÚ
(
x
 + 
»ù
.x +„eù.
width
,

1135 
y
 + 
»ù
.y)

1137 
def
 
	$Ú_£t_due_fÜ_¥ecific_d©e
(
£lf
, 
widg‘
):

1139 
£lf
.
ÿËnd¬
.
	`£t_t™Ë
("Set Due Date")

1140 #G‘ 
sk
 
äom
ask 
Çme


1141 
sk
 = 
£lf
.
»q
.
	`g‘_sk
(£lf.
	`g‘_£Ëùed_sks
()[0])

1142 
nÙ
 
sk
.
	$g‘_due_d©e
():

1143 
d©e
 = 
sk
.
	$g‘_¡¬t_d©e
()

1145 
d©e
 = 
sk
.
	$g‘_due_d©e
()

1146 
£lf
.
ÿËnd¬
.
	$£t_d©e
(
d©e
, 
GTGC®’d¬
.
DATE_KIND_DUE
)

1147 #Show 
the
 
ÿËnd¬
 
ju¡
 
above
h
mou£
 
Ú
 
widg‘
's†ine of symmetry

1148 
»ù
 = 
widg‘
.
	$g‘_®loÿtiÚ
()

1149 
»suÉ
, 
x
, 
y
 = 
widg‘
.
	`g‘_wšdow
().
	$g‘_Üigš
()

1150 
£lf
.
ÿËnd¬
.
	`show_©_pos™iÚ
(
x
 + 
»ù
.x +„eù.
width
,

1151 
y
 + 
»ù
.y)

1153 
def
 
	$Ú_d©e_chªged
(
£lf
, 
ÿËnd¬
):

1154 #G‘ 
sks
'†i¡ fromask‚ames' 
li¡


1155 
sks
 = [
£lf
.
»q
.
	$g‘_sk
(
sk
èsk 
š
 
£lf
.
	`g‘_£Ëùed_sks
()]

1156 
d©e
, 
d©e_kšd
 = 
ÿËnd¬
.
	$g‘_£Ëùed_d©e
()

1157 
d©e_kšd
 =ğ
GTGC®’d¬
.
DATE_KIND_DUE
:

1158 
sk
 
š
 
sks
:

1159 
sk
.
	$£t_due_d©e
(
d©e
)

1160 
–if
 
d©e_kšd
 =ğ
GTGC®’d¬
.
DATE_KIND_START
:

1161 
sk
 
š
 
sks
:

1162 
sk
.
	$£t_¡¬t_d©e
(
d©e
)

1164 
def
 
	$Ú_modify_gs
(
£lf
, 
widg‘
):

1166 
sks
 = 
£lf
.
	$g‘_£Ëùed_sks
()

1167 
£lf
.
modifygs_dŸlog
.
	$modify_gs
(
sks
)

1169 
def
 
	$şo£_®l_sk_ed™Üs
(
£lf
, 
sk_id
):

1171 
®l_subsks
 = []

1173 
def
 
	$Œaû_subsks
(
roÙ
):

1174 
®l_subsks
.
	$­³nd
(
roÙ
)

1175 
i
 
š
 
roÙ
.
	$g‘_subsks
():

1176 
i
 
nÙ
 
š
 
®l_subsks
:

1177 
	$Œaû_subsks
(
i
)

1179 
	`Œaû_subsks
(
£lf
.
»q
.
	$g‘_sk
(
sk_id
))

1181 
sk
 
š
 
®l_subsks
:

1182 
£lf
.
vmªag”
.
	`şo£_sk
(
sk
.
	$g‘_id
())

1184 
def
 
	$Ú_m¬k_as_dÚe
(
£lf
, 
widg‘
):

1185 
sks_uid
 = [
uid
 uid 
š
 
£lf
.
	$g‘_£Ëùed_sks
()

1186 
uid
 
is
 
nÙ
 
NÚe
]

1187 
	`Ën
(
sks_uid
) == 0:

1189 
sks
 = [
£lf
.
»q
.
	$g‘_sk
(
uid
èuid 
š
 
sks_uid
]

1190 
sks_¡©us
 = [
sk
.
	$g‘_¡©us
(è
sk
 
š
 
sks
]

1191 
uid
, 
sk
, 
¡©us
 
š
 
	$z
(
sks_uid
, 
sks
, 
sks_¡©us
):

1192 
¡©us
 =ğ
Task
.
STA_DONE
:

1193 #M¬kšg 
as
 
undÚe


1194 
£lf
.
vmªag”
.
	$ask_£t_sk_¡©us
(
sk
, 
Task
.
STA_ACTIVE
)

1195 #P¬’t 
of
 
th©
 
sk
 
mu¡
 
be
 
upd©ed
 - 
nÙ
 
to
 b
shown


1196 #š 
wÜkv›w
, 
upd©e
 
chd»n
 
couÁ
, 
‘c
.

1197 
·»Á_id
 
š
 
sk
.
	$g‘_·»Ás
():

1198 
·»Á
 = 
£lf
.
»q
.
	$g‘_sk
(
·»Á_id
)

1199 
·»Á
.
	$modif›d
()

1201 
£lf
.
vmªag”
.
	$ask_£t_sk_¡©us
(
sk
, 
Task
.
STA_DONE
)

1202 
£lf
.
	$şo£_®l_sk_ed™Üs
(
uid
)

1204 
def
 
	$Ú_dismiss_sk
(
£lf
, 
widg‘
):

1205 
sks_uid
 = [
uid
 uid 
š
 
£lf
.
	$g‘_£Ëùed_sks
()

1206 
uid
 
is
 
nÙ
 
NÚe
]

1207 
	`Ën
(
sks_uid
) == 0:

1209 
sks
 = [
£lf
.
»q
.
	$g‘_sk
(
uid
èuid 
š
 
sks_uid
]

1210 
sks_¡©us
 = [
sk
.
	$g‘_¡©us
(è
sk
 
š
 
sks
]

1211 
uid
, 
sk
, 
¡©us
 
š
 
	$z
(
sks_uid
, 
sks
, 
sks_¡©us
):

1212 
¡©us
 =ğ
Task
.
STA_DISMISSED
:

1213 
£lf
.
vmªag”
.
	$ask_£t_sk_¡©us
(
sk
, 
Task
.
STA_ACTIVE
)

1215 
£lf
.
vmªag”
.
	$ask_£t_sk_¡©us
(
sk
, 
Task
.
STA_DISMISSED
)

1216 
£lf
.
	$şo£_®l_sk_ed™Üs
(
uid
)

1218 
def
 
	$­¶y_f‹r_Ú_·Ãs
(
£lf
, 
f‹r_Çme
, 
»äesh
=
True
):

1220 #Re£ˆ
quickadd_’Œy
 
ªÙh”
 
f‹r
 
is
 
­¶›d


1221 
£lf
.
quickadd_’Œy
.
	`£t_‹xt
("")

1222 
·Ã
 
š
 
£lf
.
vŒ“_·Ãs
:

1223 
vŒ“
 = 
£lf
.
»q
.
	$g‘_sks_Œ“
(
Çme
=
·Ã
, 
»äesh
=
F®£
)

1224 
vŒ“
.
	$­¶y_f‹r
(
f‹r_Çme
, 
»äesh
=refresh)

1226 
def
 
	$uÇµly_f‹r_Ú_·Ãs
(
£lf
, 
f‹r_Çme
, 
»äesh
=
True
):

1228 
·Ã
 
š
 
£lf
.
vŒ“_·Ãs
:

1229 
vŒ“
 = 
£lf
.
»q
.
	$g‘_sks_Œ“
(
Çme
=
·Ã
, 
»äesh
=
F®£
)

1230 
vŒ“
.
	$uÇµly_f‹r
(
f‹r_Çme
, 
»äesh
=refresh)

1232 
def
 
	$Ú_£Ëù_g
(
£lf
, 
widg‘
=
NÚe
, 
row
=NÚe, 
cŞ
=None):

1234 
ÿÎback
 
wh’
 
£Ëùšg
 
ª
 
–em’t
 
of
 
the
 
	`gŒ“
 (
Ëá
 
sideb¬
)

1236 #FIXME 
add
 
suµÜt
 
muÉË
 
£ËùiÚ
 
of
 
gs
 
š
 
futu»


1238 #Wh’ 
you
 
şick
 
Ú
 
a
 
g
, you 
wªt
 
to
 
un£Ëù
 
the
 
sks


1239 
Ãw_gli¡
 = 
£lf
.
	$g‘_£Ëùed_gs
()

1241 
gÇme
 
š
 
£lf
.
­¶›d_gs
:

1242 
gÇme
 
nÙ
 
š
 
Ãw_gli¡
:

1243 
£lf
.
	$uÇµly_f‹r_Ú_·Ãs
(
gÇme
, 
»äesh
=
F®£
)

1245 
gÇme
 
š
 
Ãw_gli¡
:

1246 
gÇme
 
nÙ
 
š
 
£lf
.
­¶›d_gs
:

1247 
£lf
.
	$­¶y_f‹r_Ú_·Ãs
(
gÇme
)

1248 #IÀ
of
 
£¬ch
 
g
, 
£t
 
qu”y
 
š
 
quickadd
 

1249 #»fššg 
£¬ch
 
qu”y


1250 
g
 = 
£lf
.
»q
.
	$g‘_g
(
gÇme
)

1251 
g
.
	$is_£¬ch_g
():

1252 
£lf
.
quickadd_’Œy
.
	`£t_‹xt
(
g
.
	`g‘_©Œibu‹
("query"))

1254 
£lf
.
­¶›d_gs
 = 
Ãw_gli¡


1256 
def
 
	$Ú_skdÚe_cursÜ_chªged
(
£lf
, 
£ËùiÚ
=
NÚe
):

1259 
Chªges
 
the
 
way
h
£Ëùed
 
sk
 
is
 
di¥Ïyed
.

1261 
£‰šgs_dÚe
 = {"Ïb–": 
GnomeCÚfig
.
MARK_DONE
,

1262 "toŞt": 
GnomeCÚfig
.
MARK_DONE_TOOLTIP
,

1263 "icÚ-Çme": "gtg-sk-dÚe"
	}
}

1264 
£‰šgs_undÚe
 = {"Ïb–": 
GnomeCÚfig
.
MARK_UNDONE
,

1265 "toŞt": 
GnomeCÚfig
.
MARK_UNDONE_TOOLTIP
,

1267 
£‰šgs_dismiss
 = {"Ïb–": 
GnomeCÚfig
.
MARK_DISMISS
,

1268 "toŞt": 
GnomeCÚfig
.
MARK_DISMISS_TOOLTIP
,

1270 
£‰šgs_undismiss
 = {"Ïb–": 
GnomeCÚfig
.
MARK_UNDISMISS
,

1271 "toŞt": 
GnomeCÚfig
.
MARK_UNDISMISS_TOOLTIP
,

1274 
def
 
	$upd©e_bu‰Ú
(
bu‰Ú
, 
£‰šgs
):

1275 
bu‰Ú
.
	`£t_icÚ_Çme
(
£‰šgs
["icon-name"])

1276 
bu‰Ú
.
	`£t_Ïb–
(
£‰šgs
["label"])

1277 
bu‰Ú
.
	`£t_toŞt_‹xt
(
£‰šgs
["tooltip"])

1279 
def
 
	$upd©e_m’u_™em
(
m’u_™em
, 
£‰šgs
):

1280 
image
 = 
Gtk
.
Image
.
	`Ãw_äom_icÚ_Çme
(
£‰šgs
["icon-name"], 16)

1281 
image
.
	$£t_pix–_size
(16)

1282 
image
.
	$show
()

1283 
m’u_™em
.
	$£t_image
(
image
)

1284 
m’u_™em
.
	`£t_Ïb–
(
£‰šgs
["label"])

1286 #W
un£Ëù
 
®l
 
š
 
the
 
aùive
 
sk
 
v›w


1287 #OÆy 
som‘hšg
 
is
 
£Ëùed
 
š
 
the
 
şo£d
 
sk
 
li¡


1288 #And 
we
 
chªge
 
the
 
¡©us
 
of
h
DÚe
/
dismiss
 
bu‰Ú


1289 
	$upd©e_bu‰Ú
(
£lf
.
dÚebu‰Ú
, 
£‰šgs_dÚe
)

1290 
	$upd©e_m’u_™em
(
£lf
.
dÚe_mi
, 
£‰šgs_dÚe
)

1291 
	$upd©e_bu‰Ú
(
£lf
.
dismissbu‰Ú
, 
£‰šgs_dismiss
)

1292 
	$upd©e_m’u_™em
(
£lf
.
dismiss_mi
, 
£‰šgs_dismiss
)

1293 
£ËùiÚ
.
	`couÁ_£Ëùed_rows
() > 0:

1294 
tid
 = 
£lf
.
	`g‘_£Ëùed_sk
('closed')

1295 
sk
 = 
£lf
.
»q
.
	$g‘_sk
(
tid
)

1296 
£lf
.
vŒ“_·Ãs
['aùive'].
	`g‘_£ËùiÚ
().
	$un£Ëù_®l
()

1297 
sk
.
	`g‘_¡©us
() == "Dismiss":

1298 
£lf
.
bud”
.
	`g‘_objeù
(

1299 "ùcm_m¬k_as_nÙ_dÚe").
	$£t_£ns™ive
(
F®£
)

1300 
£lf
.
bud”
.
	`g‘_objeù
("ùcm_undismiss").
	$£t_£ns™ive
(
True
)

1301 
	$upd©e_bu‰Ú
(
£lf
.
dismissbu‰Ú
, 
£‰šgs_undismiss
)

1302 
	$upd©e_m’u_™em
(
£lf
.
dismiss_mi
, 
£‰šgs_undismiss
)

1304 
£lf
.
bud”
.
	`g‘_objeù
(

1305 "ùcm_m¬k_as_nÙ_dÚe").
	$£t_£ns™ive
(
True
)

1306 
£lf
.
bud”
.
	`g‘_objeù
(

1307 "ùcm_undismiss").
	$£t_£ns™ive
(
F®£
)

1308 
	$upd©e_bu‰Ú
(
£lf
.
dÚebu‰Ú
, 
£‰šgs_undÚe
)

1309 
	$upd©e_m’u_™em
(
£lf
.
dÚe_mi
, 
£‰šgs_undÚe
)

1310 
£lf
.
	$upd©e_bu‰Ús_£ns™iv™y
()

1312 
def
 
	$Ú_sk_cursÜ_chªged
(
£lf
, 
£ËùiÚ
=
NÚe
):

1315 
Chªges
 
the
 
way
h
£Ëùed
 
sk
 
is
 
di¥Ïyed
.

1317 #W
un£Ëù
 
®l
 
š
 
the
 
şo£d
 
sk
 
v›w


1318 #OÆy 
som‘hšg
 
is
 
£Ëùed
 
š
 
the
 
aùive
 
sk
 
li¡


1319 
£lf
.
dÚebu‰Ú
.
	`£t_icÚ_Çme
("gtg-task-done")

1320 
£lf
.
dismissbu‰Ú
.
	`£t_icÚ_Çme
("gtg-task-dismiss")

1321 
£ËùiÚ
.
	`couÁ_£Ëùed_rows
() > 0:

1322 'şo£d' 
š
 
£lf
.
vŒ“_·Ãs
:

1323 
£lf
.
vŒ“_·Ãs
['şo£d'].
	`g‘_£ËùiÚ
().
	$un£Ëù_®l
()

1324 
£lf
.
dÚebu‰Ú
.
	$£t_Ïb–
(
GnomeCÚfig
.
MARK_DONE
)

1325 
£lf
.
dÚebu‰Ú
.
	$£t_toŞt_‹xt
(
GnomeCÚfig
.
MARK_DONE_TOOLTIP
)

1326 
£lf
.
dismissbu‰Ú
.
	$£t_Ïb–
(
GnomeCÚfig
.
MARK_DISMISS
)

1327 
£lf
.
	$upd©e_bu‰Ús_£ns™iv™y
()

1329 
def
 
	$Ú_şo£
(
£lf
, 
widg‘
=
NÚe
):

1331 #Savšg 
is
 
now
 
dÚe
 
š
 
maš
.
py


1332 
£lf
.
	$qu™
()

1334 #usšg 
dummy
 
·¿m‘”s
 
th©
 
¬e
 
giv’
 
by
 
the
 
sigÇl


1335 
def
 
	$upd©e_bu‰Ús_£ns™iv™y
(
£lf
, 
a
=
NÚe
, 
b
=NÚe, 
c
=None):

1336 
’abË
 = 
£lf
.
£ËùiÚ
.
	$couÁ_£Ëùed_rows
()

1337 'şo£d' 
š
 
£lf
.
vŒ“_·Ãs
:

1338 
’abË
 +ğ
£lf
.
şo£d_£ËùiÚ
.
	`couÁ_£Ëùed_rows
() > 0

1339 
£lf
.
ed™_mi
.
	$£t_£ns™ive
(
’abË
)

1340 
£lf
.
Ãw_subsk_mi
.
	$£t_£ns™ive
(
’abË
)

1341 
£lf
.
dÚe_mi
.
	$£t_£ns™ive
(
’abË
)

1342 
£lf
.
dismiss_mi
.
	$£t_£ns™ive
(
’abË
)

1343 
£lf
.
d–‘e_mi
.
	$£t_£ns™ive
(
’abË
)

1344 
£lf
.
dÚebu‰Ú
.
	$£t_£ns™ive
(
’abË
)

1345 
£lf
.
dismissbu‰Ú
.
	$£t_£ns™ive
(
’abË
)

1346 
£lf
.
d–‘ebu‰Ú
.
	$£t_£ns™ive
(
’abË
)

1348 ###PUBLIC 
METHODS
 #########################################################
 g‘_£Ëùed_sk(£lf,v=NÚe):

1350 
R‘uºs
 
the
'uid' 
of
h
£Ëùed
 
sk
, 
ªy
.

1351 
If
 
muÉË
 
sks
 
¬e
 
£Ëùed
, 
»tuºs
 
Úly
 
the
 
fœ¡
 
ªd


1352 
kes
 
ÿ»
 
of
 
£Ëùšg
 
Úly
 
	`th©
 (
un£Ëùšg
 
the
 
Ùh”s
)

1354 @
·¿m
 
tv
: 
The
 
Œ“
 
v›w
 
to
 
fšd
 
the
 
£Ëùed
 
sk
 
š
. 
DeçuÉs
o

1355 
the
 
sk_tv›w
.

1357 
ids
 = 
£lf
.
	$g‘_£Ëùed_sks
(
tv
)

1358 
	`Ën
(
ids
) > 0:

1359 #FIXME: 
we
 
should
 
®so
 
un£Ëù
 
®l
 
the
 
Ùh”s


1360  
ids
[0]

1362  
NÚe


1364 
def
 
	$g‘_£Ëùed_sks
(
£lf
, 
tv
=
NÚe
):

1366 
R‘uºs
 
a
 
li¡
 
of
 'uids' oà
the
 
£Ëùed
 
sks
, 
ªd
h
cÜ»¥Údšg


1367 
™”s


1369 @
·¿m
 
tv
: 
The
 
Œ“
 
v›w
 
to
 
fšd
 
the
 
£Ëùed
 
sk
 
š
. 
DeçuÉs
o

1370 
the
 
sk_tv›w
.

1372 #FIXME 
Why
 
we
 
have
 
aùive
 
as
 
back
 ? 
is
 
th©
 
so
? 
Study
 
this
 
code


1373 
£Ëùed
 = []

1374 
tv
:

1375 
£Ëùed
 = 
£lf
.
vŒ“_·Ãs
[
tv
].
	$g‘_£Ëùed_nodes
()

1377 'aùive' 
š
 
£lf
.
vŒ“_·Ãs
:

1378 
£Ëùed
 = 
£lf
.
vŒ“_·Ãs
['aùive'].
	$g‘_£Ëùed_nodes
()

1379 
i
 
š
 
£lf
.
vŒ“_·Ãs
:

1380 
	`Ën
(
£Ëùed
) == 0:

1381 
£Ëùed
 = 
£lf
.
vŒ“_·Ãs
[
i
].
	$g‘_£Ëùed_nodes
()

1382  
£Ëùed


1384 #Ià
no¥ecŸl
=
True
, 
Úly
 
nÜm®
 @
g
 
¬e
 
cÚsid”ed


1385 
def
 
	$g‘_£Ëùed_gs
(
£lf
, 
no¥ecŸl
=
F®£
):

1387 
R‘uºs
 
the
 
£Ëùed
 
nodes
 
äom
h
gŒ“


1389 @
·¿m
 
no¥ecŸl
: 
dÛ¢
't„eturnagshat do‚ot stat with

1391 
gli¡
 = []

1392 
£lf
.
gŒ“v›w
:

1393 
gli¡
 = 
£lf
.
gŒ“v›w
.
	$g‘_£Ëùed_nodes
()

1394 #Ià
no
 
£ËùiÚ
, 
we
 
di¥Ïy
 
®l


1395 
nÙ
 
no¥ecŸl
 
	`ªd
 (nÙ 
gli¡
 
Ü
 
	`Ën
(taglist) < 0):

1396 
gli¡
 = ['gtg-tags-all']

1397 
no¥ecŸl
:

1398 
t
 
š
 
	$li¡
(
gli¡
):

1399 
nÙ
 
t
.
	`¡¬tsw™h
('@'):

1400 
gli¡
.
	$»move
(
t
)

1401  
gli¡


1403 
def
 
	$»£t_cursÜ
(
£lf
):

1405 
to
 
ªy
 
right
 
şick
 
aùiÚ
. 
Should
 
be
 
u£d
 
wh’ev”
 
we
're done

1406 
wÜkšg
 
w™h
 
ªy
 
g
 
through
 
a
 
right
 
şick
 
m’u
 
aùiÚ
.

1408 
£lf
.
g_aùive
:

1409 
£lf
.
g_aùive
 = 
F®£


1410 
·th
, 
cŞ
 = 
£lf
.
´evious_cursÜ


1411 
£lf
.
gŒ“v›w
:

1412 
£lf
.
gŒ“v›w
.
	$£t_cursÜ
(
·th
, 
cŞ
, 0)

1414 
def
 
	$£t_rg‘_cursÜ
(
£lf
):

1417 
We
 
Ãed
 
this
 
beÿu£
 
the
 
cÚ‹xt
 
m’u
 
wl
 
d—ùiv©e


1418 (
ªd
 
š
 
tuº
, 
ÿÎ
 
	$»£t_cursÜ
()è
befÜe
, 
exam¶e
, 
the
 
cŞÜ


1419 
pick”
 
dŸlog
 
begšs
. 
Should
 
be
 
u£d
 
©
 
the
 
begšnšg
 
of
 
ªy
 
g


1420 
ed™šg
 
funùiÚ
 
to
 
»mšd
 
the
 
u£r
 
which
 
g
 
they
're working with.

1422 
nÙ
 
£lf
.
g_aùive
:

1423 
£lf
.
g_aùive
 = 
True


1424 
·th
, 
cŞ
 = 
£lf
.
rg‘_cursÜ


1425 
£lf
.
gŒ“v›w
:

1426 
£lf
.
gŒ“v›w
.
	$£t_cursÜ
(
·th
, 
cŞ
, 0)

1428 
def
 
	$add_·ge_to_sideb¬_nÙebook
(
£lf
, 
icÚ
, 
·ge
):

1430 
be
 
added
 
as
 
the
 
Ï¡
 
b
. 
Also
 
ÿu£s
h
bs
 
to
 be

1431 
shown
 
they
're‚ot.

1432 @
·¿m
 
icÚ
: 
a
 
Gtk
.
Image
 
piùu»
 
to
 
di¥Ïy
 
Ú
 
the
 
b


1433 @
·¿m
 
·ge
: 
Gtk
.
F¿me
-
ba£d
 
·Ãl
 
to
 
be
 
added


1435  
£lf
.
	$_add_·ge
(
£lf
.
sideb¬_nÙebook
, 
icÚ
, 
·ge
)

1437 
def
 
	$add_·ge_to_maš_nÙebook
(
£lf
, 
t™Ë
, 
·ge
):

1439 
wl
 
be
 
added
 
as
 
the
 
Ï¡
 
b
. 
Also
 
ÿu£s
h
bs
 
to
 be

1440 
shown
.

1441 @
·¿m
 
t™Ë
: 
ShÜt
 
‹xt
 
to
 
u£
 
the
 
b
 
Ïb–


1442 @
·¿m
 
·ge
: 
Gtk
.
F¿me
-
ba£d
 
·Ãl
 
to
 
be
 
added


1444  
£lf
.
	`_add_·ge
(£lf.
maš_nÙebook
, 
Gtk
.
	`Lab–
(
Ïb–
=
t™Ë
), 
·ge
)

1446 
def
 
	$add_·ge_to_acûssÜy_nÙebook
(
£lf
, 
t™Ë
, 
·ge
):

1448 
b
 
wl
 
be
 
added
 
as
 
the
 
Ï¡
ab. 
Also
 
ÿu£s
h
bs
 
to
 be

1449 
shown
.

1450 @
·¿m
 
t™Ë
: 
ShÜt
 
‹xt
 
to
 
u£
 
the
 
b
 
Ïb–


1451 @
·¿m
 
·ge
: 
Gtk
.
F¿me
-
ba£d
 
·Ãl
 
to
 
be
 
added


1453  
£lf
.
	`_add_·ge
(£lf.
acûssÜy_nÙebook
, 
Gtk
.
	`Lab–
(
Ïb–
=
t™Ë
),

1454 
·ge
)

1456 
def
 
	$»move_·ge_äom_sideb¬_nÙebook
(
£lf
, 
·ge
):

1458 
Úly
 
Úe
 
b
 
š
 
the
 
nÙebook
,hb 
£ËùÜ
 
wl
 
be
 
hidd’
.

1459 @
·¿m
 
·ge
: 
Gtk
.
F¿me
-
ba£d
 
·Ãl
 
to
 
be
 
»moved


1461  
£lf
.
	$_»move_·ge
(
£lf
.
sideb¬_nÙebook
, 
·ge
)

1463 
def
 
	$»move_·ge_äom_maš_nÙebook
(
£lf
, 
·ge
):

1465 
this
 
Ëaves
 
Úly
 
Úe
 
b
 
š
 
the
 
nÙebook
,hb 
£ËùÜ
 
wl


1466 
be
 
hidd’
.

1467 @
·¿m
 
·ge
: 
Gtk
.
F¿me
-
ba£d
 
·Ãl
 
to
 
be
 
»moved


1469  
£lf
.
	$_»move_·ge
(
£lf
.
maš_nÙebook
, 
·ge
)

1471 
def
 
	$»move_·ge_äom_acûssÜy_nÙebook
(
£lf
, 
·ge
):

1473 
If
 
this
 
Ëaves
 
Úly
 
Úe
 
b
 
š
 
the
 
nÙebook
,hb 
£ËùÜ


1474 
wl
 
be
 
hidd’
.

1475 @
·¿m
 
·ge
: 
Gtk
.
F¿me
-
ba£d
 
·Ãl
 
to
 
be
 
»moved


1477  
£lf
.
	$_»move_·ge
(
£lf
.
acûssÜy_nÙebook
, 
·ge
)

1479 
def
 
	$hide
(
£lf
):

1481 
£lf
.
brow£r_shown
 = 
F®£


1482 
£lf
.
wšdow
.
	$hide
()

1483 
GObjeù
.
	`idË_add
(
£lf
.
em™
, "visibility-toggled")

1485 
def
 
	$show
(
£lf
):

1487 
£lf
.
brow£r_shown
 = 
True


1488 #»d¿w 
the
 
GDK
 
wšdow
, 
bršgšg
 
™
 
to
 
äÚt


1489 
£lf
.
wšdow
.
	$show
()

1490 
£lf
.
wšdow
.
	$´e£Á
()

1491 
£lf
.
wšdow
.
	$g¿b_focus
()

1492 
£lf
.
quickadd_’Œy
.
	$g¿b_focus
()

1493 
GObjeù
.
	`idË_add
(
£lf
.
em™
, "visibility-toggled")

1495 
def
 
	$icÚify
(
£lf
):

1497 
£lf
.
wšdow
.
	$icÚify
()

1499 
def
 
	$is_visibË
(
£lf
):

1501  
£lf
.
wšdow
.
	`g‘_´İ”ty
("visible")

1503 
def
 
	$is_aùive
(
£lf
):

1505  
£lf
.
wšdow
.
	`g‘_´İ”ty
("is-active")

1507 
def
 
	$g‘_bud”
(
£lf
):

1508  
£lf
.
bud”


1510 
def
 
	$g‘_wšdow
(
£lf
):

1511  
£lf
.
wšdow


1513 
def
 
	$g‘_aùive_Œ“
(
£lf
):

1515 
R‘uºs
 
the
 
brow£r
 
Œ“
 
w™h
 
®l
h
f‹rs
 
­¶›d
. 
The
 
sks
 
š


1516 
the
 
Œ“
 
¬e
h
§me
 
as
h
Úes
 
shown
 
š
h
brow£r
 
cu¼’t
 
v›w


1518  
£lf
.
aùiv‘»e


1520 
def
 
	$g‘_şo£d_Œ“
(
£lf
):

1522 
R‘uºs
 
the
 
brow£r
 
Œ“
 
w™h
 
®l
h
f‹rs
 
­¶›d
. 
The
 
sks
 
š


1523 
the
 
Œ“
 
¬e
h
§me
 
as
h
Úes
 
shown
 
š
h
brow£r
 
cu¼’t
 
şo£d


1524 
v›w
.

1526  
£lf
.
	$__ü—‹_şo£d_Œ“
()

1528 
def
 
	$is_shown
(
£lf
):

1529  
£lf
.
brow£r_shown


1531 ## 
BACKENDS
 
RELATED
 
METHODS
 ##################################################

1532 
def
 
	$Ú_back’d_çed
(
£lf
, 
£nd”
, 
back’d_id
, 
”rÜ_code
):

1534 
SigÇl
 
ÿÎback
.

1535 
Wh’
 
a
 
back’d
 
çs
 
to
 
wÜk
, 
lßds
‡ 
Gtk
.
Infob¬
Ø
®”t
 
the
 
u£r


1537 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
Úly
 
h”e
 
sigÇl
 
com·tib™y


1538 @
·¿m
 
back’d_id
: 
the
 
id
 
of
h
çšg
 
back’d


1539 @
·¿m
 
”rÜ_code
: 
a
 
back’d
 
”rÜ
 
code
, 
as
 
¥ecif›d


1540 
š
 
Back’dsSigÇls


1542 
šfob¬
 = 
£lf
.
	$_Ãw_šfob¬
(
back’d_id
)

1543 
šfob¬
.
	$£t_”rÜ_code
(
”rÜ_code
)

1545 
def
 
	$Ú_back’d_Ãedšg_š‹¿ùiÚ
(
£lf
, 
£nd”
, 
back’d_id
, 
desütiÚ
,

1546 
š‹¿ùiÚ_ty³
, 
ÿÎback
):

1548 
SigÇl
 
ÿÎback
.

1549 
Wh’
 
a
 
back’d
 
Ãeds
 
some
 
kšd
 
of
 
ãedback
 
äom
 
the
 
u£r
,

1550 
lßds
 
a
 
Gtk
.
Infob¬
 
to
 
®”t
 
the
 
u£r
.

1551 
This
 
is
 
u£d
, 
exam¶e
, 
to
 
»que¡
 
cÚfœm©iÚ
 
aá”
 
auth’tiÿtšg


1552 
vŸ
 
OAuth
.

1554 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
Úly
 
h”e
 
sigÇl
 
com·tib™y


1555 @
·¿m
 
back’d_id
: 
the
 
id
 
of
h
çšg
 
back’d


1556 @
·¿m
 
desütiÚ
: 
a
 
¡ršg
 
desüibšg
 
the
 
š‹¿ùiÚ
 
Ãeded


1557 @
·¿m
 
š‹¿ùiÚ_ty³
: 
a
 
¡ršg
 
desüibšg
 
the
 
ty³
 
of
 
š‹¿ùiÚ


1558 (
yes
/
no
, 
Úly
 
cÚfœm
, 
ok
/
ÿnûl
...)

1559 @
·¿m
 
ÿÎback
: 
the
 
funùiÚ
 
to
 
ÿÎ
 
wh’
h
u£r
 
´ovides
he

1560 
ãedback


1562 
šfob¬
 = 
£lf
.
	$_Ãw_šfob¬
(
back’d_id
)

1563 
šfob¬
.
	$£t_š‹¿ùiÚ_»que¡
(
desütiÚ
, 
š‹¿ùiÚ_ty³
,

1564 
ÿÎback
)

1566 
def
 
	$__»move_back’d_šfob¬
(
£lf
, 
chd
, 
back’d_id
):

1568 
H–³r
 
funùiÚ
 
to
 
»move
 
ª
 
Gtk
.
Infob¬
 
»Ï‹d
Ø
a
 
back’d


1570 @
·¿m
 
chd
: 
a
 
Gtk
.
Infob¬


1571 @
·¿m
 
back’d_id
: 
the
 
id
 
of
h
back’d
 
which
 
Gtk
.
Infob¬
 
should
 
be


1572 
»moved
.

1574 
	$isš¡ªû
(
chd
, 
Cu¡omInfoB¬
è
ªd
\

1575 
chd
.
	`g‘_back’d_id
(è=ğ
back’d_id
:

1576 
£lf
.
vbox_toŞb¬s
:

1577 
£lf
.
vbox_toŞb¬s
.
	$»move
(
chd
)

1579 
def
 
	$»move_back’d_šfob¬
(
£lf
, 
£nd”
, 
back’d_id
):

1581 
SigÇl
 
ÿÎback
.

1582 
D–‘es
 
the
 
Gtk
.
Infob¬s
 
»Ï‹d
 
to
 
a
 
back’d


1584 @
·¿m
 
£nd”
: 
nÙ
 
u£d
, 
Úly
 
h”e
 
sigÇl
 
com·tib™y


1585 @
·¿m
 
back’d_id
: 
the
 
id
 
of
h
back’d
 
which
 
Gtk
.
Infob¬
 
should
 
be


1586 
»moved
.

1588 
back’d
 = 
£lf
.
»q
.
	$g‘_back’d
(
back’d_id
)

1589 
nÙ
 
back’d
 
	`Ü
 (back’d 
ªd
 back’d.
	$is_’abËd
()):

1590 #»mov
Şd
 
šfob¬
 
»Ï‹d
 
to
 
back’d_id
, 
ªy


1591 
£lf
.
vbox_toŞb¬s
:

1592 
£lf
.
vbox_toŞb¬s
.
	$fÜ—ch
(
£lf
.
__»move_back’d_šfob¬
,

1593 
back’d_id
)

1595 
def
 
	$_Ãw_šfob¬
(
£lf
, 
back’d_id
):

1597 
H–³r
 
funùiÚ
 
to
 
ü—‹
 
a
 
Ãw
 
šfob¬
 ¨
back’d


1599 @
·¿m
 
back’d_id
: 
the
 
back’d
 
which
 
we
're creatinghe infobar

1600 @
»tuºs
 
Gtk
.
Infob¬
: 
the
 
ü—‹d
 
šfob¬


1602 #»mov
Şd
 
šfob¬
 
»Ï‹d
 
to
 
back’d_id
, 
ªy


1603 
nÙ
 
£lf
.
vbox_toŞb¬s
:

1605 
£lf
.
vbox_toŞb¬s
.
	$fÜ—ch
(
£lf
.
__»move_back’d_šfob¬
, 
back’d_id
)

1606 #add 
a
 
Ãw
 
Úe


1607 
šfob¬
 = 
	$Cu¡omInfoB¬
(
£lf
.
»q
, s–f, s–f.
vmªag”
, 
back’d_id
)

1608 
£lf
.
vbox_toŞb¬s
.
	$·ck_¡¬t
(
šfob¬
, 
True
, True, 0)

1609  
šfob¬


1611 #### 
SEARCH
 
RELATED
 
STUFF
 #####################################################
 g‘_£Ëùed_£¬ch(£lf):

1613 
£lf
.
gŒ“v›w
:

1614 
gs
 = 
£lf
.
gŒ“v›w
.
	$g‘_£Ëùed_nodes
()

1615 
	`Ën
(
gs
) > 0:

1616 
g
 = 
£lf
.
gŒ“
.
	$g‘_node
(
gs
[0])

1617 
g
.
	$is_£¬ch_g
():

1618  
gs
[0]

1619  
NÚe


1621 
def
 
	$_š™_£¬ch_com¶‘iÚ
(
£lf
):

1623 
£lf
.
£¬ch_com¶‘iÚ
 = s–f.
bud”
.
	`g‘_objeù
(

1625 
£lf
.
quickadd_’Œy
.
	$£t_com¶‘iÚ
(
£lf
.
£¬ch_com¶‘iÚ
)

1627 
£lf
.
£¬ch_possibË_aùiÚs
 = {

1628 'add': 
	`_
("Add Task"),

1629 'İ’': 
	`_
("Open Task"),

1630 '£¬ch': 
	`_
("Search"),

1631 
	}
}

1633 
£lf
.
£¬ch_aùiÚs
 = []

1635 
£lf
.
£¬ch_com¶‘e_¡Üe
 = 
Gtk
.
	$Li¡StÜe
(
¡r
)

1636 
gÇme
 
š
 
£lf
.
»q
.
	$g‘_®l_gs
():

1637 #Úly 
»guÏr
 
gs


1638 
gÇme
.
	`¡¬tsw™h
("@"):

1639 
£lf
.
£¬ch_com¶‘e_¡Üe
.
	$­³nd
([
gÇme
])

1641 
commªd
 
š
 
SEARCH_COMMANDS
:

1642 
£lf
.
£¬ch_com¶‘e_¡Üe
.
	$­³nd
([
commªd
])

1644 
£lf
.
£¬ch_com¶‘iÚ
.
	$£t_mod–
(
£lf
.
£¬ch_com¶‘e_¡Üe
)

1645 
£lf
.
£¬ch_com¶‘iÚ
.
	$£t_‹xt_cŞumn
(0)

1647 
def
 
	$Ú_quickadd_chªged
(
£lf
, 
ed™abË
):

1649 #d–‘
Şd
 
aùiÚs


1650 
i
 
š
 
	`¿nge
(
	$Ën
(
£lf
.
£¬ch_aùiÚs
)):

1651 
£lf
.
£¬ch_com¶‘iÚ
.
	$d–‘e_aùiÚ
(0)

1653 
£lf
.
£¬ch_aùiÚs
 = []

1654 
Ãw_aùiÚs
 = []

1655 
qu”y
 = 
£lf
.
quickadd_’Œy
.
	$g‘_‹xt
()

1656 
qu”y
 = qu”y.
	$¡r
()

1658 #Ià
the
 
g
 
·Ã
 
is
 
hidd’
, 
»£t
 
£¬ch
 
f‹r
 
wh’
 
qu”y
 i 
em±y


1659 
qu”y
 =ğ'' 
ªd
 
nÙ
 
£lf
.
cÚfig
.
	`g‘
("tag_pane"):

1660 
Œ“
 = 
£lf
.
»q
.
	$g‘_sks_Œ“
(
»äesh
=
F®£
)

1661 
f‹rs
 = 
Œ“
.
	$li¡_­¶›d_f‹rs
()

1662 
g_id
 
š
 
£lf
.
»q
.
	$g‘_®l_gs
():

1663 
g
 = 
£lf
.
»q
.
	$g‘_g
(
g_id
)

1664 
g
.
	$is_£¬ch_g
(è
ªd
 
g_id
 
š
 
f‹rs
:

1665 
£lf
.
»q
.
	$»move_g
(
g_id
)

1666 
£lf
.
	$­¶y_f‹r_Ú_·Ãs
(
CÜeCÚfig
.
ALLTASKS_TAG
)

1669 
qu”y
:

1670 
£lf
.
»q
.
	$g‘_sk_id
(
qu”y
è
is
 
nÙ
 
NÚe
:

1671 
Ãw_aùiÚs
.
	`­³nd
('open')

1673 
Ãw_aùiÚs
.
	`­³nd
('add')

1675 #I 
qu”y
 
·r§bË
?

1676 
Œy
:

1677 
	$·r£_£¬ch_qu”y
(
qu”y
)

1678 
Ãw_aùiÚs
.
	`­³nd
('search')

1679 
exû±
 
Inv®idQu”y
:

1680 
·ss


1682 #Add 
Ãw
 
Üd”
 
of
 
aùiÚs


1683 
aid
, 
Çme
 
š
 
	$’um”©e
(
Ãw_aùiÚs
):

1684 
aùiÚ
 = 
£lf
.
£¬ch_possibË_aùiÚs
[
Çme
]

1685 
£lf
.
£¬ch_com¶‘iÚ
.
	$š£¹_aùiÚ_m¬kup
(
aid
, 
aùiÚ
)

1686 
£lf
.
£¬ch_aùiÚs
.
	$­³nd
(
Çme
)

1688 
Œ“
 = 
£lf
.
»q
.
	$g‘_sks_Œ“
(
»äesh
=
F®£
)

1689 
f‹rs
 = 
Œ“
.
	$li¡_­¶›d_f‹rs
()

1690 
g_id
 
š
 
£lf
.
»q
.
	$g‘_®l_gs
():

1691 
g
 = 
£lf
.
»q
.
	$g‘_g
(
g_id
)

1692 
g
.
	$is_£¬ch_g
(è
ªd
 
g_id
 
š
 
f‹rs
:

1693 
£lf
.
»q
.
	$»move_g
(
g_id
)

1694 
£lf
.
	$­¶y_f‹r_Ú_·Ãs
(
CÜeCÚfig
.
ALLTASKS_TAG
)

1696 
def
 
	$ex·nd_£¬ch_g
(
£lf
):

1698 
™
 
mu¡
 
be
 
dÚe
 
mªu®ly
 """

1699 
£lf
.
gŒ“v›w
 
is
 
nÙ
 
NÚe
:

1700 
mod–
 = 
£lf
.
gŒ“v›w
.
	$g‘_mod–
()

1701 
£¬ch_™”
 = 
mod–
.
	`my_g‘_™”
((
CÜeCÚfig
.
SEARCH_TAG
, ))

1702 
£¬ch_·th
 = 
mod–
.
	$g‘_·th
(
£¬ch_™”
)

1703 
£lf
.
gŒ“v›w
.
	$ex·nd_row
(
£¬ch_·th
, 
F®£
)

1705 
def
 
	$Ú_’Œycom¶‘iÚ_aùiÚ_aùiv©ed
(
£lf
, 
com¶‘iÚ
, 
šdex
):

1707 
aùiÚ
 = 
£lf
.
£¬ch_aùiÚs
[
šdex
]

1708 
aùiÚ
 == 'add':

1709 
£lf
.
	$Ú_quickadd_aùiv©e
(
NÚe
)

1710 
–if
 
aùiÚ
 == 'open':

1711 
sk_t™Ë
 = 
£lf
.
quickadd_’Œy
.
	$g‘_‹xt
()

1712 
sk_id
 = 
£lf
.
»q
.
	$g‘_sk_id
(
sk_t™Ë
)

1713 
£lf
.
vmªag”
.
	$İ’_sk
(
sk_id
)

1714 
£lf
.
quickadd_’Œy
.
	`£t_‹xt
('')

1715 
–if
 
aùiÚ
 == 'search':

1716 
qu”y
 = 
£lf
.
quickadd_’Œy
.
	$g‘_‹xt
()

1717 #! 
©
 
the
 
begšnšg
 
is
 
»£rved
 
keywÜd
 
libÏrch


1718 
qu”y
.
	`¡¬tsw™h
('!'):

1719 
Ïb–
 = '_' + 
qu”y


1721 
Ïb–
 = 
qu”y


1723 #fšd 
possibË
 
Çme
 
cŞlisiÚs


1724 
Çme
, 
numb”
 = 
Ïb–
, 1

1725 
®»ady_£¬ch
 = 
F®£


1726 
True
:

1727 
g
 = 
£lf
.
»q
.
	$g‘_g
(
Çme
)

1728 
g
 
is
 
NÚe
:

1731 
g
.
	$is_£¬ch_g
(è
ªd
 
g
.
	`g‘_©Œibu‹
("qu”y"è=ğ
qu”y
:

1732 
®»ady_£¬ch
 = 
True


1735 #thi 
Çme
 
is
 
u£d
, 
addšg
 
numb”


1736 
numb”
 += 1

1737 
Çme
 = 
Ïb–
 + ' ' + 
	$¡r
(
numb”
)

1739 
nÙ
 
®»ady_£¬ch
:

1740 
g
 = 
£lf
.
»q
.
	$Ãw_£¬ch_g
(
Çme
, 
qu”y
)

1742 #Aµly 
Ãw
 
£¬ch
 
right
 
now


1743 
£lf
.
gŒ“v›w
 
is
 
nÙ
 
NÚe
:

1744 #S–eù 
Ãw
 
£¬ch
 
š
 
gsideb¬
 
ªd
 
­¶y
 
™


1746 #Mak
su»
 
£¬ch
 
g
 
·»Á
 
is
 
ex·nded


1747 #(
Ùh”wi£
 
£ËùiÚ
 
dÛs
 
nÙ
 
wÜk
)

1748 
£lf
.
	$ex·nd_£¬ch_g
()

1750 #G‘ 
™”©Ü
 
Ãw
 
£¬ch
 
g


1751 
mod–
 = 
£lf
.
gŒ“v›w
.
	$g‘_mod–
()

1752 
·th
 = 
£lf
.
gŒ“
.
	`g‘_·ths_fÜ_node
(
g
.
	`g‘_id
())[0]

1753 
g_™”
 = 
mod–
.
	$my_g‘_™”
(
·th
)

1755 #S–eù 
Úly
 
™
 
ªd
 
­¶y
 
f‹rs
 
Ú
 
tİ
 
of
 
th©


1756 
£ËùiÚ
 = 
£lf
.
gŒ“v›w
.
	$g‘_£ËùiÚ
()

1757 
£ËùiÚ
.
	$un£Ëù_®l
()

1758 
£ËùiÚ
.
	$£Ëù_™”
(
g_™”
)

1759 
£lf
.
	$Ú_£Ëù_g
()

1761 
£lf
.
	`­¶y_f‹r_Ú_·Ãs
(
Çme
)

	@gtk/browser/custominfobar.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


18 
impÜt
 
th»adšg


20 
äom
 
GTG
 
impÜt
 
_


21 
äom
 
	gGTG
.
	gback’ds
.
back’dsigÇls
 
impÜt
 
Back’dSigÇls


22 
äom
 
	gGTG
.
	gtoŞs
.
ÃtwÜkmªag”
 
impÜt
 
is_cÚÃùiÚ_up


25 
şass
 
	$Cu¡omInfoB¬
(
Gtk
.
InfoB¬
):

27 
A
 
Gtk
.
InfoB¬
 
¥ecŸlized
 
di¥Ïyšg
 
”rÜs
 
ªd
 
»que¡s
 

28 
š‹¿ùiÚ
 
comšg
 
äom
 
the
 
back’ds


31 
AUTHENTICATION_MESSAGE
 = 
	`_
("The <b>%s</b> synchronization service cannot "

36 
NETWORK_MESSAGE
 = 
	`_
("Dueo‡‚etwork…roblem, I cannot contact "

39 
DBUS_MESSAGE
 = 
	`_
("Cannot connecto DBus, I've disabled "

42 
def
 
	$__š™__
(
£lf
, 
»q
, 
brow£r
, 
vmªag”
, 
back’d_id
):

44 
CÚ¡ruùÜ
, 
P»·»s
 
the
 
šfob¬
.

46 @
·¿m
 
»q
: 
a
 
Reque¡”
 
objeù


47 @
·¿m
 
brow£r
: 
a
 
TaskBrow£r
 
objeù


48 @
·¿m
 
vmªag”
: 
a
 
V›wMªag”
 
objeù


49 @
·¿m
 
back’d_id
: 
the
 
id
 
of
h
back’d
 
lšked
 
to
h
šfob¬


51 
	`su³r
(
Cu¡omInfoB¬
, 
£lf
).
	$__š™__
()

52 
£lf
.
»q
 =„eq

53 
£lf
.
brow£r
 = browser

54 
£lf
.
vmªag”
 = vmanager

55 
£lf
.
back’d_id
 = backend_id

56 
£lf
.
back’d
 = s–f.
»q
.
	$g‘_back’d
(
back’d_id
)

58 
def
 
	$g‘_back’d_id
(
£lf
):

60 
G‘‹r
 
funùiÚ
 
to
  
the
 
id
 
of
h
back’d
 
which
 
this


61 
Gtk
.
InfoB¬
 
was
 
ü—‹d


63  
£lf
.
back’d_id


65 
def
 
	$_pİuÏ‹
(
£lf
):

67 
cÚ‹Á_box
 = 
£lf
.
	$g‘_cÚ‹Á_¬—
()

68 
cÚ‹Á_box
.
	$£t_homog’eous
(
F®£
)

69 
£lf
.
Ïb–
 = 
Gtk
.
	$Lab–
()

70 
£lf
.
Ïb–
.
	$£t_lše_w¿p
(
True
)

71 
£lf
.
Ïb–
.
	$£t_®ignm’t
(0.5, 0.5)

72 
£lf
.
Ïb–
.
	$£t_ju¡ify
(
Gtk
.
Ju¡ifiÿtiÚ
.
FILL
)

73 
cÚ‹Á_box
.
	$·ck_¡¬t
(
£lf
.
Ïb–
, 
True
, True, 0)

75 
def
 
	$_Ú_”rÜ_»¥Ú£
(
£lf
, 
widg‘
, 
ev’t
):

77 
SigÇl
 
ÿÎback
 
execu‹d
 
wh’
 
the
 
u£r
 
acknowËdges
h
”rÜ
 
di¥Ïyed


78 
š
 
the
 
šfob¬


80 @
·¿m
 
widg‘
: 
nÙ
 
u£d
, 
h”e
 
com·tib™y
 
w™h
 
sigÇls
 
ÿÎbacks


81 @
·¿m
 
ev’t
: 
the
 
code
 
of
h
gtk
 
»¥Ú£


83 
£lf
.
	$hide
()

84 
ev’t
 =ğ
Gtk
.
Re¥Ú£Ty³
.
ACCEPT
:

85 
£lf
.
vmªag”
.
	$cÚfigu»_back’d
(
back’d_id
=
£lf
.backend_id)

87 
def
 
	$£t_”rÜ_code
(
£lf
, 
”rÜ_code
):

89 
S‘s
 
this
 
šfob¬
 
to
 
show
 
ª
 
”rÜ
Ø
the
 
u£r


91 @
·¿m
 
”rÜ_code
: 
the
 
code
 
of
h
”rÜ
 
to
 
show
. 
E¼Ü
 
codes
 
¬e


92 
li¡ed
 
š
 
Back’dSigÇls


94 
£lf
.
	$_pİuÏ‹
()

95 
£lf
.
	`cÚÃù
("»¥Ú£", s–f.
_Ú_”rÜ_»¥Ú£
)

96 
back’d_Çme
 = 
£lf
.
back’d
.
	$g‘_humª_Çme
()

98 
”rÜ_code
 =ğ
Back’dSigÇls
.
ERRNO_AUTHENTICATION
:

99 
£lf
.
	$£t_mes§ge_ty³
(
Gtk
.
Mes§geTy³
.
ERROR
)

100 
£lf
.
Ïb–
.
	`£t_m¬kup
(£lf.
AUTHENTICATION_MESSAGE
 % 
back’d_Çme
)

101 
£lf
.
	`add_bu‰Ú
(
	`_
('Configure synchronization service'),

102 
Gtk
.
Re¥Ú£Ty³
.
ACCEPT
)

103 
£lf
.
	`add_bu‰Ú
(
	`_
('IgnÜe'), 
Gtk
.
Re¥Ú£Ty³
.
CLOSE
)

105 
–if
 
”rÜ_code
 =ğ
Back’dSigÇls
.
ERRNO_NETWORK
:

106 
nÙ
 
	$is_cÚÃùiÚ_up
():

108 
£lf
.
	$£t_mes§ge_ty³
(
Gtk
.
Mes§geTy³
.
WARNING
)

109 
£lf
.
Ïb–
.
	`£t_m¬kup
(£lf.
NETWORK_MESSAGE
 % 
back’d_Çme
)

110 #FIXME: 
u£
 
gtk
 
¡ock
 
bu‰Ú
 
š¡—d


111 
£lf
.
	`add_bu‰Ú
(
	`_
('Ok'), 
Gtk
.
Re¥Ú£Ty³
.
CLOSE
)

113 
–if
 
”rÜ_code
 =ğ
Back’dSigÇls
.
ERRNO_DBUS
:

114 
£lf
.
	$£t_mes§ge_ty³
(
Gtk
.
Mes§geTy³
.
WARNING
)

115 
£lf
.
Ïb–
.
	`£t_m¬kup
(£lf.
DBUS_MESSAGE
 % 
back’d_Çme
)

116 
£lf
.
	`add_bu‰Ú
(
	`_
('Ok'), 
Gtk
.
Re¥Ú£Ty³
.
CLOSE
)

118 
£lf
.
	$show_®l
()

120 
def
 
	$£t_š‹¿ùiÚ_»que¡
(
£lf
, 
desütiÚ
, 
š‹¿ùiÚ_ty³
, 
ÿÎback
):

122 
S‘s
 
this
 
šfob¬
 
to
 
»que¡
 
ª
 
š‹¿ùiÚ
 
äom
 
the
 
u£r


124 @
·¿m
 
desütiÚ
: 
a
 
¡ršg
 
desüibšg
 
the
 
š‹¿ùiÚ
 
Ãeded


125 @
·¿m
 
š‹¿ùiÚ_ty³
: 
a
 
¡ršg
 
desüibšg
 
the
 
ty³
 
of
 
š‹¿ùiÚ


126 (
yes
/
no
, 
Úly
 
cÚfœm
, 
ok
/
ÿnûl
...)

127 @
·¿m
 
ÿÎback
: 
the
 
funùiÚ
 
to
 
ÿÎ
 
wh’
h
u£r
 
´ovides
he

128 
ãedback


130 
£lf
.
	$_pİuÏ‹
()

131 
£lf
.
ÿÎback
 = callback

132 
£lf
.
	$£t_mes§ge_ty³
(
Gtk
.
Mes§geTy³
.
INFO
)

133 
£lf
.
Ïb–
.
	$£t_m¬kup
(
desütiÚ
)

134 
£lf
.
	`cÚÃù
("»¥Ú£", s–f.
_Ú_š‹¿ùiÚ_»¥Ú£
)

135 
£lf
.
š‹¿ùiÚ_ty³
 = interaction_type

136 
š‹¿ùiÚ_ty³
 =ğ
	`Back’dSigÇls
().
INTERACTION_CONFIRM
:

137 
£lf
.
	`add_bu‰Ú
(
	`_
('CÚfœm'), 
Gtk
.
Re¥Ú£Ty³
.
ACCEPT
)

138 
–if
 
š‹¿ùiÚ_ty³
 =ğ
	`Back’dSigÇls
().
INTERACTION_TEXT
:

139 
£lf
.
	`add_bu‰Ú
(
	`_
('CÚtšue'), 
Gtk
.
Re¥Ú£Ty³
.
ACCEPT
)

140 
–if
 
š‹¿ùiÚ_ty³
 =ğ
	`Back’dSigÇls
().
INTERACTION_INFORM
:

141 
£lf
.
	`add_bu‰Ú
(
	`_
('OK'), 
Gtk
.
Re¥Ú£Ty³
.
ACCEPT
)

142 
£lf
.
	$show_®l
()

144 
def
 
	$_Ú_š‹¿ùiÚ_»¥Ú£
(
£lf
, 
widg‘
, 
ev’t
):

146 
SigÇl
 
ÿÎback
 
execu‹d
 
wh’
 
the
 
u£r
 
gives
h
ãedback
 
a


147 
»que¡ed
 
š‹¿ùiÚ


149 @
·¿m
 
widg‘
: 
nÙ
 
u£d
, 
h”e
 
com·tib™y
 
w™h
 
sigÇls
 
ÿÎbacks


150 @
·¿m
 
ev’t
: 
the
 
code
 
of
h
gtk
 
»¥Ú£


152 
ev’t
 =ğ
Gtk
.
Re¥Ú£Ty³
.
ACCEPT
:

153 
£lf
.
š‹¿ùiÚ_ty³
 =ğ
	`Back’dSigÇls
().
INTERACTION_TEXT
:

154 
£lf
.
	$_´•¬e_‹xtu®_š‹¿ùiÚ
()

155 
–if
 
£lf
.
š‹¿ùiÚ_ty³
 =ğ
	`Back’dSigÇls
().
INTERACTION_CONFIRM
:

156 
£lf
.
	$hide
()

157 
th»adšg
.
	`Th»ad
(
rg‘
=
	`g‘©Œ
(
£lf
.
back’d
,

158 
£lf
.
ÿÎback
)).
	$¡¬t
()

160 
£lf
.
	$hide
()

162 
def
 
	$_´•¬e_‹xtu®_š‹¿ùiÚ
(
£lf
):

164 
H–³r
 
funùiÚ
. 
gtk
 
ÿÎs
 
to
 
pİuÏ‹
 
the
 
šfob¬
 
š
h
of


165 
š‹¿ùiÚ
 
»que¡


167 
t™Ë
, 
desütiÚ
\

168 ğ
	`g‘©Œ
(
£lf
.
back’d
,

169 
£lf
.
ÿÎback
)("get_ui_dialog_text")

170 
£lf
.
dŸlog
 = 
Gtk
.
	$Wšdow
(è#ty³ = 
Gtk
.
WšdowTy³
.
POPUP


171 
£lf
.
dŸlog
.
	$£t_t™Ë
(
t™Ë
)

172 
£lf
.
dŸlog
.
	$£t_Œªs›Á_fÜ
(
£lf
.
brow£r
.
wšdow
)

173 
£lf
.
dŸlog
.
	$£t_de¡roy_w™h_·»Á
(
True
)

174 
£lf
.
dŸlog
.
	$£t_pos™iÚ
(
Gtk
.
WšdowPos™iÚ
.
CENTER_ON_PARENT
)

175 
£lf
.
dŸlog
.
	$£t_mod®
(
True
)

176 #£lf.
dŸlog
.
	`£t_size_»que¡
(300,170)

177 
vbox
 = 
Gtk
.
	$Box
(
Ü›Á©iÚ
=
Gtk
.
Or›Á©iÚ
.
VERTICAL
)

178 
£lf
.
dŸlog
.
	$add
(
vbox
)

179 
desütiÚ_Ïb–
 = 
Gtk
.
	$Lab–
()

180 
desütiÚ_Ïb–
.
	$£t_ju¡ify
(
Gtk
.
Ju¡ifiÿtiÚ
.
FILL
)

181 
desütiÚ_Ïb–
.
	$£t_lše_w¿p
(
True
)

182 
desütiÚ_Ïb–
.
	$£t_m¬kup
(
desütiÚ
)

183 
®ign
 = 
Gtk
.
Alignm’t
.
	$Ãw
(0.5, 0.5, 1, 1)

184 
®ign
.
	$£t_·ddšg
(10, 0, 20, 20)

185 
®ign
.
	$add
(
desütiÚ_Ïb–
)

186 
vbox
.
	$·ck_¡¬t
(
®ign
, 
True
, True, 0)

187 
£lf
.
‹xt_box
 = 
Gtk
.
	$EÁry
()

188 
£lf
.
‹xt_box
.
	`£t_size_»que¡
(-1, 40)

189 
®ign
 = 
Gtk
.
Alignm’t
.
	$Ãw
(0.5, 0.5, 1, 1)

190 
®ign
.
	$£t_·ddšg
(20, 20, 20, 20)

191 
®ign
.
	$add
(
£lf
.
‹xt_box
)

192 
vbox
.
	$·ck_¡¬t
(
®ign
, 
True
, True, 0)

193 
bu‰Ú
 = 
Gtk
.
	$Bu‰Ú
(
¡ock
=
Gtk
.
STOCK_OK
)

194 
bu‰Ú
.
	`cÚÃù
("şicked", 
£lf
.
_Ú_‹xt_cÚfœmed
)

195 
bu‰Ú
.
	`£t_size_»que¡
(-1, 40)

196 
vbox
.
	$·ck_¡¬t
(
bu‰Ú
, 
F®£
, 
True
, 0)

197 
£lf
.
dŸlog
.
	$show_®l
()

198 
£lf
.
	$hide
()

200 
def
 
	$_Ú_‹xt_cÚfœmed
(
£lf
, 
widg‘
):

202 
SigÇl
 
ÿÎback
, 
u£d
 
wh’
 
the
 
š‹¿ùiÚ
 
Ãeds
 
a
 
‹xtu®
 
šput
 
to
 
be


203 
	`com¶‘ed
 (
e
.
g
, 
the
 
tw™‹r
 
OAuth
, 
»que¡šg
 
a
 
pš
)

205 @
·¿m
 
widg‘
: 
nÙ
 
u£d
, 
h”e
 
sigÇl
 
ÿÎback
 
com·tib™y


207 
‹xt
 = 
£lf
.
‹xt_box
.
	$g‘_‹xt
()

208 
£lf
.
dŸlog
.
	$de¡roy
()

209 
th»adšg
.
	`Th»ad
(
rg‘
=
	`g‘©Œ
(
£lf
.
back’d
, s–f.
ÿÎback
),

210 
¬gs
=("£t_‹xt", 
‹xt
)).
	`¡¬t
()

	@gtk/browser/modifytags_dialog.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


20 
äom
 
GTG
 
impÜt
 
_


21 
äom
 
	gGTG
.
	ggtk
.
brow£r
 
impÜt
 
GnomeCÚfig


22 
äom
 
	gGTG
.
	gtoŞs
.
gs
 
impÜt
 
·r£_g_li¡


25 
şass
 
	$ModifyTagsDŸlog
(
objeù
):

27 
DŸlog
 
b©ch
 
addšg
/
»mov®
 
of
 
gs


30 
def
 
	$__š™__
(
£lf
, 
g_com¶‘iÚ
, 
»q
):

31 
£lf
.
»q
 =„eq

32 
£lf
.
sks
 = []

34 
£lf
.
	$_š™_dŸlog
()

35 
£lf
.
g_’Œy
.
	$£t_com¶‘iÚ
(
g_com¶‘iÚ
)

37 #Remb” 
v®ues
 
äom
 
Ï¡
 
time


38 
£lf
.
Ï¡_g_’Œy
 = 
	`_
("NewTag")

39 
£lf
.
Ï¡_­¶y_to_subsks
 = 
F®£


41 
def
 
	$_š™_dŸlog
(
£lf
):

43 
bud”
 = 
Gtk
.
	$Bud”
()

44 
bud”
.
	$add_äom_fe
(
GnomeCÚfig
.
MODIFYTAGS_UI_FILE
)

45 
bud”
.
	`cÚÃù_sigÇls
({

47 
£lf
.
Ú_cÚfœm
,

49 
Ïmbda
 
dŸlog
: dŸlog.
hide
,

50 
	}
})

52 
£lf
.
g_’Œy
 = 
bud”
.
g‘_objeù
("tag_entry")

53 
£lf
.
­¶y_to_subsks
 = 
bud”
.
g‘_objeù
("apply_to_subtasks")

54 
£lf
.
dŸlog
 = 
bud”
.
g‘_objeù
("modifytags_dialog")

56 
def
 
	$modify_gs
(
£lf
, 
sks
):

58 
	`Ën
(
sks
) == 0:

61 
£lf
.
sks
 =asks

63 
£lf
.
g_’Œy
.
	$£t_‹xt
(
£lf
.
Ï¡_g_’Œy
)

64 
£lf
.
g_’Œy
.
	$g¿b_focus
()

65 
£lf
.
­¶y_to_subsks
.
	$£t_aùive
(
£lf
.
Ï¡_­¶y_to_subsks
)

67 
£lf
.
dŸlog
.
	$run
()

68 
£lf
.
dŸlog
.
	$hide
()

70 
£lf
.
sks
 = []

72 
def
 
	$Ú_cÚfœm
(
£lf
, 
widg‘
):

74 
gs
 = 
	`·r£_g_li¡
(
£lf
.
g_’Œy
.
	$g‘_‹xt
())

76 #Ià
the
 
checkbox
 
is
 
checked
, 
fšd
 
®l
 
subsks


77 
£lf
.
­¶y_to_subsks
.
	$g‘_aùive
():

78 
sk_id
 
š
 
£lf
.
sks
:

79 
sk
 = 
£lf
.
»q
.
	$g‘_sk
(
sk_id
)

80 #FIXME: 
PythÚ
 
nÙ
 
»š™Ÿlize
 
the
  
v®ue
 
of
 
™s


81 #·¿m‘” 
th”efÜe
 
™
 
mu¡
 
be
 
dÚe
 
mªu®ly
. 
This
 
funùiÚ


82 #should 
be
 
»äaùÜed
 #a 
çr
 
™
 
is
 
m¬ked
 
as
 
d•riÿ‹d


83 
subsk
 
š
 
sk
.
	$g‘_£lf_ªd_®l_subsks
(
sks
=[]):

84 
subsk_id
 = 
subsk
.
	$g‘_id
()

85 
subsk_id
 
nÙ
 
š
 
£lf
.
sks
:

86 
£lf
.
sks
.
	$­³nd
(
subsk_id
)

88 
sk_id
 
š
 
£lf
.
sks
:

89 
sk
 = 
£lf
.
»q
.
	$g‘_sk
(
sk_id
)

90 
g
, 
is_pos™ive
 
š
 
gs
:

91 
is_pos™ive
:

92 
sk
.
	$add_g
(
g
)

94 
sk
.
	$»move_g
(
g
)

95 
sk
.
	$sync
()

97 #Remb” 
the
 
Ï¡
 
aùiÚs


98 
£lf
.
Ï¡_g_’Œy
 = s–f.
g_’Œy
.
	$g‘_‹xt
()

99 
£lf
.
Ï¡_­¶y_to_subsks
 = s–f.
­¶y_to_subsks
.
	$g‘_aùive
()

	@gtk/browser/simple_color_selector.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
	gsim¶e_cŞÜ_£ËùÜ
: 
a
 
moduË
 
defššg
‡ 
widg‘
 
®lowšg
 
to
 
pick
‡ 
cŞÜ


19 
äom
 
a
 
·Ë‰e
. 
The
 
widg‘
 
®so
 
®lows
 
to
 
defše
 
ªd
 
add
 
Ãw
 
cŞÜs
.

22 
äom
 
gi
.
»pos™Üy
 
impÜt
 
GObjeù
, 
	gGtk
, 
Gdk


24 
impÜt
 
m©h


26 
äom
 
GTG
 
impÜt
 
_


28 
	gDEFAULT_PALETTE
 = [

37 
	gBUTTON_WIDTH
 = 36

38 
BUTTON_HEIGHT
 = 24

41 
şass
 
	$Sim¶eCŞÜS–eùÜP®‘‹I‹m
(
Gtk
.
D¿wšgA»a
):

44 
def
 
	$__š™__
(
£lf
, 
cŞÜ
=
NÚe
):

45 
Gtk
.
D¿wšgA»a
.
	$__š™__
(
£lf
)

46 
£lf
.
cŞÜ
 = color

47 
£lf
.
£Ëùed
 = 
F®£


48 
£lf
.
	$add_ev’ts
(
Gdk
.
Ev’tMask
.
BUTTON_PRESS_MASK
)

49 #CÚÃù 
ÿÎbacks


51 #£lf.
	`cÚÃù
("expo£-ev’t", 
£lf
.
Ú_expo£
)

52 
£lf
.
	`cÚÃù
("d¿w", s–f.
Ú_expo£
)

53 
£lf
.
	`cÚÃù
("cÚfigu»_ev’t", s–f.
Ú_cÚfigu»
)

55 
def
 
	$__d¿w
(
£lf
, 
ü
):

57 
®loc
 = 
£lf
.
	$g‘_®loÿtiÚ
()

58 #FIXME - 
why
 
to
 
u£
 
a
 
¥ecŸl
 
v¬ŸbËs
?

59 
®loc_w
, 
®loc_h
 = 
®loc
.
width
,‡Îoc.
height


60 #D¿wšg 
cÚ‹xt


61 #ü_ùxˆğ
Gdk
.
	`ÿœo_ü—‹
(
£lf
.
wšdow
è#pylšt: 
di§bË
-
msg
=
E1101


62 #gdkcÚ‹xˆğ
Gdk
.
	`CaœoCÚ‹xt
(
ü_ùxt
)

64 
gdkcÚ‹xt
 = 
ü


66 #D¿w 
»ùªgË


67 
£lf
.
cŞÜ
 
is
 
nÙ
 
NÚe
:

68 
my_cŞÜ
 = 
Gdk
.
	$cŞÜ_·r£
(
£lf
.
cŞÜ
)

69 
Gdk
.
	$ÿœo_£t_sourû_cŞÜ
(
gdkcÚ‹xt
, 
my_cŞÜ
)

71 
Gdk
.
	`ÿœo_£t_sourû_rgba
(
gdkcÚ‹xt
, Gdk.
	$RGBA
(0, 0, 0, 0))

72 
gdkcÚ‹xt
.
	$»ùªgË
(0, 0, 
®loc_w
, 
®loc_h
)

73 
gdkcÚ‹xt
.
	$fl
()

75 #Ou‹¸
lše


76 
Gdk
.
	`ÿœo_£t_sourû_rgba
(
gdkcÚ‹xt
, Gdk.
	$RGBA
(0, 0, 0, 0.30))

77 
gdkcÚ‹xt
.
	$£t_lše_width
(2.0)

78 
gdkcÚ‹xt
.
	$»ùªgË
(0, 0, 
®loc_w
, 
®loc_h
)

79 
gdkcÚ‹xt
.
	$¡roke
()

81 #Ià
£Ëùed
 
d¿w
 
a
 
symbŞ


82 if(
£lf
.
£Ëùed
):

83 
size
 = 
®loc_h
 * 0.50 - 3

84 
pos_x
 = 
m©h
.
	`æoÜ
((
®loc_w
 - 
size
) / 2)

85 
pos_y
 = 
m©h
.
	`æoÜ
((
®loc_h
 - 
size
) / 2)

86 
Gdk
.
	`ÿœo_£t_sourû_rgba
(
gdkcÚ‹xt
,

87 
Gdk
.
	$RGBA
(255, 255, 255, 0.80))

88 
gdkcÚ‹xt
.
	`¬c
(

89 
®loc_w
 / 2, 
®loc_h
 / 2, 
size
 / 2 + 3, 0, 2 * 
m©h
.
pi
)

90 
gdkcÚ‹xt
.
	$fl
()

91 
gdkcÚ‹xt
.
	$£t_lše_width
(1.0)

92 
Gdk
.
	`ÿœo_£t_sourû_rgba
(
gdkcÚ‹xt
, Gdk.
	$RGBA
(0, 0, 0, 0.20))

93 
gdkcÚ‹xt
.
	`¬c
(

94 
®loc_w
 / 2, 
®loc_h
 / 2, 
size
 / 2 + 3, 0, 2 * 
m©h
.
pi
)

95 
gdkcÚ‹xt
.
	$¡roke
()

96 
Gdk
.
	`ÿœo_£t_sourû_rgba
(
gdkcÚ‹xt
, Gdk.
	$RGBA
(0, 0, 0, 0.50))

97 
gdkcÚ‹xt
.
	$£t_lše_width
(3.0)

98 
gdkcÚ‹xt
.
	`move_to
(
pos_x
, 
pos_y
 + 
size
 / 2)

99 
gdkcÚ‹xt
.
	`lše_to
(
pos_x
 + 
size
 / 2, 
pos_y
 + size)

100 
gdkcÚ‹xt
.
	`lše_to
(
pos_x
 + 
size
, 
pos_y
)

101 
gdkcÚ‹xt
.
	$¡roke
()

103 ###ÿÎback ###
 on_expo£(£lf, widg‘, cr):

105 
£lf
.
	$__d¿w
(
ü
)

107 
def
 
	$Ú_cÚfigu»
(
£lf
, 
widg‘
, 
·¿ms
):

109 #FIXME - 
missšg
 
ÿœo
 
cÚ‹xt


110 #£lf.
	`__d¿w
(
ü
)

112 ###PUBLIC 
IF
 ###
 s‘_cŞÜ(£lf, cŞÜ):

114 
£lf
.
cŞÜ
 = color

116 
def
 
	$£t_£Ëùed
(
£lf
, 
£l
):

118 
£lf
.
£Ëùed
 = 
£l


119 
£lf
.
	$queue_d¿w
()

121 
def
 
	$g‘_£Ëùed
(
£lf
):

123  
£lf
.
£Ëùed


126 
şass
 
	$Sim¶eCŞÜS–eùÜ
(
Gtk
.
Box
):

128 
to
 
defše
 
Ãw
 
cŞÜs
."""

130 
def
 
	$__š™__
(
£lf
, 
width
=9, 
cŞÜs
=
NÚe
, 
cu¡om_cŞÜs
=None):

131 
Gtk
.
Box
.
	$__š™__
(
£lf
, 
Ü›Á©iÚ
=
Gtk
.
Or›Á©iÚ
.
VERTICAL
)

132 
£lf
.
width
 = width

133 #widg‘ 
mod–


134 
cŞÜs
 
is
 
NÚe
:

135 
£lf
.
cŞÜs
 = 
DEFAULT_PALETTE


137 
£lf
.
cŞÜs
 = colors

138 
cu¡om_cŞÜs
 
is
 
NÚe
:

139 
£lf
.
cu¡om_cŞÜs
 = []

141 
£lf
.
cu¡om_cŞÜs
 = custom_colors

142 
£lf
.
bu‰Ús
 = []

143 
£lf
.
cc_bu‰Ús
 = []

144 
£lf
.
bu‰Ús_lookup
 = {
	}
}

145 
£lf
.
£Ëùed_cŞ
 = 
NÚe


146 #Bud 
up
 
the
 
widg‘


147 
£lf
.
·Ë‰e
 = 
NÚe


148 
£lf
.
cu¡om_·Ë‰e
 = 
NÚe


149 
£lf
.
	$__bud_·Ë‰e
()

150 
£lf
.
	$__bud_cu¡om_·Ë‰e
()

151 #Show 
tİËv–


152 
£lf
.
	$show
()

154 
def
 
	$__»£t_·Ë‰e
(
£lf
):

156 
£lf
.
·Ë‰e
 
is
 
nÙ
 
NÚe
:

157 
£lf
.
£Ëùed_cŞ
 
is
 
nÙ
 
NÚe
 
ªd
 \

158 
£lf
.
£Ëùed_cŞ
.
cŞÜ
 
š
 s–f.
cŞÜs
:

159 
£lf
.
£Ëùed_cŞ
 = 
NÚe


160 
bu‰Ú
 
š
 
£lf
.
bu‰Ús
:

161 
£lf
.
bu‰Ús_lookup
.
	$pİ
(
bu‰Ú
.
cŞÜ
)

162 
£lf
.
bu‰Ús
 = []

163 
£lf
.
·Ë‰e
.
	$de¡roy
()

165 
def
 
	$__bud_·Ë‰e
(
£lf
):

167 
£lf
.
	$__»£t_·Ë‰e
()

168 #(
»
-)
ü—‹
 
the
 
·Ë‰e
 
widg‘


169 
£lf
.
·Ë‰e
 = 
Gtk
.
	$Alignm’t
()

170 
£lf
.
	$·ck_¡¬t
(
£lf
.
·Ë‰e
, 
True
, True, 0)

171 #D¿w 
the
 
·Ë‰e


172 
vbox
 = 
Gtk
.
	$Box
(
Ü›Á©iÚ
=
Gtk
.
Or›Á©iÚ
.
VERTICAL
)

173 
£lf
.
·Ë‰e
.
	$add
(
vbox
)

174 
vbox
.
	$£t_¥acšg
(4)

175 
i
 
š
 
	`¿nge
(
	$Ën
(
£lf
.
cŞÜs
)):

176 
i
 % 
£lf
.
width
 == 0:

177 
cur_box
 = 
Gtk
.
	$Box
()

178 
vbox
.
	$·ck_¡¬t
(
cur_box
, 
True
, True, 0)

179 #add 
the
 
cŞÜ
 
box


180 
img
 = 
	$Sim¶eCŞÜS–eùÜP®‘‹I‹m
()

181 
img
.
	$£t_size_»que¡
(

182 
BUTTON_WIDTH
, 
BUTTON_HEIGHT
)

183 
img
.
	`cÚÃù
("bu‰Ú-´ess-ev’t", 
£lf
.
Ú_cŞÜ_şicked
)

184 
img
.
	$£t_cŞÜ
(
£lf
.
cŞÜs
[
i
])

185 
£lf
.
bu‰Ús_lookup
[£lf.
cŞÜs
[
i
]] = 
img


186 
£lf
.
bu‰Ús
.
	$­³nd
(
img
)

187 
cur_box
.
	$·ck_¡¬t
(
img
, 
F®£
, False, 0)

188 
cur_box
.
	$£t_¥acšg
(4)

189 #mak
·Ë‰e
 
visibË


190 
£lf
.
·Ë‰e
.
	$show_®l
()

192 
def
 
	$__»£t_cu¡om_·Ë‰e
(
£lf
):

194 
£lf
.
cu¡om_·Ë‰e
 
is
 
nÙ
 
NÚe
:

195 
£lf
.
£Ëùed_cŞ
 
is
 
nÙ
 
NÚe
 
ªd
 \

196 
£lf
.
£Ëùed_cŞ
.
cŞÜ
 
š
 s–f.
cu¡om_cŞÜs
:

197 
£lf
.
£Ëùed_cŞ
 = 
NÚe


198 
bu‰Ú
 
š
 
£lf
.
cc_bu‰Ús
:

199 
bu‰Ú
.
cŞÜ
 
is
 
nÙ
 
NÚe
:

200 
£lf
.
bu‰Ús_lookup
.
	$pİ
(
bu‰Ú
.
cŞÜ
)

201 
£lf
.
cc_bu‰Ús
 = []

202 
£lf
.
cu¡om_·Ë‰e
.
	$de¡roy
()

204 
def
 
	$__bud_cu¡om_·Ë‰e
(
£lf
):

206 
£lf
.
	$__»£t_cu¡om_·Ë‰e
()

207 #(
»
-)
ü—‹
 
the
 
·Ë‰e
 
widg‘


208 
£lf
.
cu¡om_·Ë‰e
 = 
Gtk
.
Alignm’t
.
	$Ãw
(0, 0, 1, 0)

209 
£lf
.
cu¡om_·Ë‰e
.
	$£t_·ddšg
(10, 0, 0, 0)

210 
£lf
.
	$·ck_¡¬t
(
£lf
.
cu¡om_·Ë‰e
, 
True
, True, 0)

211 #D¿w 
the
 
´evious
 
cŞÜ
 
·Ë‰e
: 
Úly
 
Úe
 
lše


212 
cc_vbox
 = 
Gtk
.
	$Box
(
Ü›Á©iÚ
=
Gtk
.
Or›Á©iÚ
.
VERTICAL
)

213 
£lf
.
cu¡om_·Ë‰e
.
	$add
(
cc_vbox
)

214 
cc_vbox
.
	$£t_¥acšg
(4)

215 
cc_box
 = 
Gtk
.
	$Box
()

216 
cc_vbox
.
	$·ck_¡¬t
(
cc_box
, 
True
, True, 0)

217 
i
 
š
 
	`¿nge
(
	$Ën
(
£lf
.
cu¡om_cŞÜs
)):

218 #add 
the
 
cŞÜ
 
box


219 
img
 = 
	$Sim¶eCŞÜS–eùÜP®‘‹I‹m
()

220 
img
.
	$£t_size_»que¡
(

221 
BUTTON_WIDTH
, 
BUTTON_HEIGHT
)

222 
img
.
	`cÚÃù
("bu‰Ú-´ess-ev’t", 
£lf
.
Ú_cŞÜ_şicked
)

223 
i
 < 
	$Ën
(
£lf
.
cu¡om_cŞÜs
):

224 
img
.
	$£t_cŞÜ
(
£lf
.
cu¡om_cŞÜs
[
i
])

225 
£lf
.
bu‰Ús_lookup
[£lf.
cu¡om_cŞÜs
[
i
]] = 
img


226 
cc_box
.
	$·ck_¡¬t
(
img
, 
F®£
, False, 0)

227 
cc_box
.
	$£t_¥acšg
(4)

228 
£lf
.
cc_bu‰Ús
.
	$­³nd
(
img
)

229 #D¿w 
the
 
add
 
bu‰Ú


230 
bu‰Ús_hbox
 = 
Gtk
.
	$Box
()

231 
cc_vbox
.
	$·ck_¡¬t
(
bu‰Ús_hbox
, 
True
, True, 0)

232 
img
 = 
Gtk
.
	$Image
()

233 
img
.
	$£t_äom_¡ock
(
Gtk
.
STOCK_ADD
, Gtk.
IcÚSize
.
BUTTON
)

234 
£lf
.
add_bu‰Ú
 = 
Gtk
.
	$Bu‰Ú
()

235 
£lf
.
add_bu‰Ú
.
	$£t_image
(
img
)

236 
£lf
.
add_bu‰Ú
.
	`£t_Ïb–
(
	`_
("Add custom color"))

237 
bu‰Ús_hbox
.
	$·ck_¡¬t
(
£lf
.
add_bu‰Ú
, 
True
, 
F®£
, 0)

238 
£lf
.
add_bu‰Ú
.
	`cÚÃù
("şicked", s–f.
Ú_cŞÜ_add
)

239 #D¿w 
the
 
ş—r
 
£Ëùed
 
cŞÜ
 
bu‰Ú


240 
img
 = 
Gtk
.
	$Image
()

241 
img
.
	$£t_äom_¡ock
(
Gtk
.
STOCK_REMOVE
, Gtk.
IcÚSize
.
BUTTON
)

242 
£lf
.
ş—r_bu‰Ú
 = 
Gtk
.
	$Bu‰Ú
()

243 
£lf
.
ş—r_bu‰Ú
.
	$£t_image
(
img
)

244 
£lf
.
ş—r_bu‰Ú
.
	`£t_Ïb–
(
	`_
("Clear selected color"))

245 
bu‰Ús_hbox
.
	$·ck_¡¬t
(
£lf
.
ş—r_bu‰Ú
, 
True
, 
F®£
, 0)

246 
£lf
.
ş—r_bu‰Ú
.
	`cÚÃù
("şicked", s–f.
Ú_cŞÜ_ş—r
)

247 
£lf
.
ş—r_bu‰Ú
.
	$£t_£ns™ive
(
F®£
)

248 #hid
the
 
cu¡om
 
·Ë‰e
 
no
 cu¡om 
cŞÜ
 
is
 
defšed


249 
	`Ën
(
£lf
.
cu¡om_cŞÜs
) == 0:

250 
£lf
.
cu¡om_·Ë‰e
.
	$hide
()

252 
£lf
.
cu¡om_·Ë‰e
.
	$show_®l
()

255 
def
 
	$Ú_cŞÜ_şicked
(
£lf
, 
widg‘
, 
ev’t
):

257 
nÙify
 
the
 
·»Á
"""

258 #ià
»
-
şick
: 
un£Ëù


259 
£lf
.
£Ëùed_cŞ
 =ğ
widg‘
:

260 
£lf
.
£Ëùed_cŞ
.
	$£t_£Ëùed
(
F®£
)

261 
£lf
.
£Ëùed_cŞ
 = 
NÚe


262 
£lf
.
ş—r_bu‰Ú
.
	$£t_£ns™ive
(
F®£
)

264 #ià
´evious
 
£ËùiÚ
: 
un£Ëù


265 
£lf
.
£Ëùed_cŞ
 
is
 
nÙ
 
NÚe
:

266 
£lf
.
£Ëùed_cŞ
.
	$£t_£Ëùed
(
F®£
)

267 
£lf
.
£Ëùed_cŞ
 = 
widg‘


268 
£lf
.
£Ëùed_cŞ
.
	$£t_£Ëùed
(
True
)

269 
£lf
.
ş—r_bu‰Ú
.
	$£t_£ns™ive
(
True
)

270 
£lf
.
	`em™
("color-changed")

272 
def
 
	$Ú_cŞÜ_ş—r
(
£lf
, 
widg‘
):

274 
cŞÜ
, 
upd©e
 
the
 
mod–
 
ªd
 
nÙify
h
·»Á
"""

275 #un£Ëù 
cu¼’t
 
£ËùiÚ


276 
£lf
.
£Ëùed_cŞ
 
is
 
nÙ
 
NÚe
:

277 
£lf
.
£Ëùed_cŞ
.
	$£t_£Ëùed
(
F®£
)

278 
£lf
.
£Ëùed_cŞ
 = 
NÚe


279 
£lf
.
ş—r_bu‰Ú
.
	$£t_£ns™ive
(
F®£
)

280 
£lf
.
	`em™
("color-changed")

282 
def
 
	$Ú_cŞÜ_add
(
£lf
, 
widg‘
):

284 
wšdow
, 
upd©e
 
the
 
mod–
, 
nÙif›s
h
·»Á
."""

285 
cŞÜ_dŸlog
 = 
Gtk
.
	`CŞÜS–eùiÚDŸlog
(
	`_
('Choose‡ color'))

287 
cŞÜ£l
 = 
cŞÜ_dŸlog
.
	$g‘_cŞÜ_£ËùiÚ
()

288 
£lf
.
£Ëùed_cŞ
 
is
 
nÙ
 
NÚe
:

289 
cŞÜ
 = 
Gdk
.
	$cŞÜ_·r£
(
£lf
.
£Ëùed_cŞ
.
cŞÜ
)

290 
cŞÜ£l
.
	$£t_cu¼’t_cŞÜ
(
cŞÜ
)

291 
»¥Ú£
 = 
cŞÜ_dŸlog
.
	$run
()

292 
Ãw_cŞÜ
 = 
cŞÜ£l
.
	$g‘_cu¼’t_cŞÜ
()

293 #Check 
»¥Ú£_id
 
ªd
 
£t
 
cŞÜ
 
»quœed


294 
»¥Ú£
 =ğ
Gtk
.
Re¥Ú£Ty³
.
OK
 
ªd
 
Ãw_cŞÜ
:

296 #¡rcŞÜ = 
Gtk
.
	`cŞÜ_£ËùiÚ_·Ë‰e_to_¡ršg
([
Ãw_cŞÜ
])

297 
¡rcŞÜ
 = 
Ãw_cŞÜ
.
	$to_¡ršg
()

298 #Add 
the
 
cŞÜ
 
to
h
·Ë‰e
 
ªd
 
nÙify


299 
¡rcŞÜ
 
nÙ
 
š
 
£lf
.
cŞÜs
:

300 
£lf
.
	$add_cu¡om_cŞÜ
(
¡rcŞÜ
)

301 #S–eù 
the
 
Ãw
 
cŞÜ
 
ªd
 
nÙify


302 
£lf
.
	$£t_£Ëùed_cŞÜ
(
¡rcŞÜ
)

303 
£lf
.
	`em™
("color-changed")

304 #CËª 
up


305 
cŞÜ_dŸlog
.
	$de¡roy
()

307 #publiø
IF


308 
def
 
	$has_cŞÜ
(
£lf
, 
cŞ
):

310  
cŞ
 
š
 
£lf
.
cŞÜs
 
Ü
 cŞ iÀ£lf.
cu¡om_cŞÜs


312 
def
 
	$g‘_cu¡om_cŞÜs
(
£lf
):

314  
£lf
.
cu¡om_cŞÜs


316 
def
 
	$£t_cu¡om_cŞÜs
(
£lf
, 
cu¡om_cŞÜs
):

318 
£lf
.
cu¡om_cŞÜs
 = []

319 
cŞ
 
š
 
cu¡om_cŞÜs
:

320 
cŞ
 
nÙ
 
š
 
£lf
.
cŞÜs
:

321 
£lf
.
cu¡om_cŞÜs
.
	$­³nd
(
cŞ
)

322 #Upd©
the
 
cu¡om
 
·Ë‰e


323 
£lf
.
	$__bud_cu¡om_·Ë‰e
()

324 #hid
the
 
cu¡om
 
·Ë‰e
 
no
 cu¡om 
cŞÜ
 
is
 
defšed


325 
	`Ën
(
£lf
.
cu¡om_cŞÜs
) == 0:

326 
£lf
.
cu¡om_·Ë‰e
.
	$hide
()

328 
def
 
	$add_cu¡om_cŞÜ
(
£lf
, 
cŞ
):

330 
cŞ
 
nÙ
 
š
 
£lf
.
cu¡om_cŞÜs
:

331 
£lf
.
cu¡om_cŞÜs
.
	$š£¹
(0, 
cŞ
)

332 
	`Ën
(
£lf
.
cu¡om_cŞÜs
è> s–f.
width
:

333 
£lf
.
cu¡om_cŞÜs
.
	$pİ
()

334 
£lf
.
	$__bud_cu¡om_·Ë‰e
()

335 
£lf
.
	`em™
("color-added")

337 
def
 
	$g‘_£Ëùed_cŞÜ
(
£lf
):

339 
£lf
.
£Ëùed_cŞ
 
is
 
NÚe
:

340  
NÚe


342  
£lf
.
£Ëùed_cŞ
.
cŞÜ


344 
def
 
	$£t_£Ëùed_cŞÜ
(
£lf
, 
cŞ
):

346 
’abËs
 
ş—r
 
bu‰Ú
 
wh’
 
a
 
cŞÜ
 
is
 
£Ëùed
"""

347 
£lf
.
	$un£Ëù_cŞÜ
()

348 
£lf
.
	$has_cŞÜ
(
cŞ
):

349 
£lf
.
bu‰Ús_lookup
[
cŞ
].
	$£t_£Ëùed
(
True
)

350 
£lf
.
£Ëùed_cŞ
 = s–f.
bu‰Ús_lookup
[
cŞ
]

351 
£lf
.
ş—r_bu‰Ú
.
	$£t_£ns™ive
(
True
)

353 
def
 
	$un£Ëù_cŞÜ
(
£lf
):

355 
£lf
.
£Ëùed_cŞ
 
is
 
nÙ
 
NÚe
:

356 
£lf
.
£Ëùed_cŞ
.
	$£t_£Ëùed
(
F®£
)

357 
£lf
.
£Ëùed_cŞ
 = 
NÚe


358 
£lf
.
ş—r_bu‰Ú
.
	$£t_£ns™ive
(
F®£
)

360 
GObjeù
.
	$ty³_»gi¡”
(
Sim¶eCŞÜS–eùÜ
)

361 
GObjeù
.
	`sigÇl_Ãw
("cŞÜ-chªged", 
Sim¶eCŞÜS–eùÜ
,

362 
GObjeù
.
SIGNAL_RUN_FIRST
, GObjeù.
TYPE_NONE
, ())

363 
GObjeù
.
	`sigÇl_Ãw
("cŞÜ-added", 
Sim¶eCŞÜS–eùÜ
,

364 
GObjeù
.
SIGNAL_RUN_FIRST
, GObjeù.
TYPE_NONE
, ())

	@gtk/browser/tag_context_menu.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
	gg_cÚ‹xt_m’u
:

19 
Im¶em’ts
 
a
 
cÚ‹xt
 (
pİ
-
up
è
m’u
 
the
 
g
 
™em
 
š
h
sideb¬
.

20 
Right
 
now
 
™
 
is
 
ju¡
 
a
 
sh–l
 
It
 i 
suµo£d
 
to
 
become
‡ 
mÜe
 
g’”ic


21 
sideb¬
 
cÚ‹xt
 
®l
 
kšd
 
of
 
™em
 
di¥Ïyed
 
th”e
.

22 
Also
, 
™
 
is
 
suµo£d
 
to
 
hªdË
 
mÜe
 
com¶ex
 
m’us
 (
w™h
 
nÚ
-
¡d
 
widg‘s
,

23 
like
 
a
 
cŞÜ
 
pick”
)

26 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


27 
äom
 
	gGTG
.
	ggtk
.
cŞÜs
 
impÜt
 
	gg’”©e_g_cŞÜ
, 
	gcŞÜ_add
, 
cŞÜ_»move


28 
äom
 
GTG
 
impÜt
 
_


31 
şass
 
	$TagCÚ‹xtM’u
(
Gtk
.
M’u
):

34 
def
 
	$__š™__
(
£lf
, 
»q
, 
vmªag”
, 
g
=
NÚe
):

35 
Gtk
.
M’u
.
	$__š™__
(
£lf
)

36 
£lf
.
»q
 =„eq

37 
£lf
.
vmªag”
 = vmanager

38 
£lf
.
g
 =ag

39 #Bud 
up
 
the
 
m’u


40 
£lf
.
	$£t_g
(
g
)

41 
£lf
.
	$__bud_m’u
()

43 
def
 
	$__bud_m’u
(
£lf
):

45 #Re£ˆ
the
 
widg‘


46 
i
 
š
 
£lf
:

47 
£lf
.
	$»move
(
i
)

48 
i
.
	$de¡roy
()

49 
£lf
.
g
 
is
 
nÙ
 
NÚe
:

50 #CŞÜ 
choo£r
 
FIXME
: 
SHOULD
 
BECOME
 
A
 
COLOR
 
PICKER


51 
£lf
.
mi_cc
 = 
Gtk
.
	$M’uI‹m
()

52 
£lf
.
mi_cc
.
	`£t_Ïb–
(
	`_
("Edit Tag..."))

53 
£lf
.
mi_ùag
 = 
Gtk
.
	$M’uI‹m
()

54 
£lf
.
mi_ùag
.
	`£t_Ïb–
(
	`_
("Generate Color"))

55 
£lf
.
mi_d–_g
 = 
Gtk
.
	$M’uI‹m
()

56 
£lf
.
mi_d–_g
.
	`£t_Ïb–
(
	`_
("Delete Tag"))

57 
£lf
.
	$­³nd
(
£lf
.
mi_cc
)

58 
£lf
.
	$­³nd
(
£lf
.
mi_ùag
)

59 
£lf
.
	$­³nd
(
£lf
.
mi_d–_g
)

60 
£lf
.
mi_d–_g
.
	`cÚÃù
('activate',

61 
£lf
.
vmªag”
.
Ú_d–‘e_g
)

62 
£lf
.
mi_cc
.
	`cÚÃù
('aùiv©e', s–f.
Ú_mi_cc_aùiv©e
)

63 
£lf
.
mi_ùag
.
	`cÚÃù
('aùiv©e', s–f.
Ú_mi_ùag_aùiv©e
)

64 
£lf
.
g
.
	$is_£¬ch_g
():

65 
£lf
.
mi_d–
 = 
Gtk
.
	$M’uI‹m
()

66 
£lf
.
mi_d–
.
	`£t_Ïb–
(
	`_
("Delete"))

67 
£lf
.
	$­³nd
(
£lf
.
mi_d–
)

68 
£lf
.
mi_d–
.
	`cÚÃù
('aùiv©e', s–f.
Ú_mi_d–_aùiv©e
)

69 #Mak
™
 
visibË


70 
£lf
.
	$show_®l
()

72 ###PUBLIC 
API
 ############################################################

73 
def
 
	$£t_g
(
£lf
, 
g
):

75 
£lf
.
g
 =ag

76 
£lf
.
	$__bud_m’u
()

78 ###CALLBACKS #############################################################
 on_mi_cc_aùiv©e(£lf, widg‘):

80 
£lf
.
vmªag”
.
	$İ’_g_ed™Ü
(
£lf
.
g
)

82 
def
 
	$Ú_mi_ùag_aùiv©e
(
£lf
, 
widg‘
):

83 
¿ndom_cŞÜ
 = 
	$g’”©e_g_cŞÜ
()

84 
´e£Á_cŞÜ
 = 
£lf
.
g
.
	`g‘_©Œibu‹
('color')

85 if(
´e£Á_cŞÜ
 
is
 
nÙ
 
NÚe
):

86 
	$cŞÜ_»move
(
´e£Á_cŞÜ
)

87 
£lf
.
g
.
	`£t_©Œibu‹
('cŞÜ', 
¿ndom_cŞÜ
)

88 
	$cŞÜ_add
(
¿ndom_cŞÜ
)

90 
def
 
	$Ú_mi_d–_aùiv©e
(
£lf
, 
widg‘
):

92 
£lf
.
»q
.
	`»move_g
(£lf.
g
.
	`g‘_Çme
())

	@gtk/browser/tag_editor.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
	gg_ed™Ü
: 
this
 
moduË
 
cÚšs
 
two
 
şas£s
: 
TagIcÚS–eùÜ
 
ªd
 
TagEd™Ü
.

20 
TagEd™Ü
 
im¶em’t
 
a
 
dŸlog
 
wšdow
 
th©
 
ÿn
 
be
 
u£d
 
to
 
ed™
 
the
 
´İ”t›s


21 
of
 
a
 
g
.

23 
TagIcÚS–eùÜ
 
is
 
š‹nded
 
as
 
a
 
æßtšg
 
wšdow
 
th©
 
®lows
 
to
 
£Ëù
 
ª
 
icÚ


24 
a
 
g
.

27 
äom
 
gi
.
»pos™Üy
 
impÜt
 
GObjeù
, 
	gGtk
, 
	gGdk
, 
GdkPixbuf


29 
äom
 
GTG
 
impÜt
 
_


30 
äom
 
	gGTG
.
	ggtk
.
	gbrow£r
.
sim¶e_cŞÜ_£ËùÜ
 
impÜt
 
Sim¶eCŞÜS–eùÜ


31 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


32 
äom
 
	gGTG
.
	ggtk
.
cŞÜs
 
impÜt
 
	gcŞÜ_add
, 
cŞÜ_»move


35 
şass
 
	$TagIcÚS–eùÜ
(
Gtk
.
Wšdow
):

37 
TagIcÚS–eùÜ
 
is
 
š‹nded
 
as
 
a
 
æßtšg
 
wšdow
 
th©
 
®lows
 
to
 
£Ëù


38 
ª
 
icÚ
 
a
 
g
. 
It
 
di¥Ïy
‡ 
li¡
 
of
 icÚ 
š
‡ 
pİup
 
wšdow
.

41 
def
 
	$__š™__
(
£lf
):

43 #£lf.
	`__gobjeù_š™__
(
ty³
=
Gtk
.
WšdowTy³
.
POPUP
)

44 #GObjeù.
GObjeù
.
	`__š™__
(
£lf
)

45 
Gtk
.
Wšdow
.
	$__š™__
(
£lf
)

47 
£lf
.
lßded
 = 
F®£


48 
£lf
.
£Ëùed_icÚ
 = 
NÚe


49 
£lf
.
symbŞ_mod–
 = 
NÚe


50 #Bud 
up
 
the
 
wšdow


51 
£lf
.
	$__bud_wšdow
()

52 #Mak
™
 
visibË


53 #£lf.
	`hide_®l
()

55 
£lf
.
	$hide
()

57 
def
 
	$__bud_wšdow
(
£lf
):

59 
£lf
.
	$£t_ty³_hšt
(
Gdk
.
WšdowTy³Hšt
.
POPUP_MENU
)

60 
vbox
 = 
Gtk
.
	$Box
(
Ü›Á©iÚ
=
Gtk
.
Or›Á©iÚ
.
VERTICAL
)

61 
£lf
.
	$add
(
vbox
)

62 #icÚ 
li¡


63 
sşd_wš
 = 
Gtk
.
	$SüŞËdWšdow
()

64 
sşd_wš
.
	$£t_pŞicy
(
Gtk
.
PŞicyTy³
.
NEVER
, Gtk.PŞicyTy³.
ALWAYS
)

65 
sşd_wš
.
	$£t_shadow_ty³
(
Gtk
.
ShadowTy³
.
ETCHED_IN
)

66 
vbox
.
	$·ck_¡¬t
(
sşd_wš
, 
True
, True, 0)

67 
£lf
.
symbŞ_iv
 = 
Gtk
.
	$IcÚV›w
()

68 
£lf
.
symbŞ_iv
.
	$£t_pixbuf_cŞumn
(0)

69 
£lf
.
symbŞ_iv
.
	$£t_cŞumns
(7)

70 
£lf
.
symbŞ_iv
.
	$£t_™em_width
(32)

71 #IcÚV›w 
size
:

73 #™ 
£ems
 
th©
 
w™h
 
the
 
above
 
·¿m‘”s
, 
a
 
row
 
width
 
is
 
about
:

74 #™em_couÁ * (32
	`px
 (
™em
è+ 6px (
dæt
 
·ddšg
è+ 2px (
¥acšg
?)) \

75 #+ 2*6
	`px
 (
dæt
 
widg‘
 
m¬gš
)

76 #Th
§me
 
gÛs
 
row
 
height
, 
but
 
bešg
 
right
 
this
 
v®ue
 
is
 
Ëss


77 #impÜÁ 
due
 
to
 
the
 
v”tiÿl
 
süŞlb¬
.

78 #Th
IcVw
 
size
 
should
 
f™
 
the
 
width
 
of
 7 
cŞs
 
ªd
 
height
 oà~4 
lšes
.

79 
SIZE_REQUEST
 = (40 * 7 + 12, 38 * 4)

80 
£lf
.
symbŞ_iv
.
	$£t_size_»que¡
(*
SIZE_REQUEST
)

81 
sşd_wš
.
	$£t_size_»que¡
(*
SIZE_REQUEST
)

82 
sşd_wš
.
	$add
(
£lf
.
symbŞ_iv
)

83 #icÚ 
»move
 
bu‰Ú


84 
img
 = 
Gtk
.
	$Image
()

85 
img
.
	$£t_äom_¡ock
(
Gtk
.
STOCK_REMOVE
, Gtk.
IcÚSize
.
BUTTON
)

86 
£lf
.
»move_bt
 = 
Gtk
.
	$Bu‰Ú
()

87 
£lf
.
»move_bt
.
	$£t_image
(
img
)

88 
£lf
.
»move_bt
.
	`£t_Ïb–
(
	`_
("Remove selected icon"))

89 
vbox
.
	$·ck_¡¬t
(
£lf
.
»move_bt
, 
F®£
, False, 0)

90 #£ˆ
the
 
ÿÎbacks


91 
£lf
.
symbŞ_iv
.
	`cÚÃù
("£ËùiÚ-chªged", s–f.
Ú_£ËùiÚ_chªged
)

92 
£lf
.
»move_bt
.
	`cÚÃù
("şicked", s–f.
Ú_»move_bt_şicked
)

94 
def
 
	$__focus_out
(
£lf
, 
widg‘
, 
ev’t
):

96 
wš_±r
 = 
£lf
.
	`g‘_wšdow
().
	$g‘_poš‹r
()

97 
wš_size
 = 
£lf
.
	$g‘_size
()

98 
	`nÙ
(0 <ğ
wš_±r
[1] <ğ
wš_size
[0] 
ªd


99 0 <ğ
wš_±r
[2] <ğ
wš_size
[1]):

100 
£lf
.
	$şo£_£ËùÜ
()

102 
def
 
	$__lßd_icÚ
(
£lf
):

104 
Lßds
 
embËm
 
icÚs
 
äom
 
the
 
cu¼’t
 
icÚ
 
theme


106 
Som‘imes
 
ª
 
icÚ
 
ÿn
't be†oaded because of‡ bug in system

107 
lib¿r›s
, 
e
.
g
. 
bug
 #1079587. 
G¿ûfuly
 
deg¿d©e
 
ªd
 
sk


108 
the
 
lßdšg
 
of
 
a
 
cÜru±ed
 
icÚ
.

110 
£lf
.
symbŞ_mod–
 = 
Gtk
.
	$Li¡StÜe
(
GdkPixbuf
.
Pixbuf
, 
¡r
)

111 
icÚ
 
š
 
Gtk
.
IcÚTheme
.
	`g‘_deçuÉ
().
	`li¡_icÚs
(
cÚ‹xt
="Emblems"):

112 
Œy
:

113 
img
 = 
Gtk
.
IcÚTheme
.
	`g‘_deçuÉ
().
	$lßd_icÚ
(
icÚ
, 16, 0)

114 
£lf
.
symbŞ_mod–
.
	$­³nd
([
img
, 
icÚ
])

115 
exû±
 
GObjeù
.
GE¼Ü
:

116 
Log
.
	`”rÜ
("FaedØlßd icÚ '%s'" % 
icÚ
)

117 
£lf
.
symbŞ_iv
.
	$£t_mod–
(
£lf
.
symbŞ_mod–
)

118 
£lf
.
lßded
 = 
True


120 ###PUBLIC 
IF
 ###
 s‘_»move_’abËd(£lf,ƒÇbË):

122 
£lf
.
»move_bt
.
	$£t_£ns™ive
(
’abË
)

124 ###ÿÎback ###
 on_£ËùiÚ_chªged(£lf, widg‘):

126 
nÙif›s
 
the
 
·»Á
 
widg‘
."""

127 
my_·th
 = 
£lf
.
symbŞ_iv
.
	$g‘_£Ëùed_™ems
()

128 
	`Ën
(
my_·th
) > 0:

129 
my_™”
 = 
£lf
.
symbŞ_mod–
.
	$g‘_™”
(
my_·th
[0])

130 
£lf
.
£Ëùed_icÚ
 = s–f.
symbŞ_mod–
.
	$g‘_v®ue
(
my_™”
, 1)

132 
£lf
.
£Ëùed_icÚ
 = 
NÚe


133 
£lf
.
	`em™
('selection-changed')

134 
£lf
.
	$şo£_£ËùÜ
()

136 
def
 
	$Ú_»move_bt_şicked
(
£lf
, 
widg‘
):

138 
£lf
.
£Ëùed_icÚ
 = 
NÚe


139 
£lf
.
	`em™
('selection-changed')

140 
£lf
.
	$şo£_£ËùÜ
()

142 ###PUBLIC 
IF
 ###
 show_©_pos™iÚ(£lf,…os_x,…os_y):

144 
nÙ
 
£lf
.
lßded
:

145 
£lf
.
	$__lßd_icÚ
()

146 
£lf
.
	$move
(
pos_x
, 
pos_y
)

147 
£lf
.
	$show_®l
()

148 #som
wšdow
 
mªag”s
 
ignÜe
 
move
 
befÜe
 
you
 
show
 
a
 wšdow. (
which


149 #Úes? 
que¡iÚ
 
by
 
šv”nizzi
)

150 
£lf
.
	$move
(
pos_x
, 
pos_y
)

151 
£lf
.
	$g¿b_add
()

152 #W
g¿b
 
the
 
poš‹r
 
š
h
ÿËnd¬


153 #FIXME 
THIS
 
DOES
 
NOT
 
WORK
!!!!!!!

154 
Gdk
.
	`poš‹r_g¿b
(
£lf
.
	`g‘_wšdow
(), 
True
,

155 #Gdk.
Modif›rTy³
.
BUTTON1_MASK
 |

156 #Gdk.
Modif›rTy³
.
MOD2_MASK
,

157 #FIXME!!!! 
JUST
 
GUESSING
 
THE
 
TYPE


158 
Gdk
.
Ev’tMask
.
ALL_EVENTS_MASK
,

159 
NÚe
,

160 
NÚe
,

162 
£lf
.
	`cÚÃù
('bu‰Ú-´ess-ev’t', s–f.
__focus_out
)

164 
def
 
	$şo£_£ËùÜ
(
£lf
):

166 
£lf
.
	$hide
()

168 
Gdk
.
	$poš‹r_ung¿b
(0)

169 
£lf
.
	$g¿b_»move
()

171 
def
 
	$g‘_£Ëùed_icÚ
(
£lf
):

173  
£lf
.
£Ëùed_icÚ


175 
def
 
	$un£Ëù_icÚ
(
£lf
):

177 
£lf
.
symbŞ_iv
.
	$un£Ëù_®l
()

180 
GObjeù
.
	$ty³_»gi¡”
(
TagIcÚS–eùÜ
)

181 
GObjeù
.
	`sigÇl_Ãw
("£ËùiÚ-chªged", 
TagIcÚS–eùÜ
,

182 
GObjeù
.
SigÇlFÏgs
.
RUN_FIRST
, 
NÚe
, ())

185 
şass
 
	$TagEd™Ü
(
Gtk
.
Wšdow
):

188 
def
 
	$__š™__
(
£lf
, 
»q
, 
vmªag”
, 
g
=
NÚe
):

189 
Gtk
.
Wšdow
.
	$__š™__
(
£lf
)

191 
£lf
.
»q
 =„eq

192 
£lf
.
vmªag”
 = vmanager

193 
£lf
.
g
 =ag

194 
£lf
.
cÚfig
 = s–f.
»q
.
	`g‘_cÚfig
('tag_editor')

195 
£lf
.
cu¡om_cŞÜs
 = 
NÚe


196 
£lf
.
Š_’Œy_w©ch_id
 = 
NÚe


197 
£lf
.
Š_cb_şicked_hid
 = 
NÚe


198 
£lf
.
Š_’Œy_şicked_hid
 = 
NÚe


199 
£lf
.
tis_£ËùiÚ_chªged_hid
 = 
NÚe


200 
£lf
.
g_icÚ_£ËùÜ
 = 
NÚe


201 #Bud 
up
 
the
 
wšdow


202 
£lf
.
	$£t_pos™iÚ
(
Gtk
.
WšdowPos™iÚ
.
CENTER
)

203 
£lf
.
	`£t_t™Ë
('Editag')

204 
£lf
.
	$£t_bÜd”_width
(10)

205 
£lf
.
	$£t_»sizabË
(
F®£
)

206 
£lf
.
	$__bud_wšdow
()

207 
£lf
.
	$__£t_ÿÎbacks
()

208 
£lf
.
	$£t_g
(
g
)

209 #Mak
™
 
visibË


210 
£lf
.
	$show_®l
()

212 
def
 
	$__bud_wšdow
(
£lf
):

214 #tİËv– 
widg‘


215 
£lf
.
tİ_vbox
 = 
Gtk
.
	$Box
(
Ü›Á©iÚ
=
Gtk
.
Or›Á©iÚ
.
VERTICAL
)

216 
£lf
.
	$add
(
£lf
.
tİ_vbox
)

217 #h—d” 
lše
: 
icÚ
, 
grid
 
w™h
 
Çme
 
ªd
 "hide in wv"

219 
£lf
.
hdr_®ign
 = 
Gtk
.
	$Alignm’t
()

220 
£lf
.
tİ_vbox
.
	$·ck_¡¬t
(
£lf
.
hdr_®ign
, 
True
, True, 0)

221 
£lf
.
hdr_®ign
.
	$£t_·ddšg
(0, 25, 0, 0)

222 
£lf
.
hdr_box
 = 
Gtk
.
	$Box
()

223 
£lf
.
hdr_®ign
.
	$add
(
£lf
.
hdr_box
)

224 
£lf
.
hdr_box
.
	$£t_¥acšg
(10)

225 #Bu‰Ú 
to
 
g
 
icÚ
 
£ËùÜ


226 
£lf
.
ti_bt
 = 
Gtk
.
	$Bu‰Ú
()

227 
£lf
.
ti_bt_Ïb–
 = 
Gtk
.
	$Lab–
()

228 
£lf
.
ti_bt
.
	$add
(
£lf
.
ti_bt_Ïb–
)

229 
£lf
.
hdr_box
.
	$·ck_¡¬t
(
£lf
.
ti_bt
, 
True
, True, 0)

230 
£lf
.
ti_bt
.
	$£t_size_»que¡
(64, 64)

231 
£lf
.
ti_bt
.
	$£t_»l›f
(
Gtk
.
R–›fStyË
.
HALF
)

232 #vbox 
g
 
Çme
 
ªd
 
hid
 
š
 
WV


233 
£lf
.
_grid
 = 
Gtk
.
	$Grid
()

234 
£lf
.
hdr_box
.
	$·ck_¡¬t
(
£lf
.
_grid
, 
True
, True, 0)

235 
£lf
.
_grid
.
	$£t_cŞumn_¥acšg
(5)

236 
£lf
.
Š_’Œy_lbl_®ign
 = 
Gtk
.
Alignm’t
.
	$Ãw
(0, 0.5, 0, 0)

237 
£lf
.
_grid
.
	$add
(
£lf
.
Š_’Œy_lbl_®ign
)

238 
£lf
.
Š_’Œy_lbl
 = 
Gtk
.
	$Lab–
()

239 
£lf
.
Š_’Œy_lbl
.
	`£t_m¬kup
("<span weight='bold'>%s</span>"

240 % 
	`_
("Name : "))

241 
£lf
.
Š_’Œy_lbl_®ign
.
	$add
(
£lf
.
Š_’Œy_lbl
)

242 
£lf
.
Š_’Œy
 = 
Gtk
.
	$EÁry
()

243 
£lf
.
Š_’Œy
.
	$£t_width_ch¬s
(20)

244 
£lf
.
_grid
.
	$©ch
(
£lf
.
Š_’Œy
, 1, 0, 1, 1)

245 
£lf
.
Š_cb_lbl_®ign
 = 
Gtk
.
Alignm’t
.
	$Ãw
(0, 0.5, 0, 0)

246 
£lf
.
_grid
.
	$©ch
(
£lf
.
Š_cb_lbl_®ign
, 0, 1, 1, 1)

247 
£lf
.
Š_cb_lbl
 = 
Gtk
.
	`Lab–
(
Ïb–
=
	`_
("Show Tag in Work View :"))

248 
£lf
.
Š_cb_lbl_®ign
.
	$add
(
£lf
.
Š_cb_lbl
)

249 
£lf
.
Š_cb
 = 
Gtk
.
	$CheckBu‰Ú
()

250 
£lf
.
_grid
.
	$©ch
(
£lf
.
Š_cb
, 1, 1, 1, 1)

251 #Tag 
cŞÜ


252 
£lf
.
tc_vbox
 = 
Gtk
.
	$Box
(
Ü›Á©iÚ
=
Gtk
.
Or›Á©iÚ
.
VERTICAL
)

253 
£lf
.
tİ_vbox
.
	$·ck_¡¬t
(
£lf
.
tc_vbox
, 
True
, True, 0)

254 
£lf
.
tc_Ïb–_®ign
 = 
Gtk
.
	$Alignm’t
()

255 
£lf
.
tc_vbox
.
	$·ck_¡¬t
(
£lf
.
tc_Ïb–_®ign
, 
True
, True, 0)

256 
£lf
.
tc_Ïb–_®ign
.
	$£t_·ddšg
(0, 0, 0, 0)

257 
£lf
.
tc_Ïb–
 = 
Gtk
.
	$Lab–
()

258 
£lf
.
tc_Ïb–_®ign
.
	$add
(
£lf
.
tc_Ïb–
)

259 
£lf
.
tc_Ïb–
.
	`£t_m¬kup
(

260 "<¥ª weight='bŞd'>%s</¥ª>" % 
	`_
("Select Tag Color:"))

261 
£lf
.
tc_Ïb–
.
	$£t_®ignm’t
(0, 0.5)

262 #Tag 
cŞÜ
 
choo£r


263 
£lf
.
tc_cc_®ign
 = 
Gtk
.
Alignm’t
.
	$Ãw
(0.5, 0.5, 0, 0)

264 
£lf
.
tc_vbox
.
	$·ck_¡¬t
(
£lf
.
tc_cc_®ign
, 
True
, True, 0)

265 
£lf
.
tc_cc_®ign
.
	$£t_·ddšg
(15, 15, 10, 10)

266 
£lf
.
tc_cc_cŞ£l
 = 
	$Sim¶eCŞÜS–eùÜ
()

267 #£lf.
tc_cc_cŞ£l
 = 
Gtk
.
	`CŞÜChoo£rWidg‘
()

268 
£lf
.
tc_cc_®ign
.
	$add
(
£lf
.
tc_cc_cŞ£l
)

269 #IcÚ 
£ËùÜ


270 
£lf
.
g_icÚ_£ËùÜ
 = 
	$TagIcÚS–eùÜ
()

272 
def
 
	$__£t_ÿÎbacks
(
£lf
):

274 #S‘ 
the
 
ÿÎbacks


275 
£lf
.
ti_bt
.
	`cÚÃù
('şicked', s–f.
Ú_ti_bt_şicked
)

276 
£lf
.
tis_£ËùiÚ_chªged_hid
 = \

277 
£lf
.
g_icÚ_£ËùÜ
.
	`cÚÃù
('selection-changed',

278 
£lf
.
Ú_tis_£ËùiÚ_chªged
)

279 
£lf
.
Š_’Œy_şicked_hid
 = \

280 
£lf
.
Š_’Œy
.
	`cÚÃù
('chªged', s–f.
Ú_Š_’Œy_chªged
)

281 
£lf
.
Š_cb_şicked_hid
 = s–f.
Š_cb
.
	`cÚÃù
('clicked',

282 
£lf
.
Ú_Š_cb_şicked
)

284 
£lf
.
tc_cc_cŞ£l
.
	`cÚÃù
('cŞÜ-chªged', s–f.
Ú_tc_cŞ£l_chªged
)

285 
£lf
.
tc_cc_cŞ£l
.
	`cÚÃù
('cŞÜ-added', s–f.
Ú_tc_cŞ£l_added
)

286 #£lf.
tc_cc_cŞ£l
.
	`cÚÃù
('color-activated',

287 #£lf.
Ú_tc_cŞ£l_aùiv©ed
)

288 
£lf
.
	`cÚÃù
('d–‘e-ev’t', s–f.
Ú_şo£
)

290 #®low 
ç¡
 
şosšg
 
by
 
Esÿ³
 
key


293 
agr
 = 
Gtk
.
	$AcûlGroup
()

294 
£lf
.
	$add_acûl_group
(
agr
)

295 
key
, 
modif›r
 = 
Gtk
.
	`acûË¿tÜ_·r£
('Escape')

296 
agr
.
	`cÚÃù_group
(
key
, 
modif›r
, 
Gtk
.
AcûlFÏgs
.
VISIBLE
, 
£lf
.
Ú_şo£
)

299 
def
 
	$__£t_deçuÉ_v®ues
(
£lf
):

301 #Di§bË 
some
 
hªdËrs
 
£‰šg
 
up
 
the
 
widg‘
 
to
 
avoid


303 
£lf
.
Š_cb
.
	$hªdËr_block
(
£lf
.
Š_cb_şicked_hid
)

304 
£lf
.
Š_’Œy
.
	$hªdËr_block
(
£lf
.
Š_’Œy_şicked_hid
)

305 
£lf
.
g_icÚ_£ËùÜ
.
	$hªdËr_block
(
£lf
.
tis_£ËùiÚ_chªged_hid
)

306 #DeçuÉ 
icÚ


307 
m¬kup
 = "<¥ª size='sm®l'>%s</¥ª>" % 
	`_
("Click To\nSet Icon")

308 
£lf
.
ti_bt_Ïb–
.
	$£t_ju¡ify
(
Gtk
.
Ju¡ifiÿtiÚ
.
CENTER
)

309 
£lf
.
ti_bt_Ïb–
.
	$£t_m¬kup
(
m¬kup
)

310 
£lf
.
ti_bt_Ïb–
.
	$show
()

311 
£lf
.
	$__£t_icÚ
(
NÚe
)

312 #Un£Ëù 
ªy
 
´eviou¦y
 
£Ëùed
 
icÚ


313 
£lf
.
g_icÚ_£ËùÜ
.
	$un£Ëù_icÚ
()

314 #Show 
š
 
WV


315 
£lf
.
Š_cb
.
	$£t_aùive
(
True
)

316 #Nam
’Œy


317 
£lf
.
Š_’Œy
.
	`£t_‹xt
(
	`_
("Enterag‚ame here"))

318 
£lf
.
Š_’Œy
.
	$£t_icÚ_äom_¡ock
(
Gtk
.
EÁryIcÚPos™iÚ
.
SECONDARY
,

319 
NÚe
)

320 #CŞÜ 
£ËùiÚ


322 
£lf
.
tc_cc_cŞ£l
.
	$un£Ëù_cŞÜ
()

323 #£lf.
tc_cc_cŞ£l
.
	`£t_u£_®pha
(
F®£
)

324 #£lf.
tc_cc_cŞ£l
.
	`£t_rgba
(
£lf
.tc_cc_cŞ£l, 
NÚe
)

325 #Cu¡om 
cŞÜs


326 
£lf
.
cu¡om_cŞÜs
 = s–f.
cÚfig
.
	`g‘
('custom_colors')

327 
	`Ën
(
£lf
.
cu¡om_cŞÜs
) > 0:

328 
£lf
.
tc_cc_cŞ£l
.
	$£t_cu¡om_cŞÜs
(
£lf
.
cu¡om_cŞÜs
)

330 
£lf
.
Š_’Œy
.
	$g¿b_focus
()

331 #Re-
’abË
 
checkbu‰Ú
 
hªdËr_block


332 
£lf
.
Š_cb
.
	$hªdËr_unblock
(
£lf
.
Š_cb_şicked_hid
)

333 
£lf
.
Š_’Œy
.
	$hªdËr_unblock
(
£lf
.
Š_’Œy_şicked_hid
)

334 
£lf
.
g_icÚ_£ËùÜ
.
	$hªdËr_unblock
(
£lf
.
tis_£ËùiÚ_chªged_hid
)

336 
def
 
	$__£t_icÚ
(
£lf
, 
icÚ
):

338 
wh’
 
no
 
icÚ
 
is
 
£Ëùed
."""

339 
icÚ
 
is
 
nÙ
 
NÚe
:

340 
i
 
š
 
£lf
.
ti_bt
:

341 
£lf
.
ti_bt
.
	$»move
(
i
)

342 
ti_bt_img
 = 
Gtk
.
Image
.
	$Ãw_äom_icÚ_Çme
(
icÚ
,

343 
Gtk
.
IcÚSize
.
BUTTON
)

344 
ti_bt_img
.
	$show
()

345 
£lf
.
ti_bt
.
	$add
(
ti_bt_img
)

347 
i
 
š
 
£lf
.
ti_bt
:

348 
£lf
.
ti_bt
.
	$»move
(
i
)

349 
£lf
.
ti_bt
.
	$add
(
£lf
.
ti_bt_Ïb–
)

351 ###PUBLIC 
API
 ###
 s‘_g(£lf,ag):

353 #£t_aùiv
em™
 
the
 'toggË' 
sigÇl
, 
so
 
we
 
have
 
to
 
di§bË


354 #th
hªdËr
 
wh’
 
we
 
upd©e
 
´og¿mm©iÿÎy


355 
£lf
.
	$__£t_deçuÉ_v®ues
()

356 
g
 
is
 
NÚe
:

357 
£lf
.
g
 = 
NÚe


359 #Di§bË 
some
 
hªdËrs
 
£‰šg
 
up
 
the
 
widg‘
 
to
 
avoid


361 
£lf
.
Š_cb
.
	$hªdËr_block
(
£lf
.
Š_cb_şicked_hid
)

362 
£lf
.
Š_’Œy
.
	$hªdËr_block
(
£lf
.
Š_’Œy_şicked_hid
)

363 
£lf
.
g
 =ag

364 #Upd©
’Œy


365 
g
.
	$is_£¬ch_g
():

366 
Çme
 = 
g
.
	$g‘_Çme
()

368 
Çme
 = 
g
.
	`g‘_Çme
()[1:]

369 
£lf
.
Š_’Œy
.
	$£t_‹xt
(
Çme
)

370 #Upd©
visib™y
 
š
 
WÜk
 
V›w


371 
s_hidd’_š_wv
 = (
£lf
.
g
.
	`g‘_©Œibu‹
("nonworkview") == "True")

372 
£lf
.
Š_cb
.
	$£t_aùive
(
nÙ
 
s_hidd’_š_wv
)

373 #Ià
avaabË
, 
upd©e
 
icÚ


374 ià(
g
.
	`g‘_©Œibu‹
('icÚ'è
is
 
nÙ
 
NÚe
):

375 
icÚ
 = 
g
.
	`g‘_©Œibu‹
('icon')

376 
£lf
.
	$__£t_icÚ
(
icÚ
)

377 #Ià
avaabË
, 
upd©e
 
cŞÜ
 
£ËùiÚ


378 ià(
g
.
	`g‘_©Œibu‹
('cŞÜ'è
is
 
nÙ
 
NÚe
):

379 
cŞ
 = 
g
.
	`g‘_©Œibu‹
('color')

380 
nÙ
 
£lf
.
tc_cc_cŞ£l
.
	$has_cŞÜ
(
cŞ
):

381 
£lf
.
tc_cc_cŞ£l
.
	$add_cu¡om_cŞÜ
(
cŞ
)

382 
£lf
.
tc_cc_cŞ£l
.
	$£t_£Ëùed_cŞÜ
(
cŞ
)

383 #Re-
’abË
 
checkbu‰Ú
 
hªdËr_block


384 
£lf
.
Š_cb
.
	$hªdËr_unblock
(
£lf
.
Š_cb_şicked_hid
)

385 
£lf
.
Š_’Œy
.
	$hªdËr_unblock
(
£lf
.
Š_’Œy_şicked_hid
)

387 ###CALLBACKS ###
 w©ch_Š_’Œy_chªges(£lf):

389 
b“n
 
nÙiûd
 
aá”
 1 
£cÚd
, 
»que¡
 
ª
 
upd©e
."""

390 
cur_v®ue
 = 
£lf
.
Š_’Œy
.
	$g‘_‹xt
()

391 
£lf
.
Š_’Œy_Ï¡_»cÜded_v®ue
 !ğ
cur_v®ue
:

392 #they'» difã»Á:h”e'
s
 
b“n
 
some
 
upd©es
, 
wa™
 
fu¹h”


393  
True


396 #upd©
the
 
g
 
Çme


397 
£lf
.
Š_’Œy_w©ch_id
 = 
NÚe


398 
cur_v®ue
.
	`¡r
() != '':

399 
£lf
.
g
.
	$is_£¬ch_g
():

400 
Ãw_Çme
 = 
cur_v®ue


402 
Ãw_Çme
 = "@" + 
cur_v®ue


403 
£lf
.
»q
.
	`»Çme_g
(£lf.
g
.
	`g‘_Çme
(), 
Ãw_Çme
)

404  
F®£


406 
def
 
	$Ú_tis_£ËùiÚ_chªged
(
£lf
, 
widg‘
):

408 
icÚ
 = 
£lf
.
g_icÚ_£ËùÜ
.
	$g‘_£Ëùed_icÚ
()

409 
icÚ
 
is
 
nÙ
 
NÚe
:

410 
£lf
.
g
.
	`£t_©Œibu‹
("icÚ", 
icÚ
)

411 
£lf
.
	$__£t_icÚ
(
icÚ
)

413 
£lf
.
g
.
	`d–_©Œibu‹
("icon")

414 
£lf
.
	$__£t_icÚ
(
NÚe
)

416 
def
 
	$Ú_ti_bt_şicked
(
£lf
, 
widg‘
):

418 
to
 
the
 
bu‰Ú
."""

419 
»ù
 = 
£lf
.
ti_bt
.
	$g‘_®loÿtiÚ
()

420 #´šˆ
£lf
.
ti_bt
.
	`g‘_wšdow
().
	`g‘_Üigš
()

422 
»suÉ
, 
pos_x
, 
pos_y
 = \

423 
£lf
.
ti_bt
.
	`g‘_wšdow
().
	$g‘_Üigš
()

424 #£lf.
ti_bt
.
wšdow
.
	`g‘_Üigš
()

425 
£lf
.
g_icÚ_£ËùÜ
.
	`show_©_pos™iÚ
(

426 
pos_x
 + 
»ù
.
x
 +„eù.
width
 + 2,

427 
pos_y
 + 
»ù
.
y
)

428 
£lf
.
g
.
	`g‘_©Œibu‹
('icÚ'è
is
 
nÙ
 
NÚe
:

429 
£lf
.
g_icÚ_£ËùÜ
.
	$£t_»move_’abËd
(
True
)

431 
£lf
.
g_icÚ_£ËùÜ
.
	$£t_»move_’abËd
(
F®£
)

433 
def
 
	$Ú_Š_’Œy_chªged
(
£lf
, 
widg‘
):

435 
mÚ™Üšg
 
to
 
decide
 
wh’
Ø
upd©e
 
a
 
g
's‚ame."""

436 
£lf
.
Š_’Œy_Ï¡_»cÜded_v®ue
 = s–f.
Š_’Œy
.
	$g‘_‹xt
()

437 #check 
v®id™y


438 
£lf
.
Š_’Œy_Ï¡_»cÜded_v®ue
.
	`¡r
() == "":

439 
£lf
.
Š_’Œy
.
	$£t_icÚ_äom_¡ock
(
Gtk
.
EÁryIcÚPos™iÚ
.
SECONDARY
,

440 
Gtk
.
STOCK_DIALOG_ERROR
)

442 
£lf
.
Š_’Œy
.
	$£t_icÚ_äom_¡ock
(

443 
Gtk
.
EÁryIcÚPos™iÚ
.
SECONDARY
, 
NÚe
)

444 #f‹¸
out
 
chªge
 
»que¡s
 
to
 
»duû
 
comm™
 
ov”h—d


445 
£lf
.
Š_’Œy_w©ch_id
 
is
 
NÚe
:

446 #Th”
is
 
no
 
w©ch”s
 
the
 
‹xt
 
’Œy
. 
Regi¡”
 
Úe
.

447 #Also, 
wa™
 1 
£cÚd
 
befÜe
 
comm™šg
 
the
 
chªge
 
š
 
Üd”
 
to


448 #»duû 
»Çme
 
»que¡s


449 
Š_’Œy_chªges
 = 
£lf
.
w©ch_Š_’Œy_chªges


450 
£lf
.
Š_’Œy_w©ch_id
 = 
GObjeù
.
	$timeout_add
(1000,

451 
Š_’Œy_chªges
)

453 
def
 
	$Ú_Š_cb_şicked
(
£lf
, 
widg‘
):

455 
widg‘
's state."""

456 
£lf
.
g
 
is
 
nÙ
 
NÚe
:

457 
show_š_wv
 = 
£lf
.
Š_cb
.
	$g‘_aùive
()

458 
hide_š_wv
 = 
nÙ
 
show_š_wv


459 
£lf
.
g
.
	`£t_©Œibu‹
('nÚwÜkv›w', 
	$¡r
(
hide_š_wv
))

461 
def
 
	$Ú_tc_cŞ£l_chªged
(
£lf
, 
widg‘
):

463 
£ËùiÚ
"""

464 
cŞÜ
 = 
£lf
.
tc_cc_cŞ£l
.
	$g‘_£Ëùed_cŞÜ
()

465 
£lf
.
g
 
is
 
nÙ
 
NÚe
:

466 
cŞÜ
 
is
 
nÙ
 
NÚe
:

467 
my_cŞÜ
 = 
Gdk
.
	$cŞÜ_·r£
(
cŞÜ
)

468 
cŞÜ
 = 
Gdk
.
	`CŞÜ
(

469 
my_cŞÜ
.
»d
, my_cŞÜ.
g»’
, my_cŞÜ.
blue
).
	$to_¡ršg
()

470 
	$cŞÜ_add
(
cŞÜ
)

471 
£lf
.
g
.
	`£t_©Œibu‹
('cŞÜ', 
cŞÜ
)

473 
	`cŞÜ_»move
(
£lf
.
g
.
	`g‘_©Œibu‹
('color'))

474 
£lf
.
g
.
	`d–_©Œibu‹
('color')

476 
def
 
	$Ú_tc_cŞ£l_aùiv©ed
(
£lf
, 
widg‘
, 
cŞÜ
):

478 
£ËùiÚ
"""

479 
	`´št
("aùiv©ed", 
widg‘
, 
cŞÜ
, " <--- ignoring for‚ow")

481 #cŞÜ = 
£lf
.
tc_cc_cŞ£l
.
	`g‘_rgba
().
	`to_cŞÜ
()

482 
cŞÜ
 = cŞÜ.
	$to_cŞÜ
()

483 
£lf
.
g
 
is
 
nÙ
 
NÚe
:

484 
cŞÜ
 
is
 
nÙ
 
NÚe
:

485 
£lf
.
g
.
	`£t_©Œibu‹
('cŞÜ', 
cŞÜ
)

487 
£lf
.
g
.
	`d–_©Œibu‹
('color')

489 
def
 
	$Ú_tc_cŞ£l_added
(
£lf
, 
widg‘
):

491 
cÚfigu¿tiÚ
"""

492 
£lf
.
cu¡om_cŞÜs
 = s–f.
tc_cc_cŞ£l
.
	$g‘_cu¡om_cŞÜs
()

493 
£lf
.
cÚfig
.
	`£t
("cu¡om_cŞÜs", s–f.
cu¡om_cŞÜs
)

495 
def
 
	$Ú_şo£
(
£lf
, 
widg‘
, 
ev’t
, 
¬g1
=
NÚe
, 
¬g2
=NÚe, 
¬g3
=None):

498 
Argum’ts
 
¬g1
-
¬g3
 
¬e
 
Ãeded
 
to
 
§tisfy
 
ÿÎback
 
wh’
 
şosšg


499 
by
 
Esÿ³


501 
£lf
.
vmªag”
.
	$şo£_g_ed™Ü
()

502  
True


	@gtk/browser/treeview_factory.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
	gGObjeù
, 
	gGtk
, 
Pªgo


18 
impÜt
 
	gxml
.
	g§x
.
§xuts
 
as
 saxutils

19 
impÜt
 
loÿË


21 
äom
 
GTG
 
impÜt
 
_


22 
äom
 
	gGTG
.
cÜe
 
impÜt
 
CÜeCÚfig


23 
äom
 
	gGTG
.
	gcÜe
.
sk
 
impÜt
 
Task


24 
äom
 
	gGTG
.
	gcÜe
.
£¬ch
 
impÜt
 
	g·r£_£¬ch_qu”y
, 
£¬ch_f‹r


25 
äom
 
	gGTG
.
	ggtk
.
	gbrow£r
.
C–lR’d””Tags
 
impÜt
 CellRendererTags

26 
äom
 
libÏrch_gtk
 
impÜt
 
T»eV›w


27 
äom
 
	gGTG
.
gtk
 
impÜt
 
cŞÜs


28 
äom
 
	gGTG
.
	gtoŞs
.
d©es
 
impÜt
 
D©e


31 
şass
 
	$T»ev›wFaùÜy
():

33 
def
 
	$__š™__
(
£lf
, 
»que¡”
, 
cÚfig
):

34 
£lf
.
»q
 = 
»que¡”


35 
£lf
.
mašv›w
 = s–f.
»q
.
	$g‘_sks_Œ“
()

36 
£lf
.
cÚfig
 = config

38 #In™ŸÈ
uÇùive
 
cŞÜ


39 #Thi 
is
 
a
 
üude
 
hack
. 
As
 
we
 
dÚ
't have‡„eferenceohe

40 #Œ“v›w 
to
 
»Œ›ve
 
the
 
¡yË
, 
we
 
§ve
 
th©
 
cŞÜ
 
wh’
 we

41 #bud 
the
 
Œ“v›w
.

42 
£lf
.
uÇùive_cŞÜ
 = "#888a85"

44 #Li¡ 
of
 
keys
 
cÚÃùšg
/
discÚÃùšg
 
Tag
 
Œ“


45 
£lf
.
g_şlbcks
 = []

47 #Cach
gs
 
Œ“v›w
 
Ú_»Çme_g
 
ÿÎback


48 
£lf
.
gs_v›w
 = 
NÚe


50 #############################
#FunùiÚ 
sks
 
cŞumns


52 
def
 
	$_has_hidd’_subsk
(
£lf
, 
sk
):

53 #nÙ 
»cursive


54 
di¥Ïy_couÁ
 = 
£lf
.
mašv›w
.
	`node_n_chd»n
(
sk
.
	$g‘_id
())

55 
»®_couÁ
 = 0

56 
sk
.
	$has_chd
():

57 
tid
 
š
 
sk
.
	$g‘_chd»n
():

58 
sub_sk
 = 
£lf
.
»q
.
	$g‘_sk
(
tid
)

59 
sub_sk
 
ªd
 sub_sk.
	`g‘_¡©us
(è=ğ
Task
.
STA_ACTIVE
:

60 
»®_couÁ
 =„eal_count + 1

61  
di¥Ïy_couÁ
 < 
»®_couÁ


63 
def
 
	$sk_bg_cŞÜ
(
£lf
, 
node
, 
deçuÉ_cŞÜ
):

64 
£lf
.
cÚfig
.
	`g‘
('bg_color_enable'):

65  
cŞÜs
.
	`background_cŞÜ
(
node
.
	`g‘_gs
(), 
deçuÉ_cŞÜ
)

67  
NÚe


69 #»tuº 
ª
 
Üd”ed
 
li¡
 
of
 
gs
 oà
a
 
sk


70 
def
 
	$sk_gs_cŞumn
(
£lf
, 
node
):

71 
gs
 = 
node
.
	$g‘_gs
()

73 
£¬ch_·»Á
 = 
£lf
.
»q
.
	$g‘_g
(
CÜeCÚfig
.
SEARCH_TAG
)

74 
£¬ch_g
 
š
 
£¬ch_·»Á
.
	$g‘_chd»n
():

75 
g
 = 
£lf
.
»q
.
	$g‘_g
(
£¬ch_g
)

76 
m©ch
 = 
	`£¬ch_f‹r
(

77 
node
,

78 
	`·r£_£¬ch_qu”y
(
g
.
	`g‘_©Œibu‹
('query')),

80 
m©ch
 
ªd
 
£¬ch_g
 
nÙ
 
š
 
gs
:

81 
gs
.
	$­³nd
(
g
)

83 
gs
.
	`sÜt
(
key
=
Ïmbda
 
x
: x.
	$g‘_Çme
())

84  
gs


86 #sk 
t™Ë


87 
def
 
	$sk_t™Ë_cŞumn
(
£lf
, 
node
):

88  
§xuts
.
	`esÿ³
(
node
.
	$g‘_t™Ë
())

90 #sk 
t™Ë
/
Ïb–


91 
def
 
	$sk_Ïb–_cŞumn
(
£lf
, 
node
):

92 
¡r_fÜm©
 = "%s"

94 
node
.
	`g‘_¡©us
(è=ğ
Task
.
STA_ACTIVE
:

95 #w
m¬k
 
š
 
bŞd
 
sks
 
which
 
¬e
 
due
 
today
 
Ü
 
as
 
Now


96 
days_Ëá
 = 
node
.
	$g‘_days_Ëá
()

97 
days_Ëá
 
is
 
nÙ
 
NÚe
 
ªd
 days_left <= 0:

98 
¡r_fÜm©
 = "<b>%s</b>"

99 
£lf
.
	$_has_hidd’_subsk
(
node
):

100 
¡r_fÜm©
 = "<span color='%s'>%s</span>"\

101 % (
£lf
.
uÇùive_cŞÜ
, 
¡r_fÜm©
)

103 
t™Ë
 = 
¡r_fÜm©
 % 
§xuts
.
	`esÿ³
(
node
.
	$g‘_t™Ë
())

104 
node
.
	`g‘_¡©us
(è=ğ
Task
.
STA_ACTIVE
:

105 
couÁ
 = 
£lf
.
mašv›w
.
	`node_n_chd»n
(
node
.
	`g‘_id
(),

106 
»cursive
=
True
)

107 
couÁ
 != 0:

108 
t™Ë
 +ğ" (%s)" % 
couÁ


109 
–if
 
node
.
	`g‘_¡©us
(è=ğ
Task
.
STA_DISMISSED
:

110 
t™Ë
 = "<¥ª cŞÜ='%s'>%s</¥ª>" % (
£lf
.
uÇùive_cŞÜ
,itle)

112 
£lf
.
cÚfig
.
	`g‘
("contents_preview_enable"):

113 
exû½t
 = 
§xuts
.
	`esÿ³
(
node
.
	$g‘_exû½t
(
lšes
=1,

114 
¡r_gs
=
True
,

115 
¡r_subsks
=
True
))

116 
t™Ë
 += " <span size='small' color='%s'>%s</span>" \

117 % (
£lf
.
uÇùive_cŞÜ
, 
exû½t
)

118  
t™Ë


120 #sk 
¡¬t
 
d©e


121 
def
 
	$sk_sd©e_cŞumn
(
£lf
, 
node
):

122  
node
.
	`g‘_¡¬t_d©e
().
	$to_»adabË_¡ršg
()

124 
def
 
	$sk_dued©e_cŞumn
(
£lf
, 
node
):

125 #W
show
 
the
 
mo¡
 
cÚ¡¿ššg
 
due
 
d©e
 
sk
 
w™h
 
no
 du
d©es
.

126 
node
.
	`g‘_due_d©e
(è=ğ
D©e
.
	$no_d©e
():

127  
node
.
	`g‘_due_d©e_cÚ¡¿št
().
	$to_»adabË_¡ršg
()

129 #Oth” 
sks
 
show
 
theœ
 
due
 
	`d©e
 (
which
 *
ÿn
* 
be
 
fuzzy
)

130  
node
.
	`g‘_due_d©e
().
	$to_»adabË_¡ršg
()

132 
def
 
	$sk_cd©e_cŞumn
(
£lf
, 
node
):

133  
node
.
	`g‘_şo£d_d©e
().
	$to_»adabË_¡ršg
()

135 
def
 
	$¡¬t_d©e_sÜtšg
(
£lf
, 
sk1
, 
sk2
, 
Üd”
):

136 
sÜt
 = 
£lf
.
	`__d©e_comp
(
sk1
, 
sk2
, '¡¬t', 
Üd”
)

137  
sÜt


139 
def
 
	$due_d©e_sÜtšg
(
£lf
, 
sk1
, 
sk2
, 
Üd”
):

140 
sÜt
 = 
£lf
.
	`__d©e_comp
(
sk1
, 
sk2
, 'due', 
Üd”
)

141  
sÜt


143 
def
 
	$şo£d_d©e_sÜtšg
(
£lf
, 
sk1
, 
sk2
, 
Üd”
):

144 
sÜt
 = 
£lf
.
	`__d©e_comp
(
sk1
, 
sk2
, 'şo£d', 
Üd”
)

145  
sÜt


147 
def
 
	$t™Ë_sÜtšg
(
£lf
, 
sk1
, 
sk2
, 
Üd”
):

148 
t1
 = 
sk1
.
	$g‘_t™Ë
()

149 
t2
 = 
sk2
.
	$g‘_t™Ë
()

150  (
t1
 > 
t2
) - (t1 <2)

152 
def
 
	$__d©e_comp
(
£lf
, 
sk1
, 
sk2
, 
·¿
, 
Üd”
):

154 
hªdlšg
 
fuzzy
 
d©e
 
ªd
 
com¶ex
 
s™u©iÚ
.

155 
R‘uº
 -1 
nid1
 
is
 
befÜe
 
nid2
,  1 
Ùh”wi£


157 
sk1
 
ªd
 
sk2
:

158 
·¿
 == 'start':

159 
t1
 = 
sk1
.
	$g‘_¡¬t_d©e
()

160 
t2
 = 
sk2
.
	$g‘_¡¬t_d©e
()

161 
–if
 
·¿
 == 'due':

162 
t1
 = 
sk1
.
	$g‘_urg’t_d©e
()

163 
t2
 = 
sk2
.
	$g‘_urg’t_d©e
()

164 
t1
 =ğ
D©e
.
	$no_d©e
():

165 
t1
 = 
sk1
.
	$g‘_due_d©e_cÚ¡¿št
()

166 
t2
 =ğ
D©e
.
	$no_d©e
():

167 
t2
 = 
sk2
.
	$g‘_due_d©e_cÚ¡¿št
()

168 
–if
 
·¿
 == 'closed':

169 
t1
 = 
sk1
.
	$g‘_şo£d_d©e
()

170 
t2
 = 
sk2
.
	$g‘_şo£d_d©e
()

172 
¿i£
 
	`V®ueE¼Ü
(

173 'šv®id d©com·risÚ…¬am‘”: %s'è% 
·¿


174 
sÜt
 = (
t2
 > 
t1
) - (t2 <1)

176 
sÜt
 = 0

178 #loÿÈ
funùiÚ


179 
def
 
	$»v”£_if_desûndšg
(
s
):

181 
u£r
-
¥ecif›d
 
sÜt
 
dœeùiÚ
"""

182 
Üd”
 =ğ
Gtk
.
SÜtTy³
.
ASCENDING
:

183  
s


185  -1 * 
s


187 
sÜt
 == 0:

188 #Grou°
sks
 
w™h
 
the
 
§me
 
g
 
tog‘h”
 
visu®
 
ş—Âess


189 
t1_gs
 = 
sk1
.
	$g‘_gs_Çme
()

190 
t1_gs
.
	$sÜt
()

191 
t2_gs
 = 
sk2
.
	$g‘_gs_Çme
()

192 
t2_gs
.
	$sÜt
()

193 
cmp_gs
 = (
t1_gs
 > 
t2_gs
) - (t1_tags <2_tags)

194 
sÜt
 = 
	$»v”£_if_desûndšg
(
cmp_gs
)

196 
sÜt
 =ğ0: #B»ak 
t›s
 
by
 
sÜtšg
 by 
t™Ë


197 
t1_t™Ë
 = 
sk1
.
	$g‘_t™Ë
()

198 
t2_t™Ë
 = 
sk2
.
	$g‘_t™Ë
()

199 
t1_t™Ë
 = 
loÿË
.
	$¡rxäm
(
t1_t™Ë
)

200 
t2_t™Ë
 = 
loÿË
.
	$¡rxäm
(
t2_t™Ë
)

201 
cmp_t™Ë
 = (
t1_t™Ë
 > 
t2_t™Ë
) - (t1_title <2_title)

202 
sÜt
 = 
	$»v”£_if_desûndšg
(
cmp_t™Ë
)

204  
sÜt


206 #############################
#FunùiÚ 
gs
 
cŞumns


207 #############################
ag_Çme(£lf,‚ode):

208 
Ïb–
 = 
node
.
	`g‘_©Œibu‹
("label")

209 
Ïb–
.
	`¡¬tsw™h
('@'):

210 
Ïb–
 =†abel[1:]

212 
node
.
	`g‘_©Œibu‹
("nonworkview") == "True":

213  "<¥ª cŞÜ='%s'>%s</¥ª>" % (
£lf
.
uÇùive_cŞÜ
, 
Ïb–
)

215  
Ïb–


217 
def
 
	$g‘_g_couÁ
(
£lf
, 
node
):

218 
node
.
	`g‘_id
() == 'search':

221 
tÜ‘uº
 = 
node
.
	$g‘_aùive_sks_couÁ
()

222  "<¥ª cŞÜ='%s'>%s</¥ª>" % (
£lf
.
uÇùive_cŞÜ
,

223 
tÜ‘uº
)

225 
def
 
	$is_g_£·¿tÜ_f‹r
(
£lf
, 
g
):

226  
g
.
	`g‘_©Œibu‹
('special') == 'sep'

228 
def
 
	$g_sÜtšg
(
£lf
, 
t1
, 
t2
, 
Üd”
):

229 
t1_¥
 = 
t1
.
	`g‘_©Œibu‹
("special")

230 
t2_¥
 = 
t2
.
	`g‘_©Œibu‹
("special")

231 
t1_Çme
 = 
loÿË
.
	`¡rxäm
(
t1
.
	$g‘_Çme
())

232 
t2_Çme
 = 
loÿË
.
	`¡rxäm
(
t2
.
	$g‘_Çme
())

233 
nÙ
 
t1_¥
 
ªd
‚Ù 
t2_¥
:

234  (
t1_Çme
 > 
t2_Çme
) - (t1_name <2_name)

235 
–if
 
nÙ
 
t1_¥
 
ªd
 
t2_¥
:

237 
–if
 
t1_¥
 
ªd
 
nÙ
 
t2_¥
:

240 
t1_Üd”
 = 
t1
.
	`g‘_©Œibu‹
("order")

241 
t2_Üd”
 = 
t2
.
	`g‘_©Œibu‹
("order")

242  (
t1_Üd”
 > 
t2_Üd”
) - (t1_order <2_order)

244 
def
 
	$Úg_sk_dnd
(
£lf
, 
sourû
, 
rg‘
):

245 
sk
 = 
£lf
.
»q
.
	$g‘_sk
(
sourû
)

246 
rg‘
.
	`¡¬tsw™h
('@'):

247 
sk
.
	$add_g
(
rg‘
)

248 
–if
 
rg‘
 == 'gtg-tags-none':

249 
t
 
š
 
sk
.
	$g‘_gs_Çme
():

250 
sk
.
	$»move_g
(
t
)

251 
sk
.
	$modif›d
()

254 ######## 
The
 
FaùÜy
 #######################
############################################

255 
def
 
	$gs_Œ“v›w
(
£lf
, 
Œ“
):

256 
desc
 = {
	}
}

258 #Tag 
id


259 
cŞ_Çme
 = 'tag_id'

260 
cŞ
 = {}

261 
cŞ
['»nd””'] = ['m¬kup', 
Gtk
.
C–lR’d””Text
()]

262 
	gcŞ
['v®ue'] = [
¡r
, 
Ïmbda
 
node
:‚ode.
g‘_id
()]

263 
cŞ
['visibË'] = 
F®£


264 
cŞ
['order'] = 0

265 
cŞ
['sÜtšg_func'] = 
£lf
.
g_sÜtšg


266 
desc
[
cŞ_Çme
] = 
cŞ


268 #Tag 
cŞÜ


269 
cŞ_Çme
 = 'color'

270 
cŞ
 = {}

271 
»nd”_gs
 = 
	$C–lR’d””Tags
()

272 
»nd”_gs
.
	`£t_´İ”ty
('ypad', 3)

273 
cŞ
['t™Ë'] = 
	`_
("Tags")

274 
cŞ
['»nd””'] = ['g', 
»nd”_gs
]

275 
cŞ
['v®ue'] = [
GObjeù
.
TYPE_PYOBJECT
, 
Ïmbda
 
node
:‚ode]

276 
cŞ
['ex·ndabË'] = 
F®£


277 
cŞ
['»sizabË'] = 
F®£


278 
cŞ
['order'] = 1

279 
desc
[
cŞ_Çme
] = 
cŞ


281 #Tag 
Çmes


282 
cŞ_Çme
 = 'tagname'

283 
cŞ
 = {
	}
}

284 
»nd”_‹xt
 = 
Gtk
.
	$C–lR’d””Text
()

285 
»nd”_‹xt
.
	`£t_´İ”ty
('ypad', 3)

286 
cŞ
['»nd””'] = ['m¬kup', 
»nd”_‹xt
]

287 
cŞ
['v®ue'] = [
¡r
, 
£lf
.
g_Çme
]

288 
cŞ
['ex·ndabË'] = 
True


289 
cŞ
['Ãw_cŞumn'] = 
F®£


290 
cŞ
['order'] = 2

291 
desc
[
cŞ_Çme
] = 
cŞ


293 #Tag 
couÁ


294 
cŞ_Çme
 = 'tagcount'

295 
cŞ
 = {
	}
}

296 
»nd”_‹xt
 = 
Gtk
.
	$C–lR’d””Text
()

297 
»nd”_‹xt
.
	`£t_´İ”ty
('xpad', 3)

298 
»nd”_‹xt
.
	`£t_´İ”ty
('ypad', 3)

299 
»nd”_‹xt
.
	`£t_´İ”ty
('xalign', 1.0)

300 
cŞ
['»nd””'] = ['m¬kup', 
»nd”_‹xt
]

301 
cŞ
['v®ue'] = [
¡r
, 
£lf
.
g‘_g_couÁ
]

302 
cŞ
['ex·ndabË'] = 
F®£


303 
cŞ
['Ãw_cŞumn'] = 
F®£


304 
cŞ
['order'] = 3

305 
desc
[
cŞ_Çme
] = 
cŞ


307  
£lf
.
	$bud_g_Œ“v›w
(
Œ“
, 
desc
)

309 
def
 
	$aùive_sks_Œ“v›w
(
£lf
, 
Œ“
):

310 #Bud 
the
 
t™Ë
/
Ïb–
/
gs
 
cŞumns


311 
desc
 = 
£lf
.
	`commÚ_desc_fÜ_sks
(
Œ“
, "Tasks")

313 #"
¡¬td©e
" column

314 
cŞ_Çme
 = 'startdate'

315 
cŞ
 = {
	}
}

316 
cŞ
['t™Ë'] = 
_
("Start date")

317 
cŞ
['ex·ndabË'] = 
F®£


318 
cŞ
['»sizabË'] = 
F®£


319 
cŞ
['v®ue'] = [
¡r
, 
£lf
.
sk_sd©e_cŞumn
]

320 
	gcŞ
['order'] = 3

321 
cŞ
['sÜtšg_func'] = 
£lf
.
¡¬t_d©e_sÜtšg


322 
desc
[
cŞ_Çme
] = 
cŞ


324 #'
dued©e
' column

325 
cŞ_Çme
 = 'duedate'

326 
cŞ
 = {}

327 
cŞ
['t™Ë'] = 
_
("Due")

328 
cŞ
['ex·ndabË'] = 
F®£


329 
cŞ
['»sizabË'] = 
F®£


330 
cŞ
['v®ue'] = [
¡r
, 
£lf
.
sk_dued©e_cŞumn
]

331 
	gcŞ
['order'] = 4

332 
cŞ
['sÜtšg_func'] = 
£lf
.
due_d©e_sÜtšg


333 
desc
[
cŞ_Çme
] = 
cŞ


335 #R‘uºšg 
the
 
Œ“v›w


336 
Œ“v›w
 = 
£lf
.
	$bud_sk_Œ“v›w
(
Œ“
, 
desc
)

337 
Œ“v›w
.
	`£t_sÜt_cŞumn
('duedate')

338  
Œ“v›w


340 
def
 
	$şo£d_sks_Œ“v›w
(
£lf
, 
Œ“
):

341 #Bud 
the
 
t™Ë
/
Ïb–
/
gs
 
cŞumns


342 
desc
 = 
£lf
.
	`commÚ_desc_fÜ_sks
(
Œ“
, "Closed Tasks")

344 #"
¡¬td©e
" column

345 
cŞ_Çme
 = 'closeddate'

346 
cŞ
 = {
	}
}

347 
cŞ
['t™Ë'] = 
_
("Closed date")

348 
cŞ
['ex·ndabË'] = 
F®£


349 
cŞ
['»sizabË'] = 
F®£


350 
cŞ
['v®ue'] = [
¡r
, 
£lf
.
sk_cd©e_cŞumn
]

351 
	gcŞ
['order'] = 3

352 
cŞ
['sÜtšg_func'] = 
£lf
.
şo£d_d©e_sÜtšg


353 
desc
[
cŞ_Çme
] = 
cŞ


355 #R‘uºšg 
the
 
Œ“v›w


356 
Œ“v›w
 = 
£lf
.
	$bud_sk_Œ“v›w
(
Œ“
, 
desc
)

357 
Œ“v›w
.
	`£t_sÜt_cŞumn
('closeddate')

358  
Œ“v›w


360 #Thi 
bud
 
the
 
fœ¡
 
g
/
t™Ë
 
cŞumns
, 
commÚ


361 #tØ
bÙh
 
aùive
 
ªd
 
şo£d
 
sks
 
Œ“v›w


362 
def
 
	$commÚ_desc_fÜ_sks
(
£lf
, 
Œ“
, 
t™Ë_Ïb–
):

363 
desc
 = {
	}
}

365 #švisibË 'sk_id' 
cŞumn


366 
cŞ_Çme
 = 'task_id'

367 
cŞ
 = {}

368 
cŞ
['»nd””'] = ['m¬kup', 
Gtk
.
C–lR’d””Text
()]

369 
	gcŞ
['v®ue'] = [
¡r
, 
Ïmbda
 
node
:‚ode.
g‘_id
()]

370 
cŞ
['visibË'] = 
F®£


371 
cŞ
['order'] = 0

372 
desc
[
cŞ_Çme
] = 
cŞ


374 #švisibË 'bg_cŞÜ' 
cŞumn


375 
cŞ_Çme
 = 'bg_color'

376 
cŞ
 = {}

377 
cŞ
['v®ue'] = [
¡r
, 
Ïmbda
 
node
: 
NÚe
]

378 
cŞ
['visibË'] = 
F®£


379 
desc
[
cŞ_Çme
] = 
cŞ


381 #švisibË 't™Ë' 
cŞumn


382 
cŞ_Çme
 = 'title'

383 
cŞ
 = {}

384 
»nd”_‹xt
 = 
Gtk
.
	$C–lR’d””Text
()

385 
»nd”_‹xt
.
	`£t_´İ”ty
("–lsize", 
Pªgo
.
EÎsizeMode
.
END
)

386 
cŞ
['»nd””'] = ['m¬kup', 
»nd”_‹xt
]

387 
cŞ
['v®ue'] = [
¡r
, 
£lf
.
sk_t™Ë_cŞumn
]

388 
cŞ
['visibË'] = 
F®£


389 
cŞ
['order'] = 0

390 
cŞ
['sÜtšg_func'] = 
£lf
.
t™Ë_sÜtšg


391 
desc
[
cŞ_Çme
] = 
cŞ


393 #"
gs
" column (noitle)

394 
cŞ_Çme
 = 'tags'

395 
cŞ
 = {
	}
}

396 
»nd”_gs
 = 
	$C–lR’d””Tags
()

397 
»nd”_gs
.
	`£t_´İ”ty
('xalign', 0.0)

398 
cŞ
['»nd””'] = ['g_li¡', 
»nd”_gs
]

399 
cŞ
['v®ue'] = [
GObjeù
.
TYPE_PYOBJECT
, 
£lf
.
sk_gs_cŞumn
]

400 
cŞ
['ex·ndabË'] = 
F®£


401 
cŞ
['»sizabË'] = 
F®£


402 
cŞ
['order'] = 1

403 
desc
[
cŞ_Çme
] = 
cŞ


405 #"
Ïb–
" column

406 
cŞ_Çme
 = 'label'

407 
cŞ
 = {
	}
}

408 
cŞ
['t™Ë'] = 
	$_
(
t™Ë_Ïb–
)

409 
»nd”_‹xt
 = 
Gtk
.
	$C–lR’d””Text
()

410 
»nd”_‹xt
.
	`£t_´İ”ty
("–lsize", 
Pªgo
.
EÎsizeMode
.
END
)

411 
cŞ
['»nd””'] = ['m¬kup', 
»nd”_‹xt
]

412 
cŞ
['v®ue'] = [
¡r
, 
£lf
.
sk_Ïb–_cŞumn
]

413 
cŞ
['ex·ndabË'] = 
True


414 
cŞ
['»sizabË'] = 
True


415 
cŞ
['sorting'] = 'title'

416 
cŞ
['order'] = 2

417 
desc
[
cŞ_Çme
] = 
cŞ


418  
desc


420 
def
 
	$bud_sk_Œ“v›w
(
£lf
, 
Œ“
, 
desc
):

421 
Œ“v›w
 = 
	$T»eV›w
(
Œ“
, 
desc
)

422 #Now 
th©
 
the
 
Œ“v›w
 
is
 
dÚe
, 
we
 
ÿn
 
pŞish


423 
Œ“v›w
.
	`£t_maš_£¬ch_cŞumn
('label')

424 
Œ“v›w
.
	`£t_ex·nd”_cŞumn
('label')

425 
Œ“v›w
.
	`£t_dnd_Çme
('gtg/task-iter-str')

426 #Background 
cŞÜs


427 
Œ“v›w
.
	`£t_bg_cŞÜ
(
£lf
.
sk_bg_cŞÜ
, 'bg_color')

428 #Glob® 
Œ“v›w
 
´İ”t›s


429 
Œ“v›w
.
	`£t_´İ”ty
("’abË-Œ“-lšes", 
F®£
)

430 
Œ“v›w
.
	$£t_ruËs_hšt
(
F®£
)

431 
Œ“v›w
.
	$£t_muÉË_£ËùiÚ
(
True
)

432 #Upd©šg 
the
 
uÇùive
 
	`cŞÜ
 (
§me
 
ev”yÚe
)

433 
cŞÜ
 = 
Œ“v›w
.
	`g‘_¡yË_cÚ‹xt
().
	$g‘_cŞÜ
(

434 
Gtk
.
S‹FÏgs
.
INSENSITIVE
)

435 #CÚv”ˆ
cŞÜ
 
što
 #RRRGGGBBB

436 
£lf
.
uÇùive_cŞÜ
 = 
cŞÜ
.
	`to_cŞÜ
().
	$to_¡ršg
()

437  
Œ“v›w


439 
def
 
	$bud_g_Œ“v›w
(
£lf
, 
Œ“
, 
desc
):

440 
Œ“v›w
 = 
	$T»eV›w
(
Œ“
, 
desc
)

441 #Glob® 
Œ“v›w
 
´İ”t›s


442 
Œ“v›w
.
	`£t_´İ”ty
("’abË-Œ“-lšes", 
F®£
)

443 
Œ“v›w
.
	$£t_ruËs_hšt
(
F®£
)

444 
Œ“v›w
.
	$£t_row_£·¿tÜ_func
(
£lf
.
is_g_£·¿tÜ_f‹r
)

445 
Œ“v›w
.
	$£t_h—d”s_visibË
(
F®£
)

446 
Œ“v›w
.
	`£t_dnd_Çme
('gtg/tag-iter-str')

447 
Œ“v›w
.
	`£t_dnd_ex‹º®
('gtg/sk-™”-¡r', 
£lf
.
Úg_sk_dnd
)

448 #Upd©šg 
the
 
uÇùive
 
	`cŞÜ
 (
§me
 
ev”yÚe
)

449 
cŞÜ
 = 
Œ“v›w
.
	`g‘_¡yË_cÚ‹xt
().
	$g‘_cŞÜ
(

450 
Gtk
.
S‹FÏgs
.
INSENSITIVE
)

451 #CÚv”ˆ
cŞÜ
 
što
 #RRRGGGBBB

452 
£lf
.
uÇùive_cŞÜ
 = 
cŞÜ
.
	`to_cŞÜ
().
	$to_¡ršg
()

454 
Œ“v›w
.
	`£t_sÜt_cŞumn
('tag_id')

455 
£lf
.
gs_v›w
 = 
Œ“v›w


456  
Œ“v›w


	@gtk/colors.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gdk


18 
äom
 
funùoŞs
 
impÜt
 
»duû


19 
impÜt
 
	g¿ndom


21 #Tak
li¡
 
of
 
Tags
 
ªd
 
give
 
the
 
background
 
cŞÜ
 
th©
 
should
 
be
 
­¶›d


22 #Th
»tuºed
 
cŞÜ
 
might
 
be
 
NÚe
 (
š
 
which
 , 
the
  
is
 
u£d
)

24 
	gu£d_cŞÜ
 = []

27 
def
 
	$background_cŞÜ
(
gs
, 
bgcŞÜ
=
NÚe
):

28 
nÙ
 
bgcŞÜ
:

29 
bgcŞÜ
 = 
Gdk
.
	`cŞÜ_·r£
("#FFFFFF")

30 #Compu‹ 
cŞÜ


31 
my_cŞÜ
 = 
NÚe


32 
cŞÜ_couÁ
 = 0.0

33 
»d
 = 0

34 
g»’
 = 0

35 
blue
 = 0

36 
my_g
 
š
 
gs
:

37 
my_cŞÜ_¡r
 = 
my_g
.
	`g‘_©Œibu‹
("color")

38 
my_cŞÜ_¡r
 
is
 
nÙ
 
NÚe
 
ªd
 my_cŞÜ_¡¸nÙ 
š
 
u£d_cŞÜ
:

39 
u£d_cŞÜ
.
	$­³nd
(
my_cŞÜ_¡r
)

40 
my_cŞÜ_¡r
:

41 
my_cŞÜ
 = 
Gdk
.
	$cŞÜ_·r£
(
my_cŞÜ_¡r
)

42 
cŞÜ_couÁ
 = color_count + 1

43 
»d
 =„ed + 
my_cŞÜ
.red

44 
g»’
 = g»’ + 
my_cŞÜ
.green

45 
blue
 = blu+ 
my_cŞÜ
.blue

46 
cŞÜ_couÁ
 != 0:

47 
»d
 = Ôed / 
cŞÜ_couÁ
)

48 
g»’
 = (g»’ / 
cŞÜ_couÁ
)

49 
blue
 = (blu/ 
cŞÜ_couÁ
)

50 
brighŠess
 = (
»d
 + 
g»’
 + 
blue
) / 3.0

51 
rg‘_brighŠess
 = (
bgcŞÜ
.
»d
 + bgcŞÜ.
g»’
 + bgcŞÜ.
blue
) / 3.0

53 
®pha
 = (1 - 
	`abs
(
brighŠess
 - 
rg‘_brighŠess
) / 65535.0) / 2.0

54 
»d
 = Ôed * 
®pha
 + 
bgcŞÜ
.red * (1 -‡lpha))

55 
g»’
 = (g»’ * 
®pha
 + 
bgcŞÜ
.green * (1 -‡lpha))

56 
blue
 = (blu* 
®pha
 + 
bgcŞÜ
.blue * (1 -‡lpha))

58 
my_cŞÜ
 = 
Gdk
.
	`CŞÜ
(
»d
, 
g»’
, 
blue
).
	$to_¡ršg
()

59  
my_cŞÜ


62 
def
 
	$g‘_cŞÜed_g_m¬kup
(
»q
, 
g_Çme
, 
html
=
F®£
):

64 
Giv’
 
a
 
g
 
Çme
, 
»tuºs
‡ 
¡ršg
 
cÚššg
 
the
 
m¬kup
 
to
 
cŞÜ
he

65 
g
 
Çme


66 
html
, 
»tuºs
 
a
 
¡ršg
 
š£¹abË
 
š
 html

68 
g
 = 
»q
.
	$g‘_g
(
g_Çme
)

69 
g
 
is
 
NÚe
:

70 #nØ
sk
 
lßded
 
w™h
 
th©
 
g
, 
cŞÜ
 
ÿÂÙ
 
be
 
k’


71  
g_Çme


73 
g_cŞÜ
 = 
g
.
	`g‘_©Œibu‹
("color")

74 
g_cŞÜ
:

75 
html
:

76 
fÜm©_¡ršg
 = '<span style="color:%s">%s</span>'

78 
fÜm©_¡ršg
 = '<span color="%s">%s</span>'

79  
fÜm©_¡ršg
 % (
g_cŞÜ
, 
g_Çme
)

81  
g_Çme


84 
def
 
	$g‘_cŞÜed_gs_m¬kup
(
»q
, 
g_Çmes
):

86 
C®ls
 
g‘_cŞÜed_g_m¬kup
 
—ch
 
g_Çme
 
š
 
g_Çmes


88 
g_m¬kups
 = [
	$g‘_cŞÜed_g_m¬kup
(
»q
, 
t
èˆ
š
 
g_Çmes
]

89 
gs_txt
 = ""

90 
g_m¬kups
:

91 #»duû 
üashes
 
­¶›d
 
to
 
ª
 
em±y
 
li¡


92 
gs_txt
 = 
	`»duû
(
Ïmbda
 
a
, 
b
:‡ + ", " + b, 
g_m¬kups
)

93  
gs_txt


96 
def
 
	$g’”©e_g_cŞÜ
():

98 
maxv®ue
 = 65535

99 
æag
 = 0

100 
æag
 == 0):

101 
»d
 = 
¿ndom
.
	$¿ndšt
(0, 
maxv®ue
)

102 
g»’
 = 
¿ndom
.
	$¿ndšt
(0, 
maxv®ue
)

103 
blue
 = 
¿ndom
.
	$¿ndšt
(0, 
maxv®ue
)

104 
my_cŞÜ
 = 
Gdk
.
	`CŞÜ
(
»d
, 
g»’
, 
blue
).
	$to_¡ršg
()

105 
my_cŞÜ
 
nÙ
 
š
 
u£d_cŞÜ
:

106 
æag
 = 1

107 
u£d_cŞÜ
.
	$­³nd
(
my_cŞÜ
)

108  
my_cŞÜ


111 
def
 
	$cŞÜ_add
(
´e£Á_cŞÜ
):

113 
´e£Á_cŞÜ
 
nÙ
 
š
 
u£d_cŞÜ
:

114 
u£d_cŞÜ
.
	$­³nd
(
´e£Á_cŞÜ
)

117 
def
 
	$cŞÜ_»move
(
´e£Á_cŞÜ
):

119 
´e£Á_cŞÜ
 
š
 
u£d_cŞÜ
:

120 
u£d_cŞÜ
.
	$»move
(
´e£Á_cŞÜ
)

	@gtk/crashhandler.py

1 #!/
u¤
/
bš
/
’v
 
pythÚ3


2 #Cİyrighˆ2010 
David
 
D
. 
Lowe


3 #AÎ 
rights
 
»£rved
.

4 #
#P”missiÚ 
is
 
h”eby
 
g¿Áed
, 
ä“
 
of
 
ch¬ge
, 
to
 
ªy
 
³rsÚ
 
obššg
 
a
 
cİy


5 #oà
this
 
soáw¬e
 
ªd
 
assocŸ‹d
 
docum’tiÚ
 
fes
 (
the
 "Soáw¬e"), 
to
 
d—l


6 #š 
the
 
Soáw¬e
 
w™hout
 
»¡riùiÚ
, 
šşudšg
 w™houˆ
lim™©iÚ
h
rights


7 #tØ
u£
, 
cİy
, 
modify
, 
m”ge
, 
publish
, 
di¡ribu‹
, 
subliûn£
, 
ªd
/
Ü
 
£Î


8 #cİ› 
of
 
the
 
Soáw¬e
, 
ªd
 
to
 
³rm™
 
³rsÚs
Ø
whom
hSoáw¬
is


9 #fuºished 
to
 dØ
so
, 
subjeù
Ø
the
 
fŞlowšg
 
cÚd™iÚs
:

10 #
#Th
above
 
cİyright
 
nÙiû
 
ªd
 
this
 
³rmissiÚ
‚Ùiû 
sh®l
 
be
 
šşuded
 
š


11 #®È
cİ›s
 
Ü
 
sub¡ªtŸl
 
pÜtiÚs
 
of
 
the
 
Soáw¬e
.

12 #
#THE 
SOFTWARE
 
IS
 
PROVIDED
 "AS IS", 
WITHOUT
 
WARRANTY
 
OF
 
ANY
 
KIND
, 
EXPRESS
 
OR


13 #IMPLIED, 
INCLUDING
 
BUT
 
NOT
 
LIMITED
 
TO
 
THE
 
WARRANTIES
 
OF
 
MERCHANTABILITY
,

14 #FITNESS 
FOR
 
A
 
PARTICULAR
 
PURPOSE
 
AND
 
NONINFRINGEMENT
. 
IN
 
NO
 
EVENT
 
SHALL
 
THE


15 #AUTHORS 
OR
 
COPYRIGHT
 
HOLDERS
 
BE
 
LIABLE
 
FOR
 
ANY
 
CLAIM
, 
DAMAGES
 OR 
OTHER


16 #LIABILITY, 
WHETHER
 
IN
 
AN
 
ACTION
 
OF
 
CONTRACT
, 
TORT
 
OR
 
OTHERWISE
, 
ARISING
 
FROM
,

17 #OUT 
OF
 
OR
 
IN
 
CONNECTION
 
WITH
 
THE
 
SOFTWARE
 OR THE 
USE
 OR 
OTHER
 
DEALINGS
 IN

18 #THE 
SOFTWARE
.

21 
To
 
	gu£
, 
sim¶y
 
impÜt
 
this
 
moduË
 
ªd
 
ÿÎ
 
	ggtküashhªdËr
.
š™Ÿlize
().

22 
ImpÜt
 
this
 
moduË
 
befÜe
 
ÿÎšg
 
	gGtk
.
maš
().

24 
If
 
gtküashhªdËr
 
ÿÂÙ
 
impÜt
 
	gGtk
, 
Pªgo
 
Ü
 
	gGObjeù
,

25 
gtküashhªdËr
 
wl
 
´št
 
a
 
w¬nšg
 
ªd
 
u£
 
the
  
	gexû±hook
.

27 
If
 
	gyou
're using multiplehreads, use gtkcrashhandler_thread decorator."""

29 
impÜt
 
sys


30 
impÜt
 
os


31 
impÜt
 
time


32 
impÜt
 
sigÇl


33 
impÜt
 
Œaûback


34 
impÜt
 
th»adšg


35 
äom
 
cÚ‹xib
 
impÜt
 
cÚ‹xtmªag”


37 
äom
 
GTG
 
impÜt
 
šfo


40 
	gŒy
:

41 
äom
 
gi
.
»pos™Üy
 
impÜt
 
GObjeù
, 
	gGtk
, 
Pªgo


42 
exû±
 
	gExû±iÚ
:

43 
sys
.
¡d”r
.
wr™e
("gtkcrashhandler could‚ot†oad GTK 3.0\n")

44 
_gtk_š™Ÿlized
 = 
F®£


46 
_gtk_š™Ÿlized
 = 
True


48 
äom
 
g‘‹xt
 
impÜt
 g‘‹xˆ
as
 
_


50 
APP_NAME
 = 
NÚe


51 
MESSAGE
 = 
_
("We'reerribly sorry. Could you help us fixhe…roblem by "

53 
USE_APPORT
 = 
F®£


55 
_Şd_sys_exû±hook
 = 
NÚe
 #NÚ
m—ns
 
th©
 
	$š™Ÿlize
(è
has
 
nÙ
 
b“n
 
ÿÎed


58 
dŸlog
 = 
NÚe


61 
def
 
	$š™Ÿlize
(
­p_Çme
=
NÚe
, 
mes§ge
=NÚe, 
u£_­pÜt
=
F®£
):

64 @
·¿m
 
­p_Çme
: 
The
 
cu¼’t
 
­¶iÿtiÚ
's‚ameo be„ead by humans,

65 
uÁ¿n¦©ed
.

66 @
·¿m
 
mes§ge
: 
A
 mes§g
th©
 
wl
 
be
 
di¥Ïyed
 
š
 
the
 
”rÜ
 
dŸlog
,

67 
»¶acšg
 
the
  
mes§ge
 
¡ršg
. 
UÁ¿n¦©ed
.

68 
If
 
you
 
dÚ
't want‡ message,…ass "".

69 @
·¿m
 
u£_­pÜt
: 
If
 
£t
 
to
 
True
, 
gtküashhªdËr
 
wl
 
ov”ride


70 
the
 
£‰šgs
 
š
 /
‘c
//
­pÜt
 
ªd
 
ÿÎ
‡µÜˆ
possibË
,

71 
s’y
 
çšg
 
nÙ
. 
If
 
£t
 
to
 
F®£
, 
the
 
nÜm®
 
behaviour
 
wl


72 
be
 
execu‹d
, 
which
 
may
 
m—n
 
AµÜt
 
kickšg
 
š
 
ªyway
.

74 
glob®
 
APP_NAME
, 
MESSAGE
, 
USE_APPORT
, 
_gtk_š™Ÿlized
, 
_Şd_sys_exû±hook


75 
­p_Çme
:

76 
APP_NAME
 = 
	$_
(
­p_Çme
)

77 
nÙ
 
mes§ge
 
is
 
NÚe
:

78 
MESSAGE
 = 
	$_
(
mes§ge
)

79 
u£_­pÜt
:

80 
USE_APPORT
 = 
u£_­pÜt


81 
_gtk_š™Ÿlized
 
is
 
True
 
ªd
 
_Şd_sys_exû±hook
 i 
NÚe
:

82 #§v
sys
.
exû±hook
 
fœ¡
, 
as
 
™
 
may
 
nÙ
 
be
 sys.
__exû±hook__


83 #(
exam¶e
, 
™
 
might
 
be
 
AµÜt
's…ython hook)

84 
_Şd_sys_exû±hook
 = 
sys
.
exû±hook


85 #»¶aû 
sys
.
exû±hook
 
w™h
 
our
 
own


86 
sys
.
exû±hook
 = 
_»¶aûm’t_exû±hook


89 
def
 
	$_»¶aûm’t_exû±hook
(
ty³
, 
v®ue
, 
Œaûbk
, 
th»ad
=
NÚe
):

91 #ü—‹ 
Œaûback
 
¡ršg
 
ªd
 
´št
 
™


92 
tb
 = "".
	`još
(
Œaûback
.
	$fÜm©_exû±iÚ
(
ty³
, 
v®ue
, 
Œaûbk
))

93 
th»ad
:

94 
nÙ
 
	$isš¡ªû
(
th»ad
, 
th»adšg
.
_MašTh»ad
):

95 
tb
 = "Exû±iÚ iÀth»ad %s:\n%s" % (
th»ad
.
	`g‘Name
(),b)

97 
sys
.
¡d”r
.
	`wr™e
(
tb
 + '\n')

99 #d‘”mš
wh‘h”
 
to
 
add
 
a
 "R•Üˆ´obËm..." 
bu‰Ú


100 
add_­pÜt_bu‰Ú
 = 
F®£


101 
glob®
 
USE_APPORT


102 
USE_APPORT
:

103 #£
this
 
fe
 
is
 
äom
 
a
 
´İ”ly
 
š¡®Ëd
 
di¡ributiÚ
 
·ckage


104 
Œy
:

105 
äom
 
­pÜt
.
feuts
 
impÜt
 
lik–y_·ckaged


106 
Œy
:

107 
f’ame
 = 
os
.
·th
.
	`»®·th
(os.·th.
	`još
(os.
	`g‘cwd
(),

108 
sys
.
¬gv
[0]))

109 
exû±
:

110 
f’ame
 = 
os
.
·th
.
	`»®·th
("/´oc/%i/exe" % os.
	$g‘pid
())

111 
nÙ
 
os
.
·th
.
	$isfe
(
f’ame
è
Ü
 \

112 
nÙ
 
os
.
	$acûss
(
f’ame
, 
os
.
X_OK
):

113 
¿i£
 
	$Exû±iÚ
()

114 
add_­pÜt_bu‰Ú
 = 
	$lik–y_·ckaged
(
f’ame
)

115 
exû±
:

116 
add_­pÜt_bu‰Ú
 = 
F®£


118 
»s
 = 
	$show_”rÜ_wšdow
(
tb
, 
add_­pÜt_bu‰Ú
=add_apport_button)

120 
»s
 =ğ3: #»pÜˆ
bu‰Ú
 
şicked


121 #’abË 
­pÜt
, 
ov”ridšg
 
´eã»nûs


122 
Œy
:

123 #ü—‹ 
Ãw
 
‹mpÜ¬y
 
cÚfigu¿tiÚ
 
fe
, 
wh”e
 
’abËd
=1

124 
impÜt
 
»


125 
äom
 
­pÜt
.
·ckagšg_im¶
 
impÜt
 
im¶
 
as
 
­pÜt_·ckagšg


126 
ÃwcÚfigu¿tiÚ
 = "#emporary‡pport configuration file " \

128 
Œy
:

129 
lše
 
š
 
	$İ’
(
­pÜt_·ckagšg
.
cÚfigu¿tiÚ
):

130 
»
.
	`£¬ch
('^\s*’abËd\s*=\s*0\s*$', 
lše
è
is
 
NÚe
:

131 
ÃwcÚfigu¿tiÚ
 +ğ
lše


132 
fš®ly
:

133 
ÃwcÚfigu¿tiÚ
 += "enabled=1"

134 
impÜt
 
‹mpfe


135 
‹mpfe
, 
‹mpf’ame
 =empfe.
	$mk¡emp
()

136 
os
.
	$wr™e
(
‹mpfe
, 
ÃwcÚfigu¿tiÚ
)

137 
os
.
	$şo£
(
‹mpfe
)

139 #£ˆ
­pÜt
 
to
 
u£
 
this
 
cÚfigu¿tiÚ
 
fe
, 
‹mpÜ¬y


140 
­pÜt_·ckagšg
.
cÚfigu¿tiÚ
 = 
‹mpf’ame


141 #ov”rid
AµÜt
's ignore settings forhis‡pp

142 
äom
 
­pÜt
.
»pÜt
 
impÜt
 
R•Üt


143 
R•Üt
.
check_ignÜed
 = 
Ïmbda
 
£lf
: 
F®£


144 
exû±
:

145 
·ss


147 
»s
 
	$š
 (2, 3): #quit

148 
sys
.
¡d”r
 = 
os
.
	$tmpfe
()

149 
glob®
 
_Şd_sys_exû±hook


150 
	$_Şd_sys_exû±hook
(
ty³
, 
v®ue
, 
Œaûbk
)

151 
sys
.
¡d”r
 = sys.
__¡d”r__


152 
os
.
	$_ex™
(1)

155 
def
 
	$show_”rÜ_wšdow
(
”rÜ_¡ršg
, 
add_­pÜt_bu‰Ú
=
F®£
):

158 
”rÜ_¡ršg
 -- 
the
 
”rÜ
's output (usually‡raceback)

159 
add_­pÜt_bu‰Ú
 -- 
wh‘h”
 
to
 
add
 
a
 '»pÜˆw™h‡µÜt' 
bu‰Ú


161 
R‘uºs
 
the
 
»¥Ú£
 
ID
 
of
h
dŸlog
, 1 
ignÜe
, 2 
şo£
 
ªd


162 3 
­pÜt
.

164 #š™Ÿliz
dŸlog


165 
t™Ë
 = 
	`_
("Anƒrror has occurred")

166 
glob®
 
APP_NAME


167 
APP_NAME
:

168 
t™Ë
 = 
APP_NAME


169 
glob®
 
dŸlog


170 #DØ
nÙ
 
®low
 
mÜe
 
thª
 
Úe
 
”rÜ
 
wšdow


171 
dŸlog
 
is
 
nÙ
 
NÚe
:

174 
dŸlog
 = 
Gtk
.
	$DŸlog
(
t™Ë
)

176 #t™Ë 
Lab–


177 
Ïb–
 = 
Gtk
.
	$Lab–
()

178 
Ïb–
.
	`£t_m¬kup
("<b>%s</b>" % 
	`_
("It†ooks†ike‡nƒrror has occurred."))

179 
Ïb–
.
	$£t_®ignm’t
(0, 0.5)

180 
dŸlog
.
	`g‘_cÚ‹Á_¬—
().
	$·ck_¡¬t
(
Ïb–
, 
F®£
, 
True
, 0)

182 #mes§g
Lab–


183 
glob®
 
MESSAGE


184 
‹xt_Ïb–
 = 
Gtk
.
	$Lab–
()

185 
‹xt_Ïb–
.
	$£t_m¬kup
(
MESSAGE
)

186 
‹xt_Ïb–
.
	$£t_®ignm’t
(0, 0.5)

187 
‹xt_Ïb–
.
	$£t_lše_w¿p
(
True
)

189 
def
 
	$‹xt_Ïb–_size_®loÿ‹
(
widg‘
, 
»ù
):

191 
widg‘
.
	`£t_size_»que¡
(
»ù
.
width
, -1)

193 
‹xt_Ïb–
.
	`cÚÃù
("size-®loÿ‹", 
‹xt_Ïb–_size_®loÿ‹
)

194 
nÙ
 
MESSAGE
 == "":

195 
dŸlog
.
	`g‘_cÚ‹Á_¬—
().
	$·ck_¡¬t
(
‹xt_Ïb–
, 
F®£
, 
True
, 0)

197 #TextV›w 
w™h
 
”rÜ_¡ršg


198 
bufãr
 = 
Gtk
.
	$TextBufãr
()

199 
bufãr
.
	$£t_‹xt
(
”rÜ_¡ršg
)

200 
‹xtv›w
 = 
Gtk
.
	$TextV›w
()

201 
‹xtv›w
.
	$£t_bufãr
(
bufãr
)

202 
‹xtv›w
.
	$£t_ed™abË
(
F®£
)

203 
Œy
:

204 
‹xtv›w
.
	`ov”ride_fÚt
(
Pªgo
.
	`FÚtDesütiÚ
("monospace 8"))

205 
exû±
 
Exû±iÚ
:

206 
sys
.
¡d”r
.
	`wr™e
(

209 #®low 
süŞlšg
 
of
 
‹xtv›w


210 
süŞËd
 = 
Gtk
.
	$SüŞËdWšdow
()

211 
süŞËd
.
	$£t_pŞicy
(
Gtk
.
PŞicyTy³
.
AUTOMATIC
, Gtk.PolicyType.AUTOMATIC)

212 
süŞËd
.
	$add_w™h_v›wpÜt
(
‹xtv›w
)

214 #hid
the
 
‹xtv›w
 
š
 
ª
 
Ex·nd”
 
widg‘


215 
ex·nd”
 = 
Gtk
.
	`ex·nd”_Ãw_w™h_mÃmÚic
(
	`_
("_Details"))

216 
ex·nd”
.
	$add
(
süŞËd
)

217 
ex·nd”
.
	`cÚÃù
('aùiv©e', 
Ú_ex·nded
)

218 
dŸlog
.
	`g‘_cÚ‹Á_¬—
().
	$·ck_¡¬t
(
ex·nd”
, 
True
, True, 0)

220 #add 
bu‰Ús


221 
add_­pÜt_bu‰Ú
:

222 
dŸlog
.
	`add_bu‰Ú
(
	`_
("_Reporthis…roblem..."), 3)

223 #Ià
we
'» havmuÉËh»ads, o¸iàwe'
»
 
š
 
a
 
GTK
 
ÿÎback
,

224 #executiÚ 
ÿn
  
nÜm®ly
 
š
 
Ùh”
 
th»ads
, 
so
 
add
 
bu‰Ú


225 
Gtk
.
	`maš_Ëv–
(è> 0 
Ü
 
th»adšg
.
	`aùiveCouÁ
() > 1:

226 
dŸlog
.
	`add_bu‰Ú
(
	`_
("_Ignoreheƒrror"), 1)

227 
dŸlog
.
	`add_bu‰Ú
(("_Closehe…rogram"), 2)

228 
dŸlog
.
	$£t_deçuÉ_»¥Ú£
(2)

230 #£ˆ
dŸlog
 
«¡h‘ic
 
´eã»nûs


231 
dŸlog
.
	$£t_bÜd”_width
(12)

232 
dŸlog
.
	`g‘_cÚ‹Á_¬—
().
	$£t_¥acšg
(4)

233 
dŸlog
.
	$£t_»sizabË
(
F®£
)

235 #show 
the
 
dŸlog
 
ªd
 
aù
 
Ú
 
™


236 
dŸlog
.
	$show_®l
()

237 
»s
 = 
dŸlog
.
	$run
()

238 
dŸlog
.
	$de¡roy
()

239 
»s
 < 0:

240 
»s
 = 2

241  
»s


244 
def
 
	$Ú_ex·nded
(
widg‘
):

245 
glob®
 
dŸlog


246 
dŸlog
.
	$£t_size_»que¡
(600, 600)

249 
def
 
	$gtküashhªdËr_th»ad
(
run
):

251 
th»adšg
.
Th»ad
.

253 
If
 
you
 
fÜg‘
 
to
 
u£
 
this
 
decÜ©Ü
, 
exû±iÚs
 
š
 
th»ads
 
wl
 
be


254 
´š‹d
 
to
 
¡ªd¬d
 
”rÜ
 
ouut
, 
ªd
 
GTK
's main†oop will continueo„un.

258 
şass
 
	$Exam¶eTh»ad
(
th»adšg
.
Th»ad
):

259 
E
{@
	}

}gtküashhªdËr_th»ad


260 
def
 
	$run
(
£lf
):

261 1 / 0 #thi 
”rÜ
 
wl
 
be
 
ÿught
 
by
 
gtküashhªdËr


265 
def
 
	$funùiÚ
(
¬g
):

266 
¬g
 / 0 #thi 
”rÜ
 
wl
 
be
 
ÿught
 
by
 
gtküashhªdËr


267 
th»adšg
.
	`Th»ad
(
rg‘
=
	`gtküashhªdËr_th»ad
(
funùiÚ
),
¬gs
=(1,))

268 .
	`¡¬t
()

271 
def
 
	$gtküashhªdËr_w¿µed_run
(*
¬gs
, **
kw¬gs
):

272 
Œy
:

273 
	$run
(*
¬gs
, **
kw¬gs
)

274 
exû±
 
Exû±iÚ
 
as
 
“
:

275 
lock
 = 
th»adšg
.
	$Lock
()

276 
lock
.
	$acquœe
()

277 
tb
 = 
sys
.
	`exc_šfo
()[2]

278 
Gtk
.
	`maš_Ëv–
() > 0:

279 
GObjeù
.
	`idË_add
(

280 
Ïmbda
 
“
óe, 
tb
ñb, 
th»ad
=
th»adšg
.
	$cu¼’tTh»ad
():

281 
	$_»¶aûm’t_exû±hook
(
“
.
__şass__
,ƒe, 
tb
,

282 
th»ad
=thread))

284 
time
.
	$¦“p
(0.1è#ugly 
hack
, 
£ems
 
like
 
th»ads
 
th©
 
¬e


285 #¡¬‹d 
befÜe
 
ruÂšg
 
Gtk
.
	`maš
(è
ÿu£


286 #thi 
Úe
 
to
 
üash
.

287 #Thi 
d–ay
 
®lows
 
Gtk
.
	`maš
(è
to
 
š™Ÿlize


289 #My 
adviû
: 
run
 
Gtk
.
	`maš
(è
befÜe
 
¡¬tšg


290 #ªy 
th»ads
 
Ü
 
dÚ
't„un Gtk.main()‡t‡ll

291 
	`_»¶aûm’t_exû±hook
(
“
.
__şass__
,ƒe, 
tb
,

292 
th»ad
=
th»adšg
.
	$cu¼’tTh»ad
())

293 
lock
.
	$»Ëa£
()

295 #»tuº 
w¿µed
 
run
 
GtküashhªdËr
 
has
 
b“n
 
š™Ÿlized


296 
glob®
 
_gtk_š™Ÿlized
, 
_Şd_sys_exû±hook


297 
_gtk_š™Ÿlized
 
ªd
 
_Şd_sys_exû±hook
:

298  
gtküashhªdËr_w¿µed_run


300  
run


302 
__Çme__
 == "__main__":

303 #throw 
‹¡
 
exû±iÚ


304 
	`š™Ÿlize
(
­p_Çme
="gtküashhªdËr", 
mes§ge
="Don't worry,hough. This "

309 
şass
 
	$DoNÙRunExû±iÚ
(
Exû±iÚ
):

311 
def
 
	$__¡r__
(
£lf
):

314 
¿i£
 
	$DoNÙRunExû±iÚ
()

317 ## 
We
 
hªdË
 
š™Ÿliz©iÚ
 
dœeùly
 
h”e
, 
sšû
 
this
 
moduË
 
wl
 
be
 
u£d
 
as
 
a


319 #w
li¡’
 
sigÇls
 
äom
 
the
 
sy¡em
 
š
 
Üd”
 
to
 
§ve
 
our
 
cÚfigu¿tiÚ


320 #ià
GTG
 
is
 
fÜûfuÎy
 
	`‹rmš©ed
 (
e
.
g
.: 
Ú
 
shutdown
).

322 @
cÚ‹xtmªag”


323 
def
 
	$sigÇl_ÿtch”
(
ÿÎback
):

324 #ià
TERM
 
Ü
 
ABORT
 
¬e
 
ÿught
, 
we
 
execu‹
 
the
 
ÿÎback
 
funùiÚ


325 
s
 
š
 [
sigÇl
.
SIGABRT
, sigÇl.
SIGTERM
]:

326 
sigÇl
.
	`sigÇl
(
s
, 
Ïmbda
 
a
, 
b
: 
	$ÿÎback
())

327 
y›ld


329 
	`š™Ÿlize
(
­p_Çme
="Getting Things GNOME!",

330 
mes§ge
=
	`_
(

335 è% 
šfo
.
VERSION
,

336 
u£_­pÜt
=
True
)

	@gtk/dbuswrapper.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
impÜt
 
dbus


19 
impÜt
 
	gdbus
.
glib


20 
impÜt
 
	gdbus
.
£rviû


22 
äom
 
	gGTG
.
cÜe
 
impÜt
 
CÜeCÚfig


23 
äom
 
	gGTG
.
	gtoŞs
.
d©es
 
impÜt
 
D©e


24 
äom
 
	gGTG
.
	gcÜe
.
£¬ch
 
impÜt
 
Inv®idQu”y


25 
äom
 
	gGTG
.
	gcÜe
.
£¬ch
 
impÜt
 
·r£_£¬ch_qu”y


27 
	gBUSNAME
 = 
CÜeCÚfig
.
BUSNAME


28 
BUSFACE
 = 
CÜeCÚfig
.
BUSINTERFACE


31 
def
 
	$d§n™ize
(
d©a
):

33 
CËª
 
up
 
a
 
diù
 
so
 
th©
 
™
 
ÿn
 
be
 
Œªsm™‹d
 
through
 
D
-
Bus
.

34 
D
-
Bus
 
dÛs
 
nÙ
 
have
 
cÚû±s
 
em±y
 
Ü
 
nuÎ
 
¬¿ys
 o¸
v®ues


35 
so
 
the£
 
Ãed
 
to
 
be
 
cÚv”‹d
 
što
 
bÏnk
 
v®ues
 
D
-
Bus
 
acû±s
.

36 @: 
CËªed
 
up
 
diùiÚ¬y


38 
k
, 
v
 
š
 
	`li¡
(
d©a
.
	$™ems
()):

39 #Mªu®ly 
¥ecify
 
ª
 
¬b™¿ry
 
cÚ‹Á
 
ty³
 
em±y
 
PythÚ
 
¬¿ys


40 #beÿu£ 
D
-
Bus
 
ÿn
't handleheype conversion forƒmpty‡rrays

41 
nÙ
 
v
 
ªd
 
	$isš¡ªû
(
v
, 
li¡
):

42 
d©a
[
k
] = 
dbus
.
	`A¼ay
([], "s")

43 #D-
Bus
 
has
 
no
 
cÚû±
 
of
 
a
 
nuÎ
 
Ü
 
em±y
 
v®ue
 
so
 
we
 
have
 
to
 
cÚv”t


44 #NÚ
ty³s
 
to
 
som‘hšg
 . 
I
 
u£
 
ª
 
em±y
 
¡ršg
 
beÿu£
 
™
 
has


45 #th
§me
 
behaviÜ
 
as
 
NÚe
 
š
 
a
 
PythÚ
 
cÚd™iÚ®
 
ex´essiÚ


46 
–if
 
v
 
is
 
NÚe
:

47 
d©a
[
k
] = ""

49  
d©a


52 
def
 
	$sk_to_diù
(
sk
):

54 
T¿n¦©e
 
a
 
sk
 
objeù
 
što
‡ 
D
-
Bus
 
diùiÚ¬y


56 
nÙ
 
sk
:

57  
NÚe


58  
dbus
.
	`DiùiÚ¬y
(
	`d§n™ize
({

59 "id": 
sk
.
	`g‘_id
(),

60 "¡©us": 
sk
.
	`g‘_¡©us
(),

61 "t™Ë": 
sk
.
	`g‘_t™Ë
(),

62 "dued©e": 
	`¡r
(
sk
.
	`g‘_due_d©e
()),

63 "¡¬td©e": 
	`¡r
(
sk
.
	`g‘_¡¬t_d©e
()),

64 "dÚed©e": 
	`¡r
(
sk
.
	`g‘_şo£d_d©e
()),

65 "gs": 
sk
.
	`g‘_gs_Çme
(),

66 "‹xt": 
sk
.
	`g‘_‹xt
(),

67 "subsk": 
sk
.
	`g‘_chd»n
(),

68 "·»Ás": 
sk
.
	`g‘_·»Ás
(),

69 
	}
}), 
	gsigÇtu»
="sv")

72 
şass
 
	$DBusTaskW¿µ”
(
dbus
.
£rviû
.
Objeù
):

74 
D
-
Bus
 
£rviû
 
objeù
 
th©
 
expo£s
 
GTG
'sask storeohird-party‡pps

77 
def
 
	$__š™__
(
£lf
, 
»q
, 
v›w_mªag”
):

78 #A‰ach 
the
 
objeù
 
to
 
D
-
Bus


79 
£lf
.
bus
 = 
dbus
.
	$SessiÚBus
()

80 
bus_Çme
 = 
dbus
.
£rviû
.
	$BusName
(
BUSNAME
, 
bus
=
£lf
.bus)

81 
dbus
.
£rviû
.
Objeù
.
	$__š™__
(
£lf
, 
bus_Çme
, 
BUSFACE
)

82 
£lf
.
»q
 =„eq

83 
£lf
.
v›w_mªag”
 = view_manager

85 #S¹ 
li¡’šg
 
sigÇls
 
äom
 
GTG
 
cÜe


86 
sk_Œ“
 = 
£lf
.
»q
.
	$g‘_maš_v›w
()

87 
sk_Œ“
.
	`»gi¡”_şlbck
('node-added', 
Ïmbda
 
tid
, 
_
:

88 
£lf
.
	$TaskAdded
(
tid
))

89 
sk_Œ“
.
	`»gi¡”_şlbck
('node-modif›d', 
Ïmbda
 
tid
, 
_
:

90 
£lf
.
	$TaskModif›d
(
tid
))

91 
sk_Œ“
.
	`»gi¡”_şlbck
('node-d–‘ed', 
Ïmbda
 
tid
, 
_
:

92 
£lf
.
	`TaskD–‘ed
(
tid
))

94 @
dbus
.
£rviû
.
	$m‘hod
(
BUSNAME
)

95 
def
 
	$G‘Task
(
£lf
, 
tid
):

97 
R‘r›ve
 
a
 
¥ecific
 
sk
 
by
 
ID
 
ªd
  
the
 
d©a


99 
tÜ‘
 = 
	`sk_to_diù
(
£lf
.
»q
.
	$g‘_sk
(
tid
))

100  
tÜ‘


102 @
dbus
.
£rviû
.
	$m‘hod
(
BUSNAME
)

103 
def
 
	$G‘Tasks
(
£lf
):

105 
R‘r›ve
 
a
 
li¡
 
of
 
sk
 
d©a
 
diùs


107  
£lf
.
	`G‘TasksF‹»d
(['all'])

109 @
dbus
.
£rviû
.
	`m‘hod
(
BUSNAME
, 
š_sigÇtu»
="as")

110 
def
 
	$G‘AùiveTasks
(
£lf
, 
gs
):

112 
R‘r›ve
 
a
 
li¡
 
of
 
sk
 
d©a
 
diùs


114  
£lf
.
	`G‘TasksF‹»d
(['active', 'workable'])

116 @
dbus
.
£rviû
.
	`m‘hod
(
BUSNAME
, 
š_sigÇtu»
="as")

117 
def
 
	$G‘TaskIdsF‹»d
(
£lf
, 
f‹rs
):

119 
F‹rs
 
the
 
sk
 
li¡
 
ªd
 
´ovides
†i¡ 
of
 
»maššg
 
ids


120 @
·¿m
: 
Li¡
 
of
 
¡ršgs
 
f‹rs
 
to
 
­¶y
. 
S“
 
the


121 
f‹rs_bªk
 
docum’tiÚ
 
a
 
li¡
 
of
 
¡ock
 
f‹rs
.

122 @: 
Li¡
 
of
 
ids


124 
Œ“
 = 
£lf
.
»q
.
	`g‘_sks_Œ“
().
	$g‘_ba£Œ“
()

125 
v›w
 = 
Œ“
.
	$g‘_v›wŒ“
()

126 
f‹r
 
š
 
f‹rs
:

127 
f‹r
[0] == '!':

128 
v›w
.
	`­¶y_f‹r
(
f‹r
[1:], 
·¿m‘”s
={'Ãg©e': 1
	}
})

130 
v›w
.
	$­¶y_f‹r
(
f‹r
)

131  
v›w
.
	`g‘_®l_nodes
()

133 @
dbus
.
£rviû
.
	`m‘hod
(
BUSNAME
, 
š_sigÇtu»
="as")

134 
def
 
	$G‘TasksF‹»d
(
£lf
, 
f‹rs
):

136 
G‘s
 
a
 
li¡
 
of
 
sks
 
the
 
giv’
 
f‹rs


137 @
·¿m
: 
Li¡
 
of
 
¡ršgs
 
f‹rs
 
to
 
­¶y
. 
S“
 
the


138 
f‹rs_bªk
 
docum’tiÚ
 
a
 
li¡
 
of
 
¡ock
 
f‹rs
.

139 @: 
Li¡
 
of
 
sk
 
diùs


141 
sks
 = 
£lf
.
	$G‘TaskIdsF‹»d
(
f‹rs
)

142 
sks
:

143  [
£lf
.
	$G‘Task
(
id
èid 
š
 
sks
]

145  
dbus
.
	`A¼ay
([], "s")

147 @
dbus
.
£rviû
.
	`m‘hod
(
BUSNAME
, 
š_sigÇtu»
="s")

148 
def
 
	$S—rchTasks
(
£lf
, 
qu”y
):

150 
S—rches
 
the
 
sk
 
li¡


152 
Œ“
 = 
£lf
.
»q
.
	`g‘_sks_Œ“
().
	$g‘_ba£Œ“
()

153 
v›w
 = 
Œ“
.
	$g‘_v›wŒ“
()

154 
Œy
:

155 
£¬ch
 = 
	$·r£_£¬ch_qu”y
(
qu”y
)

156 
v›w
.
	`­¶y_f‹r
('£¬ch', 
·¿m‘”s
=
£¬ch
)

157 
sks
 = 
v›w
.
	$g‘_®l_nodes
()

158 
sks
:

159  [
£lf
.
	$G‘Task
(
id
èid 
š
 
sks
]

160 
exû±
 
Inv®idQu”y
:

161 
·ss


162  
dbus
.
	`A¼ay
([], "s")

164 @
dbus
.
£rviû
.
	$m‘hod
(
BUSNAME
)

165 
def
 
	$HasTask
(
£lf
, 
tid
):

167 
R‘uºs
 
Œue
 
the
 
sk
 
id
 
is
 
´e£Á
 
š
hsk 
back’d
.

168 
Task
 
could
 
be
 
e™h”
 
İ’
 
Ü
 
şo£d
, 
but
 
nÙ
 
d–‘ed
.

170  
£lf
.
»q
.
	`has_sk
(
tid
)

172 @
dbus
.
£rviû
.
	$m‘hod
(
BUSNAME
)

173 
def
 
	$D–‘eTask
(
£lf
, 
tid
):

175 
D–‘e
 
the
 
giv’
 
sk
 
id
 
äom
h
»pos™Üy
.

177 
£lf
.
»q
.
	`d–‘e_sk
(
tid
)

179 @
dbus
.
£rviû
.
	`m‘hod
(
BUSNAME
, 
š_sigÇtu»
="sssssassas")

180 
def
 
	$NewTask
(
£lf
, 
¡©us
, 
t™Ë
, 
dued©e
, 
¡¬td©e
, 
dÚed©e
, 
gs
,

181 
‹xt
, 
subsks
):

183 
G’”©e
 
a
 
Ãw
 
sk
 
objeù
 
ªd
  
the
ask 
d©a
 
as
‡ 
diù


184 @
·¿m
 
¡©us
: 
OÃ
 
of
 'Aùive', 'Dismiss', 
Ü
 'Done'

185 @
·¿m
 
t™Ë
: 
SŒšg
 
Çme
 
of
 
the
 
sk


186 @
·¿m
 
dued©e
: 
D©e
 
the
 
sk
 
is
 
due
, 
such
 
as
 "2010-05-01".

187 
®so
 
suµÜts
 'now', 'soon', 'someday'

188 @
·¿m
 
¡¬td©e
: 
D©e
 
the
 
sk
 
wl
 
be
 
¡¬‹d


189 @
·¿m
 
dÚed©e
: 
D©e
 
the
 
sk
 
was
 
fšished


190 @
·¿m
 
gs
: 
Li¡
 
of
 
¡ršgs
 g 
to
 
­¶y
 
this
 
sk


191 @
·¿m
 
‹xt
: 
SŒšg
 
desütiÚ


192 @
·¿m
 
subsks
: 
A
 
li¡
 
of
 
sk
 
ids
 oà
sks
 
to
 
add
 
as
 
chd»n


193 @: 
A
 
diùiÚ¬y
 
w™h
 
the
 
d©a
 
of
h
Ãwly
 
ü—‹d
 
sk


195 
Á
 = 
£lf
.
»q
.
	$Ãw_sk
(
gs
=tags)

196 
sub
 
š
 
subsks
:

197 
Á
.
	$add_chd
(
sub
)

198 
Á
.
	`£t_¡©us
(
¡©us
, 
dÚed©e
=
D©e
.
	$·r£
(
dÚed©e
))

199 
Á
.
	$£t_t™Ë
(
t™Ë
)

200 
Á
.
	`£t_due_d©e
(
D©e
.
	$·r£
(
dued©e
))

201 
Á
.
	`£t_¡¬t_d©e
(
D©e
.
	$·r£
(
¡¬td©e
))

202 
Á
.
	$£t_‹xt
(
‹xt
)

203  
	`sk_to_diù
(
Á
)

205 @
dbus
.
£rviû
.
	$m‘hod
(
BUSNAME
)

206 
def
 
	$ModifyTask
(
£lf
, 
tid
, 
sk_d©a
):

208 
Upd©es
 
the
 
sk
 
w™h
 
ID
 
tid
 
usšg
h
´ovided
 
šfÜm©iÚ


209 
š
 
the
 
sk_d©a
 
¡ruùu»
. 
NÙe
 
th©
 
ªy
 
f›lds
 
Ëá
 
bÏnk


210 
Ü
 
undefšed
 
š
 
sk_d©a
 
wl
 
ş—r
 
the
 
v®ue
 iÀth
sk
,

211 
so
 
the
 
be¡
 
way
 
to
 
upd©e
 
a
 
sk
 
is
Ø
fœ¡
 
»Œ›ve
 
™
 
vŸ


212 
	`g‘_sk
(
tid
), 
modify
 
’Œ›s
 
as
 
desœed
, 
ªd
 
£nd
 
™
 
back


213 
vŸ
 
this
 
funùiÚ
.

215 
sk
 = 
£lf
.
»q
.
	$g‘_sk
(
tid
)

216 
sk
.
	`£t_¡©us
(
sk_d©a
["status"],

217 
dÚed©e
=
D©e
.
	`·r£
(
sk_d©a
["donedate"]))

218 
sk
.
	`£t_t™Ë
(
sk_d©a
["title"])

219 
sk
.
	`£t_due_d©e
(
D©e
.
	`·r£
(
sk_d©a
["duedate"]))

220 
sk
.
	`£t_¡¬t_d©e
(
D©e
.
	`·r£
(
sk_d©a
["startdate"]))

221 
sk
.
	`£t_‹xt
(
sk_d©a
["text"])

223 
g
 
š
 
sk_d©a
["tags"]:

224 
sk
.
	$add_g
(
g
)

225 
sub
 
š
 
sk_d©a
["subtask"]:

226 
sk
.
	$add_chd
(
sub
)

227  
	`sk_to_diù
(
sk
)

229 @
dbus
.
£rviû
.
	$m‘hod
(
BUSNAME
)

230 
def
 
	$O³nTaskEd™Ü
(
£lf
, 
tid
):

232 
Launches
 
the
 
GUI
 
sk
 
ed™Ü
 
showšg
hsk 
w™h
 
ID
 
tid
.

234 
This
 
routše
 
»tuºs
 
as
 
soÚ
‡ 
the
 
GUI
 
has
 
Ïunched
.

236 
£lf
.
v›w_mªag”
.
	`İ’_sk
(
tid
)

238 @
dbus
.
£rviû
.
	`m‘hod
(
BUSNAME
, 
š_sigÇtu»
="ss")

239 
def
 
	$O³nNewTask
(
£lf
, 
t™Ë
, 
desütiÚ
):

241 
Launches
 
the
 
GUI
 
sk
 
ed™Ü
 
w™h
 
a
 
Ãw
ask. 
The
ask 
is
 
nÙ


242 
gu¬ª‹ed
 
to
 
exi¡
 
aá”
 
the
 
ed™Ü
 
is
 
şo£d
, 
sšû
h
u£r


243 
could
 
ÿnûl
 
the
 
ed™šg
 
£ssiÚ
.

245 
This
 
routše
 
»tuºs
 
as
 
soÚ
‡ 
the
 
GUI
 
has
 
Ïunched
.

247 
Ãw_sk
 = 
£lf
.
»q
.
	$Ãw_sk
(
Ãwsk
=
True
)

248 
t™Ë
 != "":

249 
Ãw_sk
.
	$£t_t™Ë
(
t™Ë
)

250 
desütiÚ
 != "":

251 
Ãw_sk
.
	$£t_‹xt
(
desütiÚ
)

252 
sk_id
 = 
Ãw_sk
.
	$g‘_id
()

253 
£lf
.
v›w_mªag”
.
	`İ’_sk
(
sk_id
, 
thisi¢ew
=
True
)

255 @
dbus
.
£rviû
.
	$m‘hod
(
BUSNAME
)

256 
def
 
	$HideTaskBrow£r
(
£lf
):

258 
Cau£s
 
the
 
maš
 
sk
 
brow£r
 
to
 
become
 
švisibË
. 
It
 
is
 
¡l


259 
ruÂšg
 
but
 
th”e
 
wl
 
be
 
no
 
visibË
 
šdiÿtiÚ
 
of
 
this
.

261 
£lf
.
v›w_mªag”
.
	`hide_brow£r
()

263 @
dbus
.
£rviû
.
	$m‘hod
(
BUSNAME
)

264 
def
 
	$IcÚifyTaskBrow£r
(
£lf
):

266 
Mšimizes
 
the
 
sk
 
brow£r


268 
£lf
.
v›w_mªag”
.
	`icÚify_brow£r
()

270 @
dbus
.
£rviû
.
	$m‘hod
(
BUSNAME
)

271 
def
 
	$ShowTaskBrow£r
(
£lf
):

273 
Shows
 
ªd
 
unmšimizes
 
the
 
sk
 
brow£r
‡nd 
bršgs
 
™
 
to
he

274 
tİ
 
of
 
the
 
z
-
Üd”
.

276 
£lf
.
v›w_mªag”
.
	`show_brow£r
()

278 @
dbus
.
£rviû
.
	$m‘hod
(
BUSNAME
)

279 
def
 
	$IsTaskBrow£rVisibË
(
£lf
):

281 
R‘uºs
 
Œue
 
sk
 
brow£r
 
is
 
visibË
, 
e™h”
 
mšimized
 
Ü


282 
unmšimized
, 
w™h
 
Ü
 
w™hout
 
aùive
 
focus
.

284  
£lf
.
v›w_mªag”
.
	`is_brow£r_visibË
()

286 @
dbus
.
£rviû
.
	$sigÇl
(
BUSNAME
)

287 
def
 
	$TaskAdded
(
£lf
, 
tid
):

289 
SigÇl
: 
sk
 
added


291 
·ss


293 @
dbus
.
£rviû
.
	$sigÇl
(
BUSNAME
)

294 
def
 
	$TaskModif›d
(
£lf
, 
tid
):

296 
SigÇl
: 
sk
 
modif›d


298 
·ss


300 @
dbus
.
£rviû
.
	$sigÇl
(
BUSNAME
)

301 
def
 
	$TaskD–‘ed
(
£lf
, 
tid
):

303 
SigÇl
: 
sk
 
d–‘ed


305 
·ss


	@gtk/delete_dialog.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


20 
äom
 
GTG
 
impÜt
 
	g_
, 
ng‘‹xt


21 
äom
 
	gGTG
.
gtk
 
impÜt
 
V›wCÚfig


24 
şass
 
	$D–‘iÚUI
():

26 
MAXIMUM_TIDS_TO_SHOW
 = 5

28 
def
 
	$__š™__
(
£lf
, 
»q
):

29 
£lf
.
»q
 =„eq

30 
£lf
.
tids_tod–‘e
 = []

31 #Tag 
which
 
mu¡
 
be
 
upd©ed


32 
£lf
.
upd©e_gs
 = []

33 #Lßd 
wšdow
 
Œ“


34 
£lf
.
bud”
 = 
Gtk
.
	$Bud”
()

35 
£lf
.
bud”
.
	$add_äom_fe
(
V›wCÚfig
.
DELETE_UI_FILE
)

36 
sigÇls
 = {"Ú_d–‘e_cÚfœm": 
£lf
.
Ú_d–‘e_cÚfœm
,

37 "Ú_d–‘e_ÿnûl": 
Ïmbda
 
x
: x.
hide
, 
	}
}

38 
£lf
.
bud”
.
	$cÚÃù_sigÇls
(
sigÇls
)

40 
def
 
	$Ú_d–‘e_cÚfœm
(
£lf
, 
widg‘
):

42 
Ùh”wi£
, 
we
 
wl
 
look
 
which
 
tid
 
is
 
£Ëùed
"""

43 
tid
 
š
 
£lf
.
tids_tod–‘e
:

44 
£lf
.
»q
.
	$has_sk
(
tid
):

45 
£lf
.
»q
.
	$d–‘e_sk
(
tid
, 
»cursive
=
True
)

46 
£lf
.
tids_tod–‘e
 = []

48 #Upd©
gs


49 
gÇme
 
š
 
£lf
.
upd©e_gs
:

50 
g
 = 
£lf
.
»q
.
	$g‘_g
(
gÇme
)

51 
g
.
	$modif›d
()

52 
£lf
.
upd©e_gs
 = []

54 
def
 
	$d–‘e_sks
(
£lf
, 
tids
=
NÚe
):

55 
tids
:

56 
£lf
.
tids_tod–‘e
 = 
tids


57 #W
mu¡
 
©
 
Ëa¡
 
have
 
som‘hšg
 
to
 
d–‘e
 !

58 
	`Ën
(
£lf
.
tids_tod–‘e
) > 0:

59 
skli¡
 = []

60 
£lf
.
upd©e_gs
 = []

61 
tid
 
š
 
£lf
.
tids_tod–‘e
:

63 
def
 
	$»cursive_li¡_sks
(
sk_li¡
, 
roÙ
):

65 
theœ
 
chd»n
, 
»cursiv–y
.

67 
Also
 
cŞËù
 
the
 
li¡
 
of
 
afãùed
 
gs


68 
which
 
should
 
be
 
»äeshed
"""

69 
roÙ
 
nÙ
 
š
 
sk_li¡
:

70 
sk_li¡
.
	$­³nd
(
roÙ
)

71 
gÇme
 
š
 
roÙ
.
	$g‘_gs_Çme
():

72 
gÇme
 
nÙ
 
š
 
£lf
.
upd©e_gs
:

73 
£lf
.
upd©e_gs
.
	$­³nd
(
gÇme
)

74 
i
 
š
 
roÙ
.
	$g‘_subsks
():

75 
i
 
nÙ
 
š
 
sk_li¡
:

76 
	$»cursive_li¡_sks
(
sk_li¡
, 
i
)

78 
sk
 = 
£lf
.
»q
.
	$g‘_sk
(
tid
)

79 
	$»cursive_li¡_sks
(
skli¡
, 
sk
)

81 #W
fl
 
the
 
‹xt
 
ªd
h
bu‰Ús
'†abels‡ccordingohe‚umber

82 #oà
sks
 
to
 
d–‘e


83 
Ïb–
 = 
£lf
.
bud”
.
	`g‘_objeù
("label1")

84 
Ïb–_‹xt
 = 
Ïb–
.
	$g‘_‹xt
()

85 
cdÏb–2
 = 
£lf
.
bud”
.
	`g‘_objeù
("cd-label2")

86 
cdÏb–3
 = 
£lf
.
bud”
.
	`g‘_objeù
("cd-label3")

87 
cdÏb–4
 = 
£lf
.
bud”
.
	`g‘_objeù
("cd-label4")

88 
sšguÏr
 = 
	$Ën
(
skli¡
)

89 
Ïb–_‹xt
 = 
	`ng‘‹xt
("Deleting‡ask cannot be undone, "

93 
sšguÏr
)

94 
cdÏb–2
.
	`£t_Ïb–
(
	`ng‘‹xt
("Are you sure you wanto deletehis"

98 
sšguÏr
))

100 
cdÏb–3
.
	`£t_Ïb–
(
	`ng‘‹xt
("Keep selectedask",

102 
sšguÏr
))

103 
cdÏb–4
.
	`£t_Ïb–
(
	`ng‘‹xt
("Permanently„emoveask",

105 
sšguÏr
))

106 
Ïb–_‹xt
 =†ab–_‹xt[0:Ïb–_‹xt.
	`fšd
(":") + 1]

108 #w
dÚ
'ˆwªˆtØ’d w™h ju¡ oÃaskh© dÛ¢'
t
 
f™
 
the


109 #sü“À
ªd
 
a
 
lše
 
§yšg
 "And oÃ mÜsk", 
so
 
we
 
go
‡

110 #l™
ov”
 
our
 
lim™


111 
missšg_t™Ës_couÁ
 = 
	`Ën
(
skli¡
è- 
£lf
.
MAXIMUM_TIDS_TO_SHOW


112 
missšg_t™Ës_couÁ
 >= 2:

113 
sks
 = 
skli¡
[: 
£lf
.
MAXIMUM_TIDS_TO_SHOW
]

114 
t™Ës_suffix
 = 
	`_
("\nAnd %d mÜsks" % 
missšg_t™Ës_couÁ
)

116 
sks
 = 
skli¡


117 
t™Ës_suffix
 = ""

119 
t™Ës
 = "".
	`još
("\À- " + 
sk
.
	$g‘_t™Ë
(è
sk
 
š
 
sks
)

120 
Ïb–
.
	`£t_‹xt
(
Ïb–_‹xt
 + 
t™Ës
 + 
t™Ës_suffix
)

121 
d–‘e_dŸlog
 = 
£lf
.
bud”
.
	`g‘_objeù
("confirm_delete")

122 
d–‘e_dŸlog
.
	$»size
(1, 1)

123 
ÿnûl_bu‰Ú
 = 
£lf
.
bud”
.
	`g‘_objeù
("cancel")

124 
ÿnûl_bu‰Ú
.
	$g¿b_focus
()

125 
d–‘e_dŸlog
.
	`run
() != 1:

126 
skli¡
 = []

127 
d–‘e_dŸlog
.
	$hide
()

128  
skli¡


	@gtk/editor/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
The
 
sk
 
ed™šg
 
	gGUI


19 
impÜt
 
os


21 
äom
 
GTG
 
impÜt
 
_


24 
şass
 
	gGnomeCÚfig
:

25 
cu¼’t_»p
 = 
os
.
·th
.
dœÇme
(os.·th.
	$ab¥©h
(
__fe__
))

26 
EDITOR_UI_FILE
 = 
os
.
·th
.
	`još
(
cu¼’t_»p
, "taskeditor.ui")

27 
CALENDAR_UI_FILE
 = 
os
.
·th
.
	`još
(
cu¼’t_»p
, "calendar.ui")

29 
MARK_DONE
 = 
	`_
("Mark‡s Done")

30 
MARK_UNDONE
 = 
	`_
("Mark‡s‚ot Done")

31 
MARK_DISMISS
 = 
	`_
("Dismiss")

32 
MARK_UNDISMISS
 = 
	`_
("Undismiss")

34 
MARK_DONE_TOOLTIP
 = 
	`_
("Markhisask‡s done")

35 
MARK_UNDONE_TOOLTIP
 = 
	`_
("Markhisask‡so be done")

36 
MARK_DISMISS_TOOLTIP
 = 
	`_
("Markhisask‡s‚oto be done‡nymore")

37 
MARK_UNDISMISS_TOOLTIP
 = 
	`_
("Markhisask‡so be done")

38 
DELETE_TOOLTIP
 = 
	`_
("Permanently„emovehisask")

39 
SUBTASK_TOOLTIP
 = 
	`_
("Insert‡ subtask inhisask")

40 
TAG_TOOLTIP
 = 
	`_
("Insert‡ag inhisask")

42 #Numb” 
of
 
£cÚd
 
b‘w“n
 
to
 
§ve
 
š
 
the
 
sk
 
ed™Ü


43 
SAVETIME
 = 7

	@gtk/editor/calendar.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
impÜt
 
d©‘ime


19 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
	gGObjeù
, 
	gGdk
, 
Gtk


21 
äom
 
	gGTG
.
	ggtk
.
ed™Ü
 
impÜt
 
GnomeCÚfig


22 
äom
 
	gGTG
.
	gtoŞs
.
d©es
 
impÜt
 
D©e


25 
şass
 
	$GTGC®’d¬
(
GObjeù
.GObject):

29 
DATE_KIND_DUE
 = "due"

30 
DATE_KIND_START
 = "start"

31 
DATE_KIND_CLOSED
 = "closed"

33 #Gobjeù 
sigÇl
 
desütiÚ


34 
__sigÇl_ty³__
 = (
GObjeù
.
SigÇlFÏgs
.
RUN_FIRST
,

35 
NÚe
,

38 
__gsigÇls__
 = {'d©e-chªged': 
__sigÇl_ty³__
, 
	}
}

40 
def
 
	$__š™__
(
£lf
):

41 
	`su³r
(
GTGC®’d¬
, 
£lf
).
	$__š™__
()

42 
£lf
.
__bud”
 = 
Gtk
.
	$Bud”
()

43 
£lf
.
__bud”
.
	$add_äom_fe
(
GnomeCÚfig
.
CALENDAR_UI_FILE
)

44 
£lf
.
__d©e_kšd
 = 
NÚe


45 
£lf
.
__d©e
 = 
D©e
.
	$no_d©e
()

46 
£lf
.
	$__š™_gtk__
()

48 
def
 
	$__š™_gtk__
(
£lf
):

49 
£lf
.
__wšdow
 = s–f.
__bud”
.
	`g‘_objeù
("calendar")

50 
£lf
.
__ÿËnd¬
 = s–f.
__bud”
.
	`g‘_objeù
("calendar1")

51 
£lf
.
__fuzzyd©e_bŠs
 = s–f.
__bud”
.
	`g‘_objeù
("fuzzydate_btns")

52 
£lf
.
__bud”
.
	`g‘_objeù
("bu‰Ú_ş—r").
	`cÚÃù
(

53 "şicked", 
Ïmbda
 
w
: 
£lf
.
	`__day_£Ëùed
(w, ""))

54 
£lf
.
__bud”
.
	`g‘_objeù
("bu‰Ú_now").
	`cÚÃù
(

55 "şicked", 
Ïmbda
 
w
: 
£lf
.
	`__day_£Ëùed
(w, "now"))

56 
£lf
.
__bud”
.
	`g‘_objeù
("bu‰Ú_soÚ").
	`cÚÃù
(

57 "şicked", 
Ïmbda
 
w
: 
£lf
.
	`__day_£Ëùed
(w, "soon"))

58 
£lf
.
__bud”
.
	`g‘_objeù
("bu‰Ú_someday").
	`cÚÃù
(

59 "şicked", 
Ïmbda
 
w
: 
£lf
. 
	`__day_£Ëùed
(w, "someday"))

61 
def
 
	$£t_d©e
(
£lf
, 
d©e
, 
d©e_kšd
):

62 
£lf
.
__d©e_kšd
 = 
d©e_kšd


63 
d©e_kšd
 =ğ
GTGC®’d¬
.
DATE_KIND_DUE
:

64 
£lf
.
__fuzzyd©e_bŠs
.
	$show
()

66 
£lf
.
__fuzzyd©e_bŠs
.
	$hide
()

67 
nÙ
 
d©e
:

68 #w
£t
 
the
 
widg‘
 
to
 
today
's date ifhere is‚ot‡ date defined

69 
d©e
 = 
D©e
.
	$today
()

70 
£lf
.
__d©e
 = 
d©e


71 
nÙ
 
d©e
.
	$is_fuzzy
():

72 
£lf
.
__ÿËnd¬
.
	$£Ëù_day
(
d©e
.
day
)

73 #C®’d¬ 
u£
 0..11 
a
 
mÚth
 
so
 
we
 
Ãed
 -1

74 #W
ÿn
'ˆu£ cÚv”siÚhrough…ythÚ'
s
 
d©‘ime


75 #beÿu£ 
™
 
is
 
oá’
 
ª
 
šv®id
 
d©e


76 
£lf
.
__ÿËnd¬
.
	`£Ëù_mÚth
(
d©e
.
mÚth
 - 1, d©e.
y—r
)

78 
def
 
	$__m¬k_today_š_bŞd
(
£lf
):

81 
If
 
the
 
cu¼’t
 
showed
 
mÚth
 
is
hcu¼’ˆ
	`mÚth
 (
has
h
§me
 
y—r


82 
ªd
 
mÚth
), 
th’
 
make
 
the
 
cu¼’t
 
day
 
bŞd
. 
Oth”wi£
 
no
 day 
should


83 
be
 
bŞd
.

85 
today
 = 
d©‘ime
.
d©e
.
	$today
()

87 #G‘ 
the
 
cu¼’t
 
di¥Ïyed
 
mÚth


88 #(
mÚth
 
mu¡
 
be
 
cÜ»ùed
 
beÿu£
 
ÿËnd¬
 
is
 0-
ba£d
)

89 
y—r
, 
mÚth
, 
day
 = 
£lf
.
__ÿËnd¬
.
	$g‘_d©e
()

90 
mÚth
 += 1

92 
today
.
y—r
 =ğy—¸
ªd
oday.
mÚth
 == month:

93 
£lf
.
__ÿËnd¬
.
	$m¬k_day
(
today
.
day
)

95 #Ià
m¬ked
 
day
 
is
 31
th
, 
ªd
 
the
 
Ãxt
 
mÚth
 
dÛs
 
nÙ
 
have
 31th day,

96 #unm¬k_day 
¿i£s
 
a
 
w¬nšg
. 
	`CË¬_m¬ks
(è
is
 
şev”
 
way
 
how


97 #tØ
Ët
 
GTK
 
sŞve
 
™
's bussiness.

98 
£lf
.
__ÿËnd¬
.
	$ş—r_m¬ks
()

100 
def
 
	$move_ÿËnd¬_šside
(
£lf
, 
width
, 
height
, 
x
, 
y
):

102 
™
 
is
 
di¥Ïyed
 
outside
 
the
 
sü“n
 """

103 
sü“n_width
 = 
Gdk
.
Sü“n
.
	$width
()

104 #TØ
di¥Ïy
 
ÿËnd¬
 
šside
 
the
 
sü“n
 
wh’
 
ed™Ü
 
wšdow
 
is


105 #outsid
Ëáside
 
of
 
the
 
sü“n


106 
x
 < 
width
:

107 
£lf
.
__wšdow
.
	`move
(2, 
y
 - 
height
)

108 #TØ
di¥Ïy
 
ÿËnd¬
 
šside
 
the
 
sü“n
 
wh’
 
ed™Ü
 
wšdow
 
is
 
outside


109 #rightsid
of
 
the
 
sü“n


110 
–if
 
x
 > (
sü“n_width
 - 2):

111 
£lf
.
__wšdow
.
	`move
(
sü“n_width
 - 
width
 - 2, 
y
 - 
height
)

113 
£lf
.
__wšdow
.
	`move
(
x
 - 
width
, 
y
 - 
height
)

115 
def
 
	$show_©_pos™iÚ
(
£lf
, 
x
, 
y
):

116 
width
, 
height
 = 
£lf
.
__wšdow
.
	$g‘_size
()

117 
£lf
.
	$move_ÿËnd¬_šside
(
width
, 
height
, 
x
, 
y
)

118 
£lf
.
__wšdow
.
	$show
()

119 
£lf
.
__wšdow
.
	$g¿b_add
()

121 #W
g¿b
 
the
 
poš‹r
 
š
h
ÿËnd¬


122 #Gdk.
	`poš‹r_g¿b
(

123 #£lf.
__wšdow
.
	`g‘_wšdow
(),

125 #Gdk.
Modif›rTy³
.
BUTTON1_MASK
 | 
Gdk
.Modif›rTy³.
MOD2_MASK


127 #FIXME 
THIS
 
DOES
 
NOT
 
WORK
!!!!!!!

128 
Gdk
.
	`poš‹r_g¿b
(

129 
£lf
.
	`g‘_wšdow
(),

130 
True
,

131 #Gdk.
Modif›rTy³
.
BUTTON1_MASK
 | 
Gdk
.Modif›rTy³.
MOD2_MASK
,

132 #FIXME!!!! 
JUST
 
GUESSING
 
THE
 
TYPE


133 
Gdk
.
Ev’tMask
.
ALL_EVENTS_MASK
,

134 
NÚe
,

135 
NÚe
,

139 
£lf
.
	$g‘_decÜ©ed
():

140 
£lf
.
__wšdow
.
	`cÚÃù
("d–‘e-ev’t", s–f.
şo£_ÿËnd¬
)

142 
£lf
.
__wšdow
.
	`cÚÃù
('bu‰Ú-´ess-ev’t', s–f.
__focus_out
)

143 
£lf
.
__sigid
 = s–f.
__ÿËnd¬
.
	`cÚÃù
("day-selected",

144 
£lf
.
__day_£Ëùed
,

147 
£lf
.
__sigid_mÚth
 = s–f.
__ÿËnd¬
.
	`cÚÃù
("month-changed",

148 
£lf
.
__mÚth_chªged
)

149 #ProbËm: 
Gtk
.
C®’d¬
 
dÛs
 
nÙ
 
‹Î
 
you
 
dœeùly
 
the


150 #"
day
-
£Ëùed
" signal was caused byhe user clicking on

151 #¨
d©e
, 
Ü
 
ju¡
 
browsšg
 
the
 
ÿËnd¬
.

152 #SŞutiÚ: 
we
 
Œack
 
th©
 
š
 
a
 
v¬ŸbË


153 
£lf
.
__is_u£r_ju¡_browsšg_the_ÿËnd¬
 = 
F®£


154 
£lf
.
	$__m¬k_today_š_bŞd
()

156 
def
 
	$__focus_out
(
£lf
, 
w
=
NÚe
, 
e
=None):

157 #W
should
 
Úly
 
şo£
 
the
 
poš‹r
 
şick
 
is
 
out
 
of
h
ÿËnd¬
 !

158 
p
 = 
£lf
.
__wšdow
.
	`g‘_wšdow
().
	$g‘_poš‹r
()

159 
s
 = 
£lf
.
__wšdow
.
	$g‘_size
()

160 
	`nÙ
(0 <ğ
p
[1] <ğ
s
[0] 
ªd
 0 <=…[2] <= s[1]):

161 
£lf
.
	$şo£_ÿËnd¬
()

163 
def
 
	$şo£_ÿËnd¬
(
£lf
, 
widg‘
=
NÚe
, 
e
=None):

164 
£lf
.
__wšdow
.
	$hide
()

165 
Gdk
.
	$poš‹r_ung¿b
(0)

166 
£lf
.
__wšdow
.
	$g¿b_»move
()

167 
£lf
.
__sigid
 
is
 
nÙ
 
NÚe
:

168 
£lf
.
__ÿËnd¬
.
	$discÚÃù
(
£lf
.
__sigid
)

169 
£lf
.
__sigid
 = 
NÚe


171 
£lf
.
__sigid_mÚth
 
is
 
nÙ
 
NÚe
:

172 
£lf
.
__ÿËnd¬
.
	$discÚÃù
(
£lf
.
__sigid_mÚth
)

173 
£lf
.
__sigid_mÚth
 = 
NÚe


174  
True


176 
def
 
	$__day_£Ëùed
(
£lf
, 
widg‘
, 
d©e_ty³
):

177 
d©e_ty³
 == "RealDate":

178 
ÿËnd¬_d©e
 = 
£lf
.
__ÿËnd¬
.
	$g‘_d©e
()

179 
d©e
 = 
£lf
.
	$__äom_ÿËnd¬_d©e_to_d©‘ime
(
ÿËnd¬_d©e
)

180 
£lf
.
__d©e
 = 
	$D©e
(
d©e
)

182 
£lf
.
__d©e
 = 
	$D©e
(
d©e_ty³
)

184 
£lf
.
__is_u£r_ju¡_browsšg_the_ÿËnd¬
:

185 #thi 
day
-
£Ëùed
 
sigÇl
 
was
 
ÿu£d
 
by
 
a
 
mÚth
/
y—r
 
chªge


186 
£lf
.
__is_u£r_ju¡_browsšg_the_ÿËnd¬
 = 
F®£


188 #šfÜm 
the
 
Ed™Ü
 
th©
h
d©e
 
has
 
chªged


189 
£lf
.
	$şo£_ÿËnd¬
()

190 
GObjeù
.
	`idË_add
(
£lf
.
em™
, "date-changed")

192 
def
 
	$__äom_ÿËnd¬_d©e_to_d©‘ime
(
£lf
, 
ÿËnd¬_d©e
):

194 
Gtk
.
C®’d¬
 
u£s
 
a
 0-
ba£d
 
cÚv’tiÚ
 
couÁšg
 
mÚths
.

195 
The
 
»¡
 
of
 
the
 
wÜld
, 
šşudšg
h
d©‘ime
 
moduË
, 
¡¬ts
 
äom
 1.

196 
This
 
is
 
a
 
cÚv”‹r
 
b‘w“n
 
the
 
two
. 
GTG
 
fŞlows
h
d©‘ime


197 
cÚv’tiÚ
.

199 
y—r
, 
mÚth
, 
day
 = 
ÿËnd¬_d©e


200  
d©‘ime
.
	`d©e
(
y—r
, 
mÚth
 + 1, 
day
)

202 
def
 
	$__mÚth_chªged
(
£lf
, 
widg‘
):

203 
£lf
.
__is_u£r_ju¡_browsšg_the_ÿËnd¬
 = 
True


204 
£lf
.
	$__m¬k_today_š_bŞd
()

206 
def
 
	$g‘_£Ëùed_d©e
(
£lf
):

207  
£lf
.
__d©e
, s–f.
__d©e_kšd


209 
def
 
	$__g‘©Œ__
(
£lf
, 
©Œ
):

210  
	`g‘©Œ
(
£lf
.
__wšdow
, 
©Œ
)

	@gtk/editor/editor.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
This
 
is
 
the
 
TaskEd™Ü


19 
	gIt
'she window you see when you double-click on‡ Task

20 
The
 
maš
 
‹xt
 
widg‘
 
is
 
a
 
	ghome
-
made
 
TextV›w
 
ÿÎed
 
	$TaskV›w
 (
£e
 
skv›w
.
py
)

21 
The
 
»¡
 
is
 
the
 
logic
 
of
h
widg‘
: 
d©e
 
chªgšg
 
widg‘s
, 
bu‰Ús
, ...

23 
impÜt
 
time


25 
äom
 
gi
.
»pos™Üy
 
impÜt
 
Gtk
, 
Gdk
, 
Pªgo


27 
äom
 
GTG
 
impÜt
 
_
, 
ng‘‹xt


28 
äom
 
GTG
.
gtk
.
ed™Ü
 
impÜt
 
GnomeCÚfig


29 
äom
 
GTG
.
gtk
.
ed™Ü
.
skv›w
 
impÜt
 
TaskV›w


30 
äom
 
GTG
.
cÜe
.
¶ugšs
.
’gše
 
impÜt
 
PlugšEngše


31 
äom
 
GTG
.
cÜe
.
¶ugšs
.
­i
 
impÜt
 
PlugšAPI


32 
äom
 
GTG
.
cÜe
.
sk
 
impÜt
 
Task


33 
äom
 
GTG
.
toŞs
.
d©es
 
impÜt
 
D©e


34 
äom
 
GTG
.
gtk
.
ed™Ü
.
ÿËnd¬
 
impÜt
 
GTGC®’d¬


35 
äom
 
GTG
.
gtk
.
h–p
 
impÜt
 
add_h–p_shÜtcut


38 
şass
 
	$TaskEd™Ü
(
objeù
):

40 
def
 
	$__š™__
(
£lf
,

41 
»que¡”
,

42 
vmªag”
,

43 
sk
,

44 
skcÚfig
=
NÚe
,

45 
thisi¢ew
=
F®£
,

46 
şbßrd
=
NÚe
):

48 
»q
 
is
 
the
 
»que¡”


49 
vmªag”
 
is
 
the
 
v›w
 
mªag”


50 
skcÚfig
 
is
 
a
 
CÚfigP¬£r
 
to
 
§ve
 
šfos
 
about
 
sks


51 
thisi¢ew
 
is
 
True
 
wh’
 
a
 
Ãw
 
sk
 i 
ü—‹d
 
ªd
 
İ’ed


53 
£lf
.
»q
 = 
»que¡”


54 
£lf
.
brow£r_cÚfig
 = s–f.
»q
.
	`g‘_cÚfig
('browser')

55 
£lf
.
vmªag”
 = vmanager

56 
£lf
.
cÚfig
 = 
skcÚfig


57 
£lf
.
time
 = 
NÚe


58 
£lf
.
şbßrd
 = clipboard

59 
£lf
.
bud”
 = 
Gtk
.
	$Bud”
()

60 
£lf
.
bud”
.
	$add_äom_fe
(
GnomeCÚfig
.
EDITOR_UI_FILE
)

61 
£lf
.
dÚebu‰Ú
 = s–f.
bud”
.
	`g‘_objeù
("mark_as_done_editor")

62 
£lf
.
dismissbu‰Ú
 = s–f.
bud”
.
	`g‘_objeù
("dismiss_editor")

63 
£lf
.
d–‘ebu‰Ú
 = s–f.
bud”
.
	`g‘_objeù
("delete_editor")

64 
£lf
.
d–‘ebu‰Ú
.
	$£t_toŞt_‹xt
(
GnomeCÚfig
.
DELETE_TOOLTIP
)

65 
£lf
.
subsk_bu‰Ú
 = s–f.
bud”
.
	`g‘_objeù
("insert_subtask")

66 
£lf
.
subsk_bu‰Ú
.
	$£t_toŞt_‹xt
(
GnomeCÚfig
.
SUBTASK_TOOLTIP
)

67 
£lf
.
š£¹g_bu‰Ú
 = s–f.
bud”
.
	`g‘_objeù
("inserttag")

68 
£lf
.
š£¹g_bu‰Ú
.
	$£t_toŞt_‹xt
(
GnomeCÚfig
.
TAG_TOOLTIP
)

69 
£lf
.
İ’_·»Ás_bu‰Ú
 = s–f.
bud”
.
	`g‘_objeù
("open_parents")

71 #C»©
our
 
diùiÚ¬y
 
ªd
 
cÚÃù
 
™


72 
dic
 = {

73 "m¬k_as_dÚe_şicked": 
£lf
.
chªge_¡©us
,

74 "Ú_dismiss": 
£lf
.
dismiss
,

75 "d–‘e_şicked": 
£lf
.
d–‘e_sk
,

76 "Ú_dued©e_´es£d": 
Ïmbda
 
w
: 
£lf
.
	`Ú_d©e_´es£d
(

77 
w
, 
GTGC®’d¬
.
DATE_KIND_DUE
),

78 "Ú_¡¬td©e_´es£d": 
Ïmbda
 
w
: 
£lf
.
	`Ú_d©e_´es£d
(

79 
w
, 
GTGC®’d¬
.
DATE_KIND_START
),

80 "Ú_şo£dd©e_´es£d": 
Ïmbda
 
w
: 
£lf
.
	`Ú_d©e_´es£d
(

81 
w
, 
GTGC®’d¬
.
DATE_KIND_CLOSED
),

82 "şo£_şicked": 
£lf
.
şo£
,

83 "dued©e_chªged": 
Ïmbda
 
w
: 
£lf
.
	`d©e_chªged
(

84 
w
, 
GTGC®’d¬
.
DATE_KIND_DUE
),

85 "dued©e_focus_out": 
Ïmbda
 
w
, 
e
: 
£lf
.
	`d©e_focus_out
(

86 
w
, 
e
, 
GTGC®’d¬
.
DATE_KIND_DUE
),

87 "¡¬tšgd©e_chªged": 
Ïmbda
 
w
: 
£lf
.
	`d©e_chªged
(

88 
w
, 
GTGC®’d¬
.
DATE_KIND_START
),

89 "¡¬td©e_focus_out": 
Ïmbda
 
w
, 
e
: 
£lf
.
	`d©e_focus_out
(

90 
w
, 
e
, 
GTGC®’d¬
.
DATE_KIND_START
),

91 "şo£dd©e_chªged": 
Ïmbda
 
w
: 
£lf
.
	`d©e_chªged
(

92 
w
, 
GTGC®’d¬
.
DATE_KIND_CLOSED
),

93 "şo£dd©e_focus_out": 
Ïmbda
 
w
, 
e
: 
£lf
.
	`d©e_focus_out
(

94 
w
, 
e
, 
GTGC®’d¬
.
DATE_KIND_CLOSED
),

95 "Ú_š£¹_subsk_şicked": 
£lf
.
š£¹_subsk
,

96 "Ú_š£¹g_şicked": 
£lf
.
š£¹g_şicked
,

97 "Ú_İ’_·»Á_şicked": 
£lf
.
İ’_·»Á_şicked
,

98 "Ú_move": 
£lf
.
Ú_move
,

99 
	}
}

100 
£lf
.
bud”
.
	$cÚÃù_sigÇls
(
dic
)

101 
£lf
.
wšdow
 = s–f.
bud”
.
	`g‘_objeù
("TaskEditor")

102 #Removšg 
the
 
NÜm®
 
‹xtv›w
 
to
 
»¶aû
 
™
 
by
 
our
 
own


103 #SØ
dÚ
'tryo change‡nything with glade,his is‡ home-made

105 
‹xtv›w
 = 
£lf
.
bud”
.
	`g‘_objeù
("textview")

106 
süŞËd
 = 
£lf
.
bud”
.
	`g‘_objeù
("scrolledtask")

107 
süŞËd
.
	$»move
(
‹xtv›w
)

108 
£lf
.
‹xtv›w
 = 
	$TaskV›w
(
£lf
.
»q
, s–f.
şbßrd
)

109 
£lf
.
‹xtv›w
.
	$show
()

110 
£lf
.
‹xtv›w
.
	$£t_subsk_ÿÎback
(
£lf
.
Ãw_subsk
)

111 
£lf
.
‹xtv›w
.
	$İ’_sk_ÿÎback
(
£lf
.
vmªag”
.
İ’_sk
)

112 
£lf
.
‹xtv›w
.
	$£t_Ëá_m¬gš
(7)

113 
£lf
.
‹xtv›w
.
	$£t_right_m¬gš
(5)

114 
süŞËd
.
	$add
(
£lf
.
‹xtv›w
)

115 
cÚf_fÚt_v®ue
 = 
£lf
.
brow£r_cÚfig
.
	`g‘
("font_name")

116 
cÚf_fÚt_v®ue
 != "":

117 
£lf
.
‹xtv›w
.
	`ov”ride_fÚt
(
Pªgo
.
	$FÚtDesütiÚ
(
cÚf_fÚt_v®ue
))

118 #Voa! 
™
's done

119 
£lf
.
ÿËnd¬
 = 
	$GTGC®’d¬
()

120 
£lf
.
ÿËnd¬
.
	$£t_Œªs›Á_fÜ
(
£lf
.
wšdow
)

121 
£lf
.
ÿËnd¬
.
	$£t_decÜ©ed
(
F®£
)

122 
£lf
.
dued©e_widg‘
 = s–f.
bud”
.
	`g‘_objeù
("duedate_entry")

123 
£lf
.
¡¬td©e_widg‘
 = s–f.
bud”
.
	`g‘_objeù
("startdate_entry")

124 
£lf
.
şo£dd©e_widg‘
 = s–f.
bud”
.
	`g‘_objeù
("closeddate_entry")

125 
£lf
.
dayËá_Ïb–
 = s–f.
bud”
.
	`g‘_objeù
("dayleft")

126 
£lf
.
sksideb¬
 = s–f.
bud”
.
	`g‘_objeù
("tasksidebar")

127 #Defš
acûË¿tÜ
 
keys


128 
£lf
.
	$š™_acûË¿tÜs
()

130 
£lf
.
sk
 =ask

131 
gs
 = 
sk
.
	$g‘_gs
()

132 
£lf
.
‹xtv›w
.
	$subsks_ÿÎback
(
sk
.
g‘_chd»n
)

133 
£lf
.
‹xtv›w
.
	$»movesubsk_ÿÎback
(
sk
.
»move_chd
)

134 
£lf
.
‹xtv›w
.
	$£t_g‘_g¦i¡_ÿÎback
(
sk
.
g‘_gs_Çme
)

135 
£lf
.
‹xtv›w
.
	$£t_add_g_ÿÎback
(
sk
.
add_g
)

136 
£lf
.
‹xtv›w
.
	$£t_»move_g_ÿÎback
(
sk
.
»move_g
)

137 
£lf
.
‹xtv›w
.
	$§ve_sk_ÿÎback
(
£lf
.
light_§ve
)

139 
‹x‹
 = 
£lf
.
sk
.
	$g‘_‹xt
()

140 
t™Ë
 = 
£lf
.
sk
.
	$g‘_t™Ë
()

141 #th
fœ¡
 
lše
 
is
 
the
 
t™Ë


142 
£lf
.
‹xtv›w
.
	`£t_‹xt
("%s\n" % 
t™Ë
)

143 #w
š£¹
 
the
 
»¡
 
of
h
sk


144 
‹x‹
:

145 
£lf
.
‹xtv›w
.
	`š£¹
("%s" % 
‹x‹
)

147 #Ià
nÙ
 
‹xt
, 
we
 
š£¹
 
gs


148 
gs
:

149 
t
 
š
 
gs
:

150 
£lf
.
‹xtv›w
.
	`š£¹_‹xt
("%s, " % 
t
.
	$g‘_Çme
())

151 
£lf
.
‹xtv›w
.
	`š£¹_‹xt
("\n")

152 #Ià
we
 
dÚ
't haveext, we still‚eedo insert subtasks if‡ny

153 
subsks
 = 
sk
.
	$g‘_chd»n
()

154 
subsks
:

155 
£lf
.
‹xtv›w
.
	$š£¹_subsks
(
subsks
)

156 #W
£Ëù
 
the
 
t™Ë
 
™
's‡‚ewask

157 
thisi¢ew
:

158 
£lf
.
‹xtv›w
.
	$£Ëù_t™Ë
()

160 
£lf
.
sk
.
	$£t_to_k“p
()

161 
£lf
.
‹xtv›w
.
	$modif›d
(
fuÎ
=
True
)

162 
£lf
.
wšdow
.
	`cÚÃù
("de¡roy", s–f.
de¡ruùiÚ
)

163 
£lf
.
ÿËnd¬
.
	`cÚÃù
("d©e-chªged", s–f.
Ú_d©e_chªged
)

166 
£lf
.
³ngše
 = 
	$PlugšEngše
()

167 
£lf
.
¶ugš_­i
 = 
	$PlugšAPI
(
£lf
.
»q
, s–f.
vmªag”
, self)

168 
£lf
.
³ngše
.
	$»gi¡”_­i
(
£lf
.
¶ugš_­i
)

169 
£lf
.
³ngše
.
	$ÚTaskLßd
(
£lf
.
¶ugš_­i
)

171 #Pu‰šg 
the
 
»äesh
 
ÿÎback
 
©
h
’d
 
make
h
¡¬t
 
a
 
lÙ
 
ç¡”


172 
£lf
.
‹xtv›w
.
	$»äesh_ÿÎback
(
£lf
.
»äesh_ed™Ü
)

173 
£lf
.
	$»äesh_ed™Ü
()

174 
£lf
.
‹xtv›w
.
	$g¿b_focus
()

176 #»¡Üšg 
size
 
ªd
 
pos™iÚ
, 
¥©Ÿl
 
sks


177 
£lf
.
cÚfig
 
is
 
nÙ
 
NÚe
:

178 
tid
 = 
£lf
.
sk
.
	$g‘_id
()

179 
£lf
.
cÚfig
.
	$has_£ùiÚ
(
tid
):

180 
£lf
.
cÚfig
.
	`has_İtiÚ
(
tid
, "position"):

181 
pos_x
, 
pos_y
 = 
£lf
.
cÚfig
.
	`g‘
(
tid
, "position")

182 
£lf
.
	`move
((
pos_x
), (
pos_y
))

183 
£lf
.
cÚfig
.
	`has_İtiÚ
(
tid
, "size"):

184 
width
, 
height
 = 
£lf
.
cÚfig
.
	`g‘
(
tid
, "size")

185 
£lf
.
wšdow
.
	`»size
((
width
), (
height
))

187 
£lf
.
‹xtv›w
.
	$£t_ed™abË
(
True
)

188 
£lf
.
wšdow
.
	$show
()

190 #Defš
acûË¿tÜ
-
keys
 
this
 
dŸlog


191 #TODO: 
undo
/
»do


192 
def
 
	$š™_acûË¿tÜs
(
£lf
):

193 
agr
 = 
Gtk
.
	$AcûlGroup
()

194 
£lf
.
wšdow
.
	$add_acûl_group
(
agr
)

196 #Esÿ³ 
ªd
 
CŒl
-
W
 
şo£
 
the
 
dŸlog
. 
It
's fastero call close

197 #dœeùly, 
¿th”
 
thª
 
u£
 
the
 
şo£
 
bu‰Ú
 
widg‘


198 
key
, 
modif›r
 = 
Gtk
.
	`acûË¿tÜ_·r£
('Escape')

199 
agr
.
	$cÚÃù
(
key
, 
modif›r
, 
Gtk
.
AcûlFÏgs
.
VISIBLE
, 
£lf
.
şo£
)

201 
key
, 
modif›r
 = 
Gtk
.
	`acûË¿tÜ_·r£
('<Control>w')

202 
agr
.
	$cÚÃù
(
key
, 
modif›r
, 
Gtk
.
AcûlFÏgs
.
VISIBLE
, 
£lf
.
şo£
)

204 #F1 
shows
 
h–p


205 
	`add_h–p_shÜtcut
(
£lf
.
wšdow
, "editor")

207 #CŒl-
N
 
ü—‹s
 
a
 
Ãw
 
sk


208 
key
, 
modif›r
 = 
Gtk
.
	`acûË¿tÜ_·r£
('<Control>n')

209 
agr
.
	$cÚÃù
(
key
, 
modif›r
, 
Gtk
.
AcûlFÏgs
.
VISIBLE
, 
£lf
.
Ãw_sk
)

211 #CŒl-
Shiá
-
N
 
ü—‹s
 
a
 
Ãw
 
subsk


212 
š£¹_subsk
 = 
£lf
.
bud”
.
	`g‘_objeù
("insert_subtask")

213 
key
, 
mod
 = 
Gtk
.
	`acûË¿tÜ_·r£
("<Control><Shift>n")

214 
š£¹_subsk
.
	`add_acûË¿tÜ
('şicked', 
agr
, 
key
, 
mod
,

215 
Gtk
.
AcûlFÏgs
.
VISIBLE
)

217 #CŒl-
D
 
m¬ks
 
sk
 
as
 
dÚe


218 
m¬k_as_dÚe_ed™Ü
 = 
£lf
.
bud”
.
	`g‘_objeù
('mark_as_done_editor')

219 
key
, 
mod
 = 
Gtk
.
	`acûË¿tÜ_·r£
('<Control>d')

220 
m¬k_as_dÚe_ed™Ü
.
	`add_acûË¿tÜ
('şicked', 
agr
, 
key
, 
mod
,

221 
Gtk
.
AcûlFÏgs
.
VISIBLE
)

223 #CŒl-
I
 
m¬ks
 
sk
 
as
 
dismis£d


224 
dismiss_ed™Ü
 = 
£lf
.
bud”
.
	`g‘_objeù
('dismiss_editor')

225 
key
, 
mod
 = 
Gtk
.
	`acûË¿tÜ_·r£
('<Control>i')

226 
dismiss_ed™Ü
.
	`add_acûË¿tÜ
('şicked', 
agr
, 
key
, 
mod
,

227 
Gtk
.
AcûlFÏgs
.
VISIBLE
)

229 #Cª 
be
 
ÿÎed
 
©
 
ªy
 
time
 
to
 
»æeù
 
the
 
¡©us
 
of
h
Task


230 #Reäesh 
should
 
Ãv”
 
š‹rã»
 
w™h
 
the
 
TaskV›w
.

231 #Ià
a
 
t™Ë
 
is
 
·s£d
 
as
‡ 
·¿m‘”
, 
™
 
wl
 
become


232 #th
Ãw
 
wšdow
 
t™Ë
. 
If
 
nÙ
, 
we
 
wl
 
look
 
the
 
sk
itle.

233 #Reäesh‹xˆ
is
 
wh‘h”
 
Ü
 
nÙ
 
we
 
should
 
»äesh
 
the
 
TaskV›w


234 #(
došg
 
™
 
®l
 
the
 
time
 
is
 
dªg”ous
 th
sk
 i 
em±y
)

235 
def
 
	$»äesh_ed™Ü
(
£lf
, 
t™Ë
=
NÚe
, 
»äesh‹xt
=
F®£
):

236 
£lf
.
wšdow
 
is
 
NÚe
:

238 
to_§ve
 = 
F®£


239 #t™Ë 
of
 
the
 
wšdow


240 
t™Ë
:

241 
£lf
.
wšdow
.
	$£t_t™Ë
(
t™Ë
)

242 
to_§ve
 = 
True


244 
£lf
.
wšdow
.
	`£t_t™Ë
(£lf.
sk
.
	$g‘_t™Ë
())

246 
¡©us
 = 
£lf
.
sk
.
	$g‘_¡©us
()

247 
dismiss_toŞt
 = 
GnomeCÚfig
.
MARK_DISMISS_TOOLTIP


248 
undismiss_toŞt
 = 
GnomeCÚfig
.
MARK_UNDISMISS_TOOLTIP


249 
¡©us
 =ğ
Task
.
STA_DISMISSED
:

250 
£lf
.
dÚebu‰Ú
.
	$£t_Ïb–
(
GnomeCÚfig
.
MARK_DONE
)

251 
£lf
.
dÚebu‰Ú
.
	$£t_toŞt_‹xt
(
GnomeCÚfig
.
MARK_DONE_TOOLTIP
)

252 
£lf
.
dÚebu‰Ú
.
	`£t_icÚ_Çme
("gtg-task-done")

253 
£lf
.
dismissbu‰Ú
.
	$£t_Ïb–
(
GnomeCÚfig
.
MARK_UNDISMISS
)

254 
£lf
.
dismissbu‰Ú
.
	$£t_toŞt_‹xt
(
undismiss_toŞt
)

255 
£lf
.
dismissbu‰Ú
.
	`£t_icÚ_Çme
("gtg-task-undismiss")

256 
–if
 
¡©us
 =ğ
Task
.
STA_DONE
:

257 
£lf
.
dÚebu‰Ú
.
	$£t_Ïb–
(
GnomeCÚfig
.
MARK_UNDONE
)

258 
£lf
.
dÚebu‰Ú
.
	$£t_toŞt_‹xt
(
GnomeCÚfig
.
MARK_UNDONE_TOOLTIP
)

259 
£lf
.
dÚebu‰Ú
.
	`£t_icÚ_Çme
("gtg-task-undone")

260 
£lf
.
dismissbu‰Ú
.
	$£t_Ïb–
(
GnomeCÚfig
.
MARK_DISMISS
)

261 
£lf
.
dismissbu‰Ú
.
	$£t_toŞt_‹xt
(
dismiss_toŞt
)

262 
£lf
.
dismissbu‰Ú
.
	`£t_icÚ_Çme
("gtg-task-dismiss")

264 
£lf
.
dÚebu‰Ú
.
	$£t_Ïb–
(
GnomeCÚfig
.
MARK_DONE
)

265 
£lf
.
dÚebu‰Ú
.
	$£t_toŞt_‹xt
(
GnomeCÚfig
.
MARK_DONE_TOOLTIP
)

266 
£lf
.
dÚebu‰Ú
.
	`£t_icÚ_Çme
("gtg-task-done")

267 
£lf
.
dismissbu‰Ú
.
	$£t_Ïb–
(
GnomeCÚfig
.
MARK_DISMISS
)

268 
£lf
.
dismissbu‰Ú
.
	$£t_toŞt_‹xt
(
dismiss_toŞt
)

269 
£lf
.
dismissbu‰Ú
.
	`£t_icÚ_Çme
("gtg-task-dismiss")

270 
£lf
.
dÚebu‰Ú
.
	$show
()

271 
£lf
.
sksideb¬
.
	$show
()

273 #Reäeshšg 
the
 
¡©us
 
b¬
 
Ïb–s
 
ªd
 
d©e
 
boxes


274 
¡©us
 
š
 [
Task
.
STA_DISMISSED
, Task.
STA_DONE
]:

275 
£lf
.
bud”
.
	`g‘_objeù
("Ïb–2").
	$hide
()

276 
£lf
.
bud”
.
	`g‘_objeù
("box1").
	$hide
()

277 
£lf
.
bud”
.
	`g‘_objeù
("Ïb–4").
	$show
()

278 
£lf
.
bud”
.
	`g‘_objeù
("box4").
	$show
()

280 
£lf
.
bud”
.
	`g‘_objeù
("Ïb–4").
	$hide
()

281 
£lf
.
bud”
.
	`g‘_objeù
("box4").
	$hide
()

282 
£lf
.
bud”
.
	`g‘_objeù
("Ïb–2").
	$show
()

283 
£lf
.
bud”
.
	`g‘_objeù
("box1").
	$show
()

285 #»äeshšg 
the
 
¡¬t
 
d©e
 
f›ld


286 
¡¬td©e
 = 
£lf
.
sk
.
	$g‘_¡¬t_d©e
()

287 
Œy
:

288 
´evd©e
 = 
D©e
.
	`·r£
(
£lf
.
¡¬td©e_widg‘
.
	$g‘_‹xt
())

289 
upd©e_d©e
 = 
¡¬td©e
 !ğ
´evd©e


290 
exû±
 
V®ueE¼Ü
:

291 
upd©e_d©e
 = 
True


293 
upd©e_d©e
:

294 
£lf
.
¡¬td©e_widg‘
.
	`£t_‹xt
(
	$¡r
(
¡¬td©e
))

296 #»äeshšg 
the
 
due
 
d©e
 
f›ld


297 
dued©e
 = 
£lf
.
sk
.
	$g‘_due_d©e
()

298 
Œy
:

299 
´evd©e
 = 
D©e
.
	`·r£
(
£lf
.
dued©e_widg‘
.
	$g‘_‹xt
())

300 
upd©e_d©e
 = 
dued©e
 !ğ
´evd©e


301 
exû±
 
V®ueE¼Ü
:

302 
upd©e_d©e
 = 
True


304 
upd©e_d©e
:

305 
£lf
.
dued©e_widg‘
.
	`£t_‹xt
(
	$¡r
(
dued©e
))

307 #»äeshšg 
the
 
şo£d
 
d©e
 
f›ld


308 
şo£dd©e
 = 
£lf
.
sk
.
	$g‘_şo£d_d©e
()

309 
´evşd©e
 = 
D©e
.
	`·r£
(
£lf
.
şo£dd©e_widg‘
.
	$g‘_‹xt
())

310 
şo£dd©e
 !ğ
´evşd©e
:

311 
£lf
.
şo£dd©e_widg‘
.
	`£t_‹xt
(
	$¡r
(
şo£dd©e
))

313 #»äeshšg 
the
 
day
 
Ëá
 
Ïb–


314 #Ià
the
 
sk
 
is
 
m¬ked
 
as
 
dÚe
, 
we
 
di¥Ïy
h
d–ay
 
b‘w“n
he

315 #du
d©e
 
ªd
 
the
 
aùu®
 
şosšg
 d©e. 
If
h
sk
 
i¢
't marked

316 #a 
dÚe
, 
we
 
di¥Ïy
 
the
 
numb”
 
of
 
days
 
Ëá
.

317 
¡©us
 
š
 [
Task
.
STA_DISMISSED
, Task.
STA_DONE
]:

318 
d–ay
 = 
£lf
.
sk
.
	$g‘_days_Ï‹
()

319 
d–ay
 
is
 
NÚe
:

320 
txt
 = ""

321 
–if
 
d–ay
 == 0:

322 
txt
 = "Completed onime"

323 
–if
 
d–ay
 >= 1:

324 
txt
 = 
	`ng‘‹xt
("Completed %(days)d day†ate",

325 "Com¶‘ed %(days)d day Ï‹", 
d–ay
) % \

326 {'days': 
d–ay
}

327 
–if
 
d–ay
 <= -1:

328 
abs_d–ay
 = 
	$abs
(
d–ay
)

329 
txt
 = 
	`ng‘‹xt
("Completed %(days)d dayƒarly",

330 "Com¶‘ed %(days)d day —¾y", 
abs_d–ay
) % \

331 {'days': 
abs_d–ay
}

333 
due_d©e
 = 
£lf
.
sk
.
	$g‘_due_d©e
()

334 
»suÉ
 = 
due_d©e
.
	$days_Ëá
()

335 
due_d©e
.
	$is_fuzzy
():

336 
txt
 = ""

337 
–if
 
»suÉ
 > 0:

338 
txt
 = 
	`ng‘‹xt
("DutomÜrow!", "%(days)d day Ëá", 
»suÉ
) \

339 % {'days': 
»suÉ
}

340 
–if
 
»suÉ
 == 0:

341 
txt
 = 
_
("Dueoday!")

342 
–if
 
»suÉ
 < 0:

343 
abs_»suÉ
 = 
	$abs
(
»suÉ
)

344 
txt
 = 
	`ng‘‹xt
("Due yesterday!", "Was %(days)d days‡go",

345 
abs_»suÉ
è% {'days': 
	}
abs_result}

347 
¡yË_cÚ‹xt
 = 
£lf
.
wšdow
.
	$g‘_¡yË_cÚ‹xt
()

348 
cŞÜ
 = 
¡yË_cÚ‹xt
.
	`g‘_cŞÜ
(
Gtk
.
S‹FÏgs
.
INSENSITIVE
).
	$to_cŞÜ
()

349 
£lf
.
dayËá_Ïb–
.
	`£t_m¬kup
(

350 "<¥ª cŞÜ='%s'>%s</¥ª>" % (
cŞÜ
.
	`to_¡ršg
(), 
txt
))

352 #Reäeshšg 
the
 
g
 
li¡
 
š
h
š£¹
ag 
bu‰Ú


353 
gli¡
 = 
£lf
.
»q
.
	$g‘_u£d_gs
()

354 
m’u
 = 
Gtk
.
	$M’u
()

355 
g_couÁ
 = 0

356 
gÇme
 
š
 
gli¡
:

357 
g_objeù
 = 
£lf
.
»q
.
	$g‘_g
(
gÇme
)

358 
nÙ
 
g_objeù
.
	$is_¥ecŸl
(è
ªd
 \

359 
nÙ
 
£lf
.
sk
.
	$has_gs
(
g_li¡
=[
gÇme
]):

360 
g_couÁ
 += 1

361 
mi
 = 
Gtk
.
	$M’uI‹m
(
Ïb–
=
gÇme
, 
u£_und”lše
=
F®£
)

362 
mi
.
	`cÚÃù
("aùiv©e", 
£lf
.
š£¹g
, 
gÇme
)

363 
mi
.
	$show
()

364 
m’u
.
	$­³nd
(
mi
)

365 
g_couÁ
 > 0:

366 
£lf
.
š£¹g_bu‰Ú
.
	$£t_m’u
(
m’u
)

368 #Reäeshšg 
the
 
·»Á
 
li¡
 
š
 
İ’_·»Á_bu‰Ú


369 
m’u
 = 
Gtk
.
	$M’u
()

370 
·»Ás
 = 
£lf
.
sk
.
	$g‘_·»Ás
()

371 
	`Ën
(
·»Ás
) > 0:

372 
·»Á
 
š
 
£lf
.
sk
.
	$g‘_·»Ás
():

373 
sk
 = 
£lf
.
»q
.
	$g‘_sk
(
·»Á
)

374 
mi
 = 
Gtk
.
	`M’uI‹m
(
Ïb–
=
sk
.
	`g‘_t™Ë
(), 
u£_und”lše
=
F®£
)

375 
mi
.
	`cÚÃù
("aùiv©e", 
£lf
.
İ’_·»Á
, 
·»Á
)

376 
mi
.
	$show
()

377 
m’u
.
	$­³nd
(
mi
)

378 
£lf
.
İ’_·»Ás_bu‰Ú
.
	$£t_m’u
(
m’u
)

380 
£lf
.
İ’_·»Ás_bu‰Ú
.
	$£t_£ns™ive
(
F®£
)

382 
»äesh‹xt
:

383 
£lf
.
‹xtv›w
.
	$modif›d
(
»äeshed™Ü
=
F®£
)

384 
to_§ve
:

385 
£lf
.
	$light_§ve
()

387 
def
 
	$d©e_chªged
(
£lf
, 
widg‘
, 
d©a
):

388 
Œy
:

389 
D©e
.
	`·r£
(
widg‘
.
	$g‘_‹xt
())

390 
v®id
 = 
True


391 
exû±
 
V®ueE¼Ü
:

392 
v®id
 = 
F®£


394 
v®id
:

395 #Ià
the
 
d©e
 
is
 
v®id
, 
we
 
wr™e
 
w™h
  
cŞÜ
 
š
h
widg‘


396 #"
nÚe
" will sethe default color.

397 
widg‘
.
	$ov”ride_cŞÜ
(
Gtk
.
S‹Ty³
.
NORMAL
, 
NÚe
)

398 
widg‘
.
	$ov”ride_background_cŞÜ
(
Gtk
.
S‹Ty³
.
NORMAL
, 
NÚe
)

400 #W
should
 
wr™e
 
š
 
»d
 iÀ
the
 
’Œy
 th
d©e
 
is
 
nÙ
 
v®id


401 
‹xt_cŞÜ
 = 
Gdk
.
	$RGBA
()

402 
‹xt_cŞÜ
.
	`·r£
("#F00")

403 
widg‘
.
	$ov”ride_cŞÜ
(
Gtk
.
S‹Ty³
.
NORMAL
, 
‹xt_cŞÜ
)

405 
bg_cŞÜ
 = 
Gdk
.
	$RGBA
()

406 
bg_cŞÜ
.
	`·r£
("#F88")

407 
widg‘
.
	$ov”ride_background_cŞÜ
(
Gtk
.
S‹Ty³
.
NORMAL
, 
bg_cŞÜ
)

409 
def
 
	$d©e_focus_out
(
£lf
, 
widg‘
, 
ev’t
, 
d©e_kšd
):

410 
Œy
:

411 
d©‘o£t
 = 
D©e
.
	`·r£
(
widg‘
.
	$g‘_‹xt
())

412 
exû±
 
V®ueE¼Ü
:

413 
d©‘o£t
 = 
NÚe


415 
d©‘o£t
 
is
 
nÙ
 
NÚe
:

416 
d©e_kšd
 =ğ
GTGC®’d¬
.
DATE_KIND_START
:

417 
£lf
.
sk
.
	$£t_¡¬t_d©e
(
d©‘o£t
)

418 
–if
 
d©e_kšd
 =ğ
GTGC®’d¬
.
DATE_KIND_DUE
:

419 
£lf
.
sk
.
	$£t_due_d©e
(
d©‘o£t
)

420 
–if
 
d©e_kšd
 =ğ
GTGC®’d¬
.
DATE_KIND_CLOSED
:

421 
£lf
.
sk
.
	$£t_şo£d_d©e
(
d©‘o£t
)

422 
£lf
.
	$»äesh_ed™Ü
()

424 
def
 
	$Ú_d©e_´es£d
(
£lf
, 
widg‘
, 
d©e_kšd
):

426 
d©e_kšd
 =ğ
GTGC®’d¬
.
DATE_KIND_DUE
:

427 
nÙ
 
£lf
.
sk
.
	$g‘_due_d©e
():

428 
d©e
 = 
£lf
.
sk
.
	$g‘_¡¬t_d©e
()

430 
d©e
 = 
£lf
.
sk
.
	$g‘_due_d©e
()

431 
–if
 
d©e_kšd
 =ğ
GTGC®’d¬
.
DATE_KIND_START
:

432 
d©e
 = 
£lf
.
sk
.
	$g‘_¡¬t_d©e
()

433 
–if
 
d©e_kšd
 =ğ
GTGC®’d¬
.
DATE_KIND_CLOSED
:

434 
d©e
 = 
£lf
.
sk
.
	$g‘_şo£d_d©e
()

435 
£lf
.
ÿËnd¬
.
	$£t_d©e
(
d©e
, 
d©e_kšd
)

436 #w
show
 
the
 
ÿËnd¬
 
©
h
right
 
pos™iÚ


437 
»ù
 = 
widg‘
.
	$g‘_®loÿtiÚ
()

438 
»suÉ
, 
x
, 
y
 = 
widg‘
.
	`g‘_wšdow
().
	$g‘_Üigš
()

439 
£lf
.
ÿËnd¬
.
	`show_©_pos™iÚ
(
x
 + 
»ù
.x +„eù.
width
,

440 
y
 + 
»ù
.y)

442 
def
 
	$Ú_d©e_chªged
(
£lf
, 
ÿËnd¬
):

443 
d©e
, 
d©e_kšd
 = 
ÿËnd¬
.
	$g‘_£Ëùed_d©e
()

444 
d©e_kšd
 =ğ
GTGC®’d¬
.
DATE_KIND_DUE
:

445 
£lf
.
sk
.
	$£t_due_d©e
(
d©e
)

446 
–if
 
d©e_kšd
 =ğ
GTGC®’d¬
.
DATE_KIND_START
:

447 
£lf
.
sk
.
	$£t_¡¬t_d©e
(
d©e
)

448 
–if
 
d©e_kšd
 =ğ
GTGC®’d¬
.
DATE_KIND_CLOSED
:

449 
£lf
.
sk
.
	$£t_şo£d_d©e
(
d©e
)

450 
£lf
.
	$»äesh_ed™Ü
()

452 
def
 
	$şo£_®l_subsks
(
£lf
):

453 
®l_subsks
 = []

455 
def
 
	$Œaû_subsks
(
roÙ
):

456 
i
 
š
 
roÙ
.
	$g‘_subsks
():

457 
i
 
nÙ
 
š
 
®l_subsks
:

458 
®l_subsks
.
	$­³nd
(
i
)

459 
	$Œaû_subsks
(
i
)

461 
	$Œaû_subsks
(
£lf
.
sk
)

463 
sk
 
š
 
®l_subsks
:

464 
£lf
.
vmªag”
.
	`şo£_sk
(
sk
.
	$g‘_id
())

466 
def
 
	$dismiss
(
£lf
, 
widg‘
):

467 
¡©
 = 
£lf
.
sk
.
	$g‘_¡©us
()

468 
¡©
 =ğ
Task
.
STA_DISMISSED
:

469 
£lf
.
vmªag”
.
	$ask_£t_sk_¡©us
(
£lf
.
sk
, 
Task
.
STA_ACTIVE
)

470 
£lf
.
	$»äesh_ed™Ü
()

472 
£lf
.
vmªag”
.
	$ask_£t_sk_¡©us
(
£lf
.
sk
, 
Task
.
STA_DISMISSED
)

473 
£lf
.
	$şo£_®l_subsks
()

474 
£lf
.
	$şo£
(
NÚe
)

476 
def
 
	$chªge_¡©us
(
£lf
, 
widg‘
):

477 
¡©
 = 
£lf
.
sk
.
	$g‘_¡©us
()

478 
¡©
 =ğ
Task
.
STA_DONE
:

479 
£lf
.
vmªag”
.
	$ask_£t_sk_¡©us
(
£lf
.
sk
, 
Task
.
STA_ACTIVE
)

480 
£lf
.
	$»äesh_ed™Ü
()

482 
£lf
.
vmªag”
.
	$ask_£t_sk_¡©us
(
£lf
.
sk
, 
Task
.
STA_DONE
)

483 
£lf
.
	$şo£_®l_subsks
()

484 
£lf
.
	$şo£
(
NÚe
)

486 
def
 
	$d–‘e_sk
(
£lf
, 
widg‘
):

487 #thi 
Œigg”s
 
the
 
şosšg
 
of
h
wšdow
 
š
h
v›w
 
mªag”


488 
£lf
.
sk
.
	$is_Ãw
():

489 #£lf.
»q
.
	`d–‘e_sk
(
£lf
.
sk
.
	`g‘_id
())

490 
£lf
.
vmªag”
.
	`şo£_sk
(£lf.
sk
.
	$g‘_id
())

492 
£lf
.
vmªag”
.
	`ask_d–‘e_sks
([£lf.
sk
.
	`g‘_id
()])

494 #Tak
the
 
t™Ë
 
as
 
¬gum’t
 
ªd
 h
subsk
 
ID


495 
def
 
	$Ãw_subsk
(
£lf
, 
t™Ë
=
NÚe
, 
tid
=None):

496 
tid
:

497 
£lf
.
sk
.
	$add_chd
(
tid
)

498 
–if
 
t™Ë
:

499 
subt
 = 
£lf
.
sk
.
	$Ãw_subsk
()

500 
subt
.
	$£t_t™Ë
(
t™Ë
)

501 
tid
 = 
subt
.
	$g‘_id
()

502  
tid


504 #C»©
a
 
Ãw
 
sk


505 
def
 
	$Ãw_sk
(
£lf
, *
¬gs
):

506 
sk
 = 
£lf
.
»q
.
	$Ãw_sk
(
Ãwsk
=
True
)

507 
sk_id
 = 
sk
.
	$g‘_id
()

508 
£lf
.
vmªag”
.
	$İ’_sk
(
sk_id
)

510 
def
 
	$š£¹_subsk
(
£lf
, 
widg‘
):

511 
£lf
.
‹xtv›w
.
	$š£¹_Ãwsk
()

512 
£lf
.
‹xtv›w
.
	$g¿b_focus
()

514 
def
 
	$š£¹g_şicked
(
£lf
, 
widg‘
):

515 
™”a
 = 
£lf
.
‹xtv›w
.
	$g‘_š£¹
()

516 
™”a
.
	$¡¬ts_lše
():

517 
£lf
.
‹xtv›w
.
	`š£¹_‹xt
("@", 
™”a
)

519 
£lf
.
‹xtv›w
.
	`š£¹_‹xt
(" @", 
™”a
)

520 
£lf
.
‹xtv›w
.
	$g¿b_focus
()

522 
def
 
	$š£¹g
(
£lf
, 
widg‘
, 
g
):

523 
£lf
.
‹xtv›w
.
	$š£¹_gs
([
g
])

524 
£lf
.
‹xtv›w
.
	$g¿b_focus
()

526 
def
 
	$İ’_·»Á_şicked
(
£lf
, 
widg‘
):

527 
£lf
.
vmªag”
.
	`İ’_sk
(£lf.
sk
.
	`g‘_·»Ás
()[0])

529 #OÀ
şick
 
hªdËr
 
İ’_·»Á_bu‰Ú
's menu items

530 
def
 
	$İ’_·»Á
(
£lf
, 
widg‘
, 
tid
):

531 
£lf
.
vmªag”
.
	$İ’_sk
(
tid
)

533 
def
 
	$§ve
(
£lf
):

534 
£lf
.
sk
.
	`£t_t™Ë
(£lf.
‹xtv›w
.
	$g‘_t™Ë
())

535 
£lf
.
sk
.
	`£t_‹xt
(£lf.
‹xtv›w
.
	$g‘_‹xt
())

536 
£lf
.
sk
.
	$sync
()

537 
	`´št
("*****************Savšgask:\n"+
£lf
.
‹xtv›w
.
	$g‘_‹xt
())

538 
£lf
.
cÚfig
 
is
 
nÙ
 
NÚe
:

539 
£lf
.
cÚfig
.
	$§ve
()

540 
£lf
.
time
 =ime.
	$time
()

541 #light_§v
§ve
 
the
 
sk
 
w™hout
 
»äeshšg
 
ev”y
 30
£cÚds


542 #W
wl
 
»duû
 
the
 
time
 
wh’
h
g‘_‹xt
 wÈ
be
 
š
 
ªÙh”
 
th»ad


544 
def
 
	$light_§ve
(
£lf
):

545 #ià
£lf
.
time
 
is
 
nÚe
, 
we
 
Ãv”
 
ÿÎed
 
ªy
 
§ve


546 
£lf
.
time
:

547 
diff
 = 
time
.
	`time
(è- 
£lf
.time

548 
to§ve
 = 
diff
 > 
GnomeCÚfig
.
SAVETIME


550 #w
dÚ
't wanto save‡ask while opening it

551 
to§ve
 = 
£lf
.
‹xtv›w
.
	$g‘_ed™abË
()

552 
diff
 = 
NÚe


553 
to§ve
:

554 
£lf
.
	$§ve
()

556 #Thi 
wl
 
bršg
 
the
 
Task
 
Ed™Ü
 
to
 
äÚt


557 
def
 
	$´e£Á
(
£lf
):

558 
£lf
.
wšdow
.
	$´e£Á
()

560 
def
 
	$move
(
£lf
, 
x
, 
y
):

561 
Œy
:

562 
xx
 = (
x
)

563 
yy
 = (
y
)

564 
£lf
.
wšdow
.
	$move
(
xx
, 
yy
)

565 
exû±
:

566 
·ss


568 
def
 
	$g‘_pos™iÚ
(
£lf
):

569  
£lf
.
wšdow
.
	$g‘_pos™iÚ
()

571 
def
 
	$Ú_move
(
£lf
, 
widg‘
, 
ev’t
):

572 #§všg 
the
 
pos™iÚ


573 
£lf
.
cÚfig
 
is
 
nÙ
 
NÚe
:

574 
tid
 = 
£lf
.
sk
.
	$g‘_id
()

575 
nÙ
 
£lf
.
cÚfig
.
	$has_£ùiÚ
(
tid
):

576 
£lf
.
cÚfig
.
	$add_£ùiÚ
(
tid
)

577 
£lf
.
cÚfig
.
	`£t
(
tid
, "pos™iÚ", s–f.
	$g‘_pos™iÚ
())

578 
£lf
.
cÚfig
.
	`£t
(
tid
, "size", s–f.
wšdow
.
	$g‘_size
())

580 #W
defše
 
dummy
 
v¬ŸbË
 
wh’
 
şo£
 
is
 
ÿÎed
 
äom
 
a
 
ÿÎback


581 
def
 
	$şo£
(
£lf
, 
wšdow
=
NÚe
, 
a
=NÚe, 
b
=NÚe, 
c
=None):

583 #W
should
 
®so
 
de¡roy
 
the
 
whŞe
 
sked™Ü
 
objeù
.

584 
£lf
.
wšdow
:

585 
£lf
.
wšdow
.
	$de¡roy
()

586 
£lf
.
wšdow
 = 
NÚe


588 #Th
de¡roy
 
sigÇl
 
is
 
lšked
 
to
 
the
 "şo£" 
bu‰Ú
. 
So
 
we
 
ÿÎ


589 #de¡roy 
š
 
the
 
şo£
 
funùiÚ
, 
this
 
wl
 
ÿu£
hşo£ 
to
 
be
 
ÿÎed


591 #TØ
sŞve
 
th©
, 
şo£
 
wl
 
ju¡
 
ÿÎ
 "de¡roy" 
ªd
 
the
 
de¡roy
 
sigÇl


592 #WÈ
be
 
lšked
 
to
 
this
 
de¡ruùiÚ
 
m‘hod
 
th©
 
wl
 
§ve
 
the
 
sk


593 
def
 
	$de¡ruùiÚ
(
£lf
, 
a
=
NÚe
):

594 #Sav
should
 
be
 
®so
 
ÿÎed
 
wh’
 
bufãr
 
is
 
modif›d


595 
£lf
.
³ngše
.
	$ÚTaskClo£
(
£lf
.
¶ugš_­i
)

596 
£lf
.
³ngše
.
	$»move_­i
(
£lf
.
¶ugš_­i
)

597 
tid
 = 
£lf
.
sk
.
	$g‘_id
()

598 
£lf
.
sk
.
	$is_Ãw
():

599 
£lf
.
»q
.
	$d–‘e_sk
(
tid
)

601 
£lf
.
	$§ve
()

602 
i
 
š
 
£lf
.
sk
.
	$g‘_subsks
():

603 
i
:

604 
i
.
	$£t_to_k“p
()

605 
£lf
.
vmªag”
.
	$şo£_sk
(
tid
)

607 
def
 
	$g‘_bud”
(
£lf
):

608  
£lf
.
bud”


610 
def
 
	$g‘_sk
(
£lf
):

611  
£lf
.
sk


613 
def
 
	$g‘_‹xtv›w
(
£lf
):

614  
£lf
.
‹xtv›w


616 
def
 
	$g‘_wšdow
(
£lf
):

617  
£lf
.
wšdow


	@gtk/editor/taskview.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2014 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
This
 
şass
 
im¶em’ts
 
a
 
	gGtk
.
TextV›w
 
but
 
w™h
 
mªy
 
Ùh”
 
ã©u»s


18 
like
 
hy³¾šk
 
ªd
 
Ùh”
 
¡uff
 
¥ecŸl
 
GTG


20 
FÜ
 
your
 
	gšfÜm©iÚ
, 
a
 
GtkTextV›w
 
®ways
 
cÚšs
‡ 
	gGtk
.
TextBufãr
 
which


21 
CÚšs
 
the
 
	g‹xt
. 
Ours
 
is
 
ÿÎed
 
	g£lf
.
buff
 (
how
 
Üigš®
 !)

23 
This
 
is
 
a
 
şass
 
k’
 
Üigš®ly
 
äom


24 
	gh‰p
:

25 
It
 
was
 
š
 
J­ªe£
 
ªd
 
I
 
didn
't understand‡nything buthe code.

29 
impÜt
 
os


31 
äom
 
gi
.
»pos™Üy
 
impÜt
 
GObjeù
, 
	gGtk
, 
	gGdk
, 
Pªgo


33 
äom
 
webbrow£r
 
impÜt
 
İ’
 
as
 
İ’u¾


34 
äom
 
	gGTG
.
	ggtk
.
ed™Ü
 
impÜt
 
skv›w£rŸl


35 
äom
 
	gGTG
.
toŞs
 
impÜt
 
u¾»gex


37 
	g£·¿tÜs
 = [' ', ',', '\n', '\t', '!', '?', ';', '\0', '(', ')']

38 #tho£ 
£·¿tÜs
 
¬e
 
Úly
 s•¬©Ü 
fŞlowed
 
by
 
a
 
¥aû
. 
El£
, 
they


39 #¬
·¹
 
of
 
the
 
wÜd


40 
	g¥ecŸls_£·¿tÜs
 = ['.', '/']

42 
	gbuÎ‘1_Ér
 = 'â†’'

43 
buÎ‘1_¹l
 = 'â†'

46 
şass
 
	$TaskV›w
(
Gtk
.
TextV›w
):

47 
__gty³_Çme__
 = 'HyperTextView'

48 
__gsigÇls__
 = {'ªchÜ-şicked': (
GObjeù
.
SigÇlFÏgs
.
RUN_LAST
,

49 
NÚe
, (
¡r
, sŒ, ))
	}
}

50 
__g´İ”t›s__
 = {

51 'lšk': (
GObjeù
.
TYPE_PYOBJECT
, 'link color',

52 'lšk cŞÜ oàTextV›w', 
GObjeù
.
PARAM_READWRITE
),

53 'çedlšk': (
GObjeù
.
TYPE_PYOBJECT
, 'failed†ink color',

55 
GObjeù
.
PARAM_READWRITE
),

56 'aùive': (
GObjeù
.
TYPE_PYOBJECT
, 'active color',

57 'aùivcŞÜ oàTextV›w', 
GObjeù
.
PARAM_READWRITE
),

58 'hov”': (
GObjeù
.
TYPE_PYOBJECT
, 'link:hover color',

59 'lšk:hov” cŞÜ oàTextV›w', 
GObjeù
.
PARAM_READWRITE
),

60 'g': (
GObjeù
.
TYPE_PYOBJECT
, 'tag color',

61 'g cŞÜ oàTextV›w', 
GObjeù
.
PARAM_READWRITE
),

62 'dÚe': (
GObjeù
.
TYPE_PYOBJECT
, 'link color',

63 'lšk cŞÜ oàTextV›w', 
GObjeù
.
PARAM_READWRITE
),

64 'šd’t': (
GObjeù
.
TYPE_PYOBJECT
, 'indent color',

65 'šd’ˆcŞÜ oàTextV›w', 
GObjeù
.
PARAM_READWRITE
),

68 
def
 
	$do_g‘_´İ”ty
(
£lf
, 
´İ
):

69 
Œy
:

70  
	$g‘©Œ
(
£lf
, 
´İ
.
Çme
)

71 
exû±
 
A‰ribu‹E¼Ü
:

72 
¿i£
 
	`A‰ribu‹E¼Ü
('unknowÀ´İ”ty %s' % 
´İ
.
Çme
)

74 
def
 
	$do_£t_´İ”ty
(
£lf
, 
´İ
, 
v®
):

75 
´İ
.
Çme
 
š
 
	`li¡
(
£lf
.
__g´İ”t›s__
.
	$keys
()):

76 
	$£‰r
(
£lf
, 
´İ
.
Çme
, 
v®
)

78 
¿i£
 
	`A‰ribu‹E¼Ü
('unknowÀ´İ”ty %s' % 
´İ
.
Çme
)

80 #Yes, 
we
 
wªt
 
to
 
»defše
 
the
 
bufãr
. 
Di§blšg
 
pylšt
 
Ú
 
th©
 
”rÜ
.

81 
def
 
	$__š™__
(
£lf
, 
»que¡”
, 
şbßrd
):

82 
Gtk
.
TextV›w
.
	$__š™__
(
£lf
)

83 
£lf
.
buff
 = s–f.
	$g‘_bufãr
()

84 
£lf
.
»q
 = 
»que¡”


85 #Bufã¸
š™


86 
£lf
.
lšk
 = {'background': 'white', 'foreground': '#007bff',

87 'und”lše': 
Pªgo
.
Und”lše
.
SINGLE
,

88 '¡rik‘hrough': 
F®£
}

89 
£lf
.
çedlšk
 = {'background': 'white', 'foreground': '#ff5454',

90 'und”lše': 
Pªgo
.
Und”lše
.
NONE
,

91 '¡rik‘hrough': 
F®£
}

92 
£lf
.
dÚe
 = {'background': 'white', 'foreground': 'gray',

93 '¡rik‘hrough': 
True
}

94 
£lf
.
aùive
 = {'background': 'light gray', 'foreground': '#ff1e00',

95 'und”lše': 
Pªgo
.
Und”lše
.
SINGLE
}

96 
£lf
.
hov”
 = {'background': 'light gray'}

97 
£lf
.
g
 = {'background': "#FFea00", 'foreground': 'black'}

98 
£lf
.
šd’t
 = {'sÿË': 1.4, 'ed™abË': 
F®£
, 'left-margin': 10,

99 "accumuÏtive-m¬gš": 
True
}

101 ###### 
Tag
 
we
 
wl
 
u£
 ######

102 #W
u£
 
the
 
g
 
bË
 (g 
¬e
 
defšed
 
h”e


103 #buˆ
£t
 
š
 
£lf
.
modif›d
)

104 
£lf
.
bË
 = s–f.
buff
.
	$g‘_g_bË
()

105 #Tag 
t™Ë


106 
£lf
.
t™Ë_g
 = s–f.
buff
.
	`ü—‹_g
("t™Ë", 
fÜeground
="#007bff",

107 
sÿË
=1.6, 
und”lše
=1)

108 
£lf
.
t™Ë_g
.
	`£t_´İ”ty
("pixels-above-lines", 10)

109 
£lf
.
t™Ë_g
.
	`£t_´İ”ty
("pixels-below-lines", 10)

110 #Tag 
	`highlight
 (
gs
 
¬e
 
autom©iÿÎy
 
added
 
to
 
the
 
g
 
bË
)

111 
£lf
.
buff
.
	`ü—‹_g
("æuo", 
background
="#F0F")

112 #Tag 
buÎ‘s


113 
£lf
.
buff
.
	`ü—‹_g
("buÎ‘", 
sÿË
=1.6)

114 #’d = 
£lf
.
buff
.
	`g‘_’d_™”
()

116 #Thi 
is
 
the
 
li¡
 
of
 
®l
h
lšks
 
š
 
our
 
sk


117 
£lf
.
__gs
 = []

118 #Thi 
is
 
a
 
sim¶e
 
¡ack
 
u£d
 
by
 
the
 
£rŸliz©iÚ


119 
£lf
.
__g_¡ack
 = {
	}
}

122 
£lf
.
cÚÃù
('mÙiÚ-nÙify-ev’t', s–f.
_mÙiÚ
)

123 
	g£lf
.
cÚÃù
('focus-out-event',

124 
Ïmbda
 
w
, 
e
: 
£lf
.
bË
.
	$fÜ—ch
(
£lf
.
__g_»£t
,

125 
e
.
wšdow
))

126 
£lf
.
š£¹_sigid
 = s–f.
buff
.
	`cÚÃù
('insert-text',

127 
£lf
.
_š£¹_©_cursÜ
)

128 
£lf
.
d–‘e_sigid
 = s–f.
buff
.
	`cÚÃù
("delete-range",

129 
£lf
.
_d–‘e_¿nge
)

130 
£lf
.
	`cÚÃù
('cİy-şbßrd', s–f.
cİy_şbßrd
, "copy")

131 
£lf
.
	`cÚÃù
('cut-şbßrd', s–f.
cİy_şbßrd
, "cut")

132 
£lf
.
	`cÚÃù
('·¡e-şbßrd', s–f.
·¡e_şbßrd
)

134 
£lf
.
	`cÚÃù_aá”
('d¿g-d©a-»ûived', s–f.
d¿g_»ûive
)

136 #AÎ 
the
 
typiÿl
 
´İ”t›s
 
of
 
our
 
‹xtv›w


137 
£lf
.
	$£t_w¿p_mode
(
Gtk
.
W¿pMode
.
WORD
)

138 
£lf
.
	$£t_ed™abË
(
True
)

139 
£lf
.
	$£t_cursÜ_visibË
(
True
)

140 
£lf
.
buff
.
	$£t_modif›d
(
F®£
)

143 
£rŸliz”
 = 
skv›w£rŸl
.
	$S”Ÿliz”
()

144 
£lf
.
£rŸliz”
 = serializer

145 
un£rŸliz”
 = 
skv›w£rŸl
.
	$Un£rŸliz”
(
£lf
)

146 
£lf
.
un£rŸliz”
 = unserializer

147 #FIXME 
aá”
 
discussiÚ
 
w™h
 
LiÚ–
 
»move
 
tho£
 
funùiÚs


148 #ªd 
sim¶ify
 
the
 
code


149 #£lf.
£rŸlize_fÜm©
 = 
£lf
.
buff
.
	`»gi¡”_£rŸlize_fÜm©
(

150 #mime_ty³, 
£rŸliz”
.
£rŸlize
, 
NÚe
)

151 #£lf.
de£rŸlize_fÜm©
 = 
£lf
.
buff
.
	`»gi¡”_de£rŸlize_fÜm©
(

152 #mime_ty³, 
un£rŸliz”
.
un£rŸlize
, 
NÚe
)

154 #Th
li¡
 
of
 
ÿÎbacks
 
we
 
have
 
to
 
£t


155 
£lf
.
»move_g_ÿÎback
 = 
NÚe


156 
£lf
.
add_g_ÿÎback
 = 
NÚe


157 
£lf
.
g‘_g¦i¡
 = 
NÚe


158 
£lf
.
g‘_subsks
 = 
NÚe


159 
£lf
.
»move_subsk
 = 
NÚe


160 
£lf
.
__»äesh_cb
 = 
NÚe
 #»äesh 
the
 
ed™Ü
 
wšdow


161 
£lf
.
İ’_sk
 = 
NÚe
 #İ’ 
ªÙh”
 
sk


162 
£lf
.
Ãw_subsk_ÿÎback
 = 
NÚe
 #ü—‹ 
a
 
subsk


163 
£lf
.
§ve_sk
 = 
NÚe
 #Thi 
wl
 
§ve
 
the
 
sk
 
w™hout
 
»äeshšg
 
®l


165 #Th
sigÇl
 
em™‹d
 
—ch
 
time
 
the
 
bufãr
 
is
 
modif›d


166 #Pu‰šg 
™
 
©
 
the
 
’d
 
to
 
avoid
 
došg
 iˆ
too
 
much
 
wh’
 
¡¬tšg


167 
£lf
.
modif›d_sigid
 = s–f.
buff
.
	`cÚÃù
("chªged", s–f.
modif›d
)

168 
£lf
.
back¥aû_sigid
 = s–f.
	`cÚÃù
("back¥aû", s–f.
back¥aû
)

169 
£lf
.
tobe_»äeshed
 = 
F®£


170 
£lf
.
şbßrd
 = clipboard

172 
£lf
.
	`g‘_dœeùiÚ
(è=ğ
Gtk
.
TextDœeùiÚ
.
RTL
:

173 
£lf
.
buÎ‘1
 = 
buÎ‘1_¹l


175 
£lf
.
buÎ‘1
 = 
buÎ‘1_Ér


176 
£lf
.
ed™abË
 = 
F®£


178 
def
 
	$d¿g_»ûive
(
£lf
, 
widg‘
, 
cÚ‹xt
, 
x
, 
y
, 
£ËùiÚ
, 
d©©y³
, 
‘ime
):

181 
Exam¶e
 
u§ge
: 
d¿g
 
ªd
 
drİ
 
of
 
fe
 
lšks
 """

182 
£lf
.
	$modif›d
(
fuÎ
=
True
)

183 
£lf
.
	`¡İ_emissiÚ
('drag-data-received')

185 #ed™abË 
m—ns
 
th©
 
the
 
u£r
 
ÿn
 
ed™
h
skv›w


186 #thi 
is
 
š™ŸÎy
 
£t
 
©
 
F®£
 
ªd
 
th’
 
to
 
True
 
Úû
 
the
 
ed™Ü
 
wšdow


187 #i 
di¥Ïyed
.

188 #thi 
is
 
u£d
 
to
 
avoid
 
§všg
 
the
 
sk
 
wh’
h
wšdow
 i 
¡l


189 #nÙ 
di¥Ïyed


190 
def
 
	$£t_ed™abË
(
£lf
, 
bouË
):

191 
£lf
.
ed™abË
 = 
bouË


193 
def
 
	$g‘_ed™abË
(
£lf
):

194  
£lf
.
ed™abË


196 #Thi 
funùiÚ
 
is
 
ÿÎed
 
to
 
»äesh
 
the
 
ed™Ü


197 #S³cŸÎy 
wh’
 
we
 
chªge
 
the
 
t™Ë


198 
def
 
	$»äesh
(
£lf
, 
t™Ë
):

199 
£lf
.
__»äesh_cb
:

200 
£lf
.
	$__»äesh_cb
(
t™Ë
)

202 
def
 
	$»äesh_ÿÎback
(
£lf
, 
funù
):

203 
£lf
.
__»äesh_cb
 = 
funù


205 #Thi 
ÿÎback
 
is
 
ÿÎed
 
to
 
add
 
a
 
Ãw
 
g


206 
def
 
	$£t_add_g_ÿÎback
(
£lf
, 
funù
):

207 
£lf
.
add_g_ÿÎback
 = 
funù


209 #Thi 
ÿÎback
 
is
 
ÿÎed
 
to
 
add
 
a
 
Ãw
 
g


210 
def
 
	$£t_»move_g_ÿÎback
(
£lf
, 
funù
):

211 
£lf
.
»move_g_ÿÎback
 = 
funù


213 #Thi 
ÿÎback
 
is
 
ÿÎed
 
to
 
have
 
the
 
li¡
 
of
 
gs
 oà
a
 
sk


214 
def
 
	$£t_g‘_g¦i¡_ÿÎback
(
£lf
, 
funù
):

215 
£lf
.
g‘_g¦i¡
 = 
funù


217 #Thi 
ÿÎback
 
is
 
ÿÎed
 
to
 
ü—‹
 
a
 
Ãw
 
subsk


218 
def
 
	$£t_subsk_ÿÎback
(
£lf
, 
funù
):

219 
£lf
.
Ãw_subsk_ÿÎback
 = 
funù


221 #Thi 
ÿÎback
 
is
 
ÿÎed
 
to
 
İ’
 
ªÙh”
 
sk


222 
def
 
	$İ’_sk_ÿÎback
(
£lf
, 
funù
):

223 
£lf
.
İ’_sk
 = 
funù


225 #Thi 
was
 
hi¡ÜiÿÎy
 
a
 
ÿÎback
 
but
 
™
 
»tuºs
 
the
 
t™Ë


226 
def
 
	$g‘_subskt™Ë
(
£lf
, 
tid
):

227 
sk
 = 
£lf
.
»q
.
	$g‘_sk
(
tid
)

228 
sk
:

229  
sk
.
	$g‘_t™Ë
()

231  
NÚe


233 #Thi 
ÿÎback
 
is
 
ÿÎed
 
to
 
g‘
 
the
 
li¡
 
of
 
tid
 oà
subsks


234 
def
 
	$subsks_ÿÎback
(
£lf
, 
funù
):

235 
£lf
.
g‘_subsks
 = 
funù


237 #Thi 
ÿÎback
 
is
 
ÿÎed
 
to
 
»move
 
a
 
subsk
 
by
 
™s
 
pid


238 
def
 
	$»movesubsk_ÿÎback
(
£lf
, 
funù
):

239 
£lf
.
»move_subsk
 = 
funù


241 
def
 
	$§ve_sk_ÿÎback
(
£lf
, 
funù
):

242 
£lf
.
§ve_sk
 = 
funù


244 #Bufã¸
»Ï‹d
 
funùiÚs


245 #Tho£ 
funùiÚs
 
¬e
 
higly
 
»Ï‹d
 
ªd
 
should
 
®ways
 
be
 
sym‘riÿl


246 #S“ 
®so
 
the
 
£rŸlizšg
 
funùiÚs


247 #### 
The
 "S‘ext" 
group
 ########

248 #Thi 
£t
 
the
 
‹xt
 
of
h
	`bufãr
 (
ªd
 
»¶aû
 
ªy
 
exi¡šg
 
Úe
)

249 #w™houˆ
	`de£rŸlizšg
 (
u£d
 
the
 
t™Ë
)

250 
def
 
	$£t_‹xt
(
£lf
, 
¡ri
):

251 
£lf
.
buff
.
	$£t_‹xt
(
¡ri
)

252 #Thi 
­³nd
 
‹xt
 
©
 
the
 
’d
 
of
h
bufãr
 
aá”
 
de£rŸlizšg
 
™


254 
def
 
	$š£¹
(
£lf
, 
‹xt
, 
_™”
=
NÚe
):

255 
_™”
 
is
 
NÚe
:

256 
_™”
 = 
£lf
.
buff
.
	$g‘_’d_™”
()

257 #Ok, 
this
 
lše
 
»quœe
 
ª
 
š‹g”
 
©
 
some
 
¶aû
 !

258 #di§bË 
the
 
š£¹
 
ªd
 
modif›d
 
sigÇls


259 
»cÚÃù_š£¹
 = 
F®£


260 
»cÚÃù_modif›d
 = 
F®£


261 
£lf
.
š£¹_sigid
:

262 
£lf
.
buff
.
	$discÚÃù
(
£lf
.
š£¹_sigid
)

263 
£lf
.
š£¹_sigid
 = 
F®£


264 
»cÚÃù_š£¹
 = 
True


265 
£lf
.
modif›d_sigid
:

266 
£lf
.
buff
.
	$discÚÃù
(
£lf
.
modif›d_sigid
)

267 
£lf
.
modif›d_sigid
 = 
F®£


268 
»cÚÃù_modif›d
 = 
True


271 #£lf.
buff
.
	`de£rŸlize
(
£lf
.buff, s–f.
de£rŸlize_fÜm©
, 
_™”
,

273 
£lf
.
un£rŸliz”
.
	$un£rŸlize
(

274 
£lf
.
buff
, s–f.buff, 
_™”
, 0, 
‹xt
, 
NÚe
, None)

277 
»cÚÃù_š£¹
:

278 
£lf
.
š£¹_sigid
 = s–f.
buff
.
	`cÚÃù
('insert-text',

279 
£lf
.
_š£¹_©_cursÜ
)

280 
»cÚÃù_modif›d
:

281 
£lf
.
modif›d_sigid
 = s–f.
buff
.
	`cÚÃù
("chªged", s–f.
modif›d
)

283 #Thi 
š£¹
 
¿w
 
‹xt
 
w™hout
 
de£rŸlizšg


284 
def
 
	$š£¹_‹xt
(
£lf
, 
‹xt
, 
_™”
=
NÚe
):

285 
_™”
 
is
 
NÚe
:

286 
_™”
 = 
£lf
.
buff
.
	$g‘_’d_™”
()

287 
£lf
.
buff
.
	$š£¹
(
_™”
, 
‹xt
)

289 #W
ÿÂÙ
 
g‘
 
ª
 
š£¹
 
š
 
the
 
t™Ë


290 
def
 
	$g‘_š£¹
(
£lf
):

291 
m¬k
 = 
£lf
.
buff
.
	$g‘_š£¹
()

292 
™”a
 = 
£lf
.
buff
.
	$g‘_™”_©_m¬k
(
m¬k
)

293 
™”a
.
	`g‘_lše
() == 0:

294 
™”a
.
	$fÜw¬d_lše
()

295  
™”a


297 
def
 
	$š£¹_w™h_ªchÜ
(
£lf
, 
‹xt
, 
ªchÜ
=
NÚe
, 
_™”
=NÚe, 
typ
=None):

298 
b
 = 
£lf
.
	$g‘_bufãr
()

299 
_™”
 
is
 
NÚe
:

300 
_™”
 = 
b
.
	$g‘_’d_™”
()

301 
ªchÜ
 
is
 
NÚe
:

302 
ªchÜ
 = 
‹xt


303 
g
 = 
£lf
.
	$ü—‹_ªchÜ_g
(
b
, 
ªchÜ
, 
‹xt
, 
typ
=typ)

304 
b
.
	$š£¹_w™h_gs
(
_™”
, 
‹xt
, 
g
)

306 
def
 
	$check_lšk
(
£lf
, 
u¾
):

309 
fe
:

311 
u¾
.
	`¡¬tsw™h
('file://'):

312 
f•©h
 = 
u¾
[
	`Ën
('file://'):]

313  
os
.
·th
.
	$exi¡s
(
f•©h
)

315  
True


317 
def
 
	$ü—‹_ªchÜ_g
(
£lf
, 
b
, 
ªchÜ
, 
‹xt
=
NÚe
, 
typ
=None):

318 #W
ÿÂÙ
 
have
 
two
 
gs
 
w™h
 
the
 
§me
 
Çme


320 #buˆ
™
 
has
 
a
 "is_ªchÜ" 
´İ”ty


321 
typ
 == "http":

322 
lškty³
 = 'link'

323 #By , 
the
 
ty³
 
is
 
a
 
subsk


325 
sk
 = 
£lf
.
»q
.
	$g‘_sk
(
ªchÜ
)

326 
sk
 
ªd
ask.
	`g‘_¡©us
() == "Active":

327 
lškty³
 = 'link'

329 
lškty³
 = 'done'

331 
lškty³
 =ğ'lšk' 
ªd
 
nÙ
 
£lf
.
	$check_lšk
(
ªchÜ
):

332 
lškty³
 = 'failedlink'

334 
g
 = 
b
.
	`ü—‹_g
(
NÚe
, **
£lf
.
	$g‘_´İ”ty
(
lškty³
))

335 
g
.
is_ªchÜ
 = 
True


336 
g
.
lšk
 = 
ªchÜ


337 
typ
:

338 
g
.
ty³
 = 
typ


339 
g
.
	`cÚÃù
('ev’t', 
£lf
.
_g_ev’t
, 
‹xt
, 
ªchÜ
, 
typ
)

340 
£lf
.
__gs
.
	$­³nd
(
g
)

341  
g


343 #Aµly 
the
 
g
ag 
to
 
a
 
£t
 
of
 
	`TextM¬ks
 (
nÙ
 
I‹r
)

344 
def
 
	$­¶y_g_g
(
£lf
, 
buff
, 
g
, 
s
, 
e
):

345 
ss
 = 
buff
.
	$g‘_™”_©_m¬k
(
s
)

346 
“
 = 
buff
.
	$g‘_™”_©_m¬k
(
e
)

347 #Ià
the
 
g
 
is
 
®»ady
 
­¶›d
, 
we
 dØ
nÙhšg


348 
t_li¡
 = 
ss
.
	$g‘_gs
()

349 
‹x‰ag
 = 
NÚe


350 
®»ady
 = 
F®£


351 
t
 
š
 
t_li¡
:

352 
	`ha§‰r
(
t
, 'is_g'è
ªd
.
gÇme
 =ğ
g
:

353 
‹x‰ag
 = 
t


354 
ss
.
	$begšs_g
(
t
è
ªd
 
“
.
	$’ds_g
(
t
):

355 
®»ady
 = 
True


356 
nÙ
 
‹x‰ag
:

358 
‹x‰ag
 = 
buff
.
	`ü—‹_g
(
NÚe
, **
£lf
.
	`g‘_´İ”ty
('tag'))

359 
‹x‰ag
.
is_g
 = 
True


360 
‹x‰ag
.
gÇme
 = 
g


361 #Thi 
Úe
 
is
 
m¬ks


362 
nÙ
 
®»ady
:

363 
£lf
.
	$__­¶y_g_to_m¬k
(
s
, 
e
, 
g
=
‹x‰ag
)

365 #Aµly 
the
 
g
ag 
to
 
a
 
£t
 
of
 
	`TextM¬ks
 (
nÙ
 
I‹r
)

366 #AlsØ
chªge
 
the
 
subsk
 
t™Ë
 
Ãeded


367 
def
 
	$­¶y_subsk_g
(
£lf
, 
buff
, 
subsk
, 
s
, 
e
):

368 
i_s
 = 
buff
.
	$g‘_™”_©_m¬k
(
s
)

369 
i_e
 = 
buff
.
	$g‘_™”_©_m¬k
(
e
)

370 
‹x
 = 
buff
.
	$g‘_‹xt
(
i_s
, 
i_e
, 
True
)

371 #w
dÚ
't‡ccept \n in‡ subtaskitle

372 "\n" 
š
 
‹x
:

373 
i_e
 = 
i_s
.
	$cİy
()

374 
i_e
.
	`g‘_ch¬
() != "\n":

375 
i_e
.
	$fÜw¬d_ch¬
()

376 
buff
.
	$move_m¬k
(
e
, 
i_e
)

377 
‹x
 = 
buff
.
	$g‘_‹xt
(
i_s
, 
i_e
, 
True
)

378 
	`Ën
(
‹x
) > 0:

379 
£lf
.
»q
.
	`g‘_sk
(
subsk
).
	$£t_t™Ë
(
‹x
)

380 
‹x‰ag
 = 
£lf
.
	`ü—‹_ªchÜ_g
(
buff
, 
subsk
, 
‹xt
=
‹x
,

381 
typ
="subtask")

382 
‹x‰ag
.
is_subsk
 = 
True


383 
‹x‰ag
.
chd
 = 
subsk


384 #Thi 
Úe
 
is
 
m¬ks


385 
£lf
.
	$__­¶y_g_to_m¬k
(
s
, 
e
, 
g
=
‹x‰ag
)

387 
£lf
.
	$»move_subsk
(
subsk
)

388 
buff
.
	$d–‘e_m¬k
(
s
)

389 
buff
.
	$d–‘e_m¬k
(
e
)

391 
def
 
	$ü—‹_šd’t_g
(
£lf
, 
buff
, 
Ëv–
):

393 
g
 = 
buff
.
	`ü—‹_g
(
NÚe
, **
£lf
.
	`g‘_´İ”ty
('indent'))

394 
g
.
is_šd’t
 = 
True


395 
g
.
šd’t_Ëv–
 = 
Ëv–


396  
g


398 #In£¹ 
a
 
li¡
 
of
 
subsks
 
©
 
the
 
’d
 oàth
bufãr


399 
def
 
	$š£¹_subsks
(
£lf
, 
¡_li¡
):

400 
tid
 
š
 
¡_li¡
:

401 
lše_nbr
 = 
£lf
.
buff
.
	`g‘_’d_™”
().
	$g‘_lše
()

402 #W¬nšg, 
we
 
have
 
to
 
ke
 
the
 
Ãxt
 
lše
 !

403 
£lf
.
	`wr™e_subsk
(£lf.
buff
, 
lše_nbr
 + 1, 
tid
)

405 #In£¹ 
a
 
li¡
 
of
 
g
 
š
 
the
 
fœ¡
 
lše
 oàth
bufãr


406 
def
 
	$š£¹_gs
(
£lf
, 
g_li¡
):

407 #Fœ¡, 
we
 
dÚ
't insertagshat‡re‡lready…resent

408 
t
 
š
 
£lf
.
	$g‘_g¦i¡
():

409 
t
 
š
 
g_li¡
:

410 
g_li¡
.
	$»move
(
t
)

411 
	`Ën
(
g_li¡
) > 0:

412 #W
š£¹
 
them
 
ju¡
 
aá”
 
the
 
t™Ë


413 #W
u£
 
the
 
cu¼’t
 
fœ¡
 
lše
 
™
 
begšs
 
w™h
 
a
 
g


414 
fœ¡lše
 = 
£lf
.
buff
.
	$g‘_™”_©_lše
(1)

415 
Ãwlše
 = 
True


416 
‰
 
š
 
fœ¡lše
.
	$g‘_gs
():

417 
	`ha§‰r
(
‰
, 'is_tag'):

418 
Ãwlše
 = 
F®£


419 
fœ¡lše
.
	$fÜw¬d_to_lše_’d
()

420 #Now 
we
 
should
 
check
 
the
 
cu¼’t
 
is


421 #¨
£·¿tÜ
 
Ü
 
nÙ


422 #Cu¼’y, 
we
 
š£¹
 
a
 
¥aû


423 
£lf
.
	`š£¹_‹xt
(" ", 
fœ¡lše
)

424 #Now 
we
 
check
 
this
 
Ãwlše
 
is
 
em±y


425 #(
™
 
cÚšs
 
Úly
 " " 
ªd
 ",")

426 #ià
Ãwlše
:

427 #’dlšğ
fœ¡lše
.
	`cİy
()

428 #ià
nÙ
 
’dlše
.
	`’ds_lše
():

429 #’dlše.
	`fÜw¬d_to_lše_’d
()

430 #‹xˆğ
£lf
.
buff
.
	`g‘_‹xt
(
fœ¡lše
, 
’dlše
)

431 #ià
nÙ
 
‹xt
.
	`¡r
(", "):

432 #Ãwlšğ
F®£


433 #fœ¡lše.
	`fÜw¬d_to_lše_’d
()

434 #Now 
we
 
ÿn
 
´oûss


435 
Ãwlše
:

436 
fœ¡lše
 = 
£lf
.
buff
.
	$g‘_™”_©_lše
(0)

437 
fœ¡lše
.
	$fÜw¬d_to_lše_’d
()

438 
£lf
.
	`š£¹_‹xt
("\n", 
fœ¡lše
)

439 
fœ¡lše
 = 
£lf
.
buff
.
	$g‘_™”_©_lše
(1)

440 
lše_m¬k
 = 
£lf
.
buff
.
	`ü—‹_m¬k
("fœ¡lše", 
fœ¡lše
, 
F®£
)

441 #£lf.
tv
.
	`š£¹_©_m¬k
(
buf
, 
lše_m¬k
, "\n")

442 
Áags
 = 
	$Ën
(
g_li¡
)

443 
t
 
š
 
g_li¡
:

444 
Áags
 =‚tags - 1

445 
£lf
.
	$š£¹_©_m¬k
(
£lf
.
buff
, 
lše_m¬k
, 
t
)

446 
Áags
 != 0:

447 
£lf
.
	`š£¹_©_m¬k
(£lf.
buff
, 
lše_m¬k
, ",")

448 
£lf
.
buff
.
	$d–‘e_m¬k
(
lše_m¬k
)

449 
£lf
.
	$modif›d
(
fuÎ
=
True
)

451 #add 
a
 
g
 
to
 
the
 
Ï¡
 
lše
 
of
h
sk


452 
def
 
	$š£¹_g
(
£lf
, 
g
):

453 
Ï¡lše
 = 
£lf
.
buff
.
	$g‘_’d_™”
()

454 
Ï¡lše
.
	$fÜw¬d_to_lše_’d
()

455 
£lf
.
	`š£¹_‹xt
("\n", 
Ï¡lše
)

457 
lše_m¬k
 = 
£lf
.
buff
.
	`ü—‹_m¬k
("Ï¡lše", 
Ï¡lše
, 
F®£
)

458 
£lf
.
	$š£¹_©_m¬k
(
£lf
.
buff
, 
lše_m¬k
, 
g
)

460 #thi 
funùiÚ
 
£Ëù
 
ªd
 
highligth
 
the
 
	`t™Ë
 (
fœ¡
 
lše
)

461 
def
 
	$£Ëù_t™Ë
(
£lf
):

462 
¡¬t
 = 
£lf
.
buff
.
	$g‘_¡¬t_™”
()

463 
¡İ
 = 
¡¬t
.
	$cİy
()

464 
¡İ
.
	$fÜw¬d_to_lše_’d
()

465 
£lf
.
buff
.
	$£Ëù_¿nge
(
¡¬t
, 
¡İ
)

467 #####Th"G‘ext" 
group
 #########
#G‘ 
the
 
com¶‘e
 
£rŸlized
 
‹xt


468 #Buˆ
w™hout
 
the
 
t™Ë


469 
def
 
	$g‘_‹xt
(
£lf
):

470 #w
g‘
 
the
 
‹xt


471 
¡¬t
 = 
£lf
.
buff
.
	$g‘_¡¬t_™”
()

472 
¡¬t
.
	$fÜw¬d_to_lše_’d
()

473 
cÚti
 = 
True


474 
cÚti
 
ªd
 
nÙ
 
¡¬t
.
	`’ds_g
(
£lf
.
bË
.
	`lookup
("title")):

475 
cÚti
 = 
¡¬t
.
	$fÜw¬d_lše
()

476 
cÚti
:

477 
cÚti
 = 
¡¬t
.
	$fÜw¬d_to_lše_’d
()

478 #w
go
 
to
 
the
 
Ãxt
 
lše
, 
ju¡
 
aá”
h
t™Ë


479 
¡¬t
.
	$fÜw¬d_lše
()

480 
’d
 = 
£lf
.
buff
.
	$g‘_’d_™”
()

481 
‹x‹
 = 
£lf
.
£rŸliz”
.
	$£rŸlize
(

482 
£lf
.
buff
, s–f.buff, 
¡¬t
, 
’d
, 1, 
NÚe
)

484  
‹x‹


485 #G‘ 
the
 
t™Ë
 
of
h
	`sk
 (
aka
h
fœ¡
 
lše
 oàth
bufãr
)

487 
def
 
	$g‘_t™Ë
(
£lf
):

488 
¡¬t
 = 
£lf
.
buff
.
	$g‘_¡¬t_™”
()

489 
’d
 = 
£lf
.
buff
.
	$g‘_¡¬t_™”
()

490 
’d
.
	$fÜw¬d_to_lše_’d
()

491 #Th
boŞ—n
 
¡ays
 
True
 
as
 a 
we
 
¬e
 
š
 
the
 
bufãr


492 
cÚti
 = 
True


493 
cÚti
 
ªd
 
nÙ
 
’d
.
	`’ds_g
(
£lf
.
bË
.
	`lookup
("title")):

494 
cÚti
 = 
’d
.
	$fÜw¬d_lše
()

495 
cÚti
:

496 
cÚti
 = 
’d
.
	$fÜw¬d_to_lše_’d
()

497 #W
dÚ
't wanto deserializeheitle

499 
t™Ë
 = 
	`¡r
(
£lf
.
buff
.
	$g‘_‹xt
(
¡¬t
, 
’d
, 
True
))

501 
¡r³d
 = 
t™Ë
.
	`¡r
(' \n\t')

502  
¡r³d


504 ###PRIVATE 
FUNCTIONS
 #####################################################
#Thi 
funùiÚ
 
is
 
ÿÎed
 
so
 
äequ’y
 
th©
 
we
 
should
 
İtimize
 
™
 
mÜe
.

505 
def
 
	$modif›d
(
£lf
, 
buff
=
NÚe
, 
fuÎ
=
F®£
, 
»äeshed™Ü
=
True
):

508 
It
 
»æeùs
 
the
 
chªges
 
by
:

510 1. 
Aµlyšg
 
the
 
t™Ë
 
¡yË
 
Ú
h
fœ¡
 
lše


511 2. 
Chªgšg
 
the
 
Çme
 
of
h
wšdow
 
t™Ë
 
chªge


513 
nÙ
 
buff
:

514 
buff
 = 
£lf
.buff

515 
cursÜ_m¬k
 = 
buff
.
	$g‘_š£¹
()

516 
cursÜ_™”
 = 
buff
.
	$g‘_™”_©_m¬k
(
cursÜ_m¬k
)

517 
bË
 = 
buff
.
	$g‘_g_bË
()

518 #Thi 
should
 
be
 
ÿÎed
 
Úly
 
we
 
¬e
 
Ú
 
the
 
t™Ë
 
lše


519 #A 
ª
 
İtimi§tiÚ


520 #Buˆ
we
 
should
 
¡l
 
g‘
 
the
 
t™Ë_’d
 
™”


521 
fuÎ
 
Ü
 
£lf
.
	$is_©_t™Ë
(
buff
, 
cursÜ_™”
):

522 #Th
­¶y
 
t™Ë
 
is
 
v”y
 
ex³nsive
 
beÿu£


523 #Iˆ
švŞves
 
»äeshšg
 
the
 
whŞe
 
sk
 
Œ“


524 
t™Ë_’d
 = 
£lf
.
	$_­¶y_t™Ë
(
buff
, 
»äeshed™Ü
)

526 
fuÎ
:

527 
loÿl_¡¬t
 = 
t™Ë_’d
.
	$cİy
()

528 
loÿl_’d
 = 
buff
.
	$g‘_’d_™”
()

530 #W
ª®y£
 
Úly
 
the
 
cu¼’t
 
lše


531 
loÿl_¡¬t
 = 
cursÜ_™”
.
	$cİy
()

532 
loÿl_¡¬t
.
	`£t_lše
Öoÿl_¡¬t.
	$g‘_lše
())

533 
loÿl_’d
 = 
cursÜ_™”
.
	$cİy
()

534 
loÿl_’d
.
	$fÜw¬d_lšes
(2)

535 #ià
fuÎ
=
F®£
 
we
 
d‘eù
 
g
 
Úly
 
Ú
 
the
 
cu¼’t
 
lše


537 #Th
fŞlowšg
 3 
lšes
 
¬e
 
a
 
quick
 
ugly
 
fix
 
bug
 #359469

538 #‹m°ğ
buff
.
	`g‘_™”_©_lše
(1)

539 #‹mp.
	`backw¬d_ch¬
()

540 #£lf.
	`_d‘eù_g
(
buff
, 
‹mp
, buff.
	`g‘_’d_™”
())

541 #Thi 
should
 
be
 
the
 
good
 
lše


542 
£lf
.
	$_d‘eù_g
(
buff
, 
loÿl_¡¬t
, 
loÿl_’d
)

543 
£lf
.
	$_d‘eù_u¾
(
buff
, 
loÿl_¡¬t
, 
loÿl_’d
)

545 #subt_li¡ = 
£lf
.
	`g‘_subsks
()

546 #Fœ¡, 
we
 
»move
 
the
 
Şds
 
gs


547 
g_li¡
 = []

549 
def
 
	$subfunc
(
‹x‰ag
, 
d©a
=
NÚe
):

550 
	`ha§‰r
(
‹x‰ag
, 'is_subtask'):

551 
g_li¡
.
	$­³nd
(
‹x‰ag
)

553 
bË
.
	$fÜ—ch
(
subfunc
, 
NÚe
)

554 
¡¬t
, 
’d
 = 
buff
.
	$g‘_bounds
()

555 
t
 
š
 
g_li¡
:

556 
buff
.
	$»move_g
(
t
, 
¡¬t
, 
’d
)

557 
bË
.
	$»move
(
t
)

559 #W
­¶y
 
the
 
hy³¾šk
 
g
 
to
 
subsk


560 
s
 
š
 
£lf
.
	$g‘_subsks
():

561 
¡¬t_m¬k
 = 
buff
.
	$g‘_m¬k
(
s
)

562 #"
­¶yšg
 %
s
 
to
 %s - %s"%(s, start_mark,ƒnd_mark)

563 
¡¬t_m¬k
:

564 #IÀ
çù
, 
the
 
subsk
 
m¬k
 
®ways
 
go
 
to
h
’d
 
of
 
lše
.

565 
¡¬t_i
 = 
buff
.
	$g‘_™”_©_m¬k
(
¡¬t_m¬k
)

566 
£lf
.
	`_g‘_šd’t_Ëv–
(
¡¬t_i
) > 0:

567 
¡¬t_i
.
	$fÜw¬d_to_lše_’d
()

568 
’d_m¬k
 = 
buff
.
	`ü—‹_m¬k
("/%s" % 
s
, 
¡¬t_i
, 
F®£
)

569 
£lf
.
	$­¶y_subsk_g
(
buff
, 
s
, 
¡¬t_m¬k
, 
’d_m¬k
)

571 
£lf
.
	$»move_subsk
(
s
)

573 #Now 
we
 
­¶y
 
the
 
g
ag 
to
h
m¬ks


574 
t
 
š
 
£lf
.
	$g‘_g¦i¡
():

575 
¡¬t_m¬k
 = 
buff
.
	$g‘_m¬k
(
t
)

576 
’d_m¬k
 = 
buff
.
	`g‘_m¬k
("/%s" % 
t
)

577 #"
­¶yšg
 %
s
 
to
 %s - %s"%(t, start_mark,ƒnd_mark)

578 
¡¬t_m¬k
 
ªd
 
’d_m¬k
:

579 
£lf
.
	$­¶y_g_g
(
buff
, 
t
, 
¡¬t_m¬k
, 
’d_m¬k
)

581 #Ok, 
we
 
took
 
ÿ»
 
of
 
the
 
modifiÿtiÚ


582 
£lf
.
buff
.
	$£t_modif›d
(
F®£
)

583 #El£ 
we
 
§ve
 
the
 
sk
 
	`ªyway
 (
but
 
w™hout
 
»äeshšg
 
®l
)

584 
£lf
.
§ve_sk
:

585 
£lf
.
	$§ve_sk
()

587 #D‘eù 
URL
 
š
 
the
 
sks


589 
def
 
	$_d‘eù_u¾
(
£lf
, 
buff
, 
¡¬t
, 
’d
):

590 #subt_li¡ = 
£lf
.
	`g‘_subsks
()

591 #Fœ¡, 
we
 
»move
 
the
 
Şds
 
gs


592 
g_li¡
 = []

593 
bË
 = 
buff
.
	$g‘_g_bË
()

595 
def
 
	$subfunc
(
‹x‰ag
, 
d©a
=
NÚe
):

596 
	`ha§‰r
(
‹x‰ag
, 'is_anchor'):

597 
g_li¡
.
	$­³nd
(
‹x‰ag
)

599 
bË
.
	$fÜ—ch
(
subfunc
, 
NÚe
)

600 
t
 
š
 
g_li¡
:

601 
buff
.
	$»move_g
(
t
, 
¡¬t
, 
’d
)

602 #Now 
we
 
add
 
the
 
g
 
URL


603 
™
 = 
¡¬t
.
	$cİy
()

604 
´ev
 = 
¡¬t
.
	$cİy
()

605 
™
.
	`g‘_off£t
(è< 
’d
.
	$g‘_off£t
()è
	`ªd
 (
™
.
	`g‘_ch¬
() != '\0'):

606 
™
.
	$fÜw¬d_wÜd_’d
()

607 
´ev
 = 
™
.
	$cİy
()

608 
´ev
.
	$backw¬d_wÜd_¡¬t
()

609 
‹xt
 = 
buff
.
	$g‘_‹xt
(
´ev
, 
™
, 
True
)

611 
‹xt
 
š
 ["http", "https", "www", "file"]:

612 
isu¾
 = 
buff
.
	`g‘_‹xt
(
´ev
, buff.
	`g‘_’d_™”
(), 
True
)

613 
m
 = 
u¾»gex
.
	$m©ch
(
isu¾
)

614 
m
 
is
 
nÙ
 
NÚe
:

615 
u¾
 = 
isu¾
[:
m
.
	`’d
()]

616 #FÜ 
URL
 
we
 
mu¡
 
add
 
h‰p
:

617 
‹xt
 == "www":

618 
u¾
 = "http://" + url

619 
‹x‰ag
 = 
£lf
.
	`ü—‹_ªchÜ_g
(
buff
, 
u¾
, 
‹xt
=
NÚe
,

620 
typ
="http")

621 
™
 = 
´ev
.
	$cİy
()

622 
™
.
	`fÜw¬d_ch¬s
(
m
.
	$’d
())

623 
buff
.
	$­¶y_g
(
‹x‰ag
, 
´ev
, 
™
)

625 
–if
 
‹xt
 
š
 ["bug", "lp", "bgo", "fdo", "bko"]:

626 
™
.
	`g‘_ch¬
() == " ":

627 
™
.
	$fÜw¬d_ch¬
()

628 
™
.
	`g‘_ch¬
() == "#":

629 
™
.
	$fÜw¬d_ch¬
()

630 
™
.
	`g‘_ch¬
().
	$isdig™
(è
	`ªd
 (
™
.
	`g‘_ch¬
() != '\0'):

631 
™
.
	$fÜw¬d_ch¬
()

632 
u¾
 = 
buff
.
	$g‘_‹xt
(
´ev
, 
™
, 
True
)

633 
nbr
 = 
u¾
.
	`¥l™
("#")[1]

634 
tİošt
 = 
NÚe


635 
u¾
.
	`¡¬tsw™h
("bug #"è
Ü
 url.startswith("lp #"):

636 
tİošt
 = "h‰ps://Ïunch·d.Ãt/bugs/%s" % 
nbr


637 
–if
 
u¾
.
	`¡¬tsw™h
("bgo #"):

638 
tİošt
 = "http://bugzilla.gnome.org/" + \

639 "show_bug.cgi?id=%s" % 
nbr


640 
–if
 
u¾
.
	`¡¬tsw™h
("bko #"):

641 
tİošt
 = "https://bugs.kde.org/show_bug.cgi?id=%s" \

642 % 
nbr


643 
–if
 
u¾
.
	`¡¬tsw™h
("fdo #"):

644 
tİošt
 = "http://bugs.freedesktop.org/" + \

645 "show_bug.cgi?id=%s" % 
nbr


646 
tİošt
:

647 
‹x‰ag
 = 
£lf
.
	`ü—‹_ªchÜ_g
(
buff
,

648 
tİošt
, 
‹xt
=
NÚe
,

649 
typ
="http")

650 
buff
.
	$­¶y_g
(
‹x‰ag
, 
´ev
, 
™
)

652 #D‘eù 
gs
 
š
 
buff
 iÀ
the
 
»giÚ
 
b‘w“n
 
¡¬t
 
™”
 
ªd
 
’d
 iter

653 
def
 
	$_d‘eù_g
(
£lf
, 
buff
, 
¡¬t
, 
’d
):

654 #Removšg 
®»ady
 
exi¡šg
 
g
 
š
 
the
 
cu¼’t
 
£ËùiÚ


655 #ouˆ
of
 
the
 
g
 
bË


656 
™
 = 
¡¬t
.
	$cİy
()

657 
bË
 = 
buff
.
	$g‘_g_bË
()

658 
Şd_gs
 = []

659 
Ãw_gs
 = []

660 #W
mu¡
 
be
 
¡riùly
 < 
thª
 
the
 
’d_off£t
. 
If
 
nÙ
, 
we
 
might


661 #fšd 
the
 
begšnšg
 
of
 
a
 
g
 
Ú
h
Ãxše


662 
™
.
	`g‘_off£t
(è< 
’d
.
	$g‘_off£t
()è
	`ªd
 (
™
.
	`g‘_ch¬
() != '\0'):

663 
™
.
	$begšs_g
():

664 
gs
 = 
™
.
	$g‘_toggËd_gs
(
True
)

665 

 
š
 
gs
:

666 #»movšg 
d–‘ed
 
gs


667 
	`ha§‰r
(

, 'is_tag'):

668 
gÇme
 = 

.tagname

669 
Şd_gs
.
	$­³nd
(
gÇme
)

670 
buff
.
	$»move_g
(

, 
¡¬t
, 
’d
)

671 
bË
.
	$»move
(

)

672 #Removšg 
the
 
m¬ks
 
they
 
exi¡


673 
m¬k1
 = 
buff
.
	$g‘_m¬k
(
gÇme
)

674 
m¬k1
:

675 
off£t1
 = 
buff
.
	`g‘_™”_©_m¬k
(
m¬k1
).
	$g‘_off£t
()

676 
¡¬t
.
	`g‘_off£t
(è<ğ
off£t1
 <= \

677 
’d
.
	$g‘_off£t
():

678 
buff
.
	$d–‘e_m¬k_by_Çme
(
gÇme
)

679 
m¬k2
 = 
buff
.
	`g‘_m¬k
("/%s" % 
gÇme
)

680 
m¬k2
:

681 
off£t2
 = 
buff
.
	`g‘_™”_©_m¬k
(
m¬k2
).
	$g‘_off£t
()

682 
¡¬t
.
	`g‘_off£t
(è<ğ
off£t2
 <= \

683 
’d
.
	$g‘_off£t
():

684 
buff
.
	`d–‘e_m¬k_by_Çme
("/%s" % 
gÇme
)

685 
™
.
	$fÜw¬d_ch¬
()

687 #S‘ 
™”©Üs
 
wÜd


688 
wÜd_¡¬t
 = 
¡¬t
.
	$cİy
()

689 
wÜd_’d
 = 
¡¬t
.
	$cİy
()

691 #S‘ 
™”©Üs
 

692 
ch¬_¡¬t
 = 
¡¬t
.
	$cİy
()

693 
ch¬_’d
 = 
¡¬t
.
	$cİy
()

694 
ch¬_’d
.
	$fÜw¬d_ch¬
()

695 
Ï¡_ch¬
 = 
NÚe


697 #I‹¿‹ 
ov”
 
ch¬aù”s
 
of
 
the
 
lše
 
to
 
g‘
 
wÜds


698 
ch¬_’d
.
	`com·»
(
’d
) <= 0:

699 
do_wÜd_check
 = 
F®£


700 
my_ch¬
 = 
buff
.
	$g‘_‹xt
(
ch¬_¡¬t
, 
ch¬_’d
, 
True
)

701 
my_ch¬
 
nÙ
 
š
 
£·¿tÜs
:

702 
Ï¡_ch¬
 = 
my_ch¬


703 
wÜd_’d
 = 
ch¬_’d
.
	$cİy
()

704 #Ià
a
 
¥ecŸl
 
is
 
©
 
the
 
’d
 
of
h
docum’t


705 #w
dÚ
't include it inheag

706 
wÜd_’d
.
	$is_’d
(è
ªd
 
Ï¡_ch¬
 
š
 
¥ecŸls_£·¿tÜs
:

707 
wÜd_’d
.
	$backw¬d_ch¬
()

709 #W
»move
 
the
 
¥ecŸl
 
fŞlowed
 
by
 
a
 
£·¿tÜ


710 
Ï¡_ch¬
 
š
 
¥ecŸls_£·¿tÜs
:

711 
wÜd_’d
.
	$backw¬d_ch¬
()

712 
do_wÜd_check
 = 
True


714 
ch¬_’d
.
	`com·»
(
’d
) == 0:

715 
do_wÜd_check
 = 
True


717 #W
have
 
a
 
Ãw
 
wÜd


718 
do_wÜd_check
:

719 ià(
wÜd_’d
.
	`com·»
(
wÜd_¡¬t
) > 0):

720 
my_wÜd
 = 
buff
.
	$g‘_‹xt
(
wÜd_¡¬t
, 
wÜd_’d
, 
True
)

721 #WdØ
som‘hšg
 
about
 
™


722 #W
wªt
 
a
 
g
 
bigg”
 
thª
 
the
 
sim¶e
 "@"

723 #ªd 
™
 
shouldn
't start with @@ (bug 531553)

724 
	`Ën
(
my_wÜd
è> 1 
ªd
 my_word[0] == '@' \

725 
ªd
 
nÙ
 
my_wÜd
[1] == '@':

726 #£lf.
	`­¶y_g_g
(
buff
, 
my_wÜd
, 
wÜd_¡¬t
,

728 #W
wl
 
add
 
m¬k
 
wh”e
 
g
 
should
 
be
 
­¶›d


729 
buff
.
	$ü—‹_m¬k
(
my_wÜd
, 
wÜd_¡¬t
, 
True
)

730 
buff
.
	`ü—‹_m¬k
("/%s" % 
my_wÜd
, 
wÜd_’d
, 
F®£
)

731 #addšg 
g
 
to
 
a
 
loÿl
 
li¡


732 
Ãw_gs
.
	$­³nd
(
my_wÜd
)

733 #addšg 
g
 
to
 
the
 
mod–


734 
£lf
.
	$add_g_ÿÎback
(
my_wÜd
)

736 #W
£t
 
Ãw
 
wÜd
 
bound¬›s


737 
wÜd_¡¬t
 = 
ch¬_’d
.
	$cİy
()

738 
wÜd_’d
 = 
ch¬_’d
.
	$cİy
()

740 #Stİ 
loİ
 
we
 
¬e
 
©
 
the
 
’d


741 
ch¬_’d
.
	`com·»
(
’d
) == 0:

744 #W
£¬ch
 
the
 
Ãxt
 
wÜd


745 
ch¬_¡¬t
 = 
ch¬_’d
.
	$cİy
()

746 
ch¬_’d
.
	$fÜw¬d_ch¬
()

748 #Upd©
gs
 
š
 
mod–
:

749 #w
»move
 
gs
 
th©
 
¬e
 
nÙ
 
š
 
the
 
desütiÚ
 
ªymÜe


750 
t
 
š
 
Şd_gs
:

751 
nÙ
 
t
 
š
 
Ãw_gs
:

752 
£lf
.
	$»move_g_ÿÎback
(
t
)

754 
def
 
	$is_©_t™Ë
(
£lf
, 
buff
, 
™”a
):

755 
to_»tuº
 = 
F®£


757 
™”a
.
	`g‘_lše
() == 0:

758 
to_»tuº
 = 
True


759 #W
¬e
 
©
 
a
 
lše
 
w™h
 
the
 
t™Ë
 
g
 
­¶›d


760 
–if
 
£lf
.
t™Ë_g
 
š
 
™”a
.
	$g‘_gs
():

761 
to_»tuº
 = 
True


762 #–£, 
we
 
look
 
th”e
's something between us‡nd buffer start

763 
–if
 
nÙ
 
buff
.
	`g‘_‹xt
(buff.
	`g‘_¡¬t_™”
(), 
™”a
, 
True
) \

764 .
	`¡r
('\n\t '):

765 
to_»tuº
 = 
True


767  
to_»tuº


769 #Wh’ 
the
 
u£r
 
»moves
 
a
 
£ËùiÚ
, 
we
 
»move
 
subsks
 
ªd
 @
gs


770 #äom 
this
 
£ËùiÚ


771 
def
 
	$_d–‘e_¿nge
(
£lf
, 
buff
, 
¡¬t
, 
’d
):

772 ##
If
 
we
 
¬e
 
©
 
the
 
begšnšg
 
of
 
a
 
m¬k
, 
put
 
this
 m¬k‡ˆth
’d


773 #m¬k ğ
¡¬t
.
	`g‘_m¬ks
()

774 #fÜ 
m
 
š
 
m¬ks
:

775 #´šˆ
m
.
	`g‘_Çme
()

776 #buff.
	`move_m¬k
(
m
, 
’d
)

777 #Ià
the
 
begššg
 
of
h
£ËùiÚ
 
is
 
š
h
middË
 oà
ª
 
šd’t


778 #W
wªt
 
to
 
¡¬t
 
©
 
the
 
begššg


779 
gs
 = 
¡¬t
.
	`g‘_gs
(è+ s¹.
	$g‘_toggËd_gs
(
F®£
)

780 

 
š
 
gs
:

781 ià(
	`ha§‰r
(

, 'is_indent')):

782 
lše
 = 
¡¬t
.
	$g‘_lše
()

783 
¡¬t
 = 
£lf
.
buff
.
	$g‘_™”_©_lše
(
lše
)

784 ##
™
 = 
£lf
.
buff
.
	`g‘_™”_©_lše
(
lše
)

785 ##
¡¬t
.
	`backw¬d_to_g_toggË
(

)

786 #’dšd’ˆğ
¡¬t
.
	`cİy
()

787 #’dšd’t.
	`fÜw¬d_to_g_toggË
(

)

788 #buff.
	`»move_g
(

, 
¡¬t
, 
’dšd’t
)

789 #Now 
we
 
d–‘e
 
®l
, 
aá”
 

790 
™
 = 
¡¬t
.
	$cİy
()

791 
™
.
	`g‘_off£t
(è< 
’d
.
	$g‘_off£t
(è
ªd
 
™
.
	`g‘_ch¬
() != '\0':

792 
™
.
	$begšs_g
():

793 
gs
 = 
™
.
	$g‘_gs
()

794 

 
š
 
gs
:

795 #»movšg 
d–‘ed
 
subsks


796 
	`ha§‰r
(

, 'is_subsk'è
ªd
 
™
.
	$begšs_g
(

):

797 
rg‘
 = 

.
chd


798 #´šˆ"»movšgask %s" %
rg‘


799 
£lf
.
	$»move_subsk
(
rg‘
)

800 #»movšg 
d–‘ed
 
gs


801 
	`ha§‰r
(

, 'is_g'è
ªd
 
™
.
	$begšs_g
(

):

802 
gÇme
 = 

.tagname

803 
£lf
.
	$»move_g_ÿÎback
(
gÇme
)

804 
buff
.
	$g‘_m¬k
(
gÇme
):

805 
buff
.
	$d–‘e_m¬k_by_Çme
(
gÇme
)

806 
buff
.
	`g‘_m¬k
("/%s" % 
gÇme
):

807 
buff
.
	`d–‘e_m¬k_by_Çme
("/%s" % 
gÇme
)

808 
	`ha§‰r
(

, 'is_indent'):

809 #Beÿu£ 
the
 
šd’t
 
g
 
is
 
»ad
 
Úly


810 #w
wl
 
»move
 
™


811 
’dg
 = 
™
.
	$cİy
()

812 
’dg
.
	$fÜw¬d_to_g_toggË
(

)

813 
buff
.
	$»move_g
(

, 
™
, 
’dg
)

814 #Also, 
we
 
wªt
 
to
 
d–‘e
 
the
 
šd’t
 
com¶‘–y
,

815 #Ev’ 
the
 
£ËùiÚ
 
was
 
š
h
middË
 
of
 
ª
 
šd’t


817 
™
.
	$fÜw¬d_ch¬
()

818 #now 
we
 
»®ly
 
d–‘e
 
the
 
£Ëùed
 
¡uffs


819 #£Ëøğ
£lf
.
buff
.
	`g‘_£ËùiÚ_bounds
()

820 #ià
£Ëc
:

821 #´šˆ"d–‘edexˆi ##%s##" %
£lf
.
buff
.
	`g‘_‹xt
(
£Ëc
[0],

822 #£Ëc[1])#(
¡¬t
, 
’d
)

823 #£lf.
buff
.
	`discÚÃù
(
£lf
.
d–‘e_sigid
)

824 #£lf.
	`discÚÃù
(
£lf
.
back¥aû_sigid
)

825 #£lf.
buff
.
	`¡İ_emissiÚ
("delete-range")

826 #ià
£lf
.
buff
.
	`g‘_has_£ËùiÚ
():

827 #£lf.
buff
.
	`d–‘e_£ËùiÚ
(
F®£
, 
True
)

829 #’d.
	`fÜw¬d_ch¬
()

830 #£lf.
buff
.
	`back¥aû
(
’d
, 
F®£
, 
True
)

831 #£lf.
d–‘e_sigid
 = 
£lf
.
buff
.
	`cÚÃù
("delete-range",

832 #£lf.
_d–‘e_¿nge
)

833 #£lf.
back¥aû_sigid
 = 
£lf
.
	`cÚÃù
("back¥aû", s–f.
back¥aû
)

834 #W 
çl£
 
so
 
the
 
·»Á
 
¡l
 
g‘
h
sigÇl


835  
F®£


837 
def
 
	$_­¶y_t™Ë
(
£lf
, 
buff
, 
»äeshed™Ü
=
True
):

839 
Aµly
 
the
 
t™Ë
 
ªd
  
ª
 
™”©Ü
 
aá”
 
th©


840 
t™Ë
.
buff
.
g‘_™”_©_m¬


842 
¡¬t
 = 
buff
.
	$g‘_¡¬t_™”
()

843 
’d
 = 
buff
.
	$g‘_’d_™”
()

844 
lše_nbr
 = 1

845 
lšecouÁ
 = 
buff
.
	$g‘_lše_couÁ
()

847 #Aµly 
the
 
t™Ë
 
g
 
Ú
h
fœ¡
 
lše


850 #D‘”mš
the
 
™”©Üs
 
t™Ë


851 
t™Ë_¡¬t
 = 
¡¬t
.
	$cİy
()

852 
lšecouÁ
 > 
lše_nbr
:

853 #Aµlyšg 
t™Ë
 
Ú
 
the
 
fœ¡
 
lše


854 
t™Ë_’d
 = 
buff
.
	`g‘_™”_©_lše
(
lše_nbr
 - 1)

855 
t™Ë_’d
.
	$fÜw¬d_to_lše_’d
()

856 
¡r³d
 = 
buff
.
	$g‘_‹xt
(
t™Ë_¡¬t
, 
t™Ë_’d
, 
True
)

857 
¡r³d
 = sŒ³d.
	`¡r
('\n\t ')

858 #H”
we
 
ignÜe
 
lšes
 
th©
 
¬e
 
bÏnk


859 #T™Ë 
is
 
the
 
fœ¡
 
wr™‹n
 
lše


860 
lše_nbr
 <ğ
lšecouÁ
 
ªd
 
nÙ
 
¡r³d
:

861 
lše_nbr
 += 1

862 
t™Ë_’d
 = 
buff
.
	`g‘_™”_©_lše
(
lše_nbr
 - 1)

863 
t™Ë_’d
.
	$fÜw¬d_to_lše_’d
()

864 
¡r³d
 = 
buff
.
	$g‘_‹xt
(
t™Ë_¡¬t
, 
t™Ë_’d
, 
True
)

865 
¡r³d
 = sŒ³d.
	`¡r
('\n\t ')

866 #O¸
to
 
®l
 
the
 
bufãr
 
th”e
 
is
 
Úly
 
Úe
 
lše


868 
t™Ë_’d
 = 
’d
.
	$cİy
()

869 
buff
.
	`­¶y_g_by_Çme
('t™Ë', 
t™Ë_¡¬t
, 
t™Ë_’d
)

870 
buff
.
	`»move_g_by_Çme
('t™Ë', 
t™Ë_’d
, 
’d
)

871 #Reäesh 
t™Ë
 
of
 
the
 
wšdow


872 
»äeshed™Ü
:

873 
¡r³d
 = 
buff
.
	$g‘_‹xt
(
t™Ë_¡¬t
, 
t™Ë_’d
, 
True
)

874 
¡r³d
 = sŒ³d.
	`¡r
('\n\t')

875 
£lf
.
	$»äesh
(
¡r³d
)

876  
t™Ë_’d


878 
def
 
	$__Ãwsubsk
(
£lf
, 
buff
, 
t™Ë
, 
lše_nbr
, 
Ëv–
=1):

879 
ªchÜ
 = 
£lf
.
	$Ãw_subsk_ÿÎback
(
t™Ë
)

880 
’d_i
 = 
£lf
.
	$wr™e_subsk
(
buff
, 
lše_nbr
, 
ªchÜ
, 
Ëv–
=level)

881  
’d_i


883 #Wr™
the
 
subsk
 
th’
 h
™”©Ü
 
©
h
’d
 
of
h
lše


884 
def
 
	$wr™e_subsk
(
£lf
, 
buff
, 
lše_nbr
, 
ªchÜ
, 
Ëv–
=1):

885 #di§bË 
the
 
š£¹
 
sigÇl
 
to
 
avoid
 
»cursiÚ


886 #fœ¡ly, 
we
 
check
 
th©
 
the
 
subsk
 
exi¡s
 !

887 
nÙ
 
£lf
.
»q
.
	$has_sk
(
ªchÜ
):

888  
F®£


889 
»cÚÃù_š£¹
 = 
F®£


890 
»cÚÃù_modif›d
 = 
F®£


891 
£lf
.
š£¹_sigid
:

892 
£lf
.
buff
.
	$discÚÃù
(
£lf
.
š£¹_sigid
)

893 
£lf
.
š£¹_sigid
 = 
F®£


894 
»cÚÃù_š£¹
 = 
True


895 
£lf
.
modif›d_sigid
:

896 
£lf
.
buff
.
	$discÚÃù
(
£lf
.
modif›d_sigid
)

897 
£lf
.
modif›d_sigid
 = 
F®£


898 
»cÚÃù_modif›d
 = 
True


900 #Fœ¡, 
we
 
š£¹
 
the
 
»que¡
 \
n


901 #Ià
we
 
dÚ
't dohis,he content of‚ext†ine will‡utomatically

902 #b
š
 
the
 
subsk
 
t™Ë


903 
¡¬t_i
 = 
buff
.
	$g‘_™”_©_lše
(
lše_nbr
)

904 
¡¬t_i
.
	$fÜw¬d_to_lše_’d
()

905 
buff
.
	`š£¹
(
¡¬t_i
, "\n")

906 #Ok, 
now
 
we
 
ÿn
 
¡¬t
 
wÜkšg


907 
¡¬t_i
 = 
buff
.
	$g‘_™”_©_lše
(
lše_nbr
)

908 
’d_i
 = 
¡¬t_i
.
	$cİy
()

909 #W
go
 
back
 
©
 
the
 
’d
 
of
h
´evious
 
lše


910 #¡¬t_i.
	`backw¬d_ch¬
()

911 ##
But
 
Úly
 
this
 
is
 
nÙ
 
the
 
t™Ë
.

912 
š£¹_’‹r
 = 
F®£


913 #ià
¡¬t_i
.
	`has_g
(
£lf
.
t™Ë_g
):

914 #¡¬t_i.
	`fÜw¬d_ch¬
()

915 #š£¹_’‹¸ğ
F®£


916 
¡¬t
 = 
buff
.
	`ü—‹_m¬k
("¡¬t", 
¡¬t_i
, 
True
)

917 
’d_i
.
	$fÜw¬d_lše
()

918 
’d
 = 
buff
.
	`ü—‹_m¬k
("’d", 
’d_i
, 
F®£
)

919 
buff
.
	$d–‘e
(
¡¬t_i
, 
’d_i
)

920 
¡¬t_i
 = 
buff
.
	$g‘_™”_©_m¬k
(
¡¬t
)

921 
£lf
.
	$š£¹_šd’t
(
buff
, 
¡¬t_i
, 
Ëv–
, 
’‹r
=
š£¹_’‹r
)

922 
Ãwlše
 = 
£lf
.
	$g‘_subskt™Ë
(
ªchÜ
)

923 
’d_i
 = 
buff
.
	$g‘_™”_©_m¬k
(
’d
)

924 
¡¬tm
 = 
buff
.
	$ü—‹_m¬k
(
ªchÜ
, 
’d_i
, 
True
)

925 #Pu‰šg 
the
 
subsk
 
m¬ks
 
¬ound
h
t™Ë


926 
£lf
.
	$š£¹_©_m¬k
(
buff
, 
’d
, 
Ãwlše
)

927 
’d_i
 = 
buff
.
	$g‘_™”_©_m¬k
(
’d
)

928 
’dm
 = 
buff
.
	`ü—‹_m¬k
("/%s" % 
ªchÜ
, 
’d_i
, 
F®£
)

929 #puˆ
the
 
g
 
Ú
h
m¬ks


930 
£lf
.
	$­¶y_subsk_g
(
buff
, 
ªchÜ
, 
¡¬tm
, 
’dm
)

931 #buff.
	`d–‘e_m¬k
(
¡¬t
)

932 #buff.
	`d–‘e_m¬k
(
’d
)

934 
»cÚÃù_š£¹
:

935 
£lf
.
š£¹_sigid
 = s–f.
buff
.
	`cÚÃù
('insert-text',

936 
£lf
.
_š£¹_©_cursÜ
)

937 
»cÚÃù_modif›d
:

938 
£lf
.
modif›d_sigid
 = s–f.
buff
.
	`cÚÃù
("chªged", s–f.
modif›d
)

939  
’d_i


941 
def
 
	$š£¹_Ãwsk
(
£lf
, 
f™”a
=
NÚe
):

942 
nÙ
 
f™”a
:

943 
f™”a
 = 
£lf
.
	$g‘_š£¹
()

944 #Fœ¡, 
fšd
 
a
 
lše
 
w™hout
 
subsk


945 
lše
 = 
f™”a
.
	$g‘_lše
()

946 #Avoid 
the
 
t™Ë
 
©
 
®l
 
co¡


947 
lše
 <= 0:

948 
lše
 = 1

949 
¡¬
 = 
£lf
.
buff
.
	$g‘_™”_©_lše
(
lše
)

950 
™”a
 = 
NÚe


951 
nÙ
 
™”a
:

952 
found
 = 
True


953 
t
 
š
 
¡¬
.
	$g‘_gs
():

954 
	`ha§‰r
(
t
, 'is_indent'):

955 
lše
 += 1

956 
¡¬
 = 
£lf
.
buff
.
	$g‘_™”_©_lše
(
lše
)

957 
lše
 < 
£lf
.
buff
.
	$g‘_lše_couÁ
():

958 
found
 = 
F®£


959 
found
:

960 
™”a
 = 
¡¬


962 #ià
the
 
Ï¡
 
lše
 
is
 
šd’‹d
, 
th’
 
š£¹
 
a
 
Ãw
†ine

963 #© 
the
 
’d


964 
lše
 =ğ
£lf
.
buff
.
	$g‘_lše_couÁ
():

965 
™”a
.
	$fÜw¬d_to_lše_’d
()

966 
m¬k
 = 
£lf
.
buff
.
	$ü—‹_m¬k
(
NÚe
, 
™”a
, 
True
)

967 
£lf
.
buff
.
	`š£¹
(
™”a
, "\n")

968 
™”a
 = 
£lf
.
buff
.
	$g‘_™”_©_m¬k
(
m¬k
)

969 
£lf
.
buff
.
	$d–‘e_m¬k
(
m¬k
)

971 #Ià
we
 
¬e
 
nÙ
 
Ú
 
the
 
’d
 
of
 
lše
, 
go
 
th”e


972 #buˆ
we
 
¬e
 
©
 
the
 
¡¬t
 
of
 
lše
, 
th’
 
ü—‹
h
subsk


973 #befÜ
the
 
cu¼’t
 
lše


974 
’‹r
 = 
True


975 
™”a
.
	$¡¬ts_lše
():

976 
m¬k
 = 
£lf
.
buff
.
	$ü—‹_m¬k
(
NÚe
, 
™”a
, 
True
)

977 
£lf
.
buff
.
	`š£¹
(
™”a
, "\n")

978 
™”a
 = 
£lf
.
buff
.
	$g‘_™”_©_m¬k
(
m¬k
)

979 
£lf
.
buff
.
	$d–‘e_m¬k
(
m¬k
)

980 
’‹r
 = 
F®£


981 
–if
 
nÙ
 
™”a
.
	$’ds_lše
():

982 
™”a
.
	$fÜw¬d_to_lše_’d
()

983 
’dm
 = 
£lf
.
	$š£¹_šd’t
(
£lf
.
buff
, 
™”a
, 1, 
’‹r
=enter)

984 
’d
 = 
£lf
.
buff
.
	$g‘_™”_©_m¬k
(
’dm
)

985 
£lf
.
buff
.
	$¶aû_cursÜ
(
’d
)

987 
def
 
	$š£¹_šd’t
(
£lf
, 
buff
, 
¡¬t_i
, 
Ëv–
, 
’‹r
=
True
):

988 #W
wl
 
şo£
 
the
 
cu¼’t
 
subsk
 
g


989 
li¡_¡ag
 = 
¡¬t_i
.
	$g‘_toggËd_gs
(
F®£
)

990 
¡ag
 = 
NÚe


991 
t
 
š
 
li¡_¡ag
:

992 
	`ha§‰r
(
t
, 'is_subtask'):

993 
¡ag
 = 
t


994 #mayb
the
 
g
 
was
 
nÙ
 
toggËd
 
off
 
h”e
 
but
 
we
 
w”e
 
š
h
middË


995 
nÙ
 
¡ag
:

996 
li¡_¡ag
 = 
¡¬t_i
.
	$g‘_gs
()

997 
t
 
š
 
li¡_¡ag
:

998 
	`ha§‰r
(
t
, 'is_subtask'):

999 
¡ag
 = 
t


1000 
¡ag
:

1001 #W
wl
 
»move
 
the
 
g
 
äom
h
whŞe
 
‹xt


1002 
subtid
 = 
¡ag
.
chd


1003 #W
move
 
the
 
’d_subsk
 
m¬k
 
to
 
h”e


1004 #W
have
 
to
 
ü—‹
 
a
 
‹mpÜ¬y
 
m¬k
 
w™h
 
Ëá
 
g¿v™y


1005 #Iˆ
wl
 
be
 
Ï‹r
 
»¶aûd
 
by
 
the
 
good
 
Úe
 
w™h
 
right
 
g¿v™y


1006 
‹mp_m¬k
 = 
£lf
.
buff
.
	`ü—‹_m¬k
("‹mp", 
¡¬t_i
, 
True
)

1008 
’d
 = 
buff
.
	`ü—‹_m¬k
("’d", 
¡¬t_i
, 
F®£
)

1009 
’‹r
:

1010 
buff
.
	`š£¹
(
¡¬t_i
, "\n")

1012 #Movšg 
the
 
’d
 
of
 
subsk
 
m¬k
 
to
h
pos™iÚ
 oàth
‹mp
 mark

1013 
¡ag
:

1014 
™”a
 = 
buff
.
	$g‘_™”_©_m¬k
(
‹mp_m¬k
)

1015 
buff
.
	`move_m¬k_by_Çme
("/%s" % 
subtid
, 
™”a
)

1016 
buff
.
	$d–‘e_m¬k
(
‹mp_m¬k
)

1017 #Th
m¬k
 
has
 
right
 
g¿v™y
 
but
 
beÿu£
 
we
 
put
 
™
 
Ú
 
the
 
Ëá


1018 #oà
the
 
Ãwly
 
š£¹ed
 \
n
, 
™
 
wl
 
nÙ
 
move
 
ªymÜe
.

1020 
™”a
 = 
buff
.
	$g‘_™”_©_m¬k
(
’d
)

1021 #W
should
 
Ãv”
 
have
 
ª
 
šd’tiÚ
 
©
 0.

1022 #Thi 
is
 
nÜm®ly
 
nÙ
 
Ãeded
 
ªd
 
pu»ly
 
deãnsive


1023 
™”a
.
	`g‘_lše
() <= 0:

1024 
™”a
 = 
buff
.
	$g‘_™”_©_lše
(1)

1025 
¡¬t
 = 
buff
.
	`ü—‹_m¬k
("¡¬t", 
™”a
, 
True
)

1026 
šd’tiÚ
 = ""

1027 #addšg 
two
 
¥aûs
 
by
 
Ëv–


1028 
¥aûs
 = " "

1029 
šd’tiÚ
 = ind’tiÚ + (
Ëv–
 - 1è* 
¥aûs


1030 #addšg 
the
 
symbŞ


1031 
Ëv–
 == 1:

1032 
šd’tiÚ
 = "%s% " % (šd’tiÚ, 
£lf
.
buÎ‘1
)

1033 
buff
.
	$š£¹
(
™”a
, 
šd’tiÚ
)

1034 
šd’‰ag
 = 
£lf
.
	$ü—‹_šd’t_g
(
buff
, 
Ëv–
)

1035 
£lf
.
	$__­¶y_g_to_m¬k
(
¡¬t
, 
’d
, 
g
=
šd’‰ag
)

1036  
’d


1038 
def
 
	$__­¶y_g_to_m¬k
(
£lf
, 
¡¬t
, 
’d
, 
g
=
NÚe
, 
Çme
=None):

1039 
¡¬t_i
 = 
£lf
.
buff
.
	$g‘_™”_©_m¬k
(
¡¬t
)

1040 
’d_i
 = 
£lf
.
buff
.
	$g‘_™”_©_m¬k
(
’d
)

1041 #w
should
 
­¶y
 
the
 
g
 
Úly
 th
m¬k
 
¬e
 
£·¿‹d


1042 
’d_i
.
	`g‘_off£t
(è- 
¡¬t_i
.get_offset() > 0:

1043 
g
:

1044 
£lf
.
buff
.
	$­¶y_g
(
g
, 
¡¬t_i
, 
’d_i
)

1045 
–if
 
Çme
:

1046 
£lf
.
buff
.
	$­¶y_g_by_Çme
(
Çme
, 
¡¬t_i
, 
’d_i
)

1047 
–if
 
g
:

1048 
£lf
.
buff
.
	$»move_g
(
g
, 
¡¬t_i
, 
’d_i
)

1050 
def
 
	$š£¹_©_m¬k
(
£lf
, 
buff
, 
m¬k
, 
‹xt
, 
ªchÜ
=
NÚe
):

1051 
™e
 = 
buff
.
	$g‘_™”_©_m¬k
(
m¬k
)

1052 
ªchÜ
:

1053 
£lf
.
	`š£¹_w™h_ªchÜ
(
‹xt
, 
ªchÜ
, 
_™”
=
™e
, 
typ
="subtask")

1055 
buff
.
	$š£¹
(
™e
, 
‹xt
)

1057 
def
 
	$_g‘_šd’t_Ëv–
(
£lf
, 
™”a
):

1058 
lše_nbr
 = 
™”a
.
	$g‘_lše
()

1059 
¡¬t_lše
 = 
™”a
.
	$cİy
()

1060 
¡¬t_lše
.
	$£t_lše
(
lše_nbr
)

1061 
gs
 = 
¡¬t_lše
.
	$g‘_gs
()

1062 
cu¼’t_šd’t
 = 0

1063 

 
š
 
gs
:

1064 
	`ha§‰r
(

, 'is_indent'):

1065 
cu¼’t_šd’t
 = 

.
šd’t_Ëv–


1066  
cu¼’t_šd’t


1068 #M‘hod 
ÿÎed
 
Ú
 
cİy
 
ªd
 
cut
 
aùiÚs


1069 #·¿m 
is
 
e™h”
 "cut" 
Ü
 "copy"

1070 
def
 
	$cİy_şbßrd
(
£lf
, 
widg‘
, 
·¿m
=
NÚe
):

1071 
ş
 = 
Gtk
.
Clbßrd
.
	$g‘
(
Gdk
.
SELECTION_CLIPBOARD
)

1073 #Fœ¡, 
we
 
ª®y£
 
the
 
£ËùiÚ
 
to
 
put
 
š
 
our
 
own


1074 #GTGÂ 
şbßrd
 
a
 
£ËùiÚ
 
w™h
 
desütiÚ
 
of
 
subsks


1075 
bounds
 = 
£lf
.
buff
.
	$g‘_£ËùiÚ_bounds
()

1076 
nÙ
 
bounds
:

1078 
¡¬t
, 
¡İ
 = 
£lf
.
buff
.
	$g‘_£ËùiÚ_bounds
()

1080 
£lf
.
şbßrd
.
	$cİy
(
¡¬t
, 
¡İ
, 
buÎ‘
=
£lf
.
buÎ‘1
)

1082 
‹xt
 = 
£lf
.
şbßrd
.
	$·¡e_‹xt
()

1083 
ş
.
	`£t_‹xt
(
‹xt
, 
	$Ën
(
‹xt
))

1084 
ş
.
	$¡Üe
()

1086 
·¿m
 == "cut":

1087 
£lf
.
buff
.
	$d–‘e_£ËùiÚ
(
F®£
, 
True
)

1088 
£lf
.
	`¡İ_emissiÚ
("cut_clipboard")

1090 
£lf
.
	`¡İ_emissiÚ
("copy_clipboard")

1092 #C®Ëd 
Ú
 
·¡e
.

1093 
def
 
	$·¡e_şbßrd
(
£lf
, 
widg‘
, 
·¿m
=
NÚe
):

1094 
ş
 = 
Gtk
.
Clbßrd
.
	$g‘
(
Gdk
.
SELECTION_CLIPBOARD
)

1095 #ià
the
 
şbßrd
 
‹xt
 
is
h
§me
 
¬e
 
our
 
own
 
š‹º®


1096 #şbßrd 
‹xt
, 
™
 
m—ns
 
th©
 
we
 
ÿn
 
·¡e
 
äom
 
our
 
own
 
şbßrd


1097 #–£, 
th©
 
we
 
ÿn
 
em±y
 
™
.

1098 
our_·¡e
 = 
£lf
.
şbßrd
.
	$·¡e_‹xt
()

1099 
our_·¡e
 
is
 
nÙ
 
NÚe
 
ªd
 
ş
.
	`wa™_fÜ_‹xt
() == our_paste:

1100 #fœ¡, 
we
 
d–‘e
 
the
 
cu¼’t
 
£ËùiÚ


1101 
£lf
.
buff
.
	$d–‘e_£ËùiÚ
(
F®£
, 
True
)

1102 
lše
 
š
 
£lf
.
şbßrd
.
	$·¡e
():

1103 
lše
[0] == 'text':

1104 
£lf
.
buff
.
	$š£¹_©_cursÜ
(
lše
[1])

1105 
lše
[0] == 'subtask':

1106 
tid
 = 
lše
[1]

1107 
£lf
.
	$Ãw_subsk_ÿÎback
(
tid
=tid)

1108 
m¬k
 = 
£lf
.
buff
.
	$g‘_š£¹
()

1109 
lše_nbr
 = 
£lf
.
buff
.
	`g‘_™”_©_m¬k
(
m¬k
).
	$g‘_lše
()

1110 #w
mu¡
 
·¡e
 
the
 \
n
 
befÜe
 
š£¹šg
h
subsk


1111 #–£, 
we
 
wl
 
¡¬t
 
ªÙh”
 
subsk


1112 
£lf
.
buff
.
	`š£¹_©_cursÜ
("\n")

1113 
£lf
.
	$wr™e_subsk
(
£lf
.
buff
, 
lše_nbr
, 
tid
)

1115 #w
hªdË
 
our£lves
 
the
 
·¡šg


1116 
£lf
.
	`¡İ_emissiÚ
("paste_clipboard")

1119 #w
k“p
 
the
 
nÜm®
 
·¡šg
 
by
 
nÙ
 
š‹ru±šg
h
sigÇl


1120 
£lf
.
şbßrd
.
	$ş—r
()

1122 #FunùiÚ 
ÿÎed
 
—ch
 
time
 
the
 
u£r
 
šputs
 
a
 
Ë‰”


1123 
def
 
	$_š£¹_©_cursÜ
(
£lf
, 
tv
, 
™”a
, 
‹x
, 
Ëng
):

1124 #W
dÚ
't…astehe bullet

1125 
‹x
.
	`¡r
(è!ğ
£lf
.
buÎ‘1
:

1126 #´šˆ"‹xˆ###%s### in£¹ed†’gth = %s" %(
‹x
, 
Ëng
)

1127 #di§bË 
the
 
š£¹
 
sigÇl
 
to
 
avoid
 
»cursiÚ


1128 
£lf
.
buff
.
	$discÚÃù
(
£lf
.
š£¹_sigid
)

1129 
£lf
.
š£¹_sigid
 = 
F®£


1130 
£lf
.
buff
.
	$discÚÃù
(
£lf
.
modif›d_sigid
)

1131 
£lf
.
modif›d_sigid
 = 
F®£


1133 #Fœ¡, 
we
 
wl
 
g‘
 
the
 
aùu®
 
šd’tiÚ
 
v®ue


1134 #Th
nbr
 
ju¡
 
befÜe
 
the
 \
n


1135 
lše_nbr
 = 
™”a
.
	$g‘_lše
()

1136 
¡¬t_lše
 = 
™”a
.
	$cİy
()

1137 
¡¬t_lše
.
	$£t_lše
(
lše_nbr
)

1138 
’d_lše
 = 
™”a
.
	$cİy
()

1139 
gs
 = 
¡¬t_lše
.
	$g‘_gs
()

1140 
subsk_nbr
 = 
NÚe


1141 
cu¼’t_šd’t
 = 
£lf
.
	$_g‘_šd’t_Ëv–
(
™”a
)

1142 
gs
 = 
™”a
.
	$g‘_gs
()

1143 

 
š
 
gs
:

1144 
	`ha§‰r
(

, 'is_subtask'):

1145 
subsk_nbr
 = 

.
chd


1146 #Mayb
we
 
¬e
 
sim¶y
 
©
 
the
 
’d
 
of
h
g


1147 
nÙ
 
subsk_nbr
 
ªd
 
™”a
.
	$’ds_g
():

1148 

 
š
 
™”a
.
	$g‘_toggËd_gs
(
F®£
):

1149 
	`ha§‰r
(

, 'is_subtask'):

1150 
subsk_nbr
 = 

.
chd


1152 #New 
lše
: 
the
 
u£r
 
´es£d
 
’‹r
 !

1153 #Ià
the
 
lše
 
begšs
 
w™h
 "-", 
™
's‡‚ew subtask !

1154 
‹x
 == '\n':

1155 
£lf
.
buff
.
	`ü—‹_m¬k
("š£¹_pošt", 
™”a
, 
True
)

1156 #Fœ¡, 
we
 
şo£
 
g
 
gs
.

1157 #Ià
we
 
¬e
 
©
 
the
 
’d
 
of
 
a
 
g
, w
look
 
şo£d
 
gs


1158 
şo£d_g
 = 
NÚe


1159 
cu‰šg_subsk
 = 
F®£


1160 
™”a
.
	$’ds_g
():

1161 
li¡_¡ag
 = 
™”a
.
	$g‘_toggËd_gs
(
F®£
)

1162 #O¸
maybe
 
we
 
¬e
 
š
 
the
 
middË
 
of
 
a
 
g


1164 
li¡_¡ag
 = 
™”a
.
	$g‘_gs
()

1165 
t
 
š
 
li¡_¡ag
:

1166 
	`ha§‰r
(
t
, 'is_tag'):

1167 
şo£d_g
 = 
t
.
gÇme


1168 
–if
 
	`ha§‰r
(
t
, 'is_subtask'):

1169 
cu‰šg_subsk
 = 
True


1170 
şo£d_g
 = 
t
.
chd


1171 #W
add
 
a
 
buÎ‘
 
li¡
 
but
 
nÙ
 
Ú
 
the
 
fœ¡
 
lše


1172 #Beÿu£ 
™
'sheitle

1173 
lše_nbr
 > 0:

1174 
lše
 = 
¡¬t_lše
.
	$g‘_¦iû
(
’d_lše
)

1175 #th
·¹
 
aá”
 
the
 
’‹r


1176 
»®’d
 = 
’d_lše
.
	$cİy
()

1177 
»¡oæše
 = 
NÚe


1178 
nÙ
 
»®’d
.
	$’ds_lše
():

1179 
»®’d
.
	$fÜw¬d_to_lše_’d
()

1180 
»¡oæše
 = 
’d_lše
.
	$g‘_¦iû
(
»®’d
)

1181 
»¡oæše
.
	$¡r
()

1183 #Ià
šd’t
 
is
 0, 
We
 
check
 
we
 
ü—‹d
 
a
 
Ãw
 
sk


1184 #th"-" 
might
 
be
 
aá”
 
a
 
¥aû


1185 #PythÚ 2.5 
should
 
®low
 
bÙh
 
‹¡s
 
š
 
Úe


1186 
cu¼’t_šd’t
 == 0:

1187 ià(
lše
.
	`¡¬tsw™h
('-'è
Ü
†ine.startswith(' -')) \

1188 
ªd
 
lše
.
	`l¡r
(' -').
	`¡r
() != "":

1189 
lše
 =†še.
	`l¡r
(' -')

1190 
’d_i
 = 
£lf
.
	$__Ãwsubsk
(
£lf
.
buff
, 
lše
,

1191 
lše_nbr
)

1192 #H”e, 
we
 
should
 
šüem’t
 
šd’t
 
Ëv–


1193 #Ià
we
 
š£¹ed
 
’‹r
 
š
 
the
 
middË
 
of
 
a
 
lše


1194 
»¡oæše
 
ªd
„e¡oæše.
	`¡r
() != "":

1195 #™ 
m—ns
 
we
 
have
 
two
 
subsk
 
to
 
ü—‹


1196 
£lf
.
buff
.
	`g‘_lše_couÁ
(è> 
lše_nbr
 + 1:

1197 #buˆ
dÚ
't merge withhe‚ext†ine

1198 
™”a
 = 
£lf
.
buff
.
	`g‘_™”_©_lše
(

1199 
lše_nbr
 + 1)

1200 
£lf
.
buff
.
	`š£¹
(
™”a
, "\n\n")

1201 
£lf
.
	`__Ãwsubsk
(£lf.
buff
, 
»¡oæše
,

1202 
lše_nbr
 + 1)

1204 
£lf
.
	$š£¹_šd’t
(
£lf
.
buff
, 
’d_i
, 1,

1205 
’‹r
=
True
)

1206 
tv
.
	`em™_¡İ_by_Çme
('insert-text')

1208 
£lf
.
buff
.
	`š£¹
(
™”a
, "\n")

1209 
tv
.
	`em™_¡İ_by_Çme
('insert-text')

1211 #Th’, 
šd’t
 > 0, 
we
 
šüem’t
 
™


1212 #Fœ¡ 
¡•
: 
we
 
´e£rve
 
™
.

1214 
nÙ
 
lše
.
	`l¡r
("% " % 
£lf
.
buÎ‘1
):

1215 #ià
we
 
didn
't write‡ask, we„emovehe indent

1216 #w
check
 
the
 
™”©Ü
 
is
 
w–l
 
©
h
’d
 
of


1217 #th
lše


1218 
’d_lše
.
	$’ds_lše
():

1219 
£lf
.
	$dešd’t
(
™”a
, 
ÃwËv–
=0)

1220 #–£, 
™
 
m—ns
 
th©
 
we
 
´es£d
 
’‹r
 
befÜe


1221 #¨
subsk
 
t™Ë


1223 #w
fœ¡
 
put
 
the
 
subsk
 
Úe
 
lše
 
b–ow


1224 
™”a2
 = 
£lf
.
buff
.
	$g‘_™”_©_lše
(
lše_nbr
)

1225 
£lf
.
buff
.
	`š£¹
(
™”a2
, "\n")

1226 #ªd 
šüem’t
 
the
 
Ãw
 
wh™e
 
lše


1227 
™”a2
 = 
£lf
.
buff
.
	$g‘_™”_©_lše
(
lše_nbr
)

1228 
£lf
.
	$š£¹_šd’t
(
£lf
.
buff
, 
™”a2
,

1229 
cu¼’t_šd’t
, 
’‹r
=
F®£
)

1230 
–if
 
cu¼’t_šd’t
 == 1:

1231 
£lf
.
	$š£¹_šd’t
(
£lf
.
buff
, 
™”a
,

1232 
cu¼’t_šd’t
)

1233 #w
¡İ
 
the
 
sigÇl
 
š
 
®l
 
ÿ£s


1234 
tv
.
	`em™_¡İ_by_Çme
('insert-text')

1235 #Th’ 
we
 
şo£
 
the
 
g
ag

1236 
şo£d_g
:

1237 
š£¹_m¬k
 = 
£lf
.
buff
.
	`g‘_m¬k
("insert_point")

1238 
š£¹_™”
 = 
£lf
.
buff
.
	$g‘_™”_©_m¬k
(
š£¹_m¬k
)

1239 
£lf
.
buff
.
	`move_m¬k_by_Çme
("/%s" % 
şo£d_g
,

1240 
š£¹_™”
)

1241 
£lf
.
buff
.
	$d–‘e_m¬k
(
š£¹_m¬k
)

1242 
cu‰šg_subsk
:

1243 
cursÜ
 = 
£lf
.
buff
.
	`g‘_™”_©_m¬k
(

1244 
£lf
.
buff
.
	$g‘_š£¹
())

1245 
’dl
 = 
cursÜ
.
	$cİy
()

1246 
nÙ
 
’dl
.
	$’ds_lše
():

1247 
’dl
.
	$fÜw¬d_to_lše_’d
()

1248 
‹xt
 = 
£lf
.
buff
.
	$g‘_‹xt
(
cursÜ
, 
’dl
, 
True
)

1249 
ªchÜ
 = 
£lf
.
	$Ãw_subsk_ÿÎback
(
‹xt
)

1250 
£lf
.
buff
.
	$ü—‹_m¬k
(
ªchÜ
, 
cursÜ
, 
True
)

1251 
£lf
.
buff
.
	`ü—‹_m¬k
("/%s" % 
ªchÜ
, 
’dl
, 
F®£
)

1252 
£lf
.
	$modif›d
(
fuÎ
=
True
)

1253 #Th
u£r
 
’‹»d
 
som‘hšg
 
thª
 \
n


1254 
–if
 
‹x
:

1255 #W
¬e
 
Ú
 
ª
 
šd’‹d
 
lše
 
w™hout
 
subsk
 ? 
C»©e
 
™
 !

1256 
cu¼’t_šd’t
 > 0 
ªd
 
nÙ
 
subsk_nbr
:

1257 
™”a
.
	$¡¬ts_lše
():

1258 #w
¬e
 
©
 
the
 
¡¬t
 
of
 
ª
 
exi¡šg
 
subsk


1259 #w
sim¶y
 
move
 
th©
 
subsk
 
down


1260 
£lf
.
buff
.
	`š£¹
(
™”a
, "\n")

1261 
™”a2
 = 
£lf
.
buff
.
	$g‘_™”_©_lše
(
lše_nbr
)

1262 
£lf
.
buff
.
	$š£¹
(
™”a2
, 
‹x
)

1263 
™”a3
 = 
£lf
.
buff
.
	$g‘_™”_©_lše
(
lše_nbr
)

1264 
™”a3
.
	$fÜw¬d_to_lše_’d
()

1265 
£lf
.
buff
.
	$¶aû_cursÜ
(
™”a3
)

1266 
tv
.
	`em™_¡İ_by_Çme
('insert-text')

1268 #£lf.
	`__Ãwsubsk
(
£lf
.
buff
, 
‹x
, 
lše_nbr
,

1269 #Ëv–=
cu¼’t_šd’t
)

1270 
ªchÜ
 = 
£lf
.
	$Ãw_subsk_ÿÎback
(
‹x
)

1271 
£lf
.
buff
.
	$ü—‹_m¬k
(
ªchÜ
, 
™”a
, 
True
)

1272 
£lf
.
buff
.
	`ü—‹_m¬k
("/%s" % 
ªchÜ
, 
™”a
, 
F®£
)

1273 
£lf
.
š£¹_sigid
 = s–f.
buff
.
	`cÚÃù
('insert-text',

1274 
£lf
.
_š£¹_©_cursÜ
)

1275 
£lf
.
	`cÚÃù
('key_´ess_ev’t', s–f.
_key´ess
)

1276 
£lf
.
modif›d_sigid
 = s–f.
buff
.
	`cÚÃù
("chªged", s–f.
modif›d
)

1278 
def
 
	$_key´ess
(
£lf
, 
widg‘
, 
ev’t
):

1279 #Check 
CŒl
-
R‘uº
/
EÁ”


1280 
ev’t
.
	`g‘_¡©e
(è& 
Gdk
.
Modif›rTy³
.
CONTROL_MASK
 
ªd
 \

1281 
ev’t
.
keyv®
 
	$š
 (
Gdk
.
KEY_R‘uº
, Gdk.
KEY_KP_EÁ”
):

1282 
buff
 = 
£lf
.buff

1283 
cursÜ_m¬k
 = 
buff
.
	$g‘_š£¹
()

1284 
cursÜ_™”
 = 
buff
.
	$g‘_™”_©_m¬k
(
cursÜ_m¬k
)

1285 
loÿl_¡¬t
 = 
cursÜ_™”
.
	$cİy
()

1287 
g
 
š
 
loÿl_¡¬t
.
	$g‘_gs
():

1288 
ªchÜ
 = 
g
.
lšk


1289 
typ
 = 
g
.
ty³


1290 if(
ªchÜ
):

1291 
typ
 == "subtask":

1292 
£lf
.
	$İ’_sk
(
ªchÜ
)

1293 
–if
 
typ
 =ğ"h‰p" 
ªd
 
£lf
.
	$check_lšk
(
ªchÜ
):

1294 
	$İ’u¾
(
ªchÜ
)

1296  
True


1298 #Dešd’ˆ
the
 
cu¼’t
 
lše
 
of
 
Úe
 
Ëv–


1299 #Ià
ÃwËv–
 
is
 
£t
, 
fÜû
 
to
 
go
Ø
th©
 
Ëv–


1300 
def
 
	`dešd’t
(
£lf
, 
™”a
, 
ÃwËv–
=-1):

1301 
lše
 = 
™”a
.
	$g‘_lše
()

1302 
¡¬še
 = 
£lf
.
buff
.
	$g‘_™”_©_lše
(
lše
)

1303 
ÃwËv–
 < 0:

1304 
t
 
š
 
™”a
.
	$g‘_toggËd_gs
(
F®£
):

1305 
	`ha§‰r
(
t
, 'is_indent'):

1306 
ÃwËv–
 = 
t
.
šd’t_Ëv–


1308 
ÃwËv–
 > 0:

1309 
ÃwËv–
 -= 1

1310 #Ià
™
's still < 0

1311 
ÃwËv–
 < 0:

1312 
	`´št
("bug:‚o is_indentag onhat†ine")

1313 #¡¬še.
	`backw¬d_ch¬
()

1314 #W
make
 
a
 
‹mp
 
m¬k
 
wh”e
 
we
 
should
 
š£¹
 
the
 
Ãw
 
šd’t


1315 #‹mpm = 
£lf
.
buff
.
	`ü—‹_m¬k
("‹mp", 
¡¬še
)

1316 
£lf
.
buff
.
	$discÚÃù
(
£lf
.
d–‘e_sigid
)

1317 #´šˆ"deštd’t-d–‘e: %s" %
£lf
.
buff
.
	`g‘_‹xt
(
¡¬še
, 
™”a
)

1318 
£lf
.
buff
.
	$d–‘e
(
¡¬še
, 
™”a
)

1319 #FÜ 
the
 
day
 
wh’
 
we
 
wl
 
have
 
difã»Á
 
šd’t
 
Ëv–s


1320 #Ãw™” = 
£lf
.
buff
.
	`g‘_™”_©_m¬k
(
‹mpm
)

1321 #£lf.
buff
.
	`d–‘e_m¬k
(
‹mpm
)

1322 #£lf.
	`š£¹_šd’t
(
£lf
.
buff
, 
Ãw™”
, 
ÃwËv–
, 
’‹r
=
F®£
)

1323 
£lf
.
d–‘e_sigid
 = s–f.
buff
.
	`cÚÃù
("delete-range",

1324 
£lf
.
_d–‘e_¿nge
)

1326 
def
 
	$back¥aû
(
£lf
, 
tv
):

1327 
£lf
.
buff
.
	$discÚÃù
(
£lf
.
š£¹_sigid
)

1328 
š£¹_m¬k
 = 
£lf
.
buff
.
	$g‘_š£¹
()

1329 
š£¹_™”
 = 
£lf
.
buff
.
	$g‘_™”_©_m¬k
(
š£¹_m¬k
)

1330 #AÎ 
this
 
ü­
 
to
 
fšd
 
we
 
¬e
 
©
 
the
 
’d
 
of
 
ª
 
šd’t
 
g


1331 
š£¹_™”
.
	$’ds_g
():

1332 
t
 
š
 
š£¹_™”
.
	$g‘_toggËd_gs
(
F®£
):

1333 
	`ha§‰r
(
t
, 'is_indent'):

1334 
£lf
.
	$dešd’t
(
š£¹_™”
)

1335 
tv
.
	`em™_¡İ_by_Çme
('backspace')

1336 #w
¡İ³d
 
the
 
sigÇl
, 
dÚ
't forgetoƒrase

1337 #th
£ËùiÚ
 
Úe


1338 
£lf
.
buff
.
	$d–‘e_£ËùiÚ
(
True
, True)

1339 
£lf
.
š£¹_sigid
 = s–f.
buff
.
	`cÚÃù
('insert-text',

1340 
£lf
.
_š£¹_©_cursÜ
)

1342 #Th
mou£
 
is
 
movšg
. 
We
 
mu¡
 
chªge
 
™
 
to
 
a
 
hªd
 
wh’
 
hov”šg
 
ov”
‡

1344 
def
 
	$_mÙiÚ
(
£lf
, 
v›w
, 
ev
):

1345 
wšdow
 = 
ev
.window

1346 
_
, 
x
, 
y
, _ = 
wšdow
.
	$g‘_poš‹r
()

1347 
x
, 
y
 = 
v›w
.
	$wšdow_to_bufãr_coÜds
(
Gtk
.
TextWšdowTy³
.
TEXT
, 
x
, 
y
)

1348 
gs
 = 
v›w
.
	`g‘_™”_©_loÿtiÚ
(
x
, 
y
).
	$g‘_gs
()

1349 
g
 
š
 
gs
:

1350 
	`ha§‰r
(
g
, 'is_anchor'):

1351 
t
 
š
 
	`£t
(
£lf
.
__gs
è- 
	$£t
([
g
]):

1352 
£lf
.
	$__g_»£t
(
t
, 
wšdow
)

1353 
£lf
.
	`__£t_ªchÜ
(

1354 
wšdow
, 
g
, 
Gdk
.
CursÜ
.
	`Ãw
(Gdk.
CursÜTy³
.
HAND2
),

1355 
£lf
.
	`g‘_´İ”ty
('hover'))

1358 
g_bË
 = 
£lf
.
buff
.
	$g‘_g_bË
()

1359 
g_bË
.
	$fÜ—ch
(
£lf
.
__g_»£t
, 
wšdow
)

1361 
def
 
	$_g_ev’t
(
£lf
, 
g
, 
v›w
, 
ev
, 
_™”
, 
‹xt
, 
ªchÜ
, 
typ
):

1363 
We
 
şicked
 
Ú
 
a
 
lšk


1366 
_ty³
 = 
ev
.
ty³


1367 
_ty³
 =ğ
Gdk
.
Ev’tTy³
.
MOTION_NOTIFY
:

1369 
–if
 
_ty³
 
š
 [
Gdk
.
Ev’tTy³
.
BUTTON_PRESS
,

1370 
Gdk
.
Ev’tTy³
.
BUTTON_RELEASE
]:

1371 
bu‰Ú
 = 
ev
.button

1372 
cursÜ
 = 
Gdk
.
CursÜ
.
	$Ãw
(
Gdk
.
CursÜTy³
.
HAND2
)

1373 
_ty³
 =ğ
Gdk
.
Ev’tTy³
.
BUTTON_RELEASE
:

1374 
typ
 == "subtask":

1375 
£lf
.
	$İ’_sk
(
ªchÜ
)

1376 
–if
 
typ
 == "http":

1377 
bu‰Ú
 =ğ1 
ªd
 
£lf
.
	$check_lšk
(
ªchÜ
è
ªd
 \

1378 
nÙ
 
£lf
.
buff
.
	$g‘_has_£ËùiÚ
():

1379 
	$İ’u¾
(
ªchÜ
)

1381 
	`´št
("UnknowÀlšky³ fÜ %s" % 
ªchÜ
)

1382 
£lf
.
	`em™
('ªchÜ-şicked', 
‹xt
, 
ªchÜ
, 
bu‰Ú
)

1383 
£lf
.
	`__£t_ªchÜ
(
ev
.
wšdow
, 
g
, 
cursÜ
,

1384 
£lf
.
	`g‘_´İ”ty
('hover'))

1385 
–if
 
bu‰Ú
 
š
 [1, 2]:

1386 
£lf
.
	`__£t_ªchÜ
(
ev
.
wšdow
, 
g
, 
cursÜ
,

1387 
£lf
.
	`g‘_´İ”ty
('active'))

1389 
def
 
	$__g_»£t
(
£lf
, 
g
, 
wšdow
):

1390 
	`ha§‰r
(
g
, 'is_anchor'):

1391 #W
Ãed
 
to
 
g‘
 
the
 
nÜm®
 
cursÜ
 
back


1392 
ed™šg_cursÜ
 = 
Gdk
.
CursÜ
.
	$Ãw
(
Gdk
.
CursÜTy³
.
XTERM
)

1393 
g
.
	`g‘_´İ”ty
('strikethrough'):

1394 
lškty³
 = 'done'

1396 
£lf
.
	$check_lšk
(
g
.
lšk
):

1397 
lškty³
 = 'link'

1399 
lškty³
 = 'failedlink'

1400 
£lf
.
	`__£t_ªchÜ
(
wšdow
, 
g
, 
ed™šg_cursÜ
,

1401 
£lf
.
	$g‘_´İ”ty
(
lškty³
))

1403 
def
 
	$__£t_ªchÜ
(
£lf
, 
wšdow
, 
g
, 
cursÜ
, 
´İ
):

1404 
wšdow
.
	$£t_cursÜ
(
cursÜ
)

1405 
key
, 
v®
 
š
 
´İ
.
	$™ems
():

1406 
g
.
	$£t_´İ”ty
(
key
, 
v®
)

1409 
GObjeù
.
	`ty³_»gi¡”
(
TaskV›w
)

	@gtk/editor/taskviewserial.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
impÜt
 
	gxml
.
	gdom
.
	gmšidom


20 #Th
fŞlowšg
 
funùiÚs
 
¬e
 
u£d
 
by
 
the
 
Gtk
.
TextBufãr
 
to
 
£rŸlize


21 #th
cÚ‹Á
 
of
 
the
 
sk


23 ###########S”Ÿlizšg 
funùiÚs
 ##############

24 ###S”Ÿliz
the
 
sk
 : 
ŒªsfÜm
 
™
's content in something

25 #w
ÿn
 
¡Üe
. 
This
 
funùiÚ
 
sigÇtu»
 
is
 
defšed
 
š
 
PyGTK


27 
şass
 
	$S”Ÿliz”
(
objeù
):

28 #Di§blšg 
pylšt
 
¬gum’t
 
u§ge
 
sšû
 
we
 
know
 w
¬e
 
nÙ
 
usšg
 
®l
 
¬gs


29 
def
 
	$£rŸlize
(
£lf
, 
»gi¡”_buf
, 
cÚ‹Á_buf
, 
¡¬t
, 
’d
, 
Ëngth
, 
ud©a
):

30 #Cu¼’y 
we
 
£rŸlize
 
š
 
XML


31 
™s
 = 
¡¬t
.
	$cİy
()

32 
™e
 = 
’d
.
	$cİy
()

33 #W¬nšg : 
the
 
£rŸliz©iÚ
 
´oûss
 
ÿÂÙ
 
be
 
®lowed
 
to
 
modify


34 #th
cÚ‹Á
 
of
 
the
 
bufãr
.

35 
doc
 = 
xml
.
dom
.
mšidom
.
	$Docum’t
()

36 
·»Á
 = 
doc
.
	`ü—‹EËm’t
("content")

37 
doc
.
	`­³ndChd
(
£lf
.
	$·r£_bufãr
(
cÚ‹Á_buf
, 
™s
, 
™e
, 
·»Á
, 
doc
))

38 #W
dÚ
't wanthe whole doc withhe XML declaration

39 #w
Úly
 
ke
 
the
 
fœ¡
 
	`node
 (th"cÚ‹Á" 
Úe
)

40 
node
 = 
doc
.
fœ¡Chd


42 #´šˆ
node
.
	`toxml
()

43  
node
.
	$toxml
()

45 
def
 
	$·r£_bufãr
(
£lf
, 
buff
, 
¡¬t
, 
’d
, 
·»Á
, 
doc
, 
dÚe
=[]):

47 
P¬£
 
the
 
bufãr
 
ªd
 
ouut
 
ª
 
XML
 
»´e£Á©iÚ
.

49 @
v¬
 
buff
, 
¡¬t
, 
’d
 : 
the
 
bufãr
 
to
 
·r£
 
äom
 startoƒnd

50 @
v¬
 
·»Á
, 
doc
: 
the
 
XML
 
–em’t
 
to
 
add
 
d©a
 
ªd
 doø
is


51 
the
 
XML
 
dom


52 @
v¬
 
dÚe
 : 
the
 
li¡
 
of
 
·r£d
 
gs


55 
def
 
	$is_know_g
(
g
):

57 
R‘uº
 
True
 "g" 
is
 
a
 
know
 
g
. "g" 
mu¡
 
be
‡ 
Gtk
.
TextTag
.

59 
know_gs
 = ["is_subtask", "is_indent", "is_tag"]

60 
know
 
š
 
know_gs
:

61 
	$ha§‰r
(
g
, 
know
):

62  
True


63  
F®£


64 
™
 = 
¡¬t
.
	$cİy
()

65 
g
 = 
NÚe


66 
¡¬t_™
 = 
¡¬t
.
	$cİy
()

67 
’d_™
 = 
¡¬t
.
	$cİy
()

69 
bufãr_’d
 = 
F®£


70 
nÙ
 
bufãr_’d
:

71 
g
 
is
 
NÚe
:

72 #W
¬e
 
nÙ
 
š
 
a
 
g
 
cÚ‹xt


73 #G‘ 
li¡
 
of
 
know
 
gs
 
which
 
begš
 
h”e


74 #ªd 
¬e
 
nÙ
 
®»ady
 
´oûss


75 
gs
 = []

76 

 
š
 
™
.
	$g‘_gs
():

77 
™
.
	$begšs_g
(

è
ªd
¨
nÙ
 
š
 
dÚe
‡nd \

78 
	$is_know_g
(

):

79 
gs
.
	$­³nd
(

)

80 
™
.
	$begšs_g
(è
ªd
 
	`Ën
(
gs
) > 0:

81 #W
’‹r
 
š
 
a
 
g
 
cÚ‹xt


82 
g
 = 
gs
.
	$pİ
()

83 
dÚe
.
	$­³nd
(
g
)

84 
¡¬t_™
 = 
™
.
	$cİy
()

86 #W
¡ay
 
out
 
of
 
a
 
g
 
cÚ‹xt


87 #W
wr™e
 
the
 
š
h
xml
 
node


88 
™
.
	`g‘_ch¬
() != "":

89 
·»Á
.
	`­³ndChd
(
doc
.
	`ü—‹TextNode
(
™
.
	$g‘_ch¬
()))

91 #W
¬e
 
š
 
a
 
g
 
cÚ‹xt


92 
™
.
	$’ds_g
(
g
è
Ü
 
™
.
	$equ®
(
’d
):

93 #Th”
is
 
the
 
’d
 
of
h
gtkTextTag


94 #W
´oûss
 
the
 
g


95 
’d_™
 = 
™
.
	$cİy
()

96 
’d_™
.
	$backw¬d_ch¬
()

97 
	`ha§‰r
(
g
, 'is_tag'):

98 #Th
cu¼’t
 
gtkTextTag
 
is
 
a
 
g


99 #Recursiv
ÿÎ


100 
Å¬’t
 = 
doc
.
	`ü—‹EËm’t
("tag")

101 
chd
 = 
£lf
.
	$·r£_bufãr
(
buff
, 
¡¬t_™
, 
’d_™
,

102 
Å¬’t
, 
doc
, 
dÚe
=done)

103 
·»Á
.
	$­³ndChd
(
chd
)

104 
–if
 
	`ha§‰r
(

, 'is_subtask'):

105 #Th
cu¼’t
 
gtkTextTag
 
is
 
a
 
subsk


106 
gÇme
 = "subtask"

107 
subt
 = 
doc
.
	$ü—‹EËm’t
(
gÇme
)

108 
rg‘
 = 

.
chd


109 
subt
.
	`­³ndChd
(
doc
.
	$ü—‹TextNode
(
rg‘
))

110 
·»Á
.
	$­³ndChd
(
subt
)

111 
·»Á
.
	`­³ndChd
(
doc
.
	`ü—‹TextNode
("\n"))

112 
™
.
	$fÜw¬d_lše
()

113 
–if
 
	`ha§‰r
(

, 'is_indent'):

114 #Th
cu¼’t
 
gtkTextTag
 
is
 
a
 
šd’t


115 
šd’t
 = 
buff
.
	$g‘_‹xt
(
¡¬t_™
, 
’d_™
, 
True
)

116 '\n' 
š
 
šd’t
:

117 
·»Á
.
	`­³ndChd
(
doc
.
	`ü—‹TextNode
('\n'))

118 
™
 = 
’d_™


119 #W
go
 
out
 
the
 
g
 
cÚ‹xt


120 
g
 = 
NÚe


121 
nÙ
 
™
.
	$equ®
(
’d
):

122 
™
.
	$backw¬d_ch¬
()

123 
™
.
	$equ®
(
’d
):

124 
bufãr_’d
 = 
True


126 
™
.
	$fÜw¬d_ch¬
()

128 #Fšishšg 
w™h
 
ª
 \
n
 
befÜe
 
şosšg
 </
cÚ‹Á
>

129 
·»Á
.
loÿlName
 == "content":

130 
Ï¡_v®
 = 
·»Á
.
Ï¡Chd


131 #W
add
 
a
 \
n
 
Úly
 
	`Ãeded
 (ğ
we
 
dÚ
't have‡ "\n"‡theƒnd)

132 
Ï¡_v®
 
ªd
†a¡_v®.
nodeTy³
 == 3‡nd \

133 
Ï¡_v®
.
nodeV®ue
[-1] != '\n':

134 
·»Á
.
	`­³ndChd
(
doc
.
	`ü—‹TextNode
('\n'))

135 #Thi 
funùiÚ
 
cÚÿ‹Ç‹s
 
®l
 
the
 
adjaûÁ
 
‹xt
 
node
 
of
h
XML


136 
·»Á
.
	$nÜm®ize
()

137  
·»Á


140 ######################## 
De£rŸlizšg
 ##################################

141 ###De£rŸliz: 
put
 
®l
 
š
 
the
 
TextBufãr


142 #Thi 
funùiÚ
 
sigÇtu»
 
is
 
defšed
 
š
 
PyGTK


144 
şass
 
Un£rŸliz”
:

146 
def
 
	$__š™__
(
£lf
, 
skv›w
):

147 #W
k“p
 
a
 
»ã»nû
 
to
 
the
 
Üigš®
 
skv›w


148 #NÙ 
v”y
 
´‘ty
 
but
 
cÚv’›Á


149 
£lf
.
tv
 = 
skv›w


151 #Di§blšg 
pylšt
 
¬gum’t
 
u§ge
 
sšû
 
we
 
know
 w
¬e
 
nÙ
 
usšg
 
®l
 
¬gs


152 
def
 
	$un£rŸlize
(
£lf
, 
»gi¡”_buf
, 
cÚ‹Á_buf
, 
™e
, 
Ëngth
,

153 
d©a
, 
ü_gs
, 
ud©a
):

154 
d©a
:

155 
–em’t
 = 
xml
.
dom
.
mšidom
.
	$·r£SŒšg
(
d©a
)

156 
sucûss
 = 
£lf
.
	$·r£xml
(
cÚ‹Á_buf
, 
™e
, 
–em’t
.
fœ¡Chd
)

158 
sucûss
 = 
£lf
.
	$·r£xml
(
cÚ‹Á_buf
, 
™e
, 
NÚe
)

159  
sucûss


161 #In£¹ 
a
 
li¡
 
of
 
subsks
 
©
 
the
 
’d
 oàth
bufãr


162 
def
 
	$š£¹_subsks
(
£lf
, 
buff
, 
¡_li¡
):

163 #Ià
the
 
Ï¡lše
 
of
h
bufãr
 
is
 
nÙ
 
em±y
, 
we
 
add
 
ª
 
exŒa
 \
n


164 
’d_’d
 = 
buff
.
	$g‘_’d_™”
()

165 
’d_lše
 = 
’d_’d
.
	$g‘_lše
()

166 
¡¬t_’d
 = 
buff
.
	$g‘_™”_©_lše
(
’d_lše
)

167 
buff
.
	`g‘_‹xt
(
¡¬t_’d
, 
’d_’d
, 
True
).
	$¡r
():

168 
’d_lše
 += 1

169 
tid
 
š
 
¡_li¡
:

170 
£lf
.
tv
.
	$wr™e_subsk
(
buff
, 
’d_lše
, 
tid
)

171 
’d_lše
 += 1

173 #š£¹ 
a
 
GTG
 
g
 
w™h
 
™s
 
TextV›w
ag.

174 #Yes, 
we
 
know
 : 
the
 
wÜd
 
g
 
is
 
u£d
 
two
 
difã»Á
 
cÚû±s
 
h”e
.

175 
def
 
	$š£¹_g
(
£lf
, 
buff
, 
g
, 
™”a
=
NÚe
):

176 
nÙ
 
™”a
:

177 
™”a
 = 
buff
.
	$g‘_’d_™”
()

178 
g
:

179 
sm
 = 
buff
.
	$ü—‹_m¬k
(
NÚe
, 
™”a
, 
True
)

180 
em
 = 
buff
.
	$ü—‹_m¬k
(
NÚe
, 
™”a
, 
F®£
)

181 
buff
.
	$š£¹
(
™”a
, 
g
)

182 
£lf
.
tv
.
	$­¶y_g_g
(
buff
, 
g
, 
sm
, 
em
)

184 #·r£ 
the
 
XML
 
ªd
 
put
h
cÚ‹Á
 
š
h
bufãr


185 
def
 
	$·r£xml
(
£lf
, 
buf
, 
™e
, 
–em’t
):

186 
¡¬t
 = 
buf
.
	$ü—‹_m¬k
(
NÚe
, 
™e
, 
True
)

187 
’d
 = 
buf
.
	$ü—‹_m¬k
(
NÚe
, 
™e
, 
F®£
)

188 
subsks
 = 
£lf
.
tv
.
	$g‘_subsks
()

189 
gli¡2
 = []

190 
–em’t
:

191 
n
 
š
 
–em’t
.
chdNodes
:

192 
™”a
 = 
buf
.
	$g‘_™”_©_m¬k
(
’d
)

193 
n
.
nodeTy³
 =ğn.
ELEMENT_NODE
:

194 #´šˆ"<%s>" %
n
.
nodeName


195 
n
.
nodeName
 == "subtask":

196 
tid
 = 
n
.
fœ¡Chd
.
nodeV®ue


197 #W
»move
 
the
 
added
 
subsk
 
äom
h
li¡


198 #Oà
known
 
subsks


199 #Ià
the
 
subsk
 
is
 
nÙ
 
š
h
li¡
, 
we
 
dÚ
't write it

200 
tid
 
š
 
subsks
:

201 
subsks
.
	$»move
(
tid
)

202 
lše_nbr
 = 
™”a
.
	$g‘_lše
()

203 
£lf
.
tv
.
	$wr™e_subsk
(
buf
, 
lše_nbr
, 
tid
)

204 
–if
 
n
.
nodeName
 == "tag":

205 
‹xt
 = 
n
.
fœ¡Chd
.
nodeV®ue


206 
‹xt
:

207 
£lf
.
	$š£¹_g
(
buf
, 
‹xt
, 
™”a
)

208 #W
»move
 
the
 
added
 
g
 
äom
hg 
li¡


209 #oà
known
 
g
 
this
 
sk


210 
gli¡2
.
	$­³nd
(
‹xt
)

212 
£lf
.
	$·r£xml
(
buf
, 
™”a
, 
n
)

213 
s
 = 
buf
.
	$g‘_™”_©_m¬k
(
¡¬t
)

214 
e
 = 
buf
.
	$g‘_™”_©_m¬k
(
’d
)

215 
n
.
nodeName
 == "link":

216 
ªchÜ
 = 
n
.
	`g‘A‰ribu‹
("target")

217 
g
 = 
£lf
.
tv
.
	$ü—‹_ªchÜ_g
(
buf
, 
ªchÜ
, 
NÚe
)

218 
buf
.
	$­¶y_g
(
g
, 
s
, 
e
)

220 
buf
.
	$­¶y_g_by_Çme
(
n
.
nodeName
, 
s
, 
e
)

221 
–if
 
n
.
nodeTy³
 =ğn.
TEXT_NODE
:

222 
buf
.
	$š£¹
(
™”a
, 
n
.
nodeV®ue
)

223 #Now, 
we
 
š£¹
 
the
 
»maššg
 
subsks


224 
£lf
.
	$š£¹_subsks
(
buf
, 
subsks
)

225 #W
®so
 
š£¹
 
the
 
»maššg
 
	`gs
 (
a
‡ 
Ãw
 
lše
)

226 
gli¡
 = 
£lf
.
tv
.
	$g‘_g¦i¡
()

227 
t
 
š
 
gli¡2
:

228 
t
 
š
 
gli¡
:

229 
gli¡
.
	$»move
(
t
)

230 #W
»move
 
du¶iÿ‹s


231 
t
 
š
 
gli¡
:

232 
t
 
š
 
gli¡
:

233 
gli¡
.
	$»move
(
t
)

234 
gli¡
.
	$­³nd
(
t
)

235 
	`Ën
(
gli¡
) > 0:

236 
£lf
.
tv
.
	$š£¹_gs
(
gli¡
)

237 
buf
.
	$d–‘e_m¬k
(
¡¬t
)

238 
buf
.
	$d–‘e_m¬k
(
’d
)

239  
True


	@gtk/help.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
It
 
®lows
 
you
 
	gto
:

19 - 
£tup
 
F1
 
as
 
a
 
h–p
 
shÜtcut


20 - 
di¥Ïy
 
the
 
docum’tiÚ
 
h–p
 
a
 
giv’
 
subjeù
 (
¶ugšs
, 
sync
, ...)

23 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


24 
äom
 
webbrow£r
 
impÜt
 
İ’
 
as
 
İ’u¾


26 
äom
 
GTG
 
impÜt
 
šfo


29 
def
 
	$cÚ¡ruù_h–p_addr
(
h–p_addr
=
NÚe
):

31 (: 
g’”®
 
h–p
) """

32  
šfo
.
HELP_URI
 + {

35 
	}
}.
g‘
(
h–p_addr
, "")

38 
def
 
	$show_h–p
(
h–p_addr
):

40 
h–p_u¾
 = 
	$cÚ¡ruù_h–p_addr
(
h–p_addr
)

41 
	$İ’u¾
(
h–p_u¾
)

42  
True


45 
def
 
	$add_h–p_shÜtcut
(
widg‘
, 
h–p_addr
):

47 
agr
 = 
Gtk
.
	$AcûlGroup
()

48 
widg‘
.
	$add_acûl_group
(
agr
)

49 
key
, 
modif›r
 = 
Gtk
.
	`acûË¿tÜ_·r£
('F1')

50 
agr
.
	`cÚÃù
(
key
, 
modif›r
, 
Gtk
.
AcûlFÏgs
.
VISIBLE
,

51 
Ïmbda
 *
¬gs
: 
	`show_h–p
(
h–p_addr
))

	@gtk/manager.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
Mªag”
 
lßds
 
the
 
´efs
 
ªd
 
Ïunches
h
gtk
 
maš
 
	gloİ


20 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
	gGObjeù
, 
Gtk


21 
impÜt
 
cÚfig·r£r


23 
impÜt
 
GTG


24 
äom
 
	gGTG
.
	ggtk
.
d–‘e_dŸlog
 
impÜt
 
D–‘iÚUI


25 
äom
 
	gGTG
.
	ggtk
.
	gbrow£r
.
brow£r
 
impÜt
 
TaskBrow£r


26 
äom
 
	gGTG
.
	ggtk
.
	ged™Ü
.
ed™Ü
 
impÜt
 
TaskEd™Ü


27 
äom
 
	gGTG
.
	ggtk
.
´eã»nûs
 
impÜt
 
P»ã»nûsDŸlog


28 
äom
 
	gGTG
.
	ggtk
.
¶ugšs
 
impÜt
 
PlugšsDŸlog


29 
äom
 
	gGTG
.
	ggtk
.
dbusw¿µ”
 
impÜt
 
DBusTaskW¿µ”


30 
äom
 
	gGTG
.
toŞs
 
impÜt
 
şbßrd


31 
äom
 
	gGTG
.
	gcÜe
.
	g¶ugšs
.
’gše
 
impÜt
 
PlugšEngše


32 
äom
 
	gGTG
.
	gcÜe
.
	g¶ugšs
.
­i
 
impÜt
 
PlugšAPI


33 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


34 
äom
 
	gGTG
.
	ggtk
.
back’ds_dŸlog
 
impÜt
 
Back’dsDŸlog


35 
äom
 
	gGTG
.
	gback’ds
.
back’dsigÇls
 
impÜt
 
Back’dSigÇls


36 
äom
 
	gGTG
.
	ggtk
.
	gbrow£r
.
g_ed™Ü
 
impÜt
 
TagEd™Ü


39 
şass
 
	$Mªag”
(
GObjeù
.GObject):

41 
__objeù_sigÇl__
 = (
GObjeù
.
SIGNAL_RUN_FIRST
, GObjeù.
TYPE_NONE
,

42 (
GObjeù
.
TYPE_PYOBJECT
,))

43 
__objeù_¡ršg_sigÇl__
 = (
GObjeù
.
SIGNAL_RUN_FIRST
, GObjeù.
TYPE_NONE
,

44 (
GObjeù
.
TYPE_PYOBJECT
, GObjeù.
TYPE_STRING
, ))

45 
__gsigÇls__
 = {'sks-d–‘ed': 
__objeù_sigÇl__
,

46 'sk-¡©us-chªged': 
__objeù_¡ršg_sigÇl__
,

47 
	}
}

49 ############## 
š™
 #####################################################
 __š™__(£lf,„eq):

50 
	gGObjeù
.GObjeù.
	$__š™__
(
£lf
)

51 
£lf
.
»q
 =„eq

52 
£lf
.
cÚfig_obj
 = s–f.
»q
.
	$g‘_glob®_cÚfig
()

53 
£lf
.
brow£r_cÚfig
 = s–f.
cÚfig_obj
.
	`g‘_subcÚfig
("browser")

54 
£lf
.
¶ugšs_cÚfig
 = s–f.
cÚfig_obj
.
	`g‘_subcÚfig
("plugins")

55 
£lf
.
sk_cÚfig
 = s–f.
cÚfig_obj
.
	$g‘_skcÚfig
()

58 
£lf
.
İ’ed_sk
 = {
	}
} #Thi 
is
 
the
 
li¡
 
of
 
sks
 
th©
 
¬e
 
®»ady


59 #İ’ed 
š
 
ª
 
ed™Ü
 
of
 
cour£
 
™
'sƒmpty

60 #righˆ
now


62 
£lf
.
brow£r
 = 
NÚe


63 
£lf
.
__¡¬t_brow£r_hidd’
 = 
F®£


64 
£lf
.
gtk_‹rmš©e
 = 
F®£
 #ià
Œue
, 
the
 
gtk
 
maš
 
is
 
nÙ
 
	g¡¬‹d


66 #ià
Œue
, 
şosšg
 
the
 
Ï¡
 
wšdow
 
dÛ¢
't quit GTG

67 #(
GTG
 
lives
 
somewh”e
 
w™hout
 
GUI
, 
e
.
g
. 
nÙifiÿtiÚ
 
¬—
)

68 
	g£lf
.
	gd«mÚ_mode
 = 
F®£


70 #Sh¬ed 
şbßrd


71 
£lf
.
şbßrd
 = clbßrd.
	$TaskClbßrd
(
£lf
.
»q
)

73 #Brow£¸(
¡l
 
hidd’
)

74 
£lf
.
brow£r
 = 
	$TaskBrow£r
(
£lf
.
»q
, self)

76 
£lf
.
	$__š™_¶ugš_’gše
()

78 
nÙ
 
£lf
.
__¡¬t_brow£r_hidd’
:

79 
£lf
.
	$show_brow£r
()

81 #D–‘iÚ 
UI


82 
£lf
.
d–‘e_dŸlog
 = 
NÚe


84 #P»ã»nû 
ªd
 
Back’ds
 
wšdows


85 #In™Ÿliz
dŸlogs


86 
£lf
.
´eã»nûs
 = 
	$P»ã»nûsDŸlog
(
£lf
.
»q
)

87 
£lf
.
¶ugšs
 = 
	$PlugšsDŸlog
(
£lf
.
cÚfig_obj
)

88 
£lf
.
ed™_back’ds_dŸlog
 = 
NÚe


90 #Tag 
Ed™Ü


91 
£lf
.
g_ed™Ü_dŸlog
 = 
NÚe


94 
	$DBusTaskW¿µ”
(
£lf
.
»q
, self)

95 
Log
.
	`debug
("Manager initialization finished")

97 
def
 
	$__š™_¶ugš_’gše
(
£lf
):

98 
£lf
.
³ngše
 = 
	$PlugšEngše
(
GTG
.
PLUGIN_DIR
)

99 #š™Ÿlize 
the
 
¶ugš
 
­i
 
şass


100 
£lf
.
¶ugš_­i
 = 
	$PlugšAPI
(
£lf
.
»q
, self)

101 
£lf
.
³ngše
.
	$»gi¡”_­i
(
£lf
.
¶ugš_­i
)

102 #check 
the
 
cÚf
 
u£r
 
£‰šgs


103 
Œy
:

104 
¶ugšs_’abËd
 = 
£lf
.
¶ugšs_cÚfig
.
	`g‘
("enabled")

105 
exû±
 
cÚfig·r£r
.
E¼Ü
:

106 
¶ugšs_’abËd
 = []

107 
¶ugš
 
š
 
£lf
.
³ngše
.
	$g‘_¶ugšs
():

108 
¶ugš
.
’abËd
 =…lugš.
moduË_Çme
 
š
 
¶ugšs_’abËd


109 #š™Ÿlize 
ªd
 
aùiv©es
 
—ch
 
	`¶ugš
 (
th©
 
is
 
’abËd
)

110 
£lf
.
³ngše
.
	$aùiv©e_¶ugšs
()

112 ############## 
Brow£r
 #################################################
 o³n_brow£r(£lf):

113 
nÙ
 
£lf
.
brow£r
:

114 
£lf
.
brow£r
 = 
	$TaskBrow£r
(
£lf
.
»q
, self)

115 #nÙify 
u£r
 
backup
 
was
 
u£d


116 
back’d_dic
 = 
£lf
.
»q
.
	$g‘_®l_back’ds
()

117 
back’d
 
š
 
back’d_dic
:

118 
back’d
.
	`g‘_Çme
(è=ğ"back’d_loÿlfe" 
ªd
 \

119 
back’d
.
	$u£d_backup
():

120 
back’d
.
	$nÙify_u£r_about_backup
()

121 
Log
.
	`debug
("Browser is open")

123 #FIXME : 
the
 
brow£r
 
should
 
nÙ
 
be
h
ûÁ”
 
of
h
univ”£
.

124 #IÀ
çù
, 
we
 
should
 
bud
 
a
 
sy¡em
 
wh”e
 
v›w
 
ÿn
 
them£lves


125 #a "¡ay_®ive" 
v›ws
. 
As
 
as
 
©
 
Ëa¡
 
Úe
 "¡ay_®ive" 
v›w


126 #i 
»gi¡”ed
, 
gtg
 
k“ps
 
ruÂšg
. 
It
 
qu™
 
Úly
 
wh’
 
the
 
Ï¡


127 #"
¡ay_®ive
 
v›w
" is closed (andhen unregistered).

128 #Cu¼’y, 
the
 
brow£r
 
is
 
our
 
Úly
 "¡ay_®ive" 
v›w
.

129 
def
 
	$şo£_brow£r
(
£lf
, 
£nd”
=
NÚe
):

130 
£lf
.
	$hide_brow£r
()

131 #may 
ke
 
a
 
to
 
qu™


132 
£lf
.
	$qu™
()

134 
def
 
	$hide_brow£r
(
£lf
, 
£nd”
=
NÚe
):

135 
£lf
.
brow£r
.
	$hide
()

137 
def
 
	$icÚify_brow£r
(
£lf
, 
£nd”
=
NÚe
):

138 
£lf
.
brow£r
.
	$icÚify
()

140 
def
 
	$show_brow£r
(
£lf
, 
£nd”
=
NÚe
):

141 
£lf
.
brow£r
.
	$show
()

143 
def
 
	$is_brow£r_visibË
(
£lf
, 
£nd”
=
NÚe
):

144  
£lf
.
brow£r
.
	$is_visibË
()

146 
def
 
	$g‘_brow£r
(
£lf
):

147 #u£d 
by
 
the
 
¶ugš
 
­i
 
to
 
hook
 
š
h
brow£r


148  
£lf
.
brow£r


150 
def
 
	$¡¬t_brow£r_hidd’
(
£lf
):

151 
£lf
.
__¡¬t_brow£r_hidd’
 = 
True


153 
def
 
	$£t_d«mÚ_mode
(
£lf
, 
š_d«mÚ_mode
):

155 
Ï¡
 
şo£d
 
wšdow
 
qu™s
 
GTG
 """

156 
£lf
.
d«mÚ_mode
 = 
š_d«mÚ_mode


158 #################Task 
Ed™Ü
 ############################################

159 
def
 
	$g‘_İ’ed_ed™Üs
(
£lf
):

161 
R‘uºs
 
a
 
diù
 
of
 
sk_uid
 -> 
TaskEd™Ü
, 
Úe
 
—ch
 
İ’ed
 
ed™Ü


162 
wšdow


164  
£lf
.
İ’ed_sk


166 
def
 
	$İ’_sk
(
£lf
, 
uid
, 
thisi¢ew
=
F®£
):

169 
If
 
a
 
Task
 
ed™Ü
 
is
 
®»ady
 
İ’ed
 ¨
giv’
 
sk
, 
we
 
´e£Á
 
™
.

170 
El£
, 
we
 
ü—‹
 
a
 
Ãw
 
Úe
.

172 
t
 = 
£lf
.
»q
.
	$g‘_sk
(
uid
)

173 
tv
 = 
NÚe


174 
uid
 
š
 
£lf
.
İ’ed_sk
:

175 
tv
 = 
£lf
.
İ’ed_sk
[
uid
]

176 
tv
.
	$´e£Á
()

177 
–if
 
t
:

178 
tv
 = 
	$TaskEd™Ü
(

179 
»que¡”
=
£lf
.
»q
,

180 
vmªag”
=
£lf
,

181 
sk
=
t
,

182 
skcÚfig
=
£lf
.
sk_cÚfig
,

183 
thisi¢ew
=thisisnew,

184 
şbßrd
=
£lf
.clipboard)

185 
tv
.
	$´e£Á
()

186 #»gi¡”šg 
as
 
İ’ed


187 
£lf
.
İ’ed_sk
[
uid
] = 
tv


188 #§v
th©
 
we
 
İ’ed
 
this
 
sk


189 
İ’ed_sks
 = 
£lf
.
brow£r_cÚfig
.
	`g‘
("opened_tasks")

190 
uid
 
nÙ
 
š
 
İ’ed_sks
:

191 
İ’ed_sks
.
	$­³nd
(
uid
)

192 
£lf
.
brow£r_cÚfig
.
	`£t
("İ’ed_sks", 
İ’ed_sks
)

193  
tv


195 
def
 
	$şo£_sk
(
£lf
, 
tid
):

196 #Wh’ 
ª
 
ed™Ü
 
is
 
şo£d
, 
™
 
should
 
de
-
™£lf
.

197 
tid
 
š
 
£lf
.
İ’ed_sk
:

198 #th
fŞlowšg
 
lše
 
has
 
the
 
side
 
efãù
 
of
 
»movšg
he

199 #tid 
key
 
š
 
the
 
İ’ed_sk
 
diùiÚ¬y
.

200 
ed™Ü
 = 
£lf
.
İ’ed_sk
[
tid
]

201 
ed™Ü
:

202 
d–
 
£lf
.
İ’ed_sk
[
tid
]

203 #w
have
 
to
 
»move
 
the
 
tid
 
äom
 
İ’ed_sk
 
fœ¡


204 #–£, 
™
 
şo£_sk
 
would
 
be
 
ÿÎed
 
Úû
 
agaš


205 #by 
ed™Ü
.
şo£


206 
ed™Ü
.
	$şo£
()

207 
İ’ed_sks
 = 
£lf
.
brow£r_cÚfig
.
	`g‘
("opened_tasks")

208 
tid
 
š
 
İ’ed_sks
:

209 
İ’ed_sks
.
	$»move
(
tid
)

210 
£lf
.
brow£r_cÚfig
.
	`£t
("İ’ed_sks", 
İ’ed_sks
)

211 
£lf
.
	$check_qu™_cÚd™iÚ
()

213 
def
 
	$check_qu™_cÚd™iÚ
(
£lf
):

215 
checkšg
 
we
 
Ãed
 
to
 
shut
 
down
 
the
 
whŞe
 
	`GTG
 (
no
 
wšdow
 
is
 
İ’
)

217 
nÙ
 
£lf
.
d«mÚ_mode
 
ªd
‚Ù s–f.
	$is_brow£r_visibË
(è
ªd
 \

218 
nÙ
 
£lf
.
İ’ed_sk
:

219 #nØ
Ãed
 
to
 
live
"

220 
£lf
.
	$qu™
()

222 ################ 
Oth”s
 
dŸlog
 ############################################

223 
def
 
	$İ’_ed™_back’ds
(
£lf
, 
£nd”
=
NÚe
, 
back’d_id
=None):

224 
nÙ
 
£lf
.
ed™_back’ds_dŸlog
:

225 
£lf
.
ed™_back’ds_dŸlog
 = 
	$Back’dsDŸlog
(
£lf
.
»q
)

226 
£lf
.
ed™_back’ds_dŸlog
.
	$aùiv©e
()

227 
back’d_id
 
is
 
nÙ
 
NÚe
:

228 
£lf
.
ed™_back’ds_dŸlog
.
	$show_cÚfig_fÜ_back’d
(
back’d_id
)

230 
def
 
	$cÚfigu»_back’d
(
£lf
, 
back’d_id
):

231 
£lf
.
	$İ’_ed™_back’ds
(
NÚe
, 
back’d_id
)

233 
def
 
	$İ’_´eã»nûs
(
£lf
, 
cÚfig_´iv
):

234 
£lf
.
´eã»nûs
.
	$aùiv©e
()

236 
def
 
	$cÚfigu»_¶ugšs
(
£lf
):

237 
£lf
.
¶ugšs
.
	$aùiv©e
()

239 
def
 
	$ask_d–‘e_sks
(
£lf
, 
tids
):

240 
nÙ
 
£lf
.
d–‘e_dŸlog
:

241 
£lf
.
d–‘e_dŸlog
 = 
	$D–‘iÚUI
(
£lf
.
»q
)

242 
fš®li¡
 = 
£lf
.
d–‘e_dŸlog
.
	$d–‘e_sks
(
tids
)

243 
t
 
š
 
fš®li¡
:

244 
t
.
	$g‘_id
(è
š
 
£lf
.
İ’ed_sk
:

245 
£lf
.
	`şo£_sk
(
t
.
	$g‘_id
())

246 
GObjeù
.
	`idË_add
(
£lf
.
em™
, "sks-d–‘ed", 
fš®li¡
)

247  
fš®li¡


249 
def
 
	$İ’_g_ed™Ü
(
£lf
, 
g
):

250 
nÙ
 
£lf
.
g_ed™Ü_dŸlog
:

251 
£lf
.
g_ed™Ü_dŸlog
 = 
	$TagEd™Ü
(
£lf
.
»q
, s–f, 
g
)

253 
£lf
.
g_ed™Ü_dŸlog
.
	$£t_g
(
g
)

254 
£lf
.
g_ed™Ü_dŸlog
.
	$show
()

255 
£lf
.
g_ed™Ü_dŸlog
.
	$´e£Á
()

257 
def
 
	$şo£_g_ed™Ü
(
£lf
):

258 
£lf
.
g_ed™Ü_dŸlog
.
	$hide
()

260 ###STATUS ###################################################################
‡sk_£t_sk_¡©us(£lf,ask,‚ew_¡©us):

262 
BÙh
 
brow£r
 
ªd
 
ed™Ü
 
have
 
to
 
u£
 
this
 
ûÁ¿l
 
m‘hod
Ø
£t


263 
sk
 
¡©us
. 
It
 
®so
 
em™s
 
a
 
sigÇl
 
w™h
 
the
ask 
š¡ªû
 
as
 
fœ¡


264 
ªd
 
the
 
Ãw
 
¡©us
 
as
 
£cÚd
 
·¿m‘”


266 
sk
.
	$£t_¡©us
(
Ãw_¡©us
)

267 
GObjeù
.
	`idË_add
(
£lf
.
em™
, "sk-¡©us-chªged", 
sk
, 
Ãw_¡©us
)

269 ###URIS ###################################################################
 o³n_uri_li¡(£lf, unu£d, uri_li¡):

271 
O³n
 
the
 
Ed™Ü
 
wšdows
 
of
h
sks
 
assocŸ‹d
 
w™h
h
uris
 
giv’
.

272 
Uris
 
¬e
 
of
 
the
 
fÜm
 
gtg
:

274 
uri
 
š
 
uri_li¡
:

275 
uri
.
	`¡¬tsw™h
("gtg://"):

276 
£lf
.
	`İ’_sk
(
uri
[6:])

277 #ià
no
 
wšdow
 
was
 
İ’ed
, 
we
 
ju¡
 
qu™


278 
£lf
.
	$check_qu™_cÚd™iÚ
()

280 ###MAIN ###################################################################
 maš(£lf, onû_thru=F®£, uri_li¡=[]):

281 
uri_li¡
:

282 #befÜ
İ’šg
 
the
 
»que¡ed
 
sks
, 
we
 
make
 
su»
 
th©
 
®l
 
of
 
them


283 #¬
lßded
.

284 
	`Back’dSigÇls
().
	`cÚÃù
('default-backend-loaded',

285 
£lf
.
İ’_uri_li¡
,

286 
uri_li¡
)

288 
£lf
.
	$İ’_brow£r
()

289 
GObjeù
.
	$th»ads_š™
()

290 
nÙ
 
£lf
.
gtk_‹rmš©e
:

291 
Úû_thru
:

292 
Gtk
.
	$maš_™”©iÚ
()

294 
Gtk
.
	$maš
()

297 
def
 
	$qu™
(
£lf
, 
£nd”
=
NÚe
):

298 
Gtk
.
	$maš_qu™
()

299 #§v
İ’ed
 
sks
 
ªd
 
theœ
 
pos™iÚs
.

300 
İ’_sk
 = []

301 
Ùid
 
š
 
	`li¡
(
£lf
.
İ’ed_sk
.
	$keys
()):

302 
İ’_sk
.
	$­³nd
(
Ùid
)

303 
£lf
.
İ’ed_sk
[
Ùid
].
	$şo£
()

304 
£lf
.
brow£r_cÚfig
.
	`£t
("İ’ed_sks", 
İ’_sk
)

306 #add 
the
 
¶ugš
 
£‰šgs
 
to
h
cÚf


307 #FIXME: 
this
 
code
 
is
 
»¶iÿ‹d
 
š
 
the
 
´eã»nû
 
wšdow
.

308 
	`Ën
(
£lf
.
³ngše
.
¶ugšs
) > 0:

309 
£lf
.
¶ugšs_cÚfig
.
	$ş—r
()

310 
£lf
.
¶ugšs_cÚfig
.
	`£t
(

312 [
p
.
moduË_Çme
 °
š
 
£lf
.
³ngše
.
	`g‘_¶ugšs
("disabled")],

314 
£lf
.
¶ugšs_cÚfig
.
	`£t
(

316 [
p
.
moduË_Çme
 °
š
 
£lf
.
³ngše
.
	`g‘_¶ugšs
("enabled")],

318 #¶ugš 
¬e
 
d—ùiv©ed


319 
£lf
.
³ngše
.
	`d—ùiv©e_¶ugšs
()

	@gtk/plugins.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

19 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
	gGtk
, 
Pªgo


21 
äom
 
GTG
 
impÜt
 
_


22 
äom
 
GTG
 
impÜt
 
šfo


23 
äom
 
	gGTG
.
	gcÜe
.
¶ugšs
 
impÜt
 
GnomeCÚfig


24 
äom
 
	gGTG
.
	gcÜe
.
	g¶ugšs
.
’gše
 
impÜt
 
PlugšEngše


25 
äom
 
	gGTG
.
gtk
 
impÜt
 
V›wCÚfig


26 
äom
 
	gGTG
.
gtk
 
impÜt
 
	gh–p


28 #cŞumn 
š
 
PlugšsDŸlog
.
¶ugš_¡Üe


29 
	gPLUGINS_COL_ID
 = 0

30 
PLUGINS_COL_ENABLED
 = 1

31 
PLUGINS_COL_NAME
 = 2

32 
PLUGINS_COL_SHORT_DESC
 = 3

33 
PLUGINS_COL_ACTIVATABLE
 = 4

36 
def
 
	$¶ugš_icÚ
(
cŞumn
, 
ûÎ
, 
¡Üe
, 
™”©Ü
, 
d©a
):

39 
S“
 
PlugšsDŸlog
.
	`_š™_¶ugš_Œ“
().

41 
ûÎ
.
	`£t_´İ”ty
('icon-name', 'gtg-plugin')

42 
ûÎ
.
	`£t_´İ”ty
('sensitive',

43 
¡Üe
.
	$g‘_v®ue
(
™”©Ü
, 
PLUGINS_COL_ACTIVATABLE
))

46 
def
 
	$¶ugš_”rÜ_shÜt_‹xt
(
¶ugš
):

48 
di¥Ïyšg
 
š
 
¶ugš
 
m¬kup
 """

49 
nÙ
 
¶ugš
.
”rÜ
:

52 #g‘ 
li¡s


53 
moduËs
 = 
¶ugš
.
missšg_moduËs


54 
dbus
 = 
¶ugš
.
missšg_dbus


56 #cÚv”ˆ
to
 
¡ršgs


57 
moduËs
:

58 
moduËs
 = "<sm®l><b>%s</b></sm®l>" % ', '.
	$još
(
moduËs
)

59 
dbus
:

60 
içûs
 = ["%s:%s" % (
a
, 
b
èa, bè
š
 
dbus
]

61 
dbus
 = "<sm®l><b>%s</b></sm®l>" % ', '.
	$još
(
içûs
)

64 
moduËs
 
ªd
 
nÙ
 
dbus
:

65 
‹xt
 = '\n'.
	`još
((
GnomeCÚfig
.
miss2
, 
moduËs
))

66 
–if
 
dbus
 
ªd
 
nÙ
 
moduËs
:

67 
‹xt
 = '\n'.
	`još
((
GnomeCÚfig
.
dmiss2
, 
dbus
))

68 
–if
 
moduËs
 
ªd
 
dbus
:

69 
‹xt
 = '\n'.
	`još
((
GnomeCÚfig
.
bmiss2
, 
moduËs
, 
dbus
))

71 
‹xt
 = ""

73  
‹xt


76 
def
 
	$¶ugš_”rÜ_‹xt
(
¶ugš
):

78 
nÙ
 
¶ugš
.
”rÜ
:

79  
GnomeCÚfig
.
CANLOAD


81 #desüib
missšg
 
d•’d’c›s


82 
‹xt
 = "<b>%s</b>. \n" % 
GnomeCÚfig
.
CANNOTLOAD


83 #g‘ 
li¡s


84 
moduËs
 = 
¶ugš
.
missšg_moduËs


85 
dbus
 = 
¶ugš
.
missšg_dbus


87 #cÚv”ˆ
to
 
¡ršgs


88 
moduËs
:

89 
moduËs
 = "<sm®l><b>%s</b></sm®l>" % ', '.
	$još
(
moduËs
)

90 
dbus
:

91 
içûs
 = ["%s:%s" % (
a
, 
b
èa, bè
š
 
dbus
]

92 
dbus
 = "<sm®l><b>%s</b></sm®l>" % ', '.
	$još
(
içûs
)

95 
moduËs
 
ªd
 
nÙ
 
dbus
:

96 
‹xt
 +ğ'\n'.
	`još
((
GnomeCÚfig
.
MODULEMISSING
, 
moduËs
))

97 
–if
 
dbus
 
ªd
 
nÙ
 
moduËs
:

98 
‹xt
 +ğ'\n'.
	`još
((
GnomeCÚfig
.
DBUSMISSING
, 
dbus
))

99 
–if
 
moduËs
 
ªd
 
dbus
:

100 
‹xt
 +ğ'\n'.
	`još
((
GnomeCÚfig
.
MODULANDDBUS
, 
moduËs
, 
dbus
))

102 
‹xt
 +ğ
GnomeCÚfig
.
UNKNOWN


104  
‹xt


107 
def
 
	$¶ugš_m¬kup
(
cŞumn
, 
ûÎ
, 
¡Üe
, 
™”©Ü
, 
£lf
):

111 
S“
 
PlugšsDŸlog
.
	`_š™_¶ugš_Œ“
().

113 
Çme
 = 
¡Üe
.
	$g‘_v®ue
(
™”©Ü
, 
PLUGINS_COL_NAME
)

114 
desc
 = 
¡Üe
.
	$g‘_v®ue
(
™”©Ü
, 
PLUGINS_COL_SHORT_DESC
)

116 
¶ugš_id
 = 
¡Üe
.
	$g‘_v®ue
(
™”©Ü
, 
PLUGINS_COL_ID
)

117 
¶ugš
 = 
£lf
.
³ngše
.
	$g‘_¶ugš
(
¶ugš_id
)

118 
”rÜ_‹xt
 = 
	$¶ugš_”rÜ_shÜt_‹xt
(
¶ugš
)

119 
”rÜ_‹xt
 != "":

120 
‹xt
 = "<b>%s</b>\n%s\n<i>%s</i>" % (
Çme
, 
desc
, 
”rÜ_‹xt
)

122 
‹xt
 = "<b>%s</b>\n%s" % (
Çme
, 
desc
)

124 
ûÎ
.
	`£t_´İ”ty
('m¬kup', 
‹xt
)

125 
ûÎ
.
	`£t_´İ”ty
('sensitive',

126 
¡Üe
.
	$g‘_v®ue
(
™”©Ü
, 
PLUGINS_COL_ACTIVATABLE
))

129 
şass
 
PlugšsDŸlog
:

132 
def
 
	$__š™__
(
£lf
, 
cÚfig_obj
):

133 
£lf
.
cÚfig_obj
 = config_obj

134 
£lf
.
cÚfig
 = s–f.
cÚfig_obj
.
	`g‘_subcÚfig
("plugins")

135 
bud”
 = 
Gtk
.
	$Bud”
()

136 
bud”
.
	$add_äom_fe
(
V›wCÚfig
.
PLUGINS_UI_FILE
)

138 
£lf
.
dŸlog
 = 
bud”
.
	`g‘_objeù
("PluginsDialog")

139 
£lf
.
dŸlog
.
	`£t_t™Ë
(
	`_
("Plugš - %s" % 
šfo
.
NAME
))

140 
£lf
.
¶ugš_Œ“
 = 
bud”
.
	`g‘_objeù
("PluginTree")

141 
£lf
.
¶ugš_cÚfigu»
 = 
bud”
.
	`g‘_objeù
("plugin_configure")

142 
£lf
.
¶ugš_about
 = 
bud”
.
	`g‘_objeù
("PluginAboutDialog")

143 
£lf
.
¶ugš_d•’ds
 = 
bud”
.
	`g‘_objeù
('PluginDepends')

145 
h–p
.
	`add_h–p_shÜtcut
(
£lf
.
dŸlog
, "plugins")

147 
£lf
.
³ngše
 = 
	$PlugšEngše
()

148 #¶ugš 
cÚfig
 
š™ŸtiÚ


149 
£lf
.
³ngše
.
	$g‘_¶ugšs
():

150 
£lf
.
cÚfig
.
	`£t
(

152 [
p
.
moduË_Çme
 °
š
 
£lf
.
³ngše
.
	`g‘_¶ugšs
("disabled")],

154 
£lf
.
cÚfig
.
	`£t
(

156 [
p
.
moduË_Çme
 °
š
 
£lf
.
³ngše
.
	`g‘_¶ugšs
("enabled")],

159 #£
cÚ¡ªts
 
PLUGINS_COL_
* 
cŞumn
 
m—nšgs


160 
£lf
.
¶ugš_¡Üe
 = 
Gtk
.
	$Li¡StÜe
(
¡r
, 
boŞ
, str, str, bool)

162 
bud”
.
	`cÚÃù_sigÇls
({

164 
£lf
.
Ú_h–p
,

166 
£lf
.
Ú_şo£
,

168 
£lf
.
Ú_şo£
,

170 
£lf
.
Ú_¶ugš_£Ëù
,

172 
£lf
.
Ú_¶ugš_about
,

174 
£lf
.
Ú_¶ugš_cÚfigu»
,

176 
£lf
.
Ú_¶ugš_about_şo£
,

177 
	}
})

179 
def
 
	$_š™_¶ugš_Œ“
(
£lf
):

182 
The
 
fÜm©
 
is
 
mod–Ëd
 
aá”
 
the
 
Úe
 
u£d
 
š
 
ged™
; 
£e


183 
h‰p
:

185 #fÜû 
ü—tiÚ
 
of
 
the
 
Gtk
.
Li¡StÜe
 
so
 
we
 
ÿn
 
»ã»nû
 
™


186 
£lf
.
	$_»äesh_¶ugš_¡Üe
()

188 #»nd”” 
the
 
toggË
 
cŞumn


189 
»nd””
 = 
Gtk
.
	$C–lR’d””ToggË
()

190 
»nd””
.
	`£t_´İ”ty
('xpad', 6)

191 
»nd””
.
	`cÚÃù
('toggËd', 
£lf
.
Ú_¶ugš_toggË
)

192 #toggË 
cŞumn


193 
cŞumn
 = 
Gtk
.
	$T»eV›wCŞumn
(
NÚe
, 
»nd””
, 
aùive
=
PLUGINS_COL_ENABLED
,

194 
aùiv©abË
=
PLUGINS_COL_ACTIVATABLE
,

195 
£ns™ive
=
PLUGINS_COL_ACTIVATABLE
)

196 
£lf
.
¶ugš_Œ“
.
	$­³nd_cŞumn
(
cŞumn
)

198 #¶ugš 
Çme
 
cŞumn


199 
cŞumn
 = 
Gtk
.
	$T»eV›wCŞumn
()

200 
cŞumn
.
	$£t_¥acšg
(6)

201 #icÚ 
»nd””
 
the
 
¶ugš
 
Çme
 
cŞumn


202 
icÚ_»nd””
 = 
Gtk
.
	$C–lR’d””Pixbuf
()

203 
icÚ_»nd””
.
	`£t_´İ”ty
('¡ock-size', 
Gtk
.
IcÚSize
.
SMALL_TOOLBAR
)

204 
icÚ_»nd””
.
	`£t_´İ”ty
('xpad', 3)

205 
cŞumn
.
	$·ck_¡¬t
(
icÚ_»nd””
, 
F®£
)

206 
cŞumn
.
	$£t_ûÎ_d©a_func
(
icÚ_»nd””
, 
¶ugš_icÚ
)

207 #‹xˆ
»nd””
 
the
 
¶ugš
 
Çme
 
cŞumn


208 
Çme_»nd””
 = 
Gtk
.
	$C–lR’d””Text
()

209 
Çme_»nd””
.
	`£t_´İ”ty
('–lsize', 
Pªgo
.
EÎsizeMode
.
END
)

210 
cŞumn
.
	$·ck_¡¬t
(
Çme_»nd””
, 
True
)

211 
cŞumn
.
	$£t_ûÎ_d©a_func
(
Çme_»nd””
, 
¶ugš_m¬kup
, 
£lf
)

213 
£lf
.
¶ugš_Œ“
.
	$­³nd_cŞumn
(
cŞumn
)

215 #fšish 
£tup


216 
£lf
.
¶ugš_Œ“
.
	$£t_mod–
(
£lf
.
¶ugš_¡Üe
)

217 
£lf
.
¶ugš_Œ“
.
	$£t_£¬ch_cŞumn
(2)

219 
def
 
	$_»äesh_¶ugš_¡Üe
(
£lf
):

221 
£lf
.
¶ugš_¡Üe
.
	$ş—r
()

222 
£lf
.
³ngše
.
	$»check_¶ugš_”rÜs
(
True
)

223 
Çme
, 
¶ugš
 
š
 
£lf
.
³ngše
.
¶ugšs
.
	$™ems
():

224 #aùiv©—bË 
th”e
 
is
 
no
 
”rÜ


225 
£lf
.
¶ugš_¡Üe
.
	`­³nd
((
Çme
, 
¶ugš
.
’abËd
,…lugš.
fuÎ_Çme
,

226 
¶ugš
.
shÜt_desütiÚ
,

227 
nÙ
 
¶ugš
.
”rÜ
))

229 
def
 
	$aùiv©e
(
£lf
):

231 
	`Ën
(
£lf
.
¶ugš_Œ“
.
	`g‘_cŞumns
()) == 0:

232 
£lf
.
	$_š™_¶ugš_Œ“
()

234 
£lf
.
	$_»äesh_¶ugš_¡Üe
()

235 
£lf
.
dŸlog
.
	$show_®l
()

237 
def
 
	$Ú_şo£
(
£lf
, 
widg‘
, 
d©a
=
NÚe
):

239 
£lf
.
dŸlog
.
	$hide
()

240  
True


242 @
şassm‘hod


243 
def
 
	$Ú_h–p
(
şs
, 
widg‘
):

245 
h–p
.
	`show_h–p
("plugins")

246  
True


248 
def
 
	$Ú_¶ugš_toggË
(
£lf
, 
widg‘
, 
·th
):

250 
™”©Ü
 = 
£lf
.
¶ugš_¡Üe
.
	$g‘_™”
(
·th
)

251 
¶ugš_id
 = 
£lf
.
¶ugš_¡Üe
.
	$g‘_v®ue
(
™”©Ü
, 
PLUGINS_COL_ID
)

252 
¶ugš
 = 
£lf
.
³ngše
.
	$g‘_¶ugš
(
¶ugš_id
)

253 
¶ugš
.
’abËd
 = 
nÙ
 
£lf
.
¶ugš_¡Üe
.
	$g‘_v®ue
(
™”©Ü
,

254 
PLUGINS_COL_ENABLED
)

255 
¶ugšs_’abËd
 = 
£lf
.
cÚfig
.
	`g‘
("enabled")

256 
¶ugšs_di§bËd
 = 
£lf
.
cÚfig
.
	`g‘
("disabled")

257 
¶ugš
.
’abËd
:

258 
£lf
.
³ngše
.
	$aùiv©e_¶ugšs
([
¶ugš
])

259 
¶ugšs_’abËd
.
	$­³nd
(
¶ugš
.
moduË_Çme
)

260 
¶ugš
.
moduË_Çme
 
š
 
¶ugšs_di§bËd
:

261 
¶ugšs_di§bËd
.
	$»move
(
¶ugš
.
moduË_Çme
)

263 
£lf
.
³ngše
.
	$d—ùiv©e_¶ugšs
([
¶ugš
])

264 
¶ugšs_di§bËd
.
	$­³nd
(
¶ugš
.
moduË_Çme
)

265 
¶ugš
.
moduË_Çme
 
š
 
¶ugšs_’abËd
:

266 
¶ugšs_’abËd
.
	$»move
(
¶ugš
.
moduË_Çme
)

267 
£lf
.
cÚfig
.
	`£t
("’abËd", 
¶ugšs_’abËd
)

268 
£lf
.
cÚfig
.
	`£t
("di§bËd", 
¶ugšs_di§bËd
)

269 
£lf
.
¶ugš_¡Üe
.
	$£t_v®ue
(
™”©Ü
, 
PLUGINS_COL_ENABLED
,

270 
¶ugš
.
’abËd
)

271 
£lf
.
	$_upd©e_¶ugš_cÚfigu»
(
¶ugš
)

273 
£lf
.
cÚfig_obj
.
	$§ve
()

275 
def
 
	$Ú_¶ugš_£Ëù
(
£lf
, 
¶ugš_Œ“
):

278 
Upd©e
 
the
 
bu‰Ú
 "CÚfigu»…lugš" 
£ns™iv™y
 """

279 
mod–
, 
™”©Ü
 = 
¶ugš_Œ“
.
	`g‘_£ËùiÚ
().
	$g‘_£Ëùed
()

280 
™”©Ü
 
is
 
nÙ
 
NÚe
:

281 
¶ugš_id
 = 
mod–
.
	$g‘_v®ue
(
™”©Ü
, 
PLUGINS_COL_ID
)

282 
¶ugš
 = 
£lf
.
³ngše
.
	$g‘_¶ugš
(
¶ugš_id
)

283 
£lf
.
	$_upd©e_¶ugš_cÚfigu»
(
¶ugš
)

285 
def
 
	$_upd©e_¶ugš_cÚfigu»
(
£lf
, 
¶ugš
):

286 """ EÇbËhbu‰Ú "
CÚfigu»
 
Plugš
"‡ppropriate. """

287 
cÚfigu¿bË
 = 
¶ugš
.
aùive
 
ªd
…lugš.
	$is_cÚfigu¿bË
()

288 
£lf
.
¶ugš_cÚfigu»
.
	`£t_´İ”ty
('£ns™ive', 
cÚfigu¿bË
)

290 
def
 
	$Ú_¶ugš_cÚfigu»
(
£lf
, 
widg‘
):

292 
_
, 
™”©Ü
 = 
£lf
.
¶ugš_Œ“
.
	`g‘_£ËùiÚ
().
	$g‘_£Ëùed
()

293 
™”©Ü
 
is
 
NÚe
:

295 
¶ugš_id
 = 
£lf
.
¶ugš_¡Üe
.
	$g‘_v®ue
(
™”©Ü
, 
PLUGINS_COL_ID
)

296 
¶ugš
 = 
£lf
.
³ngše
.
	$g‘_¶ugš
(
¶ugš_id
)

297 
¶ugš
.
š¡ªû
.
	$cÚfigu»_dŸlog
(
£lf
.
dŸlog
)

299 
def
 
	$Ú_¶ugš_about
(
£lf
, 
widg‘
):

301 
_
, 
™”©Ü
 = 
£lf
.
¶ugš_Œ“
.
	`g‘_£ËùiÚ
().
	$g‘_£Ëùed
()

302 
™”©Ü
 
is
 
NÚe
:

304 
¶ugš_id
 = 
£lf
.
¶ugš_¡Üe
.
	$g‘_v®ue
(
™”©Ü
, 
PLUGINS_COL_ID
)

305 
¶ugš
 = 
£lf
.
³ngše
.
	$g‘_¶ugš
(
¶ugš_id
)

307 #FIXME 
About
 
¶ugš
 
dŸlog
 
looks
 
much
 
mÜe
 
difã»Á
 
thª


308 #™ 
is
 
š
 
the
 
cu¼’t
 
Œunk


309 #FIXME 
»·œ
 
™
!

310 #FIXME 
AuthÜ
 
is
 
nÙ
 
usu®ly
 
£t
 
ªd
 i 
´e£rved
 
äom


311 #´eviou 
¶ugš
... :/

312 
£lf
.
¶ugš_about
.
	$£t_´og¿m_Çme
(
¶ugš
.
fuÎ_Çme
)

313 
£lf
.
¶ugš_about
.
	$£t_v”siÚ
(
¶ugš
.
v”siÚ
)

314 
authÜs
 = 
¶ugš
.authors

315 
	$isš¡ªû
(
authÜs
, 
¡r
):

316 
authÜs
 = "\n".
	`još
(
authÜ
.
	$¡r
()

317 
authÜ
 
š
 
authÜs
.
	`¥l™
(','))

318 
authÜs
 = [authors, ]

319 
£lf
.
¶ugš_about
.
	$£t_authÜs
(
authÜs
)

320 
desütiÚ
 = 
¶ugš
.desütiÚ.
	`»¶aû
(
r
'\n', "\n")

321 
£lf
.
¶ugš_about
.
	$£t_comm’ts
(
desütiÚ
)

322 
£lf
.
¶ugš_d•’ds
.
	`£t_Ïb–
(
	$¶ugš_”rÜ_‹xt
(
¶ugš
))

323 
£lf
.
¶ugš_about
.
	$show_®l
()

325 
def
 
	$Ú_¶ugš_about_şo£
(
£lf
, 
widg‘
, 
d©a
=
NÚe
):

328 
£lf
.
¶ugš_about
.
	$hide
()

329  
True


	@gtk/preferences.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

19 
impÜt
 
os


20 
impÜt
 
shut


22 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


23 
äom
 
	gxdg
.
Ba£DœeùÜy
 
impÜt
 
xdg_cÚfig_home


25 
impÜt
 
	gGTG
.
	gtoŞs
.
shÜtcut
 
as
 shortcut

26 
äom
 
GTG
 
impÜt
 
_


27 
äom
 
GTG
 
impÜt
 
šfo


28 
äom
 
	gGTG
.
gtk
 
impÜt
 
V›wCÚfig


29 
äom
 
	gGTG
.
gtk
 
impÜt
 
h–p


31 
	gAUTOSTART_DIRECTORY
 = 
os
.
·th
.
još
(
xdg_cÚfig_home
, "autostart")

32 
	gAUTOSTART_FILE
 = "gtg.desktop"

33 
AUTOSTART_PATH
 = 
os
.
·th
.
	$još
(
AUTOSTART_DIRECTORY
, 
AUTOSTART_FILE
)

36 
def
 
	$’abË_gtg_auto¡¬t
():

39 
Fœ¡ly
, 
loÿ‹
 
gtg
.
desktİ
 
fe
. 
Th’
 
lšk
 
™
 
š
 
AUTOSTART_FILE
.

40 
On
 
Wšdows
, 
th”e
 
is
 
no
 
os
.
symlšk
, 
ju¡
 
cİy
 
the
 
fe
. """

41 
desktİ_fe_·th
 = 
NÚe


42 
this_dœeùÜy
 = 
os
.
·th
.
	`dœÇme
(os.·th.
	$ab¥©h
(
__fe__
))

43 
·th
 
š
 ["../..", "../../../applications",

45 
fuÎ·th
 = 
os
.
·th
.
	$još
(
this_dœeùÜy
, 
·th
, 
AUTOSTART_FILE
)

46 
fuÎ·th
 = 
os
.
·th
.
	$nÜm·th
(
fuÎ·th
)

47 
os
.
·th
.
	$isfe
(
fuÎ·th
):

48 
desktİ_fe_·th
 = 
fuÎ·th


51 
desktİ_fe_·th
:

52 
nÙ
 
os
.
·th
.
	$exi¡s
(
AUTOSTART_DIRECTORY
):

53 
os
.
	$mkdœ
(
AUTOSTART_DIRECTORY
)

55 #Ià
the
 
·th
 
is
 
a
 
symlšk
 
ªd
 i 
brok’
, 
»move
 
™


56 
os
.
·th
.
	$i¦šk
(
AUTOSTART_PATH
è
ªd
 \

57 
nÙ
 
os
.
·th
.
	`exi¡s
(os.·th.
	$»®·th
(
AUTOSTART_PATH
)):

58 
os
.
	$uÆšk
(
AUTOSTART_PATH
)

60 
os
.
·th
.
	$isdœ
(
AUTOSTART_DIRECTORY
è
ªd
 \

61 
nÙ
 
os
.
·th
.
	$exi¡s
(
AUTOSTART_PATH
):

62 
	`ha§‰r
(
os
, "symlink"):

63 
os
.
	$symlšk
(
desktİ_fe_·th
, 
AUTOSTART_PATH
)

65 
shut
.
	$cİyfe
(
desktİ_fe_·th
, 
AUTOSTART_PATH
)

68 
def
 
	$di§bË_gtg_auto¡¬t
():

70 
os
.
·th
.
	$isfe
(
AUTOSTART_PATH
):

71 
os
.
	$»move
(
AUTOSTART_PATH
)

74 
şass
 
P»ã»nûsDŸlog
:

77 
def
 
	$__š™__
(
£lf
, 
»q
):

78 
£lf
.
»q
 =„eq

79 
£lf
.
cÚfig
 = s–f.
»q
.
	`g‘_cÚfig
('browser')

80 
bud”
 = 
Gtk
.
	$Bud”
()

81 
bud”
.
	$add_äom_fe
(
V›wCÚfig
.
PREFERENCES_UI_FILE
)

83 
£lf
.
dŸlog
 = 
bud”
.
	`g‘_objeù
("PreferencesDialog")

84 
£lf
.
dŸlog
.
	`£t_t™Ë
(
	`_
("P»ã»nû - %s" % 
šfo
.
NAME
))

85 
£lf
.
´ef_auto¡¬t
 = 
bud”
.
	`g‘_objeù
("pref_autostart")

86 
£lf
.
´ef_show_´ev›w
 = 
bud”
.
	`g‘_objeù
("pref_show_preview")

87 
£lf
.
bg_cŞÜ_’abË
 = 
bud”
.
	`g‘_objeù
("bg_color_enable")

88 
£lf
.
hbox1
 = 
bud”
.
	`g‘_objeù
("hbox1")

89 
£lf
.
shÜtcut_bu‰Ú
 = 
bud”
.
	`g‘_objeù
("shortcut_button")

91 
£lf
.
shÜtcut
 = 
	$ShÜtcutWidg‘
(
bud”
)

92 
h–p
.
	`add_h–p_shÜtcut
(
£lf
.
dŸlog
, "preferences")

94 
£lf
.
fÚtbu‰Ú
 = 
bud”
.
	`g‘_objeù
("fontbutton")

95 
ed™Ü_fÚt
 = 
£lf
.
cÚfig
.
	`g‘
("font_name")

96 
ed™Ü_fÚt
 == "":

97 
fÚt
 = 
£lf
.
dŸlog
.
	`g‘_¡yË_cÚ‹xt
().
	$g‘_fÚt
(

98 
Gtk
.
S‹FÏgs
.
NORMAL
)

99 
ed™Ü_fÚt
 = 
fÚt
.
	$to_¡ršg
()

100 
£lf
.
fÚtbu‰Ú
.
	$£t_fÚt_Çme
(
ed™Ü_fÚt
)

102 
bud”
.
	`cÚÃù_sigÇls
({

104 
£lf
.
Ú_auto¡¬t_toggËd
,

106 
£lf
.
toggË_´ev›w
,

108 
£lf
.
Ú_bg_cŞÜ_toggËd
,

110 
£lf
.
Ú_h–p
,

112 
£lf
.
Ú_şo£
,

114 
£lf
.
Ú_şo£
,

116 
£lf
.
Ú_fÚt_chªge
,

118 
£lf
.
shÜtcut
.
Ú_shÜtcut_toggËd
,

119 
	}
})

121 
def
 
	$_»äesh_´eã»nûs_¡Üe
(
£lf
):

123 
has_auto¡¬t
 = 
os
.
·th
.
	$isfe
(
AUTOSTART_PATH
)

124 
£lf
.
´ef_auto¡¬t
.
	$£t_aùive
(
has_auto¡¬t
)

126 
£lf
.
shÜtcut
.
	$»äesh_acûl
()

128 
show_´ev›w
 = 
£lf
.
cÚfig
.
	`g‘
("contents_preview_enable")

129 
£lf
.
´ef_show_´ev›w
.
	$£t_aùive
(
show_´ev›w
)

131 
bg_cŞÜ
 = 
£lf
.
cÚfig
.
	`g‘
("bg_color_enable")

132 
£lf
.
bg_cŞÜ_’abË
.
	$£t_aùive
(
bg_cŞÜ
)

134 
def
 
	$_»äesh_sk_brow£r
(
£lf
):

136 
sk_Œ“
 = 
£lf
.
»q
.
	`g‘_sks_Œ“
(
»äesh
=
F®£
).
	$g‘_ba£Œ“
()

137 
sk_Œ“
.
	$»äesh_®l
()

139 
def
 
	$aùiv©e
(
£lf
):

141 
£lf
.
	$_»äesh_´eã»nûs_¡Üe
()

142 
£lf
.
dŸlog
.
	$show_®l
()

144 
def
 
	$Ú_şo£
(
£lf
, 
widg‘
, 
d©a
=
NÚe
):

146 
£lf
.
dŸlog
.
	$hide
()

147  
True


149 @
şassm‘hod


150 
def
 
	$Ú_h–p
(
şs
, 
widg‘
):

152 
h–p
.
	`show_h–p
("preferences")

153  
True


155 @
şassm‘hod


156 
def
 
	$Ú_auto¡¬t_toggËd
(
şs
, 
widg‘
):

158 
widg‘
.
	$g‘_aùive
():

159 
	$’abË_gtg_auto¡¬t
()

161 
	$di§bË_gtg_auto¡¬t
()

163 
def
 
	$toggË_´ev›w
(
£lf
, 
widg‘
):

165 
cur¡©e
 = 
£lf
.
cÚfig
.
	`g‘
("contents_preview_enable")

166 
cur¡©e
 !ğ
widg‘
.
	$g‘_aùive
():

167 
£lf
.
cÚfig
.
	`£t
("cÚ‹Ás_´ev›w_’abË", 
nÙ
 
cur¡©e
)

168 
£lf
.
	$_»äesh_sk_brow£r
()

170 
def
 
	$Ú_bg_cŞÜ_toggËd
(
£lf
, 
widg‘
):

172 
cur¡©e
 = 
£lf
.
cÚfig
.
	`g‘
("bg_color_enable")

173 
cur¡©e
 !ğ
widg‘
.
	$g‘_aùive
():

174 
£lf
.
cÚfig
.
	`£t
("bg_cŞÜ_’abË", 
nÙ
 
cur¡©e
)

175 
£lf
.
	$_»äesh_sk_brow£r
()

177 
def
 
	$Ú_fÚt_chªge
(
£lf
, 
widg‘
):

179 
£lf
.
cÚfig
.
	`£t
("fÚt_Çme", s–f.
fÚtbu‰Ú
.
	$g‘_fÚt_Çme
())

182 
şass
 
ShÜtcutWidg‘
:

185 
def
 
	$__š™__
(
£lf
, 
bud”
):

186 
£lf
.
bud”
 = builder

187 
£lf
.
dŸlog
 = 
bud”
.
	`g‘_objeù
("PreferencesDialog")

188 
£lf
.
bu‰Ú
 = 
bud”
.
	`g‘_objeù
("shortcut_button")

189 
hbox1
 = 
bud”
.
	`g‘_objeù
("hbox1")

190 
£lf
.
Ãw_sk_deçuÉ_bšdšg
 = "<Primary>F12"

191 
£lf
.
g£‰šgs_š¡®l_Ïb–_shown
 = 
F®£


193 
£lf
.
li¡¡Üe
 = 
Gtk
.
	$Li¡StÜe
(
¡r
, str)

194 
£lf
.
li¡¡Üe
.
	`­³nd
(["", ""])

195 
Œ“v›w
 = 
Gtk
.
	$T»eV›w
(
£lf
.
li¡¡Üe
)

196 
cŞumn_acûl
 = 
Gtk
.
	$T»eV›wCŞumn
()

197 
Œ“v›w
.
	$­³nd_cŞumn
(
cŞumn_acûl
)

198 
Œ“v›w
.
	$£t_h—d”s_visibË
(
F®£
)

200 
ûÎ
 = 
Gtk
.
	$C–lR’d””Acûl
()

201 
ûÎ
.
	$£t_®ignm’t
(0.0, 1.0)

202 
ûÎ
.
	`£t_fixed_size
(-1, 18)

203 
ûÎ
.
	`£t_´İ”ty
("acûl-mode", 
Gtk
.
C–lR’d””AcûlMode
.
OTHER
)

204 
ûÎ
.
	`cÚÃù
("acûl-ed™ed", 
£lf
.
_ûÎAcûlEd™
, s–f.
li¡¡Üe
)

205 
ûÎ
.
	`cÚÃù
("acûl-ş—»d", 
£lf
.
_acûl_ş—»d
, s–f.
li¡¡Üe
)

206 
£lf
.
ûÎ
 = cell

207 
cŞumn_acûl
.
	$·ck_¡¬t
(
ûÎ
, 
True
)

208 
cŞumn_acûl
.
	`add_©Œibu‹
(
ûÎ
, "text", 1)

209 
hbox1
.
	$add
(
Œ“v›w
)

211 
def
 
	$»äesh_acûl
(
£lf
):

214 
nÙ
 
shÜtcut
.
	$is_g£‰šgs_´e£Á
():

215 
£lf
.
bu‰Ú
.
	$£t_£ns™ive
(
F®£
)

216 
™”1
 = 
£lf
.
li¡¡Üe
.
	$g‘_™”_fœ¡
()

217 
£lf
.
li¡¡Üe
.
	`£t_v®ue
(
™”1
, 1, "Disabled")

218 
£lf
.
ûÎ
.
	$£t_£ns™ive
(
F®£
)

220 
nÙ
 
£lf
.
g£‰šgs_š¡®l_Ïb–_shown
:

221 
£lf
.
	$_show_g£‰šgs_š¡®l_Ïb–
()

222 
£lf
.
g£‰šgs_š¡®l_Ïb–_shown
 = 
True


225 
™”1
 = 
£lf
.
li¡¡Üe
.
	$g‘_™”_fœ¡
()

226 
£lf
.
Ãw_sk_bšdšg
 = 
shÜtcut
.
	$g‘_§ved_bšdšg
()

227 
£lf
.
bšdšg_backup
 = s–f.
Ãw_sk_bšdšg


228 
£lf
.
Ãw_sk_bšdšg
 == "":

229 #U£¸
had
 
£t
 
a
 
shÜtcut
, 
but
 
has
 
now
 
di§bËd
 
™


230 
£lf
.
bu‰Ú
.
	$£t_aùive
(
F®£
)

231 
£lf
.
li¡¡Üe
.
	`£t_v®ue
(
™”1
, 1, "Disabled")

233 
–if
 
£lf
.
Ãw_sk_bšdšg
 
is
 
NÚe
:

234 #U£¸
ha¢
't set‡ shortcutƒver

235 
£lf
.
bu‰Ú
.
	$£t_aùive
(
F®£
)

236 
£lf
.
Ãw_sk_bšdšg
 = s–f.
Ãw_sk_deçuÉ_bšdšg


237 
£lf
.
bšdšg_backup
 = s–f.
Ãw_sk_bšdšg


239 #Th”
exi¡s
 
a
 
shÜtcut


240 
£lf
.
bu‰Ú
.
	$£t_aùive
(
True
)

241 (
acûl_key
, 
acûl_mods
èğ
Gtk
.
	$acûË¿tÜ_·r£
(
£lf
.
Ãw_sk_bšdšg
)

242 
£lf
.
show_šput
 = 
Gtk
.
	$acûË¿tÜ_g‘_Ïb–
(
acûl_key
, 
acûl_mods
)

243 
£lf
.
li¡¡Üe
.
	$£t_v®ue
(
™”1
, 1, 
£lf
.
show_šput
)

245 
def
 
	$Ú_shÜtcut_toggËd
(
£lf
, 
widg‘
):

247 
widg‘
.
	$g‘_aùive
():

248 
£lf
.
Ãw_sk_bšdšg
 = s–f.
bšdšg_backup


249 
shÜtcut
.
	$§ve_Ãw_bšdšg
(
£lf
.
Ãw_sk_bšdšg
, 
True
)

250 
£lf
.
ûÎ
.
	`£t_´İ”ty
("ed™abË", 
True
)

252 
£lf
.
Ãw_sk_bšdšg
 = ""

253 
shÜtcut
.
	$§ve_Ãw_bšdšg
(
£lf
.
Ãw_sk_bšdšg
, 
True
)

254 
£lf
.
ûÎ
.
	`£t_´İ”ty
("ed™abË", 
F®£
)

256 
def
 
	$_ûÎAcûlEd™
(
£lf
, 
ûÎ
, 
·th
, 
acûl_key
, 
acûl_mods
, 
code
, 
mod–
):

258 
£lf
.
show_šput
 = 
Gtk
.
	$acûË¿tÜ_g‘_Ïb–
(
acûl_key
, 
acûl_mods
)

259 
£lf
.
Ãw_sk_bšdšg
 = 
Gtk
.
	$acûË¿tÜ_Çme
(
acûl_key
, 
acûl_mods
)

260 
shÜtcut
.
	$check_šv®id™y
(
£lf
.
Ãw_sk_bšdšg
, 
acûl_key
,

261 
acûl_mods
):

262 
£lf
.
	$_show_w¬nšg
(
£lf
.
show_šput
)

264 
£lf
.
bšdšg_backup
 = s–f.
Ãw_sk_bšdšg


265 
™”
 = 
mod–
.
	$g‘_™”
(
·th
)

266 
mod–
.
	$£t_v®ue
(
™”
, 1, 
£lf
.
show_šput
)

267 
shÜtcut
.
	`§ve_Ãw_bšdšg
(
£lf
.
Ãw_sk_bšdšg
,

268 
£lf
.
bu‰Ú
.
	$g‘_aùive
())

270 
def
 
	$_acûl_ş—»d
(
£lf
, 
widg‘
, 
·th
, 
mod–
):

272 
™”
 = 
mod–
.
	$g‘_™”
(
·th
)

273 
mod–
.
	$£t_v®ue
(
™”
, 1, 
NÚe
)

275 
def
 
	$_show_g£‰šgs_š¡®l_Ïb–
(
£lf
):

276 
vbox
 = 
£lf
.
bud”
.
	`g‘_objeù
("prefs-vbox7")

277 
Ïb–
 = 
Gtk
.
	$Lab–
()

278 
Ïb–
.
	`£t_m¬kup
(
	`_
("<small>Please install <i><b>gsettings</b></i> "

280 
vbox
.
	$add
(
Ïb–
)

282 
def
 
	$_show_w¬nšg
(
£lf
, 
šput_¡r
):

284 
show
 = 
	`_
("The shortcut \"%s\" cannot be used because "

287 "CÚŒŞ, AÉ o¸Shiá‡ˆth§mtime."è% 
šput_¡r


288 
dŸlog
 = 
Gtk
.
	$Mes§geDŸlog
(
£lf
.
dŸlog
,

289 
Gtk
.
DŸlogFÏgs
.
DESTROY_WITH_PARENT
,

290 
Gtk
.
Mes§geTy³
.
WARNING
,

291 
Gtk
.
Bu‰ÚsTy³
.
OK
,

292 
show
)

293 
dŸlog
.
	$run
()

294 
dŸlog
.
	`hide
()

	@gtk/tag_completion.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

19 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


20 
impÜt
 
unicoded©a


22 
	gFILTER_NAME
 = '@@TagCompletion'

25 
def
 
	$g_f‹r
(
g
, 
·¿m‘”s
=
NÚe
):

27 
chªged
 
ª
 
	`©Œibu‹
 (
e
.
g
. 
cŞÜ
, 
wÜkv›w
è=> 
Úly
 
impÜÁ
 
gs
 """

28 
g
.
	`g‘_id
().
	`¡¬tsw™h
('@'):

29 
has_©Œibu‹s
 = 
	`Ën
(
g
.
	`g‘_®l_©Œibu‹s
(
buŠame
=
True
)) > 0

30  
has_©Œibu‹s
 
Ü
 
g
.
	`g‘_aùive_sks_couÁ
() > 0

32  
F®£


35 
def
 
	$nÜm®ize_unicode
(
¡ršg
):

37 
»´e£Á©iÚ
. 
We
 
fÜû
 
them
 
to
 
be
 
š
 
ju¡
 
Úe
 
of
hem."""

38  
unicoded©a
.
	`nÜm®ize
('NFC', 
	$¡r
(
¡ršg
))

41 
def
 
	$g_m©ch
(
com¶‘iÚ
, 
key
, 
™”©Ü
, 
cŞumn
):

44 
DÚ
't match‡ny item if only‡rtefacts (!, @)‡re inserted

45 (
dÚ
't show‡llags) """

47 
key
 = key.
	`low”
().
	$l¡r
()

48 
key
 
š
 ['', '!', '@', '!@']:

49  
F®£


51 
‹xt
 = 
com¶‘iÚ
.
	`g‘_mod–
().
	$g‘_v®ue
(
™”©Ü
, 
cŞumn
)

52 
‹xt
 = 
	`nÜm®ize_unicode
Ñext.
	$low”
())

54  
‹xt
.
	$¡¬tsw™h
(
key
)

57 
şass
 
	$TagCom¶‘iÚ
(
Gtk
.
EÁryCom¶‘iÚ
):

61 
The
 
u£r
 
ÿn
 
choo£
 
wh‘”
 
wr™e
 
g
 
w™h
 
Ü
 
w™hout
 '@',

62 
w™h
 
Ü
 
w™hout
 '!' 
which
 
is
 
u£d
 
Ãg©iÚ
.

64 
The
 
li¡
 
of
 
sks
 
is
 
upd©ed
 
by
 
LibL¬ch
 
ÿÎbacks
 """

66 
def
 
	$__š™__
(
£lf
, 
Œ“
):

69 
C»©e
 
a
 
li¡
 
¡Üe
 
which
 
is
 
cÚÃùed
 
to
‡ 
LibL¬ch
 
ªd


70 
k•t
 
upd©ed
. """

71 
Gtk
.
EÁryCom¶‘iÚ
.
	$__š™__
(
£lf
)

73 
£lf
.
gs
 = 
Gtk
.
	$Li¡StÜe
(
¡r
)

75 
Œ“
 =»e.
	$g‘_ba£Œ“
()

76 
Œ“
.
	`add_f‹r
(
FILTER_NAME
, 
g_f‹r
, {'æ©': 
True
})

77 
g_Œ“
 = 
Œ“
.
g‘_v›wŒ“
('g_com¶‘iÚ', 
F®£
)

78 
	gg_Œ“
.
»gi¡”_şlbck
('node-added-šv›w', 
£lf
.
_Ú_g_added
)

79 
	gg_Œ“
.
»gi¡”_şlbck
('node-d–‘ed-šv›w', 
£lf
.
_Ú_g_d–‘ed
)

80 
	gg_Œ“
.
	$­¶y_f‹r
(
FILTER_NAME
)

82 
£lf
.
	$£t_mod–
(
£lf
.
gs
)

83 
£lf
.
	$£t_‹xt_cŞumn
(0)

84 
£lf
.
	$£t_m©ch_func
(
g_m©ch
, 0)

85 
£lf
.
	$£t_šlše_com¶‘iÚ
(
True
)

86 
£lf
.
	$£t_šlše_£ËùiÚ
(
True
)

87 
£lf
.
	$£t_pİup_sšgË_m©ch
(
F®£
)

89 
def
 
	$_Œy_š£¹
(
£lf
, 
Çme
):

91 
It
 
k“ps
 
the
 
li¡
 
sÜ‹d
. """

92 
pos™iÚ
 = 0

93 
pos™iÚ
, 
row
 
š
 
	$’um”©e
(
£lf
.
gs
, 1):

94 
row
[0] =ğ
Çme
:

95 #®»ady 
th”e


97 
–if
 
row
[0] > 
Çme
:

98 
pos™iÚ
 -= 1

100 
£lf
.
gs
.
	`š£¹
(
pos™iÚ
, (
Çme
, ))

102 
def
 
	$_Ú_g_added
(
£lf
, 
g
, 
·th
):

104 
g
 = 
	$nÜm®ize_unicode
(
g
)

105 
£lf
.
	$_Œy_š£¹
(
g
)

106 
£lf
.
	`_Œy_š£¹
('!' + 
g
)

107 
£lf
.
	`_Œy_š£¹
(
g
[1:])

108 
£lf
.
	`_Œy_š£¹
('!' + 
g
[1:])

110 
def
 
	$_Œy_d–‘e
(
£lf
, 
Çme
):

112 
row
 
š
 
£lf
.
gs
:

113 
row
[0] =ğ
Çme
:

114 
£lf
.
gs
.
	$»move
(
row
.
™”
)

117 
def
 
	$_Ú_g_d–‘ed
(
£lf
, 
g
, 
·th
):

119 
g
 = 
	$nÜm®ize_unicode
(
g
)

120 
£lf
.
	$_Œy_d–‘e
(
g
)

121 
£lf
.
	`_Œy_d–‘e
('!' + 
g
)

122 
£lf
.
	`_Œy_d–‘e
(
g
[1:])

123 
£lf
.
	`_Œy_d–‘e
('!' + 
g
[1:])

	@info.py

1 #!/
u¤
/
bš
/
’v
 
pythÚ3


2 #-*- 
codšg
: 
utf
-8 -*-

4 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


5 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


6 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


7 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


8 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


10 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


11 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


12 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


14 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


15 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

19 
CÚšs
 
the
 
šfÜm©iÚ
 
di¥Ïyed
 
š
 
	gGTG
's Credits."""

21 
äom
 
GTG
 
impÜt
 
_


23 
	gNAME
 = "Getting Things GNOME!"

24 
URL
 = "http://gtgnome.net"

25 
HELP_URI
 = "help:gtg"

26 
TRANSLATE_URL
 = "https://translations.launchpad.net/gtg"

27 
REPORT_BUG_URL
 = "https://bugs.launchpad.net/gtg/+filebug"

28 
EMAIL
 = "gtg-contributors@lists.launchpad.net"

29 
VERSION
 = '0.3.1'

31 
SHORT_DESCRIPTION
 = \

32 
_
('GTG is‡…ersonalasks‡nd TODO-list items organizer forhe GNOME.')

35 
AUTHORS
 = ["Main developers:",

103 
	gARTISTS
 = ["Kalle Persson <kalle@kallepersson.se>",

105 
	gARTISTS
.
	$sÜt
()

107 #PËa£, 
k“p
 
the
 
width
 
©
 
max
 80 
ch¬aù”s
 
wide
 
beÿu£


108 #GtkAboutDŸlog 
š
 
GTK3
 
ÿn
't wrapext :/

109 
TRANSLATORS
 = \

111 
Aäik¯ns
:
A¹hur
 
Rke
, 
W®‹r
 
Leibb¿ndt
, 
We¦ey
 
ChªnÚ


113 
AlbªŸn
: 
VsÚ
 
Gjeci


115 
A¿bic
: 
Ahmed
 
KÙb
, 
Ali
 
AlNßimi
, 
AÇs
 
Almzoghy
, 
Bash”
 
Aobash”
,

116 
I¦am
 
Alshaikh
, 
Ka
Ã¯
s
 
Bejaoui


118 
A¡urŸn
: 
Xuacu
 
S©urio
, 
iv¬–a


120 
Basque
: 
As›r
 
Itu¼®de
 
S¬asŞa
, 
O›r
 
M“s


122 
B–¬usŸn
: 
EgÜ
 
Kuryªovich
, 
IryÇ
 
Nikªchuk


124 
B’g®i
: 
XFACT
, 
Çsœ
 
khª
 
§ik©


126 
B¿zŸn
: 
AdœKuhn
, 
Andr
Ã© 
GÚdim
, 
B–’os
 
GovªÂÚ
, 
Dª›l
 
T›ch”
,

127 
Davi
 
da
 
Sva
 
B
Ã¶
g”
, 
Djavª
 
Fagundes
, 
DougÏs
 
Sªtos
, 
EÄico
 
NicŞ‘to
,

128 
F»d”ico
 
Lİes
, 
Jo
Ã£
o
 
Cruz
 
Jr
, JoÃ£Ø
SªÇ
, 
NeLaS
, 
NtÚ
, 
Raç–
 
N”i
,

129 
Teylo
 
Laundos
 
AguŸr
, 
W®dœ
 
LeÚcio
, 
ªd»
 
ãlix


131 
Bulg¬Ÿn
: 
Damyª
 
Ivªov
, 
Sv‘o¦av
 
S‹çnov
, 
i
.
¿ynov


133 
C©®ª
: 
AdŞfo
 
Jayme
 
B¬r›Áos
, 
C¬Ës
 
S®a
, 
David
 
PÏÃÎa
,

134 
Juªma
 
H”n
Ã¡
ndez
, 
M¬c
 
Reÿ£ns
, 
Radša
 
M©ic
, 
S›gä›d
 
Gev©‹r
,

135 
ªÇ
 
m¬ti


137 
	$Chše£
 (
sim¶if›d
): 
Ang
 
Gao
, 
AÁhÚy
 
Fok
, 
EËªÜ
 
Ch’
, 
H¬Şd
.
luo
,

138 
H–šg
 
Yao
, 
Jo£ph
 
Lew
, 
KyË
 
WANG
, 
Wylm”
 
Wªg
, 
Xuª
 
Hu
, 
ch¬s
, ç™¾è‰è°·å±…å£«,

139 
somebodykiss


141 
	$Chše£
 (
Œad™iÚ®
): 
And»w
 
Liu
, 
AÁhÚy
 
Fok
, 
Po
-
J’
 
Hsu
, 
Rex
 
T§i
,

142 
ToomÜe
, 
exŒaymÚd
@
gma
.
com


144 
CrßtŸn
: 
Sa
Å¡
a
 
Tekovi
Ä‡, 
gogo


146 
Czech
: 
David
 
Kov
Ã¡Å™, 
Domšik
 
Jªk
Å¯, 
Jakub
 
Kozi£k
, 
Jª
 
Hrdša
, 
KÚki
,

147 
Kuv®y
 [
LCT
], 
Ladi¦av
 
Prskavec
, 
Mao
, 
M¬tš
 
RÙ‹r
, M¬tš 
VŞf
,

148 
M¬v
-
CZ
, 
Mos
-
kroulik
-3, 
Romª
 
HÜn
Ã­
k
, 
Tade
Ã¡Å¡ 
Pa
Å™Ã­k, 
ViktÜ


150 
Dªish
: 
AputsŸq
 
N›ls
 
Jªus£n
, 
Ask
 
HjÜth
 
L¬£n
, 
Gamayun
, 
Mog’s
 
I§g”
,

151 
P‘”
 
Skov
, 
mkj–d£n


153 
Dutch
: 
Em›n
 
KËš
, 
Fİ³
 
B’ediùus
, 
Hªs£n
, 
Heu»ka
, 
LiÚ–
 
DricÙ
,

154 
Luÿs
 
V›™es
, 
N©hª
, 
P›‹r
 
J
. 
	$K”¡’
 (
EduS’£
 
BV
)
Rachid
,

155 
Rešout
 
vª
 
Schouw’
, 
Tšo
 
Meš’
, 
kÏp
-
š
, 
puccha
, 
rob


157 
	$English
 (
Cªada
): 
Ii
 
MŞ’¯r
, 
K’
 
Sh¬p
, 
Luÿ
 
F®avigÇ
, 
Paul
 
KishimÙo


159 
	$English
 (
Un™ed
 
Kšgdom
): 
AËxªd»
 
COLLIGNON
, 
Aläedo
 
H”n
Ã¡
ndez
,

160 
AÁhÚy
 
H¬ršgtÚ
, 
Bruû
 
Cowª
, 
Cyr
, 
JÚ©hÚ
 
Hodges
, 
LiÚ–
 
DricÙ
,

161 
Luÿ
 
Inv”nizzi
, 
Mich«l
 
K•¶”
, 
OÎy
 
B‘ts
, 
Php
 
KËšh’z
,

162 
Rob”t
 
R—dmª
, 
Sid
 
Rob”ts
, 
asûn£ur
, 
lİho
, 
Luÿ
 
F®avigÇ


164 
Fšnish
: 
Heikki
 
M©ta
, 
Jussi
 
Tiœa
, 
Mika
 
T­oj
Ã¤
rvi


166 
F»nch
: 
AkaiK’
, 
AËxªd»
 
COLLIGNON
, 
B”Œªd
 
Rous£au
, 
Bruno
 
VeËux
,

167 
Cyr
, 
David
 
CÛurjŞly
, 
Domšick
 
Riv¬d
, 
Em›n
 
KËš
, 
F¿ncoisSchoubb’
,

168 
F¿n
Ã§
ois
, 
G»izgh
, 
Jibec
, 
LiÚ–
 
DricÙ
, 
Maxime
 
V”oÚe
, 
NicŞas
 
D–vaux
,

169 
P”niæos£
, 
Ph³
 
Le
 
Toquš
, 
P™™jo
, 
Pt™physik
, 
Qu’tš
 
Pag
Ã¨
s
,

170 
Rafik
 
Ou”cheçni
, 
R­ha
Ã«
l
, 
Sid
 
Rob”ts
, 
SimÚ
 
LebÏnc
, 
Sni¦as
 
Mich®ak
,

171 
ThibauÉ
 
F
Ã©
vry
, 
TimÙh“
 
B”Çrd
, 
Yves
 
MassÚ
, 
b§Ë
, 
g«Å¿lÚg
,

172 
£bz
, 
AËxªd»
 
G”maš
, 
F¿n
Ã§
ois
 
Vog–we™h
, 
JÚ©hª
 
From’tš
,

173 
Loic
 
D»ux
, 
NicŞas
 
GauÏrd
-
Qu”Ş
, 
Seba¡›n
 
MÜª
, 
Sylv›
 
G®Ët
,

174 
thomas
.
c™h¬‘
@
gma
.
com


176 
G®icŸn
: 
D¬io
, 
F¿n
 
Di
Ã©
guez
, 
JÜge
 Ã
lv¬ez
, 
Migu–
 
Anxo
 
Bouzada
, 
keko


178 
GeÜgŸn
: 
GiÜgi
 
Jv¬idze


180 
G”mª
: 
Abb
, 
AËxªd»
 
COLLIGNON
, 
Chri¡İh
-
M
. 
Lehmªn
, 
Dª›l
 
D›Œich
,

181 
Dª›l
 
Wšz’
, 
FabŸn
 
AffŞ‹r
, 
G”ä›d
 
Fuchs
, 
H’ry78
, 
IzidÜ
 
M©u
Å¡
ov
,

182 
Jª
, 
J’s
 
Mauch”
, 
JÚas
 
End”sch
, 
M¬ûl
 
Stimb”g
, 
Mich«l
 
K•¶”
,

183 
Ph
 
S‹w¬t
, 
R­h«l
 
J
. 
Schmid
, 
ScÙt
, 
S”­hyn
, 
Thomas
 
P™lik
,

184 
Tim
 
BÜdemªn
, 
g”b”
, 
schulz3000
, 
bryÎi
, 
Mich«l
 
Odaischi
,

185 
FlÜŸn
 
B
Ã¤
u”Ë
, 
BÜim


187 
G»ek
: 
FÙis
 
T§mis
, 
GeÜge
 
ChrÚis
, 
Sthis
 
Iosifidis


189 
Heb»w
: 
Erik
, 
Y¬Ú


191 
Hšdi
: 
Abdul
 
Rauf
, 
Nim™
 
Shah


193 
Hung¬Ÿn
: 
Andr
Ã¡
s
 
K
Ã¡
r
Ã¡
sz
, 
Crcsz
 
Tibü
, 
GabÜ
 
K–em’
, 
G”g–y
 
Sz¬ka
,

194 
K¿szÃcz
 
ZŞt
Ã¡
n
, 
Musz–a
 
B®
Ã¡
zs


196 
IûÏndic
: 
B®dur
, 
P®m¬
 
ThÜ¡ešssÚ
, 
Sam
Ãº
–
 
J
Ã³
n
 
GuÂ¬ssÚ


198 
IndÚesŸn
: 
Andika
 
Triwidada
, 
Wayª
 
SudŸº©a


200 
IÁ”lšgua
: 
Emio
 
S•ulveda


202 
IlŸn
: 
AÁÚio
 
Roqu’tš
, 
CÏudio
 
Ar£ni
, 
D¬io
 
B”tši
,

203 
Davide
 
Alb”–li
, 
D’nis
 
Anfossi
, 
Fabio
 
M¬cÚi
, 
F¿nûsco
 
de
 
Vœgio
,

204 
GŸnäªco
, 
Luÿ
 
F®avigÇ
, Luÿ 
Inv”nizzi
, 
Mo
 
Ca§g¿nde
, 
Radša
 
M©ic


205 , 
jŞlyr0g”


207 
J­ªe£
: 9A
PPAT3CH
, 
Chris
 
H¬ršgtÚ
, 
Hideki
 
Yamªe
, 
Hœoshi
 
Tagawa


209 
KÜ—n
: 
khmœage


211 
L™huªŸn
: 
Algimªs
 
M¬gevi
Ä
ius
, 
Mªs
 
KrŸu
Ä
i
Å«
Çs
, 
Rytis
 Åª
§lis
,

212 
aurisc4
, 
j¬o


214 
Lojabn
: 
David
 
Futch”


216 
Low
 
G”mª
: 
Mich«l
 
Odaischi
, 
bryÎi


218 
M®agasy
: 
Th›¼y
 
AndrŸmœado


220 
M®ay
: 
Ib¿him
 
ElŸs
, 
abuyİ
, 
™ikna
, 
m–ayubuÁu


222 
NÜwegŸn
 
Bokm®
: 
GamËrik
, 
RuÇr
 
Ingebrigt£n
, 
T”je
 
And»
 
Aº
Ã¸
y
, Ã˜
y¡eš


224 
	$Occ™ª
 (
po¡
 1500): 
C
Ã©
dric
 
	`VALMARY
 (
TÙ
 
’
 Ã²
c
)

226 
P”sŸn
: 
S•ehr
 
Lajev¬di


228 
PŞish
: 
Jakub
 
Ko
Å‚
akowski
, 
KÚ¿d
, 
PiÙr
 
Ha
Å‚
as
, PiÙ¸
SŒ
Ä™
bski
, 
Radek
 
Pu
Å‚
a
,

229 
Tomasz
 'Z’' 
N­›¿Ï
, Tomasz 
Mac›jewski
, 
btomasz
, 
szczym
, 
tomËe
,

230 
W™ek
 
M
., 
XevaquÜ
, 
Tomasz
 
Wo
Åº
nŸk


232 
PÜtugue£
: 
Emªu–
 Ã‚
ng–o
, 
JÛl
 
P©r
Ã£
o
, 
Paulo
 
Cabido
, 
¿ul_³»œa


234 
RomªŸn
: 
Adi
 
Roibª
, 
Jibec
, 
LucŸn
 
AdrŸn
 
Grijšcu
, 
Ovidiu


236 
RussŸn
: 
A
. 
S
. 
Pİov
, 
AËxªd”
 
SemyÚov
, 
AËxey
 
Ivªov
, AËxey 
Ko¡yuk
,

237 
AËxey
 
Nedko
, 
And»j
 
Surkov
, 
DmDr
, 
Dm™ry
 "Divius" 
Tªtsur
,

238 
Eug’e
 
Sysmªov
, 
N”g®
, 
Nik™a
 
Putko
, 
OËg
 
Kİ‹v
, 
P‘”
 
Romov
, 
S”ãr
,

239 
Vadim
 
B¬sukov
, 
Yevg’y
 
Sysmªov
, 
Yuriy
 
Vidš“v
, 
a220
, 
dueMiR
, 
maxzda
,

240 
mrk
, 
wiz
, ĞĞ»ĞµĞ³ ĞœĞ°Ğ»Ğ°Ñ…Ğ¾Ğ²

242 
S”bŸn
: 
Mo
Å¡ 
Mªd¬i
Ä‡, Ğ˜Ğ³Ğ¾Ñ€ ĞœĞ¸Ğ»Ğ¾Ğ²Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ›, ĞœĞ¸Ñ€Ğ¾ÑĞ»Ğ°Ğ² ĞĞ¸ĞºĞ¾Ğ»Ğ¸Ñ›, Ğ¡Ğ°ÑˆĞ° ĞŸĞµÑ‚Ñ€Ğ¾Ğ²Ğ¸Ñ›

244 
Sšh®e£
: à¶¢à·“à·€à¶±à·Šà¶­ à¶½à·šà¶šà¶¸à·Šà·€à·ƒà¶¸à·Š

246 
Slovak
: 
IzidÜ
 
M©u
Å¡
ov
, 
Mª
 
Slov
Ã¡
k
, 
SÏvko


248 
Slov’Ÿn
: 
And»j
 
Znid¬sic
, 
IgÜ2x
, 
groçty


250 
S·nish
: 
AdŞfo
 
Jayme
 
B¬r›Áos
, 
Alb”to
 
Caso
, 
C¬los
 Alb”tØ
O¥ša
,

251 
Chri¡İh”
, 
D’is
 
Fu’z®ida
, 
D›goJ
, 
Grlo
, 
Jav›r
 
G¬c
Ã­
a
 
D
Ã­
az
,

252 
Jav›r
 
J¬d
Ã³
n
, Jav›¸
Su
Ã¡
»z
, 
JÜge
 
GÚz
Ã¡
Ëz
, 
Jo£
 
R
. 
MegŸ
, 
LiÚ–
 
DricÙ
,

253 
M¬ûÎo
 
NicŞas
 
Mªso
, 
NicŞ
Ã¡
s
 
M
. 
Zahlut
, 
Nuk—dÜ
, 
Radša
 
M©ic
,

254 
Raç–
 
SŞ”
 - 
Dom©ix
, 
S”gio
 
RedÚdo
, 
Xuacu
 
S©urio
, 
ixzus
, 
n_®ex
,

255 
³¼imª


257 
Swedish
: 
Chri¡Ÿn
 
Wid–l
, 
Dª›l
 
NyÏnd”
, 
David
 
B’gtssÚ
,

258 
Erik
 
P›hl
 
Sylv
Ã©
n
, 
K®Ë
 
P”ssÚ
, 
Maxim
 
And”ssÚ
, 
Nikke
, 
P‘ri
 
Ro£n¡r
Ã¶
m
,

259 
j’s
 
³rssÚ


261 
T–ugu
: 
ArjuÇ
 
Rao
 
Chav®a
, à°µà±€à°µà±†à°¨à± (
V“v’
)

263 
Thai
: 
NuÎZ”0
, 
SœaNokyoÚgtÚg


265 
Turkish
: 
A—n
, 
Ali
 
KIBICI
, 
B¬is
 
A
, 
Em»
 
Ayÿ
, 
Mu¿t
 
GuÃs
,

266 
Onur
 
ALTINTA
Å
I
, 
Yi
ÄŸ
™
 
A‹
ÅŸ, 
VŞkª
 
Gez”


268 
Uk¿šŸn
: 
AËx
 
Chmyr
, 
GÚt§
, 
Pav–
 
Druzyak
, 
®ex
, 
dueMiR
, 
yvadim


270 
Urdu
: 
Abdul
 
Rauf


273 
DOCUMENTERS
 = ["Radina Matic <radina.matic@gmail.com>"]

	@plugins/__init__.py

	@plugins/bugzilla/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Paulo
 
Cabido
 <
·ulo
.
ÿbido
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
	gGTG
.
	g¶ugšs
.
	gbugzÏ
.
bugzÏ
 
impÜt
 
	g¶ugšBugzÏ


17 #suµ»s 
pyæakes
 
w¬nšg
 (
giv’
 
by
 
make
 
lšt
)

18 
F®£
 
is
 
	gTrue
:

19 
¶ugšBugzÏ
()

	@plugins/bugzilla/bug.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
GuÏume
 
DesmÙ‹s
 <
gdesmÙt
@
gnome
.
Üg
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
	g__®l__
 = ('BugFactory',)

17 
şass
 
	$Bug
(
objeù
):

19 
def
 
	$__š™__
(
£lf
, 
bug
):

21 
£rviû
 
XMLRPC


23 
£lf
.
bug
 = bug

25 @
´İ”ty


26 
def
 
	$summ¬y
(
£lf
):

27  
£lf
.
bug
['summary']

29 @
´İ”ty


30 
def
 
	$´oduù
(
£lf
):

31  
£lf
.
bug
['product']

33 @
´İ”ty


34 
def
 
	$desütiÚ
(
£lf
):

35  
£lf
.
bug
['summary']

37 @
´İ”ty


38 
def
 
	$compÚ’t
(
£lf
):

39  
£lf
.
bug
['component']

42 
şass
 
	$GnomeBug
(
Bug
):

43 
·ss


46 
şass
 
	$F»edesktİBug
(
Bug
):

47 
·ss


50 
şass
 
	$G’tooBug
(
Bug
):

51 
·ss


54 
şass
 
	$MozÏBug
(
Bug
):

55 
·ss


58 
şass
 
	$SambaBug
(
Bug
):

59 
·ss


62 
şass
 
	$RedH©Bug
(
Bug
):

63 
·ss


66 
bugs
 = {

67 'bugzÏ.gnome.Üg': 
GnomeBug
,

68 'bugs.ä“desktİ.Üg': 
F»edesktİBug
,

69 'bugzÏ.mozÏ.Üg': 
MozÏBug
,

70 'bugzÏ.§mba.Üg': 
SambaBug
,

71 'bugs.g’too.Üg': 
G’tooBug
,

72 'bugzÏ.»dh©.com': 
RedH©Bug
,

73 
	}
}

76 
şass
 
	$BugFaùÜy
(
objeù
):

77 @
¡©icm‘hod


78 
def
 
	$ü—‹
(
£rviûDomaš
, 
bug
):

79  
bugs
[
£rviûDomaš
](
bug
)

	@plugins/bugzilla/bugzilla.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
GuÏume
 
DesmÙ‹s
 <
gdesmÙt
@
gnome
.
Üg
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
GObjeù


15 
impÜt
 
»


16 
impÜt
 
th»adšg


17 
impÜt
 
	gxmÌpc
.
ş›Á


18 
äom
 
	gu¾lib
.
·r£
 
impÜt
 
u¾·r£


20 
	gäom
 .
£rviûs
 
impÜt
 
BugzÏS”viûFaùÜy


21 
	gäom
 .
£rviûs
 
impÜt
 
BugzÏS”viûNÙExi¡


22 
	gäom
 .
nÙifiÿtiÚ
 
impÜt
 
£nd_nÙifiÿtiÚ


24 
	g__®l__
 = ('pluginBugzilla', )

26 
	gbugIdP©‹º
 = 
»
.
compe
('^\d+$')

27 
bugURLP©‹º
 = 
»
.
compe
('^(https?)://(.+)/show_bug\.cgi\?id=(\d+)$')

30 
şass
 
	$G‘BugInfÜm©iÚTask
(
th»adšg
.
Th»ad
):

32 
def
 
	$__š™__
(
£lf
, 
sk
, **
kw¬gs
):

34 
£lf
.
sk
 =ask

35 
	`su³r
(
G‘BugInfÜm©iÚTask
, 
£lf
).
	$__š™__
(**
kw¬gs
)

37 
def
 
	$·r£BugU¾
(
£lf
, 
u¾
):

38 
r
 = 
	$u¾·r£
(
u¾
)

39 
qu”›s
 = 
	`diù
([
™em
.
	`¥l™
('='è™em 
š
 
r
.
qu”y
.split('&')])

40  
r
.
scheme
,„.
ho¡Çme
, 
qu”›s


42 
def
 
	$run
(
£lf
):

43 
bug_u¾
 = 
£lf
.
sk
.
	$g‘_t™Ë
()

45 #W
Úly
 
hªdË
 
bug
 
URL
. 
Wh’
 
sk
'sitle is‚ot‡ bug URL, stop

46 #hªdlšg 
qu›y
.

47 
bugURLP©‹º
.
	$m©ch
(
bug_u¾
è
is
 
NÚe
:

50 
scheme
, 
ho¡Çme
, 
qu”›s
 = 
£lf
.
	$·r£BugU¾
(
bug_u¾
)

52 
bug_id
 = 
qu”›s
.
	`g‘
('id', 
NÚe
)

53 
bugIdP©‹º
.
	$m©ch
(
bug_id
è
is
 
NÚe
:

54 #FIXME: 
make
 
some
 
£n§bË
 
aùiÚ
 
š¡—d
 
of
 
»tuºšg
 
s’y
.

57 
Œy
:

58 
bugzÏS”viû
 = 
BugzÏS”viûFaùÜy
.
	$ü—‹
(
scheme
, 
ho¡Çme
)

59 
exû±
 
BugzÏS”viûNÙExi¡
:

60 #Stİ 
qu›y
 
wh’
 
bugzÏ
 
ÿÂÙ
 
be
 
found
. 
Cu¼’y
, 
I
 
dÚ
't

61 #assum
th©
 
u£r
 
’‹rs
 
a
 
wrÚg
 
ho¡Çme
 
Ü
 
ju¡
 
ª
 
unkown


62 #bugzÏ 
£rviû
.

65 
Œy
:

66 
bug
 = 
bugzÏS”viû
.
	$g‘Bug
(
bug_id
)

67 
exû±
 
xmÌpc
.
ş›Á
.
FauÉ
 
as
 
”r
:

68 
code
 = 
”r
.
çuÉCode


69 
code
 =ğ100: #šv®id 
bug
 
ID


70 
t™Ë
 = 'Inv®id bug ID #%s' % 
bug_id


71 
–if
 
code
 =ğ101: #bug 
ID
 
nÙ
 
exi¡


72 
t™Ë
 = 'Bug #% dÛ nÙƒxi¡.' % 
bug_id


73 
–if
 
code
 =ğ102: #Acûs 
d’›d


74 
t™Ë
 = 'Acûs d’›dØbug %s' % 
bug_u¾


75 : #uÄecogªized 
”rÜ
 
code
 
cu¼’y


76 
t™Ë
 = 
”r
.
çuÉSŒšg


78 
	$£nd_nÙifiÿtiÚ
(
bugzÏS”viû
.
Çme
, 
t™Ë
)

79 
exû±
 
Exû±iÚ
 
as
 
”r
:

80 
	$£nd_nÙifiÿtiÚ
(
bugzÏS”viû
.
Çme
, 
”r
.
mes§ge
)

82 
t™Ë
 = '#%s: %s' % (
bug_id
, 
bug
.
summ¬y
)

83 
GObjeù
.
	$idË_add
(
£lf
.
sk
.
£t_t™Ë
, 
t™Ë
)

84 
‹xt
 = "%s\n\n%s" % (
bug_u¾
, 
bug
.
desütiÚ
)

85 
GObjeù
.
	$idË_add
(
£lf
.
sk
.
£t_‹xt
, 
‹xt
)

87 
gs
 = 
bugzÏS”viû
.
	$g‘Tags
(
bug
)

88 
gs
 
is
 
nÙ
 
NÚe
 
ªd
ags:

89 
g
 
š
 
gs
:

90 
GObjeù
.
	`idË_add
(
£lf
.
sk
.
add_g
, '@%s' % 
g
)

93 
şass
 
¶ugšBugzÏ
:

95 
def
 
	$aùiv©e
(
£lf
, 
¶ugš_­i
):

96 
£lf
.
¶ugš_­i
 =…lugin_api

97 
£lf
.
brow£r
 = 
¶ugš_­i
.
	$g‘_brow£r
()

98 
£lf
.
cÚÃù_id
 = s–f.
brow£r
.
	`cÚÃù
(

99 "sk-added-vŸ-quick-add", 
£lf
.
sk_added_cb
)

101 
def
 
	$sk_added_cb
(
£lf
, 
£nd”
, 
sk_id
):

102 #thi 
is
 
a
 
gobjeù
 
ÿÎback
 
th©
 
wl
 
block
 
the
 
Brow£r
.

103 #decou¶šg 
w™h
 
a
 
th»ad
. 
AÎ
 
š‹¿ùiÚ
 w™h 
sk
 
ªd
 
gs
 
objeùs


104 #(
ªythšg
 
š
 
a
 
T»e
è
mu¡
 
be
 
dÚe
 
w™h
 
gobjeù
.
	`idË_add
 (
šv”nizzi
)

106 
sk
 = 
£lf
.
¶ugš_­i
.
	`g‘_»que¡”
().
	$g‘_sk
(
sk_id
)

107 
bugTask
 = 
	$G‘BugInfÜm©iÚTask
(
sk
)

108 
bugTask
.
	$£tD«mÚ
(
True
)

109 
bugTask
.
	`¡¬t
()

	@plugins/bugzilla/notification.py

1 #-*- 
codšg
: 
utf
-8 -*-

4 
NÙifiÿtiÚ
 
is
 
u£d
 
to
 
show
 
mes§ges
Ø
GTG
 
	gu£rs
.

7 
impÜt
 
sub´oûss


9 
	g__®l__
 = ("send_notification", )

11 
	gAPP_NAME
 = "GTG"

12 #How 
mªy
 
mli£cÚd
 
the
 
nÙifiÿtiÚ
 
¬—
 
Ï¡s


13 
TIMEOUT
 = 3000

16 
def
 
	$_nÙify_vŸ_nÙify
(
t™Ë
, 
mes§ge
):

17 
NÙify
.
	$š™
(
APP_NAME
)

18 
Á
 = 
NÙify
.
NÙifiÿtiÚ
.
	$Ãw
(
t™Ë
, 
mes§ge
)

19 
Á
.
	$£t_timeout
(
TIMEOUT
)

20 
Œy
:

21 
Á
.
	$show
()

22 
exû±
:

23 #K“°
qu›t
 
h”e
 
wh’
 
nÙifiÿtiÚ
 
£rviû
 
is
 
nÙ
 
avŸÏbË
 
cu¼’y


24 #som‘ime. 
FÜ
 
exam¶e
, 
u£r
 
is
 
usšg
 
LXDE
, 
no
 
nÙifyd
 
by
 .

25 
·ss


26 
NÙify
.
	$unš™
()

29 
def
 
	$_nÙify_vŸ_nÙify_£nd
(
t™Ë
, 
mes§ge
):

30 
cmd
 = "notify-send --app-name=%s --expire-time=%d \"%s\" \"%s\"" % (

31 
APP_NAME
, 
TIMEOUT
, 
t™Ë
, 
mes§ge
)

32 
sub´oûss
.
	$Pİ’
(
cmd
, 
sh–l
=
True
)

35 #A 
»ã»nû
 
to
 
the
 
cÚü‘e
 
hªdËr
 
th©
 
£nds
 
nÙifiÿtiÚ
.

36 #By , 
this
 
»ã»nû
 
is
 
£t
 
to
 
NÚe
 
š
 
®l
 
ÿndid©es
 
¬e
 
nÙ


37 #avaabË 
to
 
k“p
 
s›Á
 
wh’
 
uÃx³ùed
 
thšgs
 
h­³n
.

38 
_nÙify_hªdËr
 = 
NÚe


39 
Œy
:

40 #Prim¬y, 
pynÙify
 
is
 
u£d
 
to
 
£nd
 
nÙifiÿtiÚ
. 
Howev”
, 
™
 
might
 
nÙ


41 #­³¬ 
š
 
u£r
' machše. So, we'
Î
 
Œy
 
ªÙh”
 
®‹º©ive
.

42 
äom
 
gi
.
»pos™Üy
 
impÜt
 
NÙify


43 
_nÙify_hªdËr
 = 
_nÙify_vŸ_nÙify


44 
exû±
 
ImpÜtE¼Ü
:

45 #Th
®‹º©ive
 
is
 
nÙify
-
£nd
, 
which
 i 
a
 
commªd
 
lše
 
ut™y
 
´ovided


46 #by 
libnÙify
 
·ckage
.

47 
´oc
 = 
sub´oûss
.
	`Pİ’
("which‚Ùify-£nd", 
sh–l
=
True
)

48 
´oc
.
	`wa™
() == 0:

49 
_nÙify_hªdËr
 = 
_nÙify_vŸ_nÙify_£nd


52 
def
 
	$£nd_nÙifiÿtiÚ
(
t™Ë
, 
mes§ge
):

55 
Wh’
 
no
 
nÙifiÿtiÚ
 
ut™y
 
is
 
avaabË
, 
ju¡
 
k“p
 
s’t
.

58 
_nÙify_hªdËr
 
is
 
nÙ
 
NÚe
:

59 
	`_nÙify_hªdËr
(
t™Ë
, 
mes§ge
)

	@plugins/bugzilla/services.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #Remov
d•’d’û
 
of
 
bugz
 
due
 
to
 
th©
 
¶ugš
 
ju¡
 
Ãeds
 
g‘
 
aùiÚ
 
ªd


4 #™ 
is
 
dÚe
 
by
 
PythÚ
 
xmÌpşib
 
sim¶y
 
’ough
.

5 
äom
 
	gxmÌpc
.
ş›Á
 
impÜt
 
S”v”Proxy


7 
	gäom
 .
bug
 
impÜt
 
BugFaùÜy


9 
	g__®l__
 = ('BugzillaServiceFactory',)

12 
şass
 
	$BugzÏS”viû
(
objeù
):

13 
Çme
 = 'Bugzilla Service'

14 
’abËd
 = 
True


15 
g_äom
 = 'component'

17 
def
 
	$__š™__
(
£lf
, 
scheme
, 
domaš
):

18 
£lf
.
scheme
 = scheme

19 
£lf
.
domaš
 = domain

21 
def
 
	$budXmlRpcS”v”U¾
(
£lf
):

23 'scheme': 
£lf
.
scheme
, 'domaš': s–f.
domaš
,

24 
	}
}

26 
def
 
	$g‘Proxy
(
£lf
, 
£rv”_u¾
):

27  
	$S”v”Proxy
(
£rv”_u¾
)

29 
def
 
	$g‘Bug
(
£lf
, 
bug_id
):

30 
£rv”_u¾
 = 
£lf
.
	$budXmlRpcS”v”U¾
()

31 
´oxy
 = 
£lf
.
	$g‘Proxy
(
£rv”_u¾
)

32 
bugs
 = 
´oxy
.
Bug
.
	`g‘
({'ids': [
bug_id
, ]
	}
})

33  
BugFaùÜy
.
ü—‹
(
£lf
.
domaš
, 
bugs
['bugs'][0])

35 
def
 
	$g‘Tags
(
£lf
, 
bug
):

37 
thª
 
a
 
¡ršg
 
š
 
some
 
bugzÏ
 
£rviû
.

39 
g_Çmes
 = 
	$g‘©Œ
(
bug
, 
£lf
.
g_äom
, 
NÚe
)

40 
g_Çmes
 
is
 
NÚe
:

42 
nÙ
 
	$isš¡ªû
(
g_Çmes
, 
li¡
):

43  [
g_Çmes
]

44  
g_Çmes


47 
şass
 
	$GnomeBugzÏ
(
BugzÏS”viû
):

48 
Çme
 = 'GNOME Bugzilla Service'

49 
g_äom
 = 'product'

52 
şass
 
	$F»edesktİBugzÏ
(
BugzÏS”viû
):

55 
Çme
 = 'Freedesktop Bugzilla Service'

58 
şass
 
	$G’tooBugzÏ
(
BugzÏS”viû
):

61 
Çme
 = 'Gentoo Bugzilla Service'

64 
şass
 
	$MozÏBugzÏ
(
BugzÏS”viû
):

67 
Çme
 = 'Mozilla Bugzilla Service'

70 
şass
 
	$SambaBugzÏ
(
BugzÏS”viû
):

73 
’abËd
 = 
F®£


74 
Çme
 = 'Samba Bugzilla Service'

77 
şass
 
	$RedH©BugzÏ
(
BugzÏS”viû
):

80 
Çme
 = 'Red Hat Bugzilla Service'

82 #Regi¡” 
bugzÏ
 
£rviûs
 
mªu®ly
, 
howev”
 
¡Üe
 
them
 
š
 
som•Ïû
 
ªd
 
lßd


83 #them 
©
 
Úû
 
is
 
b‘‹r
.

84 
£rviûs
 = {

85 'bugzÏ.gnome.Üg': 
GnomeBugzÏ
,

86 'bugs.ä“desktİ.Üg': 
F»edesktİBugzÏ
,

87 'bugzÏ.mozÏ.Üg': 
MozÏBugzÏ
,

88 'bugzÏ.§mba.Üg': 
SambaBugzÏ
,

89 'bugs.g’too.Üg': 
G’tooBugzÏ
,

90 'bugzÏ.»dh©.com': 
RedH©BugzÏ
,

91 
	}
}

94 
şass
 
	$BugzÏS”viûNÙExi¡
(
Exû±iÚ
):

95 
·ss


98 
şass
 
	$BugzÏS”viûDi§bËd
(
Exû±iÚ
):

101 
def
 
	$__š™__
(
£lf
, 
domaš
, *
¬gs
, **
kw¬gs
):

102 
£lf
.
mes§ge
 = '% i di§bËd.' % 
domaš


103 
	`su³r
(
BugzÏS”viûDi§bËd
, 
£lf
).
	$__š™__
(*
¬gs
, **
kw¬gs
)

106 
şass
 
	$BugzÏS”viûFaùÜy
(
objeù
):

109 @
¡©icm‘hod


110 
def
 
	$ü—‹
(
scheme
, 
domaš
):

111 
domaš
 
š
 
£rviûs
:

112 
£rviû
 = 
£rviûs
[
domaš
]

113 
nÙ
 
£rviû
.
’abËd
:

114 
¿i£
 
	$BugzÏS”viûDi§bËd
(
domaš
)

115  
£rviûs
[
domaš
](
scheme
, domain)

117 
¿i£
 
	`BugzÏS”viûNÙExi¡
(
domaš
)

	@plugins/export/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

3 #2012 - 
IzidÜ
 
M©u
Å¡
ov
 <
izidÜ
.
m©usov
@
gma
.
com
>

4 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


5 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


6 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


8 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


9 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


10 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


12 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


13 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
	gGTG
.
	g¶ugšs
.
	gexpÜt
.
expÜt
 
impÜt
 
	gPlugšExpÜt


19 #Mak
pyæakes
 
h­py


20 
	gF®£
:

21 
PlugšExpÜt
()

	@plugins/export/export.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

3 #2012 - 
IzidÜ
 
M©u
Å¡
ov
 <
izidÜ
.
m©usov
@
gma
.
com
>

4 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


5 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


6 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


8 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


9 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


10 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


12 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


13 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

16 
Plugš
 
expÜtšg
 
što
 
niû
 
li¡s
 
š
 
	gTXT
, 
HTML
 
Ü
 
	gPDF
 """

18 
impÜt
 
os


19 
impÜt
 
shut


20 
impÜt
 
webbrow£r


21 
impÜt
 
sub´oûss


23 
äom
 
	gxdg
.
Ba£DœeùÜy
 
impÜt
 
xdg_cÚfig_home


24 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
	gGObjeù
, 
	gGtk
, 
GdkPixbuf


26 
äom
 
GTG
 
impÜt
 
_


27 
äom
 
	gGTG
.
	g¶ugšs
.
	gexpÜt
.
sk_¡r
 
impÜt
 
g‘_sk_w¿µ”s


28 
äom
 
	gGTG
.
	g¶ugšs
.
	gexpÜt
.
‹m¶©es
 
impÜt
 
	gTem¶©e
, 
	gg‘_‹m¶©es_·ths


31 #EnfÜû 
ex‹º®
 
d•’d’c›s


32 
d•’d’û
 
	gš
 "pdflatex", "pdftk", "pdfjam":

33 
»tv®
 = 
sub´oûss
.
ÿÎ
(["which", 
d•’d’û
], 
¡dout
=sub´oûss.
PIPE
)

34 
»tv®
 != 0:

35 
¿i£
 
ImpÜtE¼Ü
("Missšg commªd %s" % 
d•’d’û
)

38 
def
 
	$g‘_u£r_dœ
(
key
):

40 
h‰p
:

41 - 
XDG_DESKTOP_DIR


42 - 
XDG_DOWNLOAD_DIR


43 - 
XDG_TEMPLATES_DIR


44 - 
XDG_PUBLICSHARE_DIR


45 - 
XDG_DOCUMENTS_DIR


46 - 
XDG_MUSIC_DIR


47 - 
XDG_PICTURES_DIR


48 - 
XDG_VIDEOS_DIR


50 
Tak’
 
äom
 
FrÚtBršg”


51 (
di¡ribu‹d
 
und”
 
the
 
GNU
 
GPL
 
v3
 
liûn£
),

52 
cou¹esy
 
of
 
J—n
-
F¿n
Ã§
ois
 
FÜtš
 
Tam
.

54 
u£r_dœs_dœs
 = 
os
.
·th
.
	`još
(
xdg_cÚfig_home
, "user-dirs.dirs")

55 
u£r_dœs_dœs
 = 
os
.
·th
.
	$ex·ndu£r
(
u£r_dœs_dœs
)

56 
nÙ
 
os
.
·th
.
	$exi¡s
(
u£r_dœs_dœs
):

58 
lše
 
š
 
	`İ’
(
u£r_dœs_dœs
, "r"):

59 
lše
.
	$¡¬tsw™h
(
key
):

60  
os
.
·th
.
	`ex·ndv¬s
(
lše
[
	`Ën
(
key
) + 2:-2])

63 
def
 
	$g‘_desktİ_dœ
():

66 
If
 
XDG
 
is
 
nÙ
 
£tup
 
cÜeùly
, 
u£
 
home
 
dœeùÜy
 
š¡—d
 """

67 
desktİ_dœ
 = 
	`g‘_u£r_dœ
("XDG_DESKTOP_DIR")

68 
desktİ_dœ
 
is
 
nÙ
 
NÚe
 
ªd
 
os
.
·th
.
	$exi¡s
(
desktİ_dœ
):

69  
desktİ_dœ


71  
os
.
·th
.
	`ex·ndu£r
('~')

74 
şass
 
PlugšExpÜt
:

77 #AÎow 
š™iz©iÚ
 
outside
 
	`__š™__
(è
ªd
 
dÚ
't complain

78 #abouˆ
too
 
mªy
 
©Œibu‹s


80 
PLUGIN_NAME
 = "export"

82 
DEFAULT_PREFERENCES
 = {

83 "m’u_’Œy": 
True
,

84 "toŞb¬_’Œy": 
True
,

85 "Ï¡_‹m¶©e": 
NÚe
,

86 
	}
}

88 
def
 
	$__š™__
(
£lf
):

89 
£lf
.
f’ame
 = 
NÚe


90 
£lf
.
‹m¶©e
 = 
NÚe


92 
def
 
	$aùiv©e
(
£lf
, 
¶ugš_­i
):

94 
£lf
.
¶ugš_­i
 =…lugin_api

95 
£lf
.
	$_š™_gtk
()

96 
£lf
.
	$_´eã»nûs_lßd
()

97 
£lf
.
	$_´eã»nûs_­¶y
()

99 
def
 
	$d—ùiv©e
(
£lf
, 
¶ugš_­i
):

101 
£lf
.
	$_gtk_d—ùiv©e
()

103 ## 
CALLBACK
 
AND
 
CORE
 
FUNCTIONS
 ################################################

104 
def
 
	$Ú_expÜt_¡¬t
(
£lf
, 
§všg
):

106 
If
 
§všg
 =ğ
True
, 
ask
 
u£r
 
wh”e
 
to
 
¡Üe
 
the
 
docum’t
. 
Oth”wi£
,

107 
İ’
 
™
 
aá”w¬ds
. """

109 
mod–
 = 
£lf
.
combo
.
	$g‘_mod–
()

110 
aùive
 = 
£lf
.
combo
.
	$g‘_aùive
()

111 
£lf
.
‹m¶©e
 = 
	$Tem¶©e
(
mod–
[
aùive
][0])

113 
sks
 = 
£lf
.
	$g‘_£Ëùed_sks
()

114 
	`Ën
(
sks
) == 0:

115 
£lf
.
	`show_”rÜ_dŸlog
(
	`_
("Noask matches your criteria. "

119 
£lf
.
f’ame
 = 
NÚe


120 
§všg
:

121 
£lf
.
f’ame
 = s–f.
	$choo£_fe
()

122 
£lf
.
f’ame
 
is
 
NÚe
:

125 
£lf
.
§ve_bu‰Ú
.
	$£t_£ns™ive
(
F®£
)

126 
£lf
.
İ’_bu‰Ú
.
	$£t_£ns™ive
(
F®£
)

128 
Œy
:

129 
£lf
.
‹m¶©e
.
	$g’”©e
(
sks
, 
£lf
.
¶ugš_­i
,

130 
£lf
.
Ú_expÜt_fšished
)

131 
exû±
 
Exû±iÚ
 
as
 
”r
:

132 
£lf
.
	`show_”rÜ_dŸlog
(

133 
	`_
("GTG could‚Ù g’”©thdocum’t: %s"è% 
”r
)

134 
¿i£


136 
def
 
	$Ú_expÜt_fšished
(
£lf
):

138 
ªd
 
hide
 
dŸlog
 """

139 
docum’t_·th
 = 
£lf
.
‹m¶©e
.
	$g‘_docum’t_·th
()

140 
docum’t_·th
:

141 
£lf
.
f’ame
:

142 
shut
.
	$cİyfe
(
docum’t_·th
, 
£lf
.
f’ame
)

144 
webbrow£r
.
	$İ’
(
docum’t_·th
)

146 
£lf
.
	`show_”rÜ_dŸlog
("Document creation failed. "

149 
£lf
.
§ve_bu‰Ú
.
	$£t_£ns™ive
(
True
)

150 
£lf
.
İ’_bu‰Ú
.
	$£t_£ns™ive
(
True
)

151 
£lf
.
expÜt_dŸlog
.
	$hide
()

153 
def
 
	$g‘_£Ëùed_sks
(
£lf
):

155 
time¥ª
 = 
NÚe


156 
»q
 = 
£lf
.
¶ugš_­i
.
	$g‘_»que¡”
()

158 
£lf
.
expÜt_®l_aùive
.
	$g‘_aùive
():

159 
Œ“Çme
 = 'active'

160 
–if
 
£lf
.
expÜt_®l_fšished
.
	$g‘_aùive
():

161 
Œ“Çme
 = 'closed'

162 
–if
 
£lf
.
expÜt_fšished_Ï¡_w“k
.
	$g‘_aùive
():

163 
Œ“Çme
 = 'closed'

164 
time¥ª
 = -7

166 
Œ“
 = 
»q
.
	$g‘_sks_Œ“
(
Çme
=
Œ“Çme
)

167 
Œ“Çme
 
nÙ
 
š
 
Œ“
.
	$li¡_­¶›d_f‹rs
():

168 
Œ“
.
	$­¶y_f‹r
(
Œ“Çme
)

170  
	$g‘_sk_w¿µ”s
(
Œ“
, 
time¥ª
)

172 ## 
GTK
 
FUNCTIONS
 ##############################################################

173 
def
 
	$_š™_gtk
(
£lf
):

175 
£lf
.
m’u_’Œy
 = 
F®£


176 
£lf
.
toŞb¬_’Œy
 = 
F®£


178 
£lf
.
m’u_™em
 = 
Gtk
.
	`M’uI‹m
(
	`_
("Exportheasks currently†isted"))

179 
£lf
.
m’u_™em
.
	`cÚÃù
('aùiv©e', s–f.
show_dŸlog
)

180 
£lf
.
m’u_™em
.
	$show
()

182 
£lf
.
tb_bu‰Ú
 = 
Gtk
.
	$ToŞBu‰Ú
(
Gtk
.
STOCK_PRINT
)

183 
£lf
.
tb_bu‰Ú
.
	`cÚÃù
('şicked', s–f.
show_dŸlog
)

184 
£lf
.
tb_bu‰Ú
.
	$show
()

186 
bud”
 = 
Gtk
.
	$Bud”
()

187 
cur_dœ
 = 
os
.
·th
.
	`dœÇme
(os.·th.
	$ab¥©h
(
__fe__
))

188 
bud”_fe
 = 
os
.
·th
.
	`još
(
cur_dœ
, "export.ui")

189 
bud”
.
	$add_äom_fe
(
bud”_fe
)

191 
£lf
.
combo
 = 
bud”
.
	`g‘_objeù
("export_combo_templ")

192 
‹m¶©es_li¡
 = 
Gtk
.
	$Li¡StÜe
(

193 
GObjeù
.
TYPE_STRING
, GObject.TYPE_STRING, GObject.TYPE_STRING,

194 
GObjeù
.
TYPE_STRING
)

195 
£lf
.
combo
.
	$£t_mod–
(
‹m¶©es_li¡
)

196 
ûÎ
 = 
Gtk
.
	$C–lR’d””Text
()

197 
£lf
.
combo
.
	$·ck_¡¬t
(
ûÎ
, 
True
)

198 
£lf
.
combo
.
	`add_©Œibu‹
(
ûÎ
, 'text', 1)

200 
£lf
.
expÜt_dŸlog
 = 
bud”
.
	`g‘_objeù
("export_dialog")

201 
£lf
.
expÜt_image
 = 
bud”
.
	`g‘_objeù
("export_image")

202 
£lf
.
´eã»nûs_dŸlog
 = 
bud”
.
	`g‘_objeù
("preferences_dialog")

203 
£lf
.
´ef_m’u
 = 
bud”
.
	`g‘_objeù
("pref_chbox_menu")

204 
£lf
.
´ef_toŞb¬
 = 
bud”
.
	`g‘_objeù
("pref_chbox_toolbar")

205 
£lf
.
desütiÚ_Ïb–
 = 
bud”
.
	`g‘_objeù
("label_description")

206 
£lf
.
§ve_bu‰Ú
 = 
bud”
.
	`g‘_objeù
("export_btn_save")

207 
£lf
.
İ’_bu‰Ú
 = 
bud”
.
	`g‘_objeù
("export_btn_open")

209 
£lf
.
expÜt_®l_aùive
 = 
bud”
.
	`g‘_objeù
(

211 
£lf
.
expÜt_®l_aùive
.
	$£t_aùive
(
True
)

212 
£lf
.
expÜt_fšished_Ï¡_w“k
 = 
bud”
.
	`g‘_objeù
(

214 
£lf
.
expÜt_®l_fšished
 = 
bud”
.
	`g‘_objeù
(

217 
bud”
.
	`cÚÃù_sigÇls
({

219 
Ïmbda
 
widg‘
: 
£lf
.
	`Ú_expÜt_¡¬t
(
F®£
),

221 
Ïmbda
 
widg‘
: 
£lf
.
	`Ú_expÜt_¡¬t
(
True
),

223 
£lf
.
_hide_dŸlog
,

225 
£lf
.
Ú_combo_chªged
,

227 
£lf
.
Ú_´eã»nûs_ÿnûl
,

229 
£lf
.
Ú_´eã»nûs_ÿnûl
,

231 
£lf
.
Ú_´eã»nûs_ok
,

232 
	}
})

234 
def
 
	$_gtk_d—ùiv©e
(
£lf
):

236 
£lf
.
m’u_’Œy
:

237 
£lf
.
¶ugš_­i
.
	$»move_m’u_™em
(
£lf
.
m’u_™em
)

238 
£lf
.
m’u_’Œy
 = 
F®£


240 
£lf
.
toŞb¬_’Œy
:

241 
£lf
.
¶ugš_­i
.
	$»move_toŞb¬_™em
(
£lf
.
tb_bu‰Ú
)

242 
£lf
.
toŞb¬_’Œy
 = 
F®£


244 
def
 
	$show_dŸlog
(
£lf
, 
widg‘
):

246 
·»Á_wšdow
 = 
£lf
.
¶ugš_­i
.
	`g‘_ui
().
	$g‘_wšdow
()

247 
£lf
.
expÜt_dŸlog
.
	$£t_Œªs›Á_fÜ
(
·»Á_wšdow
)

248 
£lf
.
	$_upd©e_combobox
()

249 
£lf
.
expÜt_dŸlog
.
	$show_®l
()

251 
def
 
	$_hide_dŸlog
(
£lf
, 
£nd”
=
NÚe
, 
d©a
=None):

254 
£lf
.
expÜt_dŸlog
.
	$hide
()

255  
True


257 
def
 
	$_upd©e_combobox
(
£lf
):

259 
mod–
 = 
£lf
.
combo
.
	$g‘_mod–
()

260 
mod–
.
	$ş—r
()

262 
‹m¶©es
 = 
	$g‘_‹m¶©es_·ths
()

263 
aùive_’Œy
 = 
NÚe


264 
i
, 
·th
 
š
 
	$’um”©e
(
‹m¶©es
):

265 
‹m¶©e
 = 
	$Tem¶©e
(
·th
)

266 
·th
 =ğ
£lf
.
´eã»nûs
["last_template"]:

267 
aùive_’Œy
 = 
i


269 
mod–
.
	`­³nd
((
·th
,

270 
‹m¶©e
.
	`g‘_t™Ë
(),

271 
‹m¶©e
.
	`g‘_desütiÚ
(),

272 
‹m¶©e
.
	$g‘_image_·th
()))

274 #w¿°
the
 
combo
-
box
 
™
'soo†ong

275 
	`Ën
(
‹m¶©es
) > 15:

276 
£lf
.
combo
.
	$£t_w¿p_width
(5)

278 
aùive_’Œy
 
is
 
NÚe
:

279 
aùive_’Œy
 = 0

280 
£lf
.
combo
.
	$£t_aùive
(
aùive_’Œy
)

282 
def
 
	$Ú_combo_chªged
(
£lf
, 
combo
):

284 
mod–
 = 
combo
.
	$g‘_mod–
()

285 
aùive
 = 
combo
.
	$g‘_aùive
()

286 
nÙ
 0 <ğ
aùive
 < 
	$Ën
(
mod–
):

288 
desütiÚ
, 
image
 = 
mod–
[
aùive
][2], model[active][3]

290 
image
:

291 
pixbuf
 = 
GdkPixbuf
.
Pixbuf
.
	$Ãw_äom_fe
(
image
)

292 
width
, 
height
 = 
£lf
.
expÜt_image
.
	$g‘_size_»que¡
()

293 
pixbuf
 =…ixbuf.
	$sÿË_sim¶e
(
width
, 
height
,

294 
GdkPixbuf
.
IÁ”pTy³
.
BILINEAR
)

295 
£lf
.
expÜt_image
.
	$£t_äom_pixbuf
(
pixbuf
)

297 
£lf
.
expÜt_image
.
	$ş—r
()

298 
£lf
.
desütiÚ_Ïb–
.
	`£t_m¬kup
("<i>%s</i>" % 
desütiÚ
)

300 #Rememb” 
the
 
Ï¡
 
£Ëùed
 
·th


301 
£lf
.
´eã»nûs
["Ï¡_‹m¶©e"] = 
mod–
[
aùive
][0]

302 
£lf
.
	$_´eã»nûs_¡Üe
()

304 
def
 
	$show_”rÜ_dŸlog
(
£lf
, 
mes§ge
):

306 
dŸlog
 = 
Gtk
.
	$Mes§geDŸlog
(

307 
·»Á
=
£lf
.
expÜt_dŸlog
,

308 
æags
=
Gtk
.
DŸlogFÏgs
.
DESTROY_WITH_PARENT
,

309 
ty³
=
Gtk
.
Mes§geTy³
.
ERROR
,

310 
bu‰Ús
=
Gtk
.
Bu‰ÚsTy³
.
OK
,

311 
mes§ge_fÜm©
=
mes§ge
)

312 
dŸlog
.
	$run
()

313 
dŸlog
.
	$de¡roy
()

315 
def
 
	$choo£_fe
(
£lf
):

317 
choo£r
 = 
Gtk
.
	`FeChoo£rDŸlog
(

318 
t™Ë
=
	`_
("Choose whereo save your†ist"),

319 
·»Á
=
£lf
.
expÜt_dŸlog
,

320 
aùiÚ
=
Gtk
.
FeChoo£rAùiÚ
.
SAVE
,

321 
bu‰Ús
=(
Gtk
.
STOCK_CANCEL
, Gtk.
Re¥Ú£Ty³
.
CANCEL
,

322 
Gtk
.
STOCK_SAVE
, Gtk.
Re¥Ú£Ty³
.
OK
))

323 
choo£r
.
	$£t_do_ov”wr™e_cÚfœm©iÚ
(
True
)

324 
choo£r
.
	$£t_deçuÉ_»¥Ú£
(
Gtk
.
Re¥Ú£Ty³
.
OK
)

325 
choo£r
.
	`£t_cu¼’t_fŞd”
(
	$g‘_desktİ_dœ
())

326 
»¥Ú£
 = 
choo£r
.
	$run
()

327 
f’ame
 = 
choo£r
.
	$g‘_f’ame
()

328 
choo£r
.
	$de¡roy
()

329 
»¥Ú£
 =ğ
Gtk
.
Re¥Ú£Ty³
.
OK
:

330  
f’ame


332  
NÚe


334 ## 
P»ã»nûs
 
m‘hods
 ########################################################

335 @
şassm‘hod


336 
def
 
	$is_cÚfigu¿bË
(
şs
):

338  
True


340 
def
 
	$cÚfigu»_dŸlog
(
£lf
, 
mªag”_dŸlog
):

342 
£lf
.
	$_´eã»nûs_lßd
()

343 
£lf
.
´eã»nûs_dŸlog
.
	$£t_Œªs›Á_fÜ
(
mªag”_dŸlog
)

344 
£lf
.
´ef_m’u
.
	`£t_aùive
(£lf.
´eã»nûs
["menu_entry"])

345 
£lf
.
´ef_toŞb¬
.
	`£t_aùive
(£lf.
´eã»nûs
["toolbar_entry"])

346 
£lf
.
´eã»nûs_dŸlog
.
	$show_®l
()

348 
def
 
	$Ú_´eã»nûs_ÿnûl
(
£lf
, 
widg‘
, 
d©a
=
NÚe
):

351 
£lf
.
´eã»nûs_dŸlog
.
	$hide
()

352  
True


354 
def
 
	$Ú_´eã»nûs_ok
(
£lf
, 
widg‘
):

356 
£lf
.
´eã»nûs
["m’u_’Œy"] = s–f.
´ef_m’u
.
	$g‘_aùive
()

357 
£lf
.
´eã»nûs
["toŞb¬_’Œy"] = s–f.
´ef_toŞb¬
.
	$g‘_aùive
()

358 
£lf
.
´eã»nûs_dŸlog
.
	$hide
()

360 
£lf
.
	$_´eã»nûs_­¶y
()

361 
£lf
.
	$_´eã»nûs_¡Üe
()

363 
def
 
	$_´eã»nûs_lßd
(
£lf
):

365 
£lf
.
´eã»nûs
 = s–f.
¶ugš_­i
.
	`lßd_cÚfigu¿tiÚ_objeù
(

366 
£lf
.
PLUGIN_NAME
, "preferences",

367 
deçuÉ_v®ues
=
£lf
.
DEFAULT_PREFERENCES
)

369 
def
 
	$_´eã»nûs_¡Üe
(
£lf
):

371 
£lf
.
¶ugš_­i
.
	`§ve_cÚfigu¿tiÚ_objeù
(

372 
£lf
.
PLUGIN_NAME
, "´eã»nûs", s–f.
´eã»nûs
)

374 
def
 
	$_´eã»nûs_­¶y
(
£lf
):

376 
£lf
.
´eã»nûs
["m’u_’Œy"] 
ªd
 
nÙ
 s–f.
m’u_’Œy
:

377 
£lf
.
¶ugš_­i
.
	$add_m’u_™em
(
£lf
.
m’u_™em
)

378 
£lf
.
m’u_’Œy
 = 
True


379 
–if
 
nÙ
 
£lf
.
´eã»nûs
["m’u_’Œy"] 
ªd
 s–f.
m’u_’Œy
:

380 
£lf
.
¶ugš_­i
.
	$»move_m’u_™em
(
£lf
.
m’u_™em
)

381 
£lf
.
m’u_’Œy
 = 
F®£


383 
£lf
.
´eã»nûs
["toŞb¬_’Œy"] 
ªd
 
nÙ
 s–f.
toŞb¬_’Œy
:

384 
£lf
.
¶ugš_­i
.
	$add_toŞb¬_™em
(
£lf
.
tb_bu‰Ú
)

385 
£lf
.
toŞb¬_’Œy
 = 
True


386 
–if
 
nÙ
 
£lf
.
´eã»nûs
["toŞb¬_’Œy"] 
ªd
 s–f.
toŞb¬_’Œy
:

387 
£lf
.
¶ugš_­i
.
	$»move_toŞb¬_™em
(
£lf
.
tb_bu‰Ú
)

388 
£lf
.
toŞb¬_’Œy
 = 
F®£


	@plugins/export/export_templates/description_pocketmod.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2010 - 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
GTG
 
impÜt
 
_


15 
	gt™Ë
 = 
_
("Foldable booklet (PDF)")

16 
desütiÚ
 = 
_
("""Aemplateo create

17 <
a
 
h»f
="h‰p://www.pock‘mod.com">
Pock‘Mod
</a>, 
which
 
is
‡ 
sm®l
 
fŞdabË


18 
bookËt
. 
Packages
 <
b
>
pdæ©ex
</b>, <b>
pdák
</b> 
ªd
 <b>
pdfjam
</b>

19 
¬e
 
»quœed
.""")

	@plugins/export/export_templates/description_sexy.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2010 - 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
GTG
 
impÜt
 
_


15 
	gt™Ë
 = 
_
("A…rofessional-looking HTML…age")

16 
desütiÚ
 = 
_
("Aemplateo create‡ HTML…age with someasks‡ndags."

	@plugins/export/export_templates/description_simple.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2010 - 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
GTG
 
impÜt
 
_


15 
	gt™Ë
 = 
_
("A simple Web…agehat can beƒasily…rinted.")

16 
desütiÚ
 = 
_
("Aemplateo create‡ simple HTML…age with someasks "

	@plugins/export/export_templates/description_statusrpt.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2010 - 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
GTG
 
impÜt
 
_


15 
	gt™Ë
 = 
_
("Status„eport")

16 
desütiÚ
 = 
_
("Aemplateo create‡ compactext file†isting onlyask "

	@plugins/export/export_templates/description_textual.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2010 - 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

16 
äom
 
GTG
 
impÜt
 
_


18 
	gt™Ë
 = 
_
("Text-only")

19 
desütiÚ
 = 
_
("Aemplateo create‡ simpleext file with someasks.")

	@plugins/export/task_str.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

3 #2012 - 
IzidÜ
 
M©u
Å¡
ov
 <
izidÜ
.
m©usov
@
gma
.
com
>

4 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


5 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


6 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


8 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


9 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


10 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


12 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


13 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
şass
 
	$TaskSŒ
(
objeù
):

20 
It
 
´ovides
 
acûss
 
to
 
the
 
sk
 
v¬ious
 
©Œibu‹s
 
dœeùly
 
vŸ
 
pythÚ


21 
©Œibu‹s
 
š¡—d
 
of
 
m‘hod
 
ÿÎs
 
ªd
 
makes
 
wr™šg
 
Ch“h


22 
‹m¶©es
 
—s›r
. """

23 #IgnÜ
big
 
numb”
 
of
 
´İ”t›s
 
ªd
 
sm®l
‚umb” oà
public
 
m‘hods


25 
def
 
	$__š™__
(
£lf
, 
sk
, 
subsks
):

26 
£lf
.
t™Ë
 = 
sk
.
	$g‘_t™Ë
()

27 
£lf
.
‹xt
 = 
	`¡r
(
sk
.
	$g‘_‹xt
())

28 
£lf
.
¡©us
 = 
sk
.
	$g‘_¡©us
()

29 
£lf
.
modif›d
 = 
	`¡r
(
sk
.
	$g‘_modif›d_¡ršg
())

30 
£lf
.
due_d©e
 = 
	`¡r
(
sk
.
	$g‘_due_d©e
())

31 
£lf
.
şo£d_d©e
 = 
	`¡r
(
sk
.
	$g‘_şo£d_d©e
())

32 
£lf
.
¡¬t_d©e
 = 
	`¡r
(
sk
.
	$g‘_¡¬t_d©e
())

33 
£lf
.
days_Ëá
 = 
	`¡r
(
sk
.
	$g‘_days_Ëá
())

34 
£lf
.
gs
 = [
t
.
	$g‘_id
(è
t
 
š
 
sk
.
	`g‘_gs
()]

36 
£lf
.
subsks
 = subtasks

38 
has_t™Ë
 = 
	`´İ”ty
(
Ïmbda
 
s
: s.
t™Ë
 != "")

39 
has_‹xt
 = 
	`´İ”ty
(
Ïmbda
 
s
: s.
‹xt
 != "")

40 
has_subsks
 = 
	`´İ”ty
(
Ïmbda
 
s
: s.
subsks
 != [])

41 
has_¡©us
 = 
	`´İ”ty
(
Ïmbda
 
s
: s.
¡©us
 != "")

42 
has_modif›d
 = 
	`´İ”ty
(
Ïmbda
 
s
: s.
modif›d
 != "")

43 
has_due_d©e
 = 
	`´İ”ty
(
Ïmbda
 
s
: s.
due_d©e
 != "")

44 
has_şo£d_d©e
 = 
	`´İ”ty
(
Ïmbda
 
s
: s.
şo£d_d©e
 != "")

45 
has_¡¬t_d©e
 = 
	`´İ”ty
(
Ïmbda
 
s
: s.
¡¬t_d©e
 != "")

46 
has_days_Ëá
 = 
	`´İ”ty
(
Ïmbda
 
s
: s.
days_Ëá
 != "")

47 
has_gs
 = 
	`´İ”ty
(
Ïmbda
 
s
: s.
gs
 != [])

50 
def
 
	$g‘_sk_w¿µ”s
(
Œ“
, 
days
=
NÚe
, 
sk_id
=None):

52 
cÚv”t
 
them
 
što
 
TaskSŒ


54 
Œ“
 -»
of
 
sks


55 
days
 - 
f‹r
 day 
š
 
û¹aš
 
time¥ª


56 
sk_id
 -  
subsks
 
of
 
this
 
sks
. 
If
 
nÙ
 
£t
, 
u£
 
roÙ
 
node
 """

58 
def
 
	$_is_š_time¥ª
(
sk
):

60 
If
 
days
 < 0, 
»tuºs
 
True
 
the
 
sk
 
has
 
b“n
 
dÚe
 
š
h
Ï¡


61 #abs(
days
).

62 
If
 
days
 >ğ0, 
»tuºs
 
True
 
the
 
sk
 
is
 
due
 
š
h
Ãxt
 #days """

63 
days
 
is
 
NÚe
:

64  
True


65 
–if
 
days
 < 0:

66 
dÚe
 = 
sk
.
	`g‘_¡©us
(è=ğsk.
STA_DONE


67 
şo£d_d©e
 = 
sk
.
	$g‘_şo£d_d©e
()

68  
dÚe
 
ªd
 
şo£d_d©e
‡nd clo£d_d©e.
	`days_Ëá
(è>ğ
days


70  
sk
.
	`g‘_days_Ëá
(è<ğ
days


72 
subsks
 = []

73 
sub_id
 
š
 
Œ“
.
	$node_®l_chd»n
(
sk_id
):

74 
subsk
 = 
	$g‘_sk_w¿µ”s
(
Œ“
, 
days
, 
sub_id
)

75 
subsk
 
is
 
nÙ
 
NÚe
:

76 
subsks
.
	$­³nd
(
subsk
)

78 
sk_id
 
is
 
NÚe
:

79  
subsks


81 
sk
 = 
Œ“
.
	$g‘_node
(
sk_id
)

82 
sk
 
is
 
NÚe
 
Ü
 
nÙ
 
	$_is_š_time¥ª
(
sk
):

83  
NÚe


85  
	`TaskSŒ
(
sk
, 
subsks
)

	@plugins/export/templates.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2010 - 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

3 #2012 - 
IzidÜ
 
M©u
Å¡
ov
 <
izidÜ
.
m©usov
@
gma
.
com
>

4 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


5 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


6 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


8 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


9 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


10 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


12 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


13 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
glob
 
impÜt
 glob

18 
impÜt
 
	gos
.
·th


19 
impÜt
 
sub´oûss


20 
impÜt
 
sys


21 
impÜt
 
‹mpfe


22 
impÜt
 
th»adšg


24 
äom
 
	gCh“h
.
Tem¶©e
 
impÜt
 Tem¶©
as
 
Ch“hTem¶©e


25 
äom
 
	gxdg
.
Ba£DœeùÜy
 
impÜt
 
xdg_cÚfig_home


26 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
GObjeù


28 
	gTEMPLATE_PATHS
 = [

29 
os
.
·th
.
još
(
xdg_cÚfig_home
, "gtg/plugins/export/export_templates"),

30 
os
.
·th
.
još
(

31 
os
.
·th
.
dœÇme
(os.·th.
ab¥©h
(
__fe__
)), "export_templates"),

35 
def
 
	$g‘_‹m¶©es_·ths
():

37 
avaabË
 
‹m¶©es
. """

38 
‹m¶©e_li¡
 = []

39 
a_dœ
 
š
 
TEMPLATE_PATHS
:

40 
‹m¶©e_li¡
 +ğ
	`glob
(
os
.
·th
.
	`još
(
a_dœ
, "template_*"))

41  
‹m¶©e_li¡


44 
şass
 
Tem¶©e
:

47 
def
 
	$__š™__
(
£lf
, 
·th
):

48 
£lf
.
_‹m¶©e
 = 
·th


49 
£lf
.
_docum’t_·th
 = 
NÚe


51 
£lf
.
_image_·th
 = s–f.
	`_fšd_fe
("thumbnail_")

52 
£lf
.
_süt_·th
 = s–f.
	`_fšd_fe
("script_")

54 
£lf
.
_t™Ë
, s–f.
_desütiÚ
 = s–f.
	$_lßd_desütiÚ
()

56 
def
 
	`_fšd_fe
(
£lf
, 
´efix
, 
suffix
=""):

58 
ba£Çme
 = 
os
.
·th
.
	$ba£Çme
(
£lf
.
_‹m¶©e
)

59 
ba£Çme
 = ba£Çme.
	`»¶aû
("‹m¶©e_", 
´efix
)

60 
·th
 = 
os
.·th.
	`još
(os.·th.
	`dœÇme
(
£lf
.
_‹m¶©e
), 
ba£Çme
)

61 
·th
 = 
os
.·th.
	`¥l™ext
Õ©h)[0] + '*' + 
suffix


62 
possibË_fËs
 = 
	$glob
(
·th
)

63 
	`Ën
(
possibË_fËs
) > 0:

64  
possibË_fËs
[0]

66  
NÚe


68 
def
 
	$_lßd_desütiÚ
(
£lf
):

70 
‹m¶©e
 
desütiÚ
 
¬e
 
¡Üed
 
š
 
pythÚ
 
moduË
 
—s›r
 
l10n
.

71 
thus
, 
we
 
Ãed
 
to
 
impÜt
 
the
 
moduË
 
giv’
 
™s
 
·th
 """

72 
·th
 = 
£lf
.
	`_fšd_fe
("description_", ".py")

73 
nÙ
 
·th
:

75 
dœ_·th
 = 
os
.
·th
.
	$dœÇme
(
·th
)

76 
dœ_·th
 
nÙ
 
š
 
sys
.
·th
:

77 
sys
.
·th
.
	$­³nd
(
dœ_·th
)

78 
moduË_Çme
 = 
os
.
·th
.
	`ba£Çme
Õ©h).
	`»¶aû
(".py", "")

79 
Œy
:

80 
moduË
 = 
	`__impÜt__
(
moduË_Çme
, 
	`glob®s
(), 
	`loÿls
(),

82  
moduË
.
t™Ë
, moduË.
desütiÚ


83 
	$exû±
 (
ImpÜtE¼Ü
, 
A‰ribu‹E¼Ü
):

86 
def
 
	$_g‘_suffix
(
£lf
):

88  
os
.
·th
.
	`¥l™ext
(
£lf
.
_‹m¶©e
)[1]

90 
def
 
	$g‘_·th
(
£lf
):

92  
£lf
.
_‹m¶©e


94 
def
 
	$g‘_image_·th
(
£lf
):

96  
£lf
.
_image_·th


98 
def
 
	$g‘_t™Ë
(
£lf
):

100  
£lf
.
_t™Ë


102 
def
 
	$g‘_desütiÚ
(
£lf
):

104  
£lf
.
_desütiÚ


106 
def
 
	$g‘_docum’t_·th
(
£lf
):

108 
R‘uº
 
NÚe
 
uÁ
 
	$g’”©e
(è
was
 
sucûssful
."""

109  
£lf
.
_docum’t_·th


111 
def
 
	$g’”©e
(
£lf
, 
sks
, 
¶ugš_­i
, 
ÿÎback
):

114 
C»©ed
 
fes
 
¬e
 
§ved
 
w™h
 
the
 
§me
 
suffix
 
as
h
‹m¶©e
. 
O³nšg


115 
the
 
fš®
 
fe
 
d‘”mšes
 
™s
 
ty³
 
ba£d
 
Ú
 
suffix
. """

116 
docum’t
 = 
	`Ch“hTem¶©e
(
fe
=
£lf
.
	`g‘_·th
(),

117 
£¬chLi¡
=[{'sks': 
sks
,

118 '¶ugš_­i': 
¶ugš_­i
}])

120 
suffix
 = ".%s" % 
£lf
.
	$_g‘_suffix
()

121 
ouut
 = 
‹mpfe
.
	$NamedTempÜ¬yFe
(
suffix
=suffix, 
d–‘e
=
F®£
)

122 
ouut
.
	`wr™e
(
	$¡r
(
docum’t
))

123 
£lf
.
_docum’t_·th
 = 
ouut
.
Çme


124 
ouut
.
	$şo£
()

126 
£lf
.
_süt_·th
:

127 
£lf
.
	$_run_süt
(
ÿÎback
)

129 
	$ÿÎback
()

131 
def
 
	$_run_süt
(
£lf
, 
ÿÎback
):

133 
the
 
»suÉ
. """

134 
docum’t_»ady
 = 
th»adšg
.
	$Ev’t
()

136 
def
 
	$süt
():

139 
The
 
süt
 
g‘s
 
·th
 
to
 
a
 
docum’t
 
as
 
™
 
Úly
 
¬gum’t
 
ªd


140 
this
 
th»ad
 
ex³ùs
 
»suÉšg
 
fe
 
as
 
the
 
Úly
 
ouut
 
of


141 
the
 
süt
. """

143 
w™h
 
	`İ’
(
£lf
.
_süt_·th
, 'r'è
as
 
süt_fe
:

144 
fœ¡_lše
 = 
süt_fe
.
	`»adlše
().
	$¡r
()

145 
fœ¡_lše
.
	`¡¬tsw™h
('#!'):

146 
cmd
 = [
fœ¡_lše
[2:], 
£lf
.
_süt_·th
,

147 
£lf
.
_docum’t_·th
]

149 
cmd
 = 
NÚe


151 
£lf
.
_docum’t_·th
 = 
NÚe


153 
cmd
 
is
 
nÙ
 
NÚe
:

154 
Œy
:

155 
£lf
.
_docum’t_·th
 = 
sub´oûss
.
	`Pİ’
(

156 
¬gs
=
cmd
, 
sh–l
=
F®£
,

157 
¡dout
=
sub´oûss
.
PIPE
).
	`communiÿ‹
()[0]

158 
exû±
 
Exû±iÚ
:

159 
·ss


161 
£lf
.
_docum’t_·th
 
ªd
 
nÙ
 
os
.
·th
.
	$exi¡s
(
£lf
.
_docum’t_·th
):

162 
£lf
.
_docum’t_·th
 = 
NÚe


163 
docum’t_»ady
.
	$£t
()

165 
def
 
	$wa™_fÜ_docum’t
():

167 
docum’t_»ady
.
	$wa™
()

168 
GObjeù
.
	$idË_add
(
ÿÎback
)

170 
th»adšg
.
	`Th»ad
(
rg‘
=
süt
).
	$¡¬t
()

171 
th»adšg
.
	`Th»ad
(
rg‘
=
wa™_fÜ_docum’t
).
	`¡¬t
()

	@plugins/geolocalized_tasks/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Paulo
 
Cabido
 <
·ulo
.
ÿbido
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
	gGTG
.
	g¶ugšs
.
	ggeŞoÿlized_sks
.
geŞoÿlized_sks
 
impÜt
 
	ggeŞoÿlizedTasks


17 #suµ»s 
pyæakes
 
w¬nšg
 (
giv’
 
by
 
make
 
lšt
)

18 
F®£
 
is
 
	gTrue
:

19 
geŞoÿlizedTasks
()

	@plugins/geolocalized_tasks/geolocalized_tasks.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Paulo
 
Cabido
 <
·ulo
.
ÿbido
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
	gGtk
, 
	gGdkPixbuf
, 
GtkClu‰”


15 
impÜt
 
os


17 
impÜt
 
Geoşue


19 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Clu‰”


20 
impÜt
 
cham¶aš


22 
äom
 
	gGTG
.
	g¶ugšs
.
	ggeŞoÿlized_sks
.
m¬k”
 
impÜt
 
	gM¬k”Lay”


24 #A‰’tiÚ!!! 
FIXME


25 #FIXME 
Duršg
 
pÜtšg
 
GTG
 
što
 
GTK3
/
PyGObjeù
 
was
 
geŞoÿlized
.
gÏde
 
cÚv”‹d


26 #tØ
GtkBud”
 
fÜm©
 
tog‘h”
 
w™h
 
Ùh”
 
gÏde
 
XMLs
.

27 #FIXME 
Sšû
 
this
 
¶ugš
 
is
 
brok’
, 
I
 
am
 
nÙ
 
gošg
 
to
 
»¶aû
 
g®de
 
m’tiÚs


28 #tØ
GtkBud”
, 
™
's your job ;)

31 
şass
 
	ggeŞoÿlizedTasks
:

33 
def
 
	$__š™__
(
£lf
):

34 
£lf
.
geoşue
 = 
Geoşue
.
	$Discov”LoÿtiÚ
()

35 
£lf
.
geoşue
.
	$cÚÃù
(
£lf
.
loÿtiÚ_chªged
)

37 
£lf
.
¶ugš_·th
 = 
os
.
·th
.
	`dœÇme
(os.·th.
	$ab¥©h
(
__fe__
))

38 
£lf
.
gÏde_fe
 = 
os
.
·th
.
	`još
(£lf.
¶ugš_·th
, "geolocalized.ui")

40 #th
´eã»nû
 
m’u
 
the
 
¶ugš


41 
£lf
.
m’u_™em
 = 
Gtk
.
	`M’uI‹m
("Geolocalized-tasks Preferences")

43 
£lf
.
PROXIMITY_FACTOR
 = 5 #5 
km


44 
£lf
.
LOCATION_DETERMINATION_METHOD
 = []

45 #"
ÃtwÜk
", "
gps
", "
ûÎphÚe
"

47 
´ovid”
 
š
 
£lf
.
geoşue
.
	$g‘_avaabË_´ovid”s
():

48 
¡©us
 = 
£lf
.
geoşue
.
	`´ovid”_¡©us
(
´ovid”
['object'])

49 
´ovid”
['Çme'].
	`low”
() == "hostip":

50 
¡©us
 
š
 ["available", "acquiring"]:

51 
£lf
.
LOCATION_DETERMINATION_METHOD
.
	`­³nd
("network")

52 
–if
 
´ovid”
['Çme'].
	$low”
(è
š
 ["gpsd", "gypsy"]:

53 
¡©us
 
š
 ["available", "acquiring"]:

54 
£lf
.
LOCATION_DETERMINATION_METHOD
.
	`­³nd
("gps")

55 
–if
 
´ovid”
['Çme'].
	`low”
() == "gsmloc":

56 
¡©us
 
š
 ["available", "acquiring"]:

57 
£lf
.
LOCATION_DETERMINATION_METHOD
.
	`­³nd
("cellphone")

59 
£lf
.
loÿtiÚ_f‹r
 = []

60 
£lf
.
sk_£·¿tÜ
 = 
Gtk
.
	$S•¬©ÜToŞI‹m
()

62 
def
 
	$aùiv©e
(
£lf
, 
¶ugš_­i
):

63 
£lf
.
¶ugš_­i
 =…lugin_api

65 #toŞb¬ 
bu‰Ú
 
the
 
Ãw
 
LoÿtiÚ
 
v›w


66 #ü—‹ 
the
 
pixbuf
 
w™h
h
icÚ
 
ªd
 
™
's size.

67 #24,24 
is
 
the
 
TaskEd™Ü
'soolbar icon size

68 
image_assign_loÿtiÚ_·th
 = 
os
.
·th
.
	`još
(
£lf
.
¶ugš_·th
,

71 
pixbug_assign_loÿtiÚ
 = 
GdkPixbuf
.
Pixbuf
.
	$Ãw_äom_fe_©_size
(

72 
image_assign_loÿtiÚ_·th
, 16, 16)

74 
image_assign_loÿtiÚ
 = 
Gtk
.
	$Image
()

75 
image_assign_loÿtiÚ
.
	$£t_äom_pixbuf
(
pixbug_assign_loÿtiÚ
)

76 
image_assign_loÿtiÚ
.
	$show
()

78 #th
m’u
 
š‹m
 
the
 
g
 
cÚ‹xt


79 
£lf
.
cÚ‹xt_™em
 = 
Gtk
.
	`ImageM’uI‹m
("Assign‡†ocationohisag")

80 
£lf
.
cÚ‹xt_™em
.
	$£t_image
(
image_assign_loÿtiÚ
)

81 #TODO: 
add
 
a
 
cut
 
to
 
the
 
m’u


83 
£lf
.
cÚ‹xt_™em
.
	`cÚÃù
('activate',

84 
£lf
.
Ú_cÚ‹xtm’u_g_loÿtiÚ
, 
¶ugš_­i
)

85 
¶ugš_­i
.
	$add_m’u_gpİup
(
£lf
.
cÚ‹xt_™em
)

87 #g‘ 
the
 
u£r
 
£‰šgs
 
äom
h
cÚfig
 
fe


88 
£lf
.
cÚfig
 = 
¶ugš_­i
.
	$g‘_cÚfig
()

89 "geŞoÿlized-sks" 
š
 
£lf
.
cÚfig
.
has_key
:

90 "´oxim™y_çùÜ" 
š
 
£lf
.
cÚfig
["geolocalized-tasks"]:

91 
v®ue
 = 
£lf
.
cÚfig
["geolocalized-tasks"]["proximity_factor"]

92 
£lf
.
PROXIMITY_FACTOR
 = 
v®ue


94 "loÿtiÚ_d‘”mš©iÚ_m‘hod" 
š
\

95 
£lf
.
cÚfig
["geolocalized-tasks"]:

96 
£lf
.
LOCATION_DETERMINATION_METHOD
 =\

97 
£lf
.
cÚfig
["geolocalized-tasks"]["location_determination\
_method"]

100 
´ovid”s
 = 
£lf
.
geoşue
.
	$g‘_avaabË_´ovid”s
()

101 
´ovid”_Çme_li¡
 = []

103 
´ovid”
 
š
 
´ovid”s
:

104 
´ovid”_Çme_li¡
.
	`­³nd
(
´ovid”
['Çme'].
	$low”
())

106 #v”ify 
the
 
loÿtiÚ
 
d‘”mš©iÚ
 
m‘hod


107 
m‘hod
 
š
 
£lf
.
LOCATION_DETERMINATION_METHOD
:

108 
m‘hod
 == "network":

109 "ho¡" 
š
 
´ovid”_Çme_li¡
:

110 
´ovid”
 
š
 
´ovid”s
:

111 
´ovid”
['Çme'].
	`low”
() == "hostip":

112 
¡©us
 = 
£lf
.
geoşue
.
	`´ovid”_¡©us
(

113 
´ovid”
['object'])

114 
¡©us
 
š
 ["error", "unavailable"]:

115 "ÃtwÜk" 
š
\

116 
£lf
.
LOCATION_DETERMINATION_METHOD
:

117 
£lf
.
LOCATION_DETERMINATION_METHOD
.
	`»move
(

121 
£lf
.
LOCATION_DETERMINATION_METHOD
.
	`»move
("network")

122 
–if
 
m‘hod
 == "gps":

123 "gpsd" 
š
 
´ovid”_Çme_li¡
 
Ü
\

124 "gypsy" 
š
 
´ovid”_Çme_li¡
:

125 
´ovid”
 
š
 
´ovid”s
:

126 
´ovid”
['Çme'].
	$low”
(è
š
 ["gpsd", "gypsy"]:

127 
¡©us
 = 
£lf
.
geoşue
.
	`´ovid”_¡©us
(

128 
´ovid”
['object'])

129 
¡©us
 
š
 ["error", "unavailable"]:

130 "gps" 
š
 
£lf
.
LOCATION_DETERMINATION_METHOD
:

131 
£lf
.
LOCATION_DETERMINATION_METHOD
.
	`»move
(

135 
£lf
.
LOCATION_DETERMINATION_METHOD
.
	`»move
("gps")

136 
–if
 
m‘hod
 == "cellphone":

137 "gsmloc" 
š
 
´ovid”_Çme_li¡
:

138 
´ovid”
 
š
 
´ovid”s
:

139 
´ovid”
['Çme'].
	`low”
() == "gsmloc":

140 
¡©us
 = 
£lf
.
geoşue
.
	`´ovid”_¡©us
(

141 
´ovid”
['object'])

142 
¡©us
 
š
 ["error", "unavailable"]:

143 "ûÎphÚe" 
š
\

144 
£lf
.
LOCATION_DETERMINATION_METHOD
:

145 
£lf
.
LOCATION_DETERMINATION_METHOD
.
	`»move
(

149 
£lf
.
LOCATION_DETERMINATION_METHOD
.
	`»move
("cellphone")

151 
Œy
:

152 
	`Ën
(
£lf
.
LOCATION_DETERMINATION_METHOD
è=ğ1 
ªd
\

153 "ÃtwÜk" 
š
 
£lf
.
LOCATION_DETERMINATION_METHOD
:

154 
£lf
.
geoşue
.
	$š™
()

155 
–if
 
	`Ën
(
£lf
.
LOCATION_DETERMINATION_METHOD
è=ğ1 
ªd
\

156 "ûÎphÚe" 
š
 
£lf
.
LOCATION_DETERMINATION_METHOD
:

157 
£lf
.
geoşue
.
	`š™
(
»sourû
=(1 << 1))

158 
–if
 
	`Ën
(
£lf
.
LOCATION_DETERMINATION_METHOD
è=ğ1 
ªd
\

159 "gps" 
š
 
£lf
.
LOCATION_DETERMINATION_METHOD
:

160 
£lf
.
geoşue
.
	`š™
(
»sourû
=(1 << 2))

162 
£lf
.
geoşue
.
	`š™
(
»sourû
=((1 << 10) - 1))

163 
exû±
 
Exû±iÚ
:

164 
£lf
.
geoşue
.
	$š™
(
»sourû
=0)

166 
£lf
.
loÿtiÚ
 = s–f.
geoşue
.
	$g‘_loÿtiÚ_šfo
()

168 #»gi¡” 
the
 
f‹r
 
ÿÎback
 
m‘hod


169 
¶ugš_­i
.
	$»gi¡”_f‹r_cb
(
£lf
.
sk_loÿtiÚ_f‹r
)

171 
def
 
	$d—ùiv©e
(
£lf
, 
¶ugš_­i
):

172 
Œy
:

173 
£lf
.
cÚ‹xt_™em
:

174 
¶ugš_­i
.
	$»move_m’u_gpİup
(
£lf
.
cÚ‹xt_™em
)

175 
exû±
:

176 
·ss


178 
Œy
:

179 
£lf
.
cÚfig
:

180 
£lf
.
cÚfig
["geolocalized-tasks"] = {

181 "´oxim™y_çùÜ": 
£lf
.
PROXIMITY_FACTOR
,

183 
£lf
.
LOCATION_DETERMINATION_METHOD
,

184 
	}
}

185 
exû±
:

186 
·ss


188 #»mov
the
 
f‹rs


189 
tid
 
š
 
£lf
.
loÿtiÚ_f‹r
:

190 
¶ugš_­i
.
	$»move_sk_äom_f‹r
(
tid
)

192 #uÄegi¡” 
the
 
f‹r
 
ÿÎback


193 
¶ugš_­i
.
	$uÄegi¡”_f‹r_cb
(
£lf
.
sk_loÿtiÚ_f‹r
)

195 #»mov
the
 
toŞb¬
 
bu‰Ús


196 
¶ugš_­i
.
	$»move_sk_toŞb¬_™em
(
£lf
.
sk_£·¿tÜ
)

197 
¶ugš_­i
.
	$»move_sk_toŞb¬_™em
(
£lf
.
bŠ_£t_loÿtiÚ
)

199 
def
 
	$ÚTaskO³Ãd
(
£lf
, 
¶ugš_­i
):

200 
image_geŞoÿliz©iÚ_·th
 = 
os
.
·th
.
	`još
(
£lf
.
¶ugš_·th
,

203 
pixbuf_geŞoÿliz©iÚ
 = 
GdkPixbuf
.
Pixbuf
.
	$Ãw_äom_fe_©_size
(

204 
image_geŞoÿliz©iÚ_·th
, 24, 24)

206 #ü—‹ 
the
 
image
 
ªd
 
assocŸ‹
h
pixbuf


207 
icÚ_geŞoÿliz©iÚ
 = 
Gtk
.
	$Image
()

208 
icÚ_geŞoÿliz©iÚ
.
	$£t_äom_pixbuf
(
pixbuf_geŞoÿliz©iÚ
)

209 
icÚ_geŞoÿliz©iÚ
.
	$show
()

211 #toŞb¬ 
bu‰Ú
 
the
 
loÿtiÚ_v›w


212 
bŠ_loÿtiÚ_v›w
 = 
Gtk
.
	$ToggËToŞBu‰Ú
()

213 
bŠ_loÿtiÚ_v›w
.
	$£t_icÚ_widg‘
(
icÚ_geŞoÿliz©iÚ
)

214 
bŠ_loÿtiÚ_v›w
.
	`£t_Ïb–
("Location View")

216 
£lf
.
sk_£·¿tÜ
 = 
¶ugš_­i
.
	`add_sk_toŞb¬_™em
(

217 
Gtk
.
	$S•¬©ÜToŞI‹m
())

219 
bŠ_£t_loÿtiÚ
 = 
Gtk
.
	$ToŞBu‰Ú
()

220 
bŠ_£t_loÿtiÚ
.
	$£t_icÚ_widg‘
(
icÚ_geŞoÿliz©iÚ
)

221 
bŠ_£t_loÿtiÚ
.
	`£t_Ïb–
("Set/View†ocation")

222 
bŠ_£t_loÿtiÚ
.
	`cÚÃù
('şicked', 
£lf
.
£t_sk_loÿtiÚ
, 
¶ugš_­i
)

223 
£lf
.
bŠ_£t_loÿtiÚ
 = 
¶ugš_­i
.
	$add_sk_toŞb¬_™em
(

224 
bŠ_£t_loÿtiÚ
)

226 
def
 
	$is_cÚfigu¿bË
(
£lf
):

227  
True


229 
def
 
	$cÚfigu»_dŸlog
(
£lf
, 
mªag”_dŸlog
):

230 
£lf
.
	$Ú_geŞoÿlized_´eã»nûs
()

232 
def
 
	$loÿtiÚ_chªged
(
£lf
):

233 #TODO: 
This
 
should
 
»äesh
 
the
 
sk
 
ªg
 
g
 
li¡


234 #upd©
the
 
loÿtiÚ


235 
£lf
.
loÿtiÚ
 = s–f.
geoşue
.
	$g‘_loÿtiÚ_šfo
()

236 #»£ˆ
the
 
f‹rs


237 
£lf
.
loÿtiÚ_f‹r
 = []

239 
def
 
	$sk_loÿtiÚ_f‹r
(
£lf
, 
tid
):

241 
has_loÿtiÚ
 = 
F®£


242 
sk
 = 
£lf
.
¶ugš_­i
.
	$g‘_sk
(
tid
)

243 
sk
.
	`g‘_¡©us
() == "Active":

244 
sk
.
	$is_wÜkabË
():

245 
gs
 = 
sk
.
	$g‘_gs
()

247 #check 
™
 
has
 
the
 
loÿtiÚ
 
£t


248 
g
 
š
 
gs
:

249 "loÿtiÚ" 
š
 
g
.
	$g‘_®l_©Œibu‹s
():

250 
has_loÿtiÚ
 = 
True


252 
has_loÿtiÚ
:

253 #dØ
the
 
aùu®
 
f‹r


254 
g
 
š
 
gs
:

255 
g
.
	`g‘_©Œibu‹
("location"):

256 
pos™iÚ
 = 
	`ev®
(
g
.
	`g‘_©Œibu‹
("location"))

257 
nÙ
 
£lf
.
geoşue
.
	`com·»_pos™iÚ
(

258 
pos™iÚ
[0],…osition[1],

259 (
£lf
.
PROXIMITY_FACTOR
)):

260 
£lf
.
¶ugš_­i
.
	$add_sk_to_f‹r
(
tid
)

261 
tid
 
nÙ
 
š
 
£lf
.
loÿtiÚ_f‹r
:

262 
£lf
.
loÿtiÚ_f‹r
.
	$­³nd
(
tid
)

263  
F®£


264  
True


266 #==ğ
GEOLOCALIZED
 
PREFERENCES
=============================================

267 
def
 
	$Ú_geŞoÿlized_´eã»nûs
(
£lf
):

268 
wT»e
 = 
Gtk
.
gÏde
.
	`XML
(
£lf
.
gÏde_fe
, "Preferences")

269 
dŸlog
 = 
wT»e
.
	`g‘_widg‘
("Preferences")

270 
dŸlog
.
	`cÚÃù
("»¥Ú£", 
£lf
.
´eã»nûs_şo£
)

272 
check_ÃtwÜk
 = 
wT»e
.
	`g‘_widg‘
("check_network")

273 
check_ûÎphÚe
 = 
wT»e
.
	`g‘_widg‘
("check_cellphone")

274 
check_gps
 = 
wT»e
.
	`g‘_widg‘
("check_gps")

276 
´ovid”s
 = 
£lf
.
geoşue
.
	$g‘_avaabË_´ovid”s
()

277 
´ovid”_Çme_li¡
 = []

279 
´ovid”
 
š
 
´ovid”s
:

280 
´ovid”_Çme_li¡
.
	`­³nd
(
´ovid”
['Çme'].
	$low”
())

282 "ho¡" 
nÙ
 
š
 
´ovid”_Çme_li¡
:

283 
check_ÃtwÜk
.
	$£t_aùive
(
F®£
)

284 
check_ÃtwÜk
.
	$£t_£ns™ive
(
F®£
)

286 "ÃtwÜk" 
š
 
£lf
.
LOCATION_DETERMINATION_METHOD
:

287 
´ovid”
 
š
 
´ovid”s
:

288 
¡©us
 = 
£lf
.
geoşue
.
	`´ovid”_¡©us
(
´ovid”
['object'])

289 
´ovid”
['Çme'].
	`low”
() == "hostip":

290 
¡©us
 
š
 ["available", "acquiring"]:

291 
check_ÃtwÜk
.
	$£t_aùive
(
True
)

294 
check_ÃtwÜk
.
	$£t_aùive
(
F®£
)

295 
check_ÃtwÜk
.
	$£t_£ns™ive
(
F®£
)

298 
´ovid”
 
š
 
´ovid”s
:

299 
¡©us
 = 
£lf
.
geoşue
.
	`´ovid”_¡©us
(
´ovid”
['object'])

300 
´ovid”
['Çme'].
	`low”
(è=ğ"ho¡" 
ªd
\

301 
¡©us
 
š
 ["error", "unavailable"]:

302 
check_ÃtwÜk
.
	$£t_aùive
(
F®£
)

303 
check_ÃtwÜk
.
	$£t_£ns™ive
(
F®£
)

306 "gsmloc" 
nÙ
 
š
 
´ovid”_Çme_li¡
:

307 
check_ûÎphÚe
.
	$£t_aùive
(
F®£
)

308 
check_ûÎphÚe
.
	$£t_£ns™ive
(
F®£
)

310 "ûÎphÚe" 
š
 
£lf
.
LOCATION_DETERMINATION_METHOD
:

311 
´ovid”
 
š
 
´ovid”s
:

312 
¡©us
 = 
£lf
.
geoşue
.
	`´ovid”_¡©us
(
´ovid”
['object'])

313 
´ovid”
['Çme'].
	`low”
() == "gsmloc":

314 
¡©us
 
š
 ["available", "acquiring"]:

315 
check_ûÎphÚe
.
	$£t_aùive
(
True
)

317 
check_ûÎphÚe
.
	$£t_aùive
(
F®£
)

318 
check_ûÎphÚe
.
	$£t_£ns™ive
(
F®£
)

321 
´ovid”
 
š
 
´ovid”s
:

322 
¡©us
 = 
£lf
.
geoşue
.
	`´ovid”_¡©us
(
´ovid”
['object'])

323 
´ovid”
['Çme'].
	`low”
(è=ğ"gsmloc" 
ªd
\

324 
¡©us
 
š
 ["error", "unavailable"]:

325 
check_ûÎphÚe
.
	$£t_aùive
(
F®£
)

326 
check_ûÎphÚe
.
	$£t_£ns™ive
(
F®£
)

329 #TODO: 
£·¿‹
 
gypsy
 
äom
 
gpsd


330 "gpsd" 
nÙ
 
š
 
´ovid”_Çme_li¡
:

331 "gypsy" 
nÙ
 
š
 
´ovid”_Çme_li¡
:

332 
check_gps
.
	$£t_aùive
(
F®£
)

333 
check_gps
.
	$£t_£ns™ive
(
F®£
)

335 "gps" 
š
 
£lf
.
LOCATION_DETERMINATION_METHOD
:

336 
´ovid”
 
š
 
´ovid”s
:

337 
¡©us
 = 
£lf
.
geoşue
.
	`´ovid”_¡©us
(
´ovid”
['object'])

338 
´ovid”
['Çme'].
	$low”
(è
š
 ["gpsd", "gypsy"]:

339 
¡©us
 
š
 ["available", "acquiring"]:

340 
check_gps
.
	$£t_aùive
(
True
)

342 
check_gps
.
	$£t_aùive
(
F®£
)

343 
check_gps
.
	$£t_£ns™ive
(
F®£
)

346 
´ovid”
 
š
 
´ovid”s
:

347 
¡©us
 = 
£lf
.
geoşue
.
	`´ovid”_¡©us
(
´ovid”
['object'])

348 
´ovid”
['Çme'].
	$low”
(è
š
 ["gpsd", "gypsy"] 
ªd
\

349 
¡©us
 
š
 ["error", "unavailable"]:

350 
check_gps
.
	$£t_aùive
(
F®£
)

351 
check_gps
.
	$£t_£ns™ive
(
F®£
)

354 
¥š_´oxim™yçùÜ
 = 
wT»e
.
	`g‘_widg‘
("spin_proximityfactor")

355 
¥š_´oxim™yçùÜ
.
	`£t_v®ue
((
£lf
.
PROXIMITY_FACTOR
))

356 
¥š_´oxim™yçùÜ
.
	`cÚÃù
("changed",

357 
£lf
.
¥š_´oxim™yçùÜ_chªged
)

358 
£lf
.
tmp_´oxim™yçùÜ
 = (£lf.
PROXIMITY_FACTOR
)

360 
dŸlog
.
	$show_®l
()

362 
def
 
	$¥š_´oxim™yçùÜ_chªged
(
£lf
, 
¥šbu‰Ú
):

363 
£lf
.
tmp_´oxim™yçùÜ
 = 
¥šbu‰Ú
.
	$g‘_v®ue
()

365 
def
 
	$´eã»nûs_şo£
(
£lf
, 
dŸlog
, 
»¥Ú£
=
NÚe
):

366 
»¥Ú£
 =ğ
Gtk
.
Re¥Ú£Ty³
.
OK
:

367 
£lf
.
PROXIMITY_FACTOR
 = (£lf.
tmp_´oxim™yçùÜ
)

368 
dŸlog
.
	$de¡roy
()

370 
dŸlog
.
	$de¡roy
()

372 #==ğ
GEOLOCALIZED
 
PREFERENCES
==============================================

374 #==ğ
SET
 
TASK
 
LOCATION
 ====================================================

375 
def
 
	$£t_sk_loÿtiÚ
(
£lf
, 
widg‘
, 
¶ugš_­i
, 
loÿtiÚ
=
NÚe
):

376 
wT»e
 = 
Gtk
.
gÏde
.
	`XML
(
£lf
.
gÏde_fe
, "SetTaskLocation")

377 
dŸlog
 = 
wT»e
.
	`g‘_widg‘
("SetTaskLocation")

378 
¶ugš_­i
.
	$£t_·»Á_wšdow
(
dŸlog
)

380 
bŠ_zoom_š
 = 
wT»e
.
	`g‘_widg‘
("btn_zoom_in")

381 
bŠ_zoom_out
 = 
wT»e
.
	`g‘_widg‘
("btn_zoom_out")

383 
dŸlog_aùiÚ_¬—_bŠ
 = 
wT»e
.
	`g‘_widg‘
("dialog_action_area_btn")

384 
bŠ_ok
 = 
wT»e
.
	`g‘_widg‘
("btn_ok")

385 
bŠ_ÿnûl
 = 
wT»e
.
	`g‘_widg‘
("btn_cancel")

386 
bŠ_şo£
 = 
wT»e
.
	`g‘_widg‘
("btn_close")

388 
£lf
.
¿diobu‰Ú1
 = 
wT»e
.
	`g‘_widg‘
("radiobutton1")

389 
£lf
.
¿diobu‰Ú2
 = 
wT»e
.
	`g‘_widg‘
("radiobutton2")

390 
£lf
.
txt_Ãw_g
 = 
wT»e
.
	`g‘_widg‘
("txt_new_tag")

391 
£lf
.
cmb_exi¡šg_g
 = 
wT»e
.
	`g‘_widg‘
("cmb_existing_tag")

393 
b–a
 = 
wT»e
.
	`g‘_widg‘
("tabela_set_task")

395 
vbox_m­
 = 
wT»e
.
	`g‘_widg‘
("vbox_map")

396 
vbox_İt
 = 
wT»e
.
	`g‘_widg‘
("vbox_opt")

398 
cham¶aš_v›w
 = 
cham¶aš
.
	$V›w
()

399 
cham¶aš_v›w
.
	`£t_´İ”ty
("scroll-mode",

400 
cham¶aš
.
SCROLL_MODE_KINETIC
)

401 #cham¶aš_v›w.
	`£t_´İ”ty
("zoom-Ú-doubË-şick", 
F®£
)

403 #ü—‹ 
a
 
li¡
 
of
 
the
 
gs
 
ªd
 
theœ
 
©Œibu‹s


404 
g_li¡
 = []

405 
g
 
š
 
¶ugš_­i
.
	$g‘_gs
():

406 
tmp_g
 = {
	}
}

407 
©Œ
 
š
 
g
.
	$g‘_®l_©Œibu‹s
():

408 
©Œ
 == "color":

409 
cŞÜ
 = 
£lf
.
	`HTMLCŞÜToRGB
(
g
.
	$g‘_©Œibu‹
(
©Œ
))

410 
tmp_g
[
©Œ
] = 
cŞÜ


411 
tmp_g
['has_color'] = "yes"

412 
–if
 
©Œ
 == "location":

413 
tmp_g
[
©Œ
] = 
	`ev®
(
g
.
	$g‘_©Œibu‹
(
©Œ
))

415 
tmp_g
[
©Œ
] = 
g
.
	$g‘_©Œibu‹
(
©Œ
)

416 
g_li¡
.
	$­³nd
(
tmp_g
)

418 #check 
th”e
 
is
 
Úe
 
g
 
w™h
 
a
 
loÿtiÚ


419 
sk_has_loÿtiÚ
 = 
F®£


420 
g
 
š
 
g_li¡
:

421 
key
, 
™em
 
š
 
	`li¡
(
g
.
	$™ems
()):

422 
key
 == "location":

423 
sk_has_loÿtiÚ
 = 
True


426 #£ˆ
the
 
m¬k”s


427 
Ïy”
 = 
	$M¬k”Lay”
()

429 
£lf
.
m¬k”_li¡
 = []

430 
sk_has_loÿtiÚ
:

431 
g
 
š
 
g_li¡
:

432 
key
, 
™em
 
š
 
	`li¡
(
g
.
	$™ems
()):

433 
key
 == "location":

434 
cŞÜ
 = 
NÚe


435 
Œy
:

436 
g
['has_color'] == "yes":

437 
cŞÜ
 = 
g
['color']

438 
exû±
:

439 #PROBLEM: 
the
 
g
 
dÛ¢
't have color

440 #Possib™y, 
u£
 
a
 
cŞÜ
 
äom
 
ªÙh”
 
g


441 
·ss


443 
£lf
.
m¬k”_li¡
.
	`­³nd
(
Ïy”
.
	`add_m¬k”
(

444 
¶ugš_­i
.
	`g‘_sk_t™Ë
(), 
g
['location'][0],

445 
g
['loÿtiÚ'][1], 
cŞÜ
))

447 
Œy
:

448 
£lf
.
loÿtiÚ
['lÚg™ude'] 
ªd
 self.location['latitude']:

449 
£lf
.
m¬k”_li¡
.
	`­³nd
(
Ïy”
.
	`add_m¬k”
(

450 
¶ugš_­i
.
	`g‘_sk_t™Ë
(),

451 
£lf
.
loÿtiÚ
['latitude'],

452 
£lf
.
loÿtiÚ
['longitude']))

453 
exû±
:

454 
£lf
.
m¬k”_li¡
.
	`­³nd
(
Ïy”
.
	`add_m¬k”
(

455 
¶ugš_­i
.
	`g‘_sk_t™Ë
(), 
NÚe
, None))

457 
cham¶aš_v›w
.
	$add_Ïy”
(
Ïy”
)

459 
embed
 = 
GtkClu‰”
.
	$Embed
()

460 
embed
.
	$£t_size_»que¡
(400, 300)

462 
nÙ
 
sk_has_loÿtiÚ
:

463 #m‘hod 
th©
 
wl
 
chªge
 
the
 
m¬k”
's…osition

464 
cham¶aš_v›w
.
	$£t_»aùive
(
True
)

465 
cham¶aš_v›w
.
	`cÚÃù
("button-release-event",

466 
£lf
.
cham¶aš_chªge_m¬k”
,

467 
cham¶aš_v›w
)

469 
Ïy”
.
	$show_®l
()

471 
sk_has_loÿtiÚ
:

472 
cham¶aš_v›w
.
	`£t_´İ”ty
("zoom-level", 9)

473 
–if
 
£lf
.
loÿtiÚ
:

474 
cham¶aš_v›w
.
	`£t_´İ”ty
("zoom-level", 5)

476 
cham¶aš_v›w
.
	`£t_´İ”ty
("zoom-level", 1)

478 
vbox_m­
.
	$add
(
embed
)

480 
embed
.
	$»®ize
()

481 
¡age
 = 
embed
.
	$g‘_¡age
()

482 
cham¶aš_v›w
.
	$£t_size
(400, 300)

483 
¡age
.
	$add
(
cham¶aš_v›w
)

485 #cÚÃù 
the
 
toŞb¬
 
bu‰Ús
 
zoom


486 
bŠ_zoom_š
.
	`cÚÃù
("şicked", 
£lf
.
zoom_š
, 
cham¶aš_v›w
)

487 
bŠ_zoom_out
.
	`cÚÃù
("şicked", 
£lf
.
zoom_out
, 
cham¶aš_v›w
)

489 
sk_has_loÿtiÚ
:

490 
dŸlog_aùiÚ_¬—_bŠ
.
	$»move
(
bŠ_ok
)

491 
dŸlog_aùiÚ_¬—_bŠ
.
	$»move
(
bŠ_ÿnûl
)

492 
dŸlog
.
	`cÚÃù
("»¥Ú£", 
£lf
.
sk_loÿtiÚ_şo£
)

494 
dŸlog_aùiÚ_¬—_bŠ
.
	$»move
(
bŠ_şo£
)

495 #show 
a
 
şo£
 
bu‰Ú
 
Ü
 
the
 
ok
/
ÿnûl


496 
dŸlog
.
	`cÚÃù
("»¥Ú£", 
£lf
.
£t_sk_loÿtiÚ_şo£
,

497 
¶ugš_­i
)

499 #ià
th”e
 
is
 
no
 
loÿtiÚ
 
£t
, 
we
 
wªt
 
to
 s‘ 
™


500 
nÙ
 
sk_has_loÿtiÚ
:

501 
£lf
.
loÿtiÚ_defšed
 = 
F®£


502 
	`Ën
(
¶ugš_­i
.
	`g‘_gs
()) > 0:

503 
li¡¡Üe
 = 
Gtk
.
	$Li¡StÜe
(
¡r
)

504 
£lf
.
cmb_exi¡šg_g
.
	$£t_mod–
(
li¡¡Üe
)

505 
g
 
š
 
¶ugš_­i
.
	$g‘_gs
():

506 
li¡¡Üe
.
	`­³nd
([
g
.
	`g‘_©Œibu‹
("name")])

507 
£lf
.
cmb_exi¡šg_g
.
	$£t_‹xt_cŞumn
(0)

508 
£lf
.
cmb_exi¡šg_g
.
	$£t_aùive
(0)

510 #»mov
¿diobu‰Ú2
 
ªd
 
the
 
combobox’Œy


511 
b–a
.
	$»move
(
£lf
.
¿diobu‰Ú1
)

512 
b–a
.
	$»move
(
£lf
.
¿diobu‰Ú2
)

513 
b–a
.
	$»move
(
£lf
.
cmb_exi¡šg_g
)

514 
Ïb–
 = 
Gtk
.
	$Lab–
()

515 
Ïb–
.
	`£t_‹xt
("Associate with‚ewag: ")

516 
b–a
.
	$©ch
(
Ïb–
, 0, 1, 0, 1)

517 
Ïb–
.
	$show
()

519 
£lf
.
loÿtiÚ_defšed
 = 
True


520 
vbox_İt
.
	$»move
(
b–a
)

521 
dŸlog
.
	`£t_t™Ë
("Viewheask's†ocation")

523 
dŸlog
.
	$show_®l
()

525 
sk_has_loÿtiÚ
:

526 
cham¶aš_v›w
.
	`ûÁ”_Ú
(

527 
£lf
.
m¬k”_li¡
[0].
	`g‘_´İ”ty
('latitude'),

528 
£lf
.
m¬k”_li¡
[0].
	`g‘_´İ”ty
('longitude'))

530 
Œy
:

531 
£lf
.
loÿtiÚ
['lÚg™ude'] 
ªd
 self.location['latitude']:

532 
cham¶aš_v›w
.
	`ûÁ”_Ú
(
£lf
.
loÿtiÚ
['latitude'],

533 
£lf
.
loÿtiÚ
['longitude'])

534 
exû±
:

535 
·ss


537 
def
 
	$sk_loÿtiÚ_şo£
(
£lf
, 
dŸlog
, 
»¥Ú£
=
NÚe
):

538 
dŸlog
.
	$de¡roy
()

540 
def
 
	$£t_sk_loÿtiÚ_şo£
(
£lf
, 
dŸlog
, 
»¥Ú£
=
NÚe
, 
¶ugš_­i
=None):

541 
»¥Ú£
 =ğ
Gtk
.
Re¥Ú£Ty³
.
OK
:

543 #Œ› 
to
 
g‘
 
the
 
¿diobu‰Ús
 
v®ue
, 
w™ch
 
may
 
nÙ
 
exi¡


544 
nÙ
 
£lf
.
loÿtiÚ_defšed
:

545 
£lf
.
¿diobu‰Ú1
.
	$g‘_aùive
():

547 
£lf
.
txt_Ãw_g
.
	`g‘_‹xt
().
	`¡r
() != "":

548 
m¬k”_pos™iÚ
 = (

549 
£lf
.
m¬k”_li¡
[0].
	`g‘_´İ”ty
('latitude'),

550 
£lf
.
m¬k”_li¡
[0].
	`g‘_´İ”ty
('longitude'))

552 #beÿu£ 
u£rs
 
som‘imes
 
make
 
mi¡akes
,

554 
tmp_g
 = ""

555 
g_Çme
 = 
£lf
.
txt_Ãw_g
.
	`g‘_‹xt
().
	`»¶aû
("@",

557 
g_Çme
 = "@" +ag_name

558 
g
 
š
 
¶ugš_­i
.
	$g‘_gs
():

559 
g
.
	`g‘_©Œibu‹
("Çme"è=ğ
g_Çme
:

560 
tmp_g
 = 
g_Çme


561 
tmp_g
:

562 
¶ugš_­i
.
	`add_g_©Œibu‹
(
g_Çme
,

564 
m¬k”_pos™iÚ
)

566 
¶ugš_­i
.
	`š£¹_g
(
g_Çme
[1:])

567 
¶ugš_­i
.
	`add_g_©Œibu‹
(
g_Çme
,

569 
m¬k”_pos™iÚ
)

570 
dŸlog
.
	$de¡roy
()

572 #dÛ 
nÙhšg
, 
no
 
g
 
£t
.

573 
·ss


576 
m¬k”_pos™iÚ
 = (

577 
£lf
.
m¬k”_li¡
[0].
	`g‘_´İ”ty
('latitude'),

578 
£lf
.
m¬k”_li¡
[0].
	`g‘_´İ”ty
('longitude'))

579 
šdex
 = 
£lf
.
cmb_exi¡šg_g
.
	$g‘_aùive
()

580 
mod–
 = 
£lf
.
cmb_exi¡šg_g
.
	$g‘_mod–
()

581 
¶ugš_­i
.
	`add_g_©Œibu‹
(
mod–
[
šdex
][0],

582 "loÿtiÚ", 
m¬k”_pos™iÚ
)

583 
dŸlog
.
	$de¡roy
()

586 
dŸlog
.
	$de¡roy
()

588 
def
 
	$cham¶aš_chªge_m¬k”
(
£lf
, 
widg‘
, 
ev’t
, 
v›w
):

589 
ev’t
.
bu‰Ú
 !ğ1 
Ü
ƒv’t.
şick_couÁ
 > 1:

590  
F®£


592 (
Ït™ude
, 
lÚg™ude
èğ
v›w
.
	`g‘_coÜds_©
((
ev’t
.
x
), Óv’t.
y
))

593 
£lf
.
m¬k”_li¡
[0].
	$£t_pos™iÚ
(
Ït™ude
, 
lÚg™ude
)

595 #==ğ
SET
 
TASK
 
LOCATION
 ====================================================

597 #==ğ
TAG
 
VIEW
 
CONTEXT
 
MENU
 ================================================

598 
def
 
	$Ú_cÚ‹xtm’u_g_loÿtiÚ
(
£lf
, 
widg‘
, 
¶ugš_­i
):

599 
wT»e
 = 
Gtk
.
gÏde
.
	`XML
(
£lf
.
gÏde_fe
, "TagLocation")

600 
dŸlog
 = 
wT»e
.
	`g‘_widg‘
("TagLocation")

601 
¶ugš_­i
.
	$£t_·»Á_wšdow
(
dŸlog
)

603 
bŠ_zoom_š
 = 
wT»e
.
	`g‘_widg‘
("btn_zoom_in")

604 
bŠ_zoom_out
 = 
wT»e
.
	`g‘_widg‘
("btn_zoom_out")

605 
vbox_m­
 = 
wT»e
.
	`g‘_widg‘
("vbox_map")

607 
g
 = 
¶ugš_­i
.
	$g‘_gpİup_g
()

608 
dŸlog
.
	`£t_t™Ë
(
g
.
	`g‘_©Œibu‹
("name") + "'s Location")

610 #g‘ 
the
 
g
's†ocation

611 
Œy
:

612 
g_loÿtiÚ
 = 
	`ev®
(
g
.
	`g‘_©Œibu‹
("location"))

613 
exû±
:

614 
g_loÿtiÚ
 = 
NÚe


616 #g‘ 
the
 
g
's color

617 
Œy
:

618 
g_cŞÜ
 = 
£lf
.
	`HTMLCŞÜToRGB
(
g
.
	`g‘_©Œibu‹
("color"))

619 
exû±
:

620 
g_cŞÜ
 = 
NÚe


622 
cham¶aš_v›w
 = 
cham¶aš
.
	$V›w
()

623 
cham¶aš_v›w
.
	`£t_´İ”ty
("scroll-mode",

624 
cham¶aš
.
SCROLL_MODE_KINETIC
)

626 
Ïy”
 = 
	$M¬k”Lay”
()

628 
m¬k”_g
 = 
NÚe


629 
g_loÿtiÚ
:

630 
m¬k”_g
 = 
Ïy”
.
	`add_m¬k”
(
g
.
	`g‘_©Œibu‹
("name"),

631 
g_loÿtiÚ
[0],ag_location[1],

632 
g_cŞÜ
)

634 
Œy
:

635 
£lf
.
loÿtiÚ
['lÚg™ude'] 
ªd
 self.location['latitude']:

636 
m¬k”_g
 = 
Ïy”
.
	`add_m¬k”
(
g
.
	`g‘_©Œibu‹
("name"),

637 
£lf
.
loÿtiÚ
['latitude'],

638 
£lf
.
loÿtiÚ
['longitude'],

639 
g_cŞÜ
)

640 
exû±
:

641 
m¬k”_g
 = 
Ïy”
.
	`add_m¬k”
(
g
.
	`g‘_©Œibu‹
("name"),

642 
NÚe
, None)

644 
cham¶aš_v›w
.
	$add_Ïy”
(
Ïy”
)

646 
embed
 = 
GtkClu‰”
.
	$Embed
()

647 
embed
.
	$£t_size_»que¡
(400, 300)

649 
cham¶aš_v›w
.
	$£t_»aùive
(
True
)

650 
cham¶aš_v›w
.
	`cÚÃù
("button-release-event",

651 
£lf
.
cham¶aš__g_chªge_m¬k”
,

652 
cham¶aš_v›w
, 
m¬k”_g
)

654 
Ïy”
.
	$show_®l
()

656 
g_loÿtiÚ
:

657 
cham¶aš_v›w
.
	`£t_´İ”ty
("zoom-level", 9)

658 
–if
 
£lf
.
loÿtiÚ
:

659 
cham¶aš_v›w
.
	`£t_´İ”ty
("zoom-level", 5)

661 
cham¶aš_v›w
.
	`£t_´İ”ty
("zoom-level", 1)

663 
vbox_m­
.
	$add
(
embed
)

665 
embed
.
	$»®ize
()

666 
¡age
 = 
embed
.
	$g‘_¡age
()

667 
cham¶aš_v›w
.
	$£t_size
(400, 300)

668 
¡age
.
	$add
(
cham¶aš_v›w
)

670 #cÚÃù 
the
 
toŞb¬
 
bu‰Ús
 
zoom


671 
bŠ_zoom_š
.
	`cÚÃù
("şicked", 
£lf
.
zoom_š
, 
cham¶aš_v›w
)

672 
bŠ_zoom_out
.
	`cÚÃù
("şicked", 
£lf
.
zoom_out
, 
cham¶aš_v›w
)

673 
dŸlog
.
	`cÚÃù
("»¥Ú£", 
£lf
.
g_loÿtiÚ_şo£
, 
g
, 
m¬k”_g
)

675 
dŸlog
.
	$show_®l
()

677 
g_loÿtiÚ
:

678 
cham¶aš_v›w
.
	`ûÁ”_Ú
(

679 
m¬k”_g
.
	`g‘_´İ”ty
('latitude'),

680 
m¬k”_g
.
	`g‘_´İ”ty
('longitude'))

682 
Œy
:

683 
£lf
.
loÿtiÚ
['lÚg™ude'] 
ªd
 self.location['latitude']:

684 
cham¶aš_v›w
.
	`ûÁ”_Ú
(
£lf
.
loÿtiÚ
['latitude'],

685 
£lf
.
loÿtiÚ
['longitude'])

686 
exû±
:

687 
·ss


689 
def
 
	$cham¶aš__g_chªge_m¬k”
(
£lf
, 
widg‘
, 
ev’t
, 
v›w
, 
m¬k”
):

690 
ev’t
.
bu‰Ú
 !ğ1 
Ü
ƒv’t.
şick_couÁ
 > 1:

691  
F®£


693 (
Ït™ude
, 
lÚg™ude
èğ
v›w
.
	`g‘_coÜds_©
((
ev’t
.
x
), Óv’t.
y
))

694 
m¬k”
.
	$£t_pos™iÚ
(
Ït™ude
, 
lÚg™ude
)

696 
def
 
	$g_loÿtiÚ_şo£
(
£lf
, 
dŸlog
, 
»¥Ú£
=
NÚe
, 
g
=NÚe, 
m¬k”
=None):

697 
»¥Ú£
 =ğ
Gtk
.
Re¥Ú£Ty³
.
OK
:

698 
g_loÿtiÚ
 = 
	`¡r
((
m¬k”
.
	`g‘_´İ”ty
('latitude'),

699 
m¬k”
.
	`g‘_´İ”ty
('longitude')))

700 
g
.
	`£t_©Œibu‹
("loÿtiÚ", 
g_loÿtiÚ
)

701 
dŸlog
.
	$de¡roy
()

703 
dŸlog
.
	$de¡roy
()

705 #==ğ
TAG
 
VIEW
 
CONTEXT
 
MENU
 ================================================

706 
def
 
	$zoom_š
(
£lf
, 
widg‘
, 
v›w
):

707 
v›w
.
	$zoom_š
()

709 
def
 
	$zoom_out
(
£lf
, 
widg‘
, 
v›w
):

710 
v›w
.
	$zoom_out
()

713 #Üigš® 
by
 
Paul
 
WškËr


714 
def
 
	$HTMLCŞÜToRGB
(
£lf
, 
cŞÜ¡ršg
):

716 
cŞÜ¡ršg
 = cŞÜ¡ršg.
	$¡r
()

717 
cŞÜ¡ršg
[0] == '#':

718 
cŞÜ¡ršg
 = colorstring[1:]

719 
	`Ën
(
cŞÜ¡ršg
) != 6:

720 
¿i£
 
	`V®ueE¼Ü
(

721 "špuˆ#% i nÙ iÀ#RRGGBB fÜm©" % 
cŞÜ¡ršg
)

722 
r
, 
g
, 
b
 = 
cŞÜ¡ršg
[:2], colorstring[2:4], colorstring[4:]

723 
r
, 
g
, 
b
 = [(
n
, 16èÀ
	`š
 (r, g, b)]

724  
Clu‰”
.
	`CŞÜ
(
r
, 
g
, 
b
)

	@plugins/geolocalized_tasks/marker.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Paulo
 
Cabido
 <
·ulo
.
ÿbido
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Clu‰”


15 
impÜt
 
cham¶aš


18 
şass
 
	$M¬k”Lay”
(
cham¶aš
.
Lay”
):

20 
def
 
	$__š™__
(
£lf
):

21 
cham¶aš
.
Lay”
.
	$__š™__
(
£lf
)

22 #¨
m¬k”
 
ÿn
 
®so
 
be
 
£t
 
š
 
RGB
 
w™h
 
šts


23 
£lf
.
g¿y
 = 
Clu‰”
.
	$CŞÜ
(51, 51, 51)

26 
£lf
.
wh™e
 = 
Clu‰”
.
	$CŞÜ
(0xff, 0xff, 0xff, 0xff)

27 
£lf
.
bÏck
 = 
Clu‰”
.
	$CŞÜ
(0x00, 0x00, 0x00, 0xff)

29 
£lf
.
	$hide
()

31 
def
 
	`add_m¬k”
(
£lf
, 
‹xt
, 
Ït™ude
, 
lÚg™ude
, 
bg_cŞÜ
=
NÚe
,

32 
‹xt_cŞÜ
=
NÚe
, 
fÚt
="Airmole 8"):

33 
nÙ
 
‹xt_cŞÜ
:

34 
‹xt_cŞÜ
 = 
£lf
.
wh™e


36 
nÙ
 
bg_cŞÜ
:

37 
bg_cŞÜ
 = 
£lf
.
g¿y


39 
m¬k”
 = 
cham¶aš
.
	$m¬k”_Ãw_w™h_‹xt
(
‹xt
, 
fÚt
, 
‹xt_cŞÜ
,

40 
bg_cŞÜ
)

42 #m¬k”.
	`£t_pos™iÚ
(38.575935, -7.921326)

43 
Ït™ude
 
ªd
 
lÚg™ude
:

44 
m¬k”
.
	$£t_pos™iÚ
(
Ït™ude
, 
lÚg™ude
)

45 
£lf
.
	$add
(
m¬k”
)

46  
m¬k”


	@plugins/hamster/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Paulo
 
Cabido
 <
·ulo
.
ÿbido
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
	gGTG
.
	g¶ugšs
.
	gham¡”
.
ham¡”
 
impÜt
 
	gham¡”Plugš


17 #suµ»s 
pyæakes
 
w¬nšg
 (
giv’
 
by
 
make
 
lšt
)

18 
F®£
 
is
 
	gTrue
:

19 
ham¡”Plugš
()

	@plugins/hamster/hamster.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #Ham¡” 
Task
 
T¿ck”
 
Plugš
 
G‘tšg
 
Thšgs
 
GNOME
!

4 #Cİyrighˆ(
c
è2009 
Kevš
 
Meh®l


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
ÿËnd¬
 
impÜt
 
timegm


18 
impÜt
 
dbus


19 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
	gGtk
, 
GdkPixbuf


20 
impÜt
 
os


21 
impÜt
 
»


22 
impÜt
 
time


23 
impÜt
 
d©‘ime


25 
äom
 
GTG
 
impÜt
 
_


26 
äom
 
	gGTG
.
	gcÜe
.
sk
 
impÜt
 
Task


29 
şass
 
	gham¡”Plugš
:

30 
PLUGIN_NAMESPACE
 = 'hamster-plugin'

31 
DEFAULT_PREFERENCES
 = {

37 
TOOLTIP_TEXT_START_ACTIVITY
 = 
_
("Start‡‚ew‡ctivity in Hamster Time" +

39 
TOOLTIP_TEXT_STOP_ACTIVITY
 = 
_
("Stoprackinghe current‡ctivity in" +

42 
START_ACTIVITY_LABEL
 = 
_
("Startask in Hamster")

43 
STOP_ACTIVITY_LABEL
 = 
_
("Stop Hamster Activity")

44 
BUFFER_TIME
 = 60 #secs

45 
PLUGIN_PATH
 = 
os
.
·th
.
dœÇme
(os.·th.
	$ab¥©h
(
__fe__
))

46 
IMG_START_PATH
 = "icons/hicolor/32x32/hamster-activity-start.png"

47 
IMG_STOP_PATH
 = "icons/hicolor/32x32/hamster-activity-stop.png"

49 
def
 
	$__š™__
(
£lf
):

50 #sk 
ed™Ü
 
widg‘


51 
£lf
.
vbox
 = 
NÚe


52 
£lf
.
bu‰Ú
 = 
Gtk
.
	$ToŞBu‰Ú
()

53 
£lf
.
Ùh”_¡İ_bu‰Ú
 = s–f.
bu‰Ú


55 
def
 
	$g‘_icÚ_widg‘
(
£lf
, 
image_·th
):

56 
image_·th
 = 
os
.
·th
.
	$još
(
£lf
.
PLUGIN_PATH
, 
image_·th
)

57 
pixbuf
 = 
GdkPixbuf
.
Pixbuf
.
	$Ãw_äom_fe_©_size
(
image_·th
, 24, 24)

59 #ü—‹ 
the
 
image
 
ªd
 
assocŸ‹
h
pixbuf


60 
icÚ
 = 
Gtk
.
	$Image
()

61 
icÚ
.
	$£t_äom_pixbuf
(
pixbuf
)

62 
icÚ
.
	$show
()

64  
icÚ


66 #### 
IÁ”aùiÚ
 
w™h
 
Ham¡”


67 
def
 
	$£ndTask
(
£lf
, 
sk
):

69 
sk
 
is
 
NÚe
:

71 
gtg_t™Ë
 = 
sk
.
	$g‘_t™Ë
()

72 
gtg_gs
 = [
t
.
	`l¡r
('@').
	$low”
(è
t
 
š
 
sk
.
	`g‘_gs_Çme
()]

74 
aùiv™y
 = "Other"

75 
£lf
.
´eã»nûs
['activity'] == 'tag':

76 
ham¡”_aùiv™›s
 = 
	`£t
([
	`¡r
(
x
[0]).
	$low”
()

77 
x
 
š
 
£lf
.
ham¡”
.
	`G‘Aùiv™›s
('')])

78 
aùiv™y_ÿndid©es
 = 
ham¡”_aùiv™›s
.
	`š‹r£ùiÚ
(

79 
	$£t
(
gtg_gs
))

80 
	`Ën
(
aùiv™y_ÿndid©es
) >= 1:

81 
aùiv™y
 = 
	`li¡
(
aùiv™y_ÿndid©es
)[0]

82 
–if
 
£lf
.
´eã»nûs
['activity'] == 'title':

83 
aùiv™y
 = 
gtg_t™Ë


84 #ham¡” 
ÿn
't handle ',' or '@' in‡ctivity‚ame

85 
aùiv™y
 =‡ùiv™y.
	`»¶aû
(',', '')

86 
aùiv™y
 = 
»
.
	`sub
('\ +@.*', '',‡ctivity)

88 
ÿ‹gÜy
 = ""

89 
£lf
.
´eã»nûs
['category'] == 'auto_tag':

90 
ham¡”_aùiv™›s
 = 
	`diù
([(
	`¡r
(
x
[0]), 
	$unicode
(
x
[1]))

91 
x
 
š


92 
£lf
.
ham¡”
.
	`G‘Aùiv™›s
('')])

93 ià(
gtg_t™Ë
 
š
 
ham¡”_aùiv™›s


94 
Ü
 
gtg_t™Ë
.
	`»¶aû
(",", ""è
š
 
ham¡”_aùiv™›s
):

95 
ÿ‹gÜy
 = "%s" % 
ham¡”_aùiv™›s
[
gtg_t™Ë
]

97 ià(
£lf
.
´eã»nûs
['ÿ‹gÜy'] =ğ'g' 
Ü


98 (
£lf
.
´eã»nûs
['ÿ‹gÜy'] =ğ'auto_g' 
ªd
 
nÙ
 
ÿ‹gÜy
)):

99 #S“ 
ªy
 
of
 
the
 
gs
 
m©ch
 
exi¡šg
 
ÿ‹gÜ›s


100 
ÿ‹gÜ›s
 = 
	`diù
([(
	`¡r
(
x
[1]).
	`low”
(), 
	$¡r
(
x
[1]))

101 
x
 
š
 
£lf
.
ham¡”
.
	`G‘C©egÜ›s
()])

102 
low”_gtg_gs
 = 
	`£t
([
x
.
	$low”
(è
x
 
š
 
gtg_gs
])

103 
š‹r£ùiÚ
 = 
	`£t
(
ÿ‹gÜ›s
.
	`keys
()).
	$š‹r£ùiÚ
(
low”_gtg_gs
)

104 
	`Ën
(
š‹r£ùiÚ
) > 0:

105 
ÿ‹gÜy
 = "%s" % 
ÿ‹gÜ›s
[
š‹r£ùiÚ
.
	`pİ
()]

106 
–if
 
	`Ën
(
gtg_gs
) > 0:

107 #FÜû 
ÿ‹gÜy
 
nÙ
 
found


108 
ÿ‹gÜy
 = 
gtg_gs
[0]

110 
desütiÚ
 = ""

111 
£lf
.
´eã»nûs
['description'] == 'title':

112 
desütiÚ
 = 
gtg_t™Ë


113 
–if
 
£lf
.
´eã»nûs
['description'] == 'contents':

114 
desütiÚ
 = 
sk
.
	$g‘_exû½t
(
¡r_gs
=
True
,

115 
¡r_subsks
=
True
)

117 
g_ÿndid©es
 = []

118 
Œy
:

119 
£lf
.
´eã»nûs
['tags'] == 'existing':

120 
ham¡”_gs
 = 
	`£t
([
	$¡r
(
x
[1]èx 
š


121 
£lf
.
ham¡”
.
	`G‘Tags
(
F®£
)])

122 
g_ÿndid©es
 = 
	`li¡
(
ham¡”_gs
.
	`š‹r£ùiÚ
(
	$£t
(
gtg_gs
)))

123 
–if
 
£lf
.
´eã»nûs
['tags'] == 'all':

124 
g_ÿndid©es
 = 
gtg_gs


125 
exû±
 
dbus
.
exû±iÚs
.
DBusExû±iÚ
:

126 #Şd 
ham¡”
 
v”siÚ
, 
dÛ¢
't supportags

127 
·ss


128 
g_¡r
 = "".
	`još
([" #" + 
x
 x 
š
 
g_ÿndid©es
])

130 #FÜm© 
of
 
fœ¡
 
¬gum’t
 oà
AddFaù
 -

131 #`[-]
¡¬t_time
[-
’d_time
] 
aùiv™y
@
ÿ‹gÜy
, 
desütiÚ
 #tag1 #tag2`

132 
çù
 = 
aùiv™y


133 
ÿ‹gÜy
:

134 
çù
 +ğ"@%s" % 
ÿ‹gÜy


135 
çù
 +ğ",%s%s" % (
desütiÚ
, 
g_¡r
)

136 
¡¬t_time
 = 
	`timegm
(
d©‘ime
.d©‘ime.
	`now
().
	$tim‘u¶e
())

137 
ham¡”_id
 = 
£lf
.
ham¡”
.
	$AddFaù
(
çù
, 
¡¬t_time
, 0, 
F®£
)

139 
ids
 = 
£lf
.
	$g‘_ham¡”_ids
(
sk
)

140 
ids
.
	`­³nd
(
	$¡r
(
ham¡”_id
))

141 
£lf
.
	$£t_ham¡”_ids
(
sk
, 
ids
)

143 
def
 
	$g‘_»cÜds
(
£lf
, 
sk
):

145 
ids
 = 
£lf
.
	$g‘_ham¡”_ids
(
sk
)

146 
»cÜds
 = []

147 
modif›d
 = 
F®£


148 
v®id_ids
 = []

149 
i
 
š
 
ids
:

150 
Œy
:

151 
d
 = 
£lf
.
ham¡”
.
	$G‘Faù
(
i
)

152 
d
 
ªd
 
i
 
nÙ
 
š
 
v®id_ids
:

153 
»cÜds
.
	$­³nd
(
d
)

154 
v®id_ids
.
	$­³nd
(
i
)

156 
exû±
 
dbus
.
DBusExû±iÚ
:

157 
·ss


158 
modif›d
 = 
True


159 
	`´št
("Removšg inv®id faù", 
i
)

160 
modif›d
:

161 
£lf
.
	$£t_ham¡”_ids
(
sk
, 
v®id_ids
)

162  
»cÜds


164 
def
 
	$g‘_aùive_id
(
£lf
):

165 
todays_çùs
 = 
£lf
.
ham¡”
.
	$G‘TodaysFaùs
()

166 
todays_çùs
 
ªd
odays_facts[-1][2] == 0:

167 #todays_çù 
is
 
a
 
li¡
. 
todays_çùs
[-1] 
gives
 
the
 
Ï‹¡
 
çù


168 #ià
todays_çùs
[-1][-1] 
is
 
the
 
¡¬t
 
time
, 
ªd


169 #todays_çùs[-1][-2] 
is
 
the
 
’d
 
time
 
of
h
	`çù
 (
v®ue
 0 
m—ns


170 #™ 
is
 
¡l
 
bešg
 
Œacked
 
upÚ
 
which
 
we
  
id
 
of
 
the
 
çù
)

171  
todays_çùs
[-1][0]

173  
NÚe


175 
def
 
	$is_sk_aùive
(
£lf
, 
sk
):

176 
»cÜds
 = 
£lf
.
	$g‘_»cÜds
(
sk
)

177 
ids
 = [
»cÜd
[0] »cÜd 
š
 
»cÜds
]

178  
£lf
.
	$g‘_aùive_id
(è
š
 
ids


180 
def
 
	$¡İ_sk
(
£lf
, 
sk
):

181 
£lf
.
	$is_sk_aùive
(
sk
):

182 
now
 = 
	`timegm
(
d©‘ime
.d©‘ime.
	`now
().
	$tim‘u¶e
())

183 #Ham¡” 
d–‘es
 
ª
 
aùiv™y
 
™
's finishime is setƒarlier

184 #thª 
cu¼’t
 
time
. 
H’û
, 
we
 
¬e
 
£‰šg
 
fšish
ime

185 #som
bufãr
 
£cs
 
äom
 
now


186 
£lf
.
ham¡”
.
	`StİT¿ckšg
(
now
 + s–f.
BUFFER_TIME
)

188 #### 
D©a¡Üe


189 
def
 
	$g‘_ham¡”_ids
(
£lf
, 
sk
):

190 
a
 = 
sk
.
	`g‘_©Œibu‹
("id-li¡", 
Çme¥aû
=
£lf
.
PLUGIN_NAMESPACE
)

191 
nÙ
 
a
:

194  
a
.
	`¥l™
(',')

196 
def
 
	$£t_ham¡”_ids
(
£lf
, 
sk
, 
ids
):

197 
sk
.
	`£t_©Œibu‹
("id-li¡", ",".
	`još
(
ids
),

198 
Çme¥aû
=
£lf
.
PLUGIN_NAMESPACE
)

200 
def
 
	$sks_d–‘ed
(
£lf
, 
widg‘
, 
d–‘ed_sks
):

202 
If
 
a
 
sk
 
is
 
bešg
 
Œacked
, 
ªd
 
™
 i 
d–‘ed
 
š
 
GTG
,

203 
this
 
m‘hod
 
¡İs
 
Œackšg
 
™


205 
sk
 
š
 
d–‘ed_sks
:

206 
£lf
.
	$¡İ_sk
(
sk
)

208 
def
 
	$sk_¡©us_chªged
(
£lf
, 
widg‘
, 
sk
, 
Ãw_¡©us
):

210 
If
 
a
 
sk
 
is
 
bešg
 
Œacked
 
ªd
 
™
's status is changed from

211 
Aùive
 -> 
DÚe
/
Dismis£d
, 
this
 
m‘hod
 
¡İs
 
Œackšg
 
™


214 
def
 
	$»cursive_li¡_sks
(
sk_li¡
, 
roÙ
):

216 
PİuÏ‹
 
a
 
li¡
 
of
 
®l
 
the
 
subsks
 
ªd
 
theœ
 
chd»n
, 
»cursiv–y


218 
roÙ
 
nÙ
 
š
 
sk_li¡
:

219 
sk_li¡
.
	$­³nd
(
roÙ
)

220 
i
 
š
 
roÙ
.
	$g‘_subsks
():

221 
	$»cursive_li¡_sks
(
sk_li¡
, 
i
)

223 
Ãw_¡©us
 
š
 [
Task
.
STA_DISMISSED
, Task.
STA_DONE
]:

224 
®l_my_chd»n
 = []

225 
	$»cursive_li¡_sks
(
®l_my_chd»n
, 
sk
)

226 
sk
 
š
 
®l_my_chd»n
:

227 
£lf
.
	$¡İ_sk
(
sk
)

229 #### 
Plugš
 
­i
 
m‘hods


230 
def
 
	$aùiv©e
(
£lf
, 
¶ugš_­i
):

231 
£lf
.
¶ugš_­i
 =…lugin_api

232 
£lf
.
ham¡”
 = 
dbus
.
	`SessiÚBus
().
	`g‘_objeù
('org.gnome.Hamster',

235 #add 
m’u
 
™em


236 
¶ugš_­i
.
	$is_brow£r
():

237 
£lf
.
m’u_™em
 = 
Gtk
.
	$M’uI‹m
(
£lf
.
START_ACTIVITY_LABEL
)

238 
£lf
.
m’u_™em
.
	$show_®l
()

239 
£lf
.
m’u_™em
.
	`cÚÃù
('aùiv©e', s–f.
brow£r_cb
, 
¶ugš_­i
)

240 
£lf
.
m’u_™em
.
	$£t_£ns™ive
(
F®£
)

241 
¶ugš_­i
.
	$add_m’u_™em
(
£lf
.
m’u_™em
)

242 #ªd 
bu‰Ú


243 
£lf
.
bu‰Ú
.
	$£t_Ïb–
(
£lf
.
START_ACTIVITY_LABEL
)

244 
¡¬t_icÚ_widg‘
 = 
£lf
.
	$g‘_icÚ_widg‘
(
£lf
.
IMG_START_PATH
)

245 
£lf
.
bu‰Ú
.
	$£t_icÚ_widg‘
(
¡¬t_icÚ_widg‘
)

246 
£lf
.
bu‰Ú
.
	$£t_toŞt_‹xt
(
£lf
.
TOOLTIP_TEXT_START_ACTIVITY
)

247 
£lf
.
bu‰Ú
.
	$£t_£ns™ive
(
F®£
)

248 
£lf
.
bu‰Ú
.
	`cÚÃù
('şicked', s–f.
brow£r_cb
, 
¶ugš_­i
)

249 
£lf
.
bu‰Ú
.
	$show
()

250 
¶ugš_­i
.
	$add_toŞb¬_™em
(
£lf
.
bu‰Ú
)

251 
¶ugš_­i
.
	$£t_aùive_£ËùiÚ_chªged_ÿÎback
(

252 
£lf
.
£ËùiÚ_chªged
)

253 
¶ugš_­i
.
	`g‘_v›w_mªag”
().
	`cÚÃù
('tasks-deleted',

254 
£lf
.
sks_d–‘ed
)

255 
¶ugš_­i
.
	`g‘_v›w_mªag”
().
	`cÚÃù
('task-status-changed',

256 
£lf
.
sk_¡©us_chªged
)

257 #£ˆ
up
 
´eã»nûs


258 
£lf
.
	$´eã»nû_dŸlog_š™
()

259 
£lf
.
	$´eã»nûs_lßd
()

261 
def
 
	$ÚTaskO³Ãd
(
£lf
, 
¶ugš_­i
):

262 #g‘ 
the
 
İ’ed
 
sk


263 
sk
 = 
¶ugš_­i
.
	`g‘_ui
().
	$g‘_sk
()

265 
sk
.
	`g‘_¡©us
(è=ğ
Task
.
STA_ACTIVE
:

266 #add 
bu‰Ú


267 
£lf
.
skbu‰Ú
 = 
Gtk
.
	$ToŞBu‰Ú
()

268 
£lf
.
	$decide_bu‰Ú_mode
(
£lf
.
skbu‰Ú
, 
sk
)

269 
£lf
.
skbu‰Ú
.
	`cÚÃù
('şicked', s–f.
sk_cb
, 
¶ugš_­i
)

270 
£lf
.
skbu‰Ú
.
	$show
()

271 
¶ugš_­i
.
	$add_toŞb¬_™em
(
£lf
.
skbu‰Ú
)

273 
»cÜds
 = 
£lf
.
	$g‘_»cÜds
(
sk
)

275 
	$Ën
(
»cÜds
):

276 #add 
£ùiÚ
 
to
 
bÙtom
 
of
 
wšdow


277 
vbox
 = 
Gtk
.
	$Box
(
Ü›Á©iÚ
=
Gtk
.
Or›Á©iÚ
.
VERTICAL
)

278 
šÃr_grid
 = 
Gtk
.
	$Grid
()

279 
	`Ën
(
»cÜds
) > 8:

280 
s
 = 
Gtk
.
	$SüŞËdWšdow
()

281 
s
.
	$£t_pŞicy
(
Gtk
.
PŞicyTy³
.
NEVER
, Gtk.PŞicyTy³.
AUTOMATIC
)

282 
v
 = 
Gtk
.
	$V›wpÜt
()

283 
v
.
	$add
(
šÃr_grid
)

284 
s
.
	$add
(
v
)

285 
v
.
	$£t_shadow_ty³
(
Gtk
.
ShadowTy³
.
NONE
)

286 
s
.
	`£t_size_»que¡
(-1, 150)

288 
s
 = 
šÃr_grid


290 
ou‹r_grid
 = 
Gtk
.
	$Grid
()

291 
vbox
.
	$·ck_¡¬t
(
s
, 
True
, True, 0)

292 
vbox
.
	$·ck_¡¬t
(
ou‹r_grid
, 
True
, True, 0)

293 
vbox
.
	`·ck_’d
(
Gtk
.
	`S•¬©Ü
(), 
True
, True, 0)

295 
tÙ®
 = 0

297 
def
 
	$add
(
w
, 
a
, 
b
, 
off£t
, 
aùive
=
F®£
):

298 
aùive
:

299 
a
 = "<span color='red'>%s</span>" %‡

300 
b
 = "<span color='red'>%s</span>" % b

302 
d©eLab–
 = 
Gtk
.
	$Lab–
(
Ïb–
=
a
)

303 
d©eLab–
.
	$£t_u£_m¬kup
(
True
)

304 
d©eLab–
.
	$£t_®ignm’t
(
x®ign
=0.0, 
y®ign
=0.5)

305 
d©eLab–
.
	`£t_size_»que¡
(200, -1)

306 
w
.
	$©ch
(
d©eLab–
, 0, 
off£t
, 1, 1)

308 
durLab–
 = 
Gtk
.
	$Lab–
(
Ïb–
=
b
)

309 
durLab–
.
	$£t_u£_m¬kup
(
True
)

310 
durLab–
.
	$£t_®ignm’t
(
x®ign
=0.0, 
y®ign
=0.5)

311 
w
.
	$©ch
(
durLab–
, 1, 
off£t
, 1, 1)

313 
aùive_id
 = 
£lf
.
	$g‘_aùive_id
()

314 
off£t
, 
i
 
š
 
	$’um”©e
(
»cÜds
):

315 
t
 = 
	$ÿlc_du¿tiÚ
(
i
)

316 
tÙ®
 +ğ
t


317 
	`add
(
šÃr_grid
, 
	`fÜm©_d©e
(
i
), 
	`fÜm©_du¿tiÚ
(
t
),

318 
off£t
, 
i
[0] =ğ
aùive_id
)

320 
	`add
(
ou‹r_grid
, "<big><b>Total</b></big>",

321 "<big><b>%s</b></big>" % 
	`fÜm©_du¿tiÚ
(
tÙ®
), 1)

323 
£lf
.
vbox
 = 
¶ugš_­i
.
	$add_widg‘_to_sked™Ü
(
vbox
)

325 
def
 
	$d—ùiv©e
(
£lf
, 
¶ugš_­i
):

326 
¶ugš_­i
.
	$is_brow£r
():

327 
¶ugš_­i
.
	$»move_m’u_™em
(
£lf
.
m’u_™em
)

328 
¶ugš_­i
.
	$»move_toŞb¬_™em
(
£lf
.
bu‰Ú
)

330 
¶ugš_­i
.
	$»move_toŞb¬_™em
(
£lf
.
skbu‰Ú
)

331 
¶ugš_­i
.
	$»move_widg‘_äom_sked™Ü
(
£lf
.
vbox
)

333 
def
 
	$brow£r_cb
(
£lf
, 
widg‘
, 
¶ugš_­i
):

334 
sk_id
 = 
¶ugš_­i
.
	`g‘_brow£r
().
	$g‘_£Ëùed_sk
()

335 
sk
 = 
¶ugš_­i
.
	`g‘_»que¡”
().
	$g‘_sk
(
sk_id
)

336 
£lf
.
	$decide_¡¬t_Ü_¡İ_aùiv™y
(
sk
, 
widg‘
)

338 
def
 
	$sk_cb
(
£lf
, 
widg‘
, 
¶ugš_­i
):

339 
sk
 = 
¶ugš_­i
.
	`g‘_ui
().
	$g‘_sk
()

340 
£lf
.
	$decide_¡¬t_Ü_¡İ_aùiv™y
(
sk
, 
widg‘
)

342 
def
 
	$decide_¡¬t_Ü_¡İ_aùiv™y
(
£lf
, 
sk
, 
widg‘
):

343 
£lf
.
	$is_sk_aùive
(
sk
):

344 
£lf
.
	$chªge_bu‰Ú_to_¡¬t_aùiv™y
(
widg‘
)

345 
£lf
.
	$¡İ_sk
(
sk
)

346 
–if
 
sk
.
	`g‘_¡©us
(è=ğ
Task
.
STA_ACTIVE
:

347 
£lf
.
	$chªge_bu‰Ú_to_¡İ_aùiv™y
(
widg‘
)

348 
£lf
.
	$£ndTask
(
sk
)

350 
def
 
	$£ËùiÚ_chªged
(
£lf
, 
£ËùiÚ
):

351 
£ËùiÚ
.
	`couÁ_£Ëùed_rows
() == 1:

352 
£lf
.
bu‰Ú
.
	$£t_£ns™ive
(
True
)

353 
£lf
.
m’u_™em
.
	$£t_£ns™ive
(
True
)

354 
sk_id
 = 
£lf
.
¶ugš_­i
.
	`g‘_brow£r
().
	$g‘_£Ëùed_sk
()

355 
sk
 = 
£lf
.
¶ugš_­i
.
	`g‘_»que¡”
().
	$g‘_sk
(
sk_id
)

356 
£lf
.
	$decide_bu‰Ú_mode
(
£lf
.
bu‰Ú
, 
sk
)

358 
£lf
.
	$chªge_bu‰Ú_to_¡¬t_aùiv™y
(
£lf
.
bu‰Ú
)

359 
£lf
.
bu‰Ú
.
	$£t_£ns™ive
(
F®£
)

360 
£lf
.
m’u_™em
.
	$£t_£ns™ive
(
F®£
)

362 
def
 
	$decide_bu‰Ú_mode
(
£lf
, 
bu‰Ú
, 
sk
):

363 
£lf
.
	$is_sk_aùive
(
sk
):

364 
£lf
.
	$chªge_bu‰Ú_to_¡İ_aùiv™y
(
bu‰Ú
)

366 
£lf
.
	$chªge_bu‰Ú_to_¡¬t_aùiv™y
(
bu‰Ú
)

368 
def
 
	$chªge_bu‰Ú_to_¡¬t_aùiv™y
(
£lf
, 
bu‰Ú
):

369 
£lf
.
m’u_™em
.
	$£t_Ïb–
(
£lf
.
START_ACTIVITY_LABEL
)

370 
£lf
.
bu‰Ú
.
	`£t_icÚ_widg‘
(£lf.
	$g‘_icÚ_widg‘
(
£lf
.
IMG_START_PATH
))

371 
£lf
.
bu‰Ú
.
	$£t_toŞt_‹xt
(
£lf
.
TOOLTIP_TEXT_START_ACTIVITY
)

373 
def
 
	$chªge_bu‰Ú_to_¡İ_aùiv™y
(
£lf
, 
bu‰Ú
):

374 
£lf
.
m’u_™em
.
	$£t_Ïb–
(
£lf
.
STOP_ACTIVITY_LABEL
)

375 
£lf
.
bu‰Ú
.
	`£t_icÚ_widg‘
(£lf.
	$g‘_icÚ_widg‘
(
£lf
.
IMG_STOP_PATH
))

376 
£lf
.
bu‰Ú
.
	$£t_toŞt_‹xt
(
£lf
.
TOOLTIP_TEXT_STOP_ACTIVITY
)

378 #### 
P»ã»nû
 
Hªdlšg


379 
def
 
	$is_cÚfigu¿bË
(
£lf
):

381  
True


383 
def
 
	$cÚfigu»_dŸlog
(
£lf
, 
mªag”_dŸlog
):

384 
£lf
.
	$´eã»nûs_lßd
()

385 
£lf
.
´eã»nûs_dŸlog
.
	$£t_Œªs›Á_fÜ
(
mªag”_dŸlog
)

387 
def
 
	$´ef_to_dŸlog
(
´ef
):

388 
£lf
.
bud”
.
	`g‘_objeù
(
´ef
 + "_" + s–f.
´eã»nûs
[pref]) \

389 .
	$£t_aùive
(
True
)

391 
	`´ef_to_dŸlog
("activity")

392 
	`´ef_to_dŸlog
("category")

393 
	`´ef_to_dŸlog
("description")

394 
	`´ef_to_dŸlog
("tags")

396 
£lf
.
´eã»nûs_dŸlog
.
	$show_®l
()

398 
def
 
	$Ú_´eã»nûs_şo£
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

400 
def
 
	$dŸlog_to_´ef
(
´ef
, 
v®s
):

401 
v®
 
š
 
v®s
:

402 
£lf
.
bud”
.
	`g‘_objeù
(
´ef
 + "_" + 
v®
).
	$g‘_aùive
():

403 
£lf
.
´eã»nûs
[
´ef
] = 
v®


406 
	`dŸlog_to_´ef
("activity", ["tag", "title"])

407 
	`dŸlog_to_´ef
("category", ["auto", "tag", "auto_tag"])

408 
	`dŸlog_to_´ef
("description", ["title", "contents", "none"])

409 
	`dŸlog_to_´ef
("tags", ["all", "existing", "none"])

411 
£lf
.
	$´eã»nûs_¡Üe
()

412 
£lf
.
´eã»nûs_dŸlog
.
	$hide
()

413  
True


415 
def
 
	$´eã»nûs_lßd
(
£lf
):

416 
£lf
.
´eã»nûs
 = s–f.
¶ugš_­i
.
	`lßd_cÚfigu¿tiÚ_objeù
(

417 
£lf
.
PLUGIN_NAMESPACE
, "preferences",

418 
deçuÉ_v®ues
=
£lf
.
DEFAULT_PREFERENCES
)

420 
def
 
	$´eã»nûs_¡Üe
(
£lf
):

421 
£lf
.
¶ugš_­i
.
	`§ve_cÚfigu¿tiÚ_objeù
(£lf.
PLUGIN_NAMESPACE
,

423 
£lf
.
´eã»nûs
)

425 
def
 
	$´eã»nû_dŸlog_š™
(
£lf
):

426 
£lf
.
bud”
 = 
Gtk
.
	$Bud”
()

427 
·th
 = "%s/´efs.ui" % 
os
.·th.
	`dœÇme
(os.·th.
	$ab¥©h
(
__fe__
))

428 
£lf
.
bud”
.
	$add_äom_fe
(
·th
)

429 
£lf
.
´eã»nûs_dŸlog
 = s–f.
bud”
.
	`g‘_objeù
("dialog1")

430 
SIGNAL_CONNECTIONS_DIC
 = {

431 "´efs_şo£": 
£lf
.
Ú_´eã»nûs_şo£
,

432 
	}
}

433 
£lf
.
bud”
.
	$cÚÃù_sigÇls
(
SIGNAL_CONNECTIONS_DIC
)

435 #### 
H–³r
 
FunùiÚs


438 
def
 
	$fÜm©_d©e
(
sk
):

439 
¡¬t_time
 = 
time
.
	$gmtime
(
sk
[1])

440  
time
.
	`¡ráime
("<b>%A, %b %e</b> %l:%M %p", 
¡¬t_time
)

443 
def
 
	$ÿlc_du¿tiÚ
(
çù
):

445 
»tuºs
 
mšu‹s


447 
¡¬t
 = 
çù
[1]

448 
’d
 = 
çù
[2]

449 
’d
 == 0:

450 
’d
 = 
	`timegm
(
time
.
	$loÿÉime
())

451  (
’d
 - 
¡¬t
) / 60

454 
def
 
	$fÜm©_du¿tiÚ
(
mšu‹s
):

455 #Ba£d 
Ú
 
ham¡”
-
­¶‘
 
code
 - ham¡”/
¡uff
.
py


458 
nÙ
 
mšu‹s
:

461 
hours
 = 
mšu‹s
 / 60

462 
mšu‹s
 = minutes % 60

463 
fÜm©‹d_du¿tiÚ
 = ""

465 
mšu‹s
 % 60 == 0:

466 #du¿tiÚ 
š
 
round
 
hours


467 
fÜm©‹d_du¿tiÚ
 +ğ"%dh" % (
hours
)

468 
–if
 
hours
 == 0:

469 #du¿tiÚ 
Ëss
 
thª
 
hour


470 
fÜm©‹d_du¿tiÚ
 +ğ"%dmš" % (
mšu‹s
 % 60.0)

472 #x 
hours
, 
y
 
mšu‹s


473 
fÜm©‹d_du¿tiÚ
 +ğ"%dh %dmš" % (
hours
, 
mšu‹s
 % 60)

475  
fÜm©‹d_du¿tiÚ


	@plugins/not_today/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2012 - 
LiÚ–
 
DricÙ
 <
liÚ–
@
¶oum
.
Ãt
>

4 #Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


5 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


6 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


8 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


9 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


10 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


12 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


13 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
äom
 
	gGTG
.
	g¶ugšs
.
	gnÙ_today
.
nÙ_today
 
impÜt
 
	gnÙToday


19 #suµ»s 
pyæakes
 
w¬nšg
 (
giv’
 
by
 
make
 
lšt
)

20 
	gF®£
:

21 
nÙToday
()

	@plugins/not_today/not_today.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2012 - 
LiÚ–
 
DricÙ
 <
liÚ–
@
¶oum
.
Ãt
>

4 #Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


5 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


6 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


8 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


9 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


10 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


12 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


13 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

15 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


16 
äom
 
	gGTG
.
	gtoŞs
.
d©es
 
impÜt
 
D©e


17 
äom
 
GTG
 
impÜt
 
_


20 
şass
 
	gnÙToday
:

22 
def
 
	$__š™__
(
£lf
):

23 
£lf
.
¶ugš_­i
 = 
NÚe


24 
£lf
.
tb_bu‰Ú
 = 
NÚe


26 
def
 
	$aùiv©e
(
£lf
, 
¶ugš_­i
):

27 
£lf
.
¶ugš_­i
 =…lugin_api

28 
£lf
.
»q
 = s–f.
¶ugš_­i
.
	$g‘_»que¡”
()

29 
£lf
.
	$_š™_gtk
()

30 
£lf
.
¶ugš_­i
.
	$£t_aùive_£ËùiÚ_chªged_ÿÎback
(

31 
£lf
.
£ËùiÚ_chªged
)

33 
def
 
	$d—ùiv©e
(
£lf
, 
¶ugš_­i
):

35 
£lf
.
	$_gtk_d—ùiv©e
()

37 
def
 
	$m¬k_nÙ_today
(
£lf
, 
bu‰Ú
):

38 
¡¬t_d©e
 = 
D©e
.
	`·r£
("tomorrow")

39 
tid
 
š
 
£lf
.
¶ugš_­i
.
	$g‘_£Ëùed
():

40 
sk
 = 
£lf
.
»q
.
	$g‘_sk
(
tid
)

41 
sk
.
	$£t_¡¬t_d©e
(
¡¬t_d©e
)

43 
def
 
	$£ËùiÚ_chªged
(
£lf
, 
£ËùiÚ
):

44 
£ËùiÚ
.
	`couÁ_£Ëùed_rows
() > 0:

45 
£lf
.
tb_bu‰Ú
.
	$£t_£ns™ive
(
True
)

47 
£lf
.
tb_bu‰Ú
.
	$£t_£ns™ive
(
F®£
)

49 ## 
GTK
 
FUNCTIONS
 ##############################################################

50 
def
 
	$_š™_gtk
(
£lf
):

53 
£lf
.
tb_bu‰Ú
 = 
Gtk
.
	$ToŞBu‰Ú
()

54 
£lf
.
tb_bu‰Ú
.
	$£t_£ns™ive
(
F®£
)

55 
£lf
.
tb_bu‰Ú
.
	`£t_icÚ_Çme
("document-revert")

56 
£lf
.
tb_bu‰Ú
.
	$£t_is_impÜÁ
(
True
)

57 
£lf
.
tb_bu‰Ú
.
	`£t_Ïb–
(
	`_
("Do itomorrow"))

58 
£lf
.
tb_bu‰Ú
.
	`cÚÃù
('şicked', s–f.
m¬k_nÙ_today
)

59 
£lf
.
tb_bu‰Ú
.
	$show
()

60 
£lf
.
¶ugš_­i
.
	$add_toŞb¬_™em
(
£lf
.
tb_bu‰Ú
)

62 
def
 
	$_gtk_d—ùiv©e
(
£lf
):

64 
£lf
.
tb_bu‰Ú
:

65 
£lf
.
¶ugš_­i
.
	$»move_toŞb¬_™em
(
£lf
.
tb_bu‰Ú
)

66 
£lf
.
tb_bu‰Ú
 = 
F®£


	@plugins/notification_area/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Paulo
 
Cabido
 <
·ulo
.
ÿbido
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
	gGTG
.
	g¶ugšs
.
	gnÙifiÿtiÚ_¬—
.
nÙifiÿtiÚ_¬—
 
impÜt
 
	gNÙifiÿtiÚA»a


16 #suµ»s 
pyæakes
 
w¬nšg
 (
giv’
 
by
 
make
 
lšt
)

17 
F®£
 
is
 
	gTrue
:

18 
NÙifiÿtiÚA»a
()

	@plugins/notification_area/notification_area.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Paulo
 
Cabido
 <
·ulo
.
ÿbido
@
gma
.
com
>

3 #- 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

4 #- 
IzidÜ
 
M©u
Å¡
ov
 <
izidÜ
.
m©usov
@
gma
.
com
>

5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

16 
impÜt
 
os


17 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


18 
	gŒy
:

19 
äom
 
gi
.
»pos™Üy
 
impÜt
 
AµIndiÿtÜ3
 
as
 
­pšdiÿtÜ


20 
exû±
:

21 
·ss


23 
äom
 
GTG
 
impÜt
 
_


24 
äom
 
GTG
 
impÜt
 
DATA_DIR


25 
äom
 
GTG
.
toŞs
.
bÜg
 
impÜt
 
BÜg


26 
äom
 
GTG
.
toŞs
.
d©es
 
impÜt
 
D©e


29 
şass
 
	$TheIndiÿtÜ
(
BÜg
):

31 
AµliÿtiÚ
 
šdiÿtÜ
 
ÿn
 
be
 
š¡ªtŸ‹d
 
Úly
 
Úû
. 
The


32 
¶ugš
 
­i
, 
wh’
 
togglšg
 
the
 
aùiv©iÚ
 
¡©e
 
of
 
a
…lugin,

33 
š¡ªtŸ‹s
 
difã»Á
 
objeùs
 
äom
 
the
 
¶ugš
 
şass
. 
Th”efÜe
,

34 
we
 
Ãed
 
to
 
k“p
 
a
 
»ã»nû
Ø
the
 
šdiÿtÜ
 
objeù
. 
This
 
şass


35 
dÛs
 
th©
.

38 
def
 
	$__š™__
(
£lf
):

39 
	`su³r
(
TheIndiÿtÜ
, 
£lf
).
	$__š™__
()

40 
nÙ
 
	`ha§‰r
(
£lf
, "_indicator"):

41 
Œy
:

42 
£lf
.
_šdiÿtÜ
 = 
­pšdiÿtÜ
.
	`IndiÿtÜ
(

45 
­pšdiÿtÜ
.
CATEGORY_APPLICATION_STATUS
)

46 
exû±
:

47 
£lf
.
_šdiÿtÜ
 = 
NÚe


49 
def
 
	$g‘_šdiÿtÜ
(
£lf
):

50  
£lf
.
_šdiÿtÜ


53 
şass
 
IcÚIndiÿtÜ
:

55 
A
 
commÚ
 
š‹rçû
 
to
 
ª
 
­p
 
šdiÿtÜ
 
ªd
 
a
 
¡©us
 
icÚ


58 
NORMAL_ICON
 = "gtg"

59 
ATTENTION_ICON
 = "gtg_need_attention"

61 
def
 
	$__š™__
(
£lf
):

62 
£lf
.
_šdiÿtÜ
 = 
	`TheIndiÿtÜ
().
	$g‘_šdiÿtÜ
()

63 
£lf
.
_icÚ
 = 
NÚe


64 
£lf
.
_m’u
 = 
NÚe


65 
£lf
.
_©‹ÁiÚ
 = 
F®£


67 
def
 
	$aùiv©e
(
£lf
, 
ËábŠ_ÿÎback
, 
m’u
):

70 
£lf
.
_m’u
 = 
m’u


72 
£lf
.
_šdiÿtÜ
:

73 #Show 
the
 
icÚ
 
ev’
 
wh’
 
runšg
 ./
süts
/
debug
.
sh


74 
theme_·th
 = 
os
.
·th
.
	`još
(
DATA_DIR
, 'icons')

75 
£lf
.
_šdiÿtÜ
.
	$£t_icÚ_theme_·th
(
theme_·th
)

77 
£lf
.
_šdiÿtÜ
.
	`£t_icÚ
("gtg-panel")

78 
£lf
.
_šdiÿtÜ
.
	$£t_©‹ÁiÚ_icÚ
(
£lf
.
ATTENTION_ICON
)

79 
£lf
.
_šdiÿtÜ
.
	$£t_m’u
(
m’u
)

80 
£lf
.
_šdiÿtÜ
.
	$£t_¡©us
(
­pšdiÿtÜ
.
STATUS_ACTIVE
)

82 
£lf
.
_icÚ
 = 
Gtk
.
	$StusIcÚ
()

83 
£lf
.
_icÚ
.
	$£t_äom_icÚ_Çme
(
£lf
.
NORMAL_ICON
)

84 
£lf
.
_icÚ
.
	`£t_toŞt_‹xt
("Getting Things GNOME!")

85 
£lf
.
_icÚ
.
	$£t_visibË
(
True
)

86 
£lf
.
_icÚ
.
	`cÚÃù
('aùiv©e', 
ËábŠ_ÿÎback
)

87 
£lf
.
_icÚ
.
	`cÚÃù
('pİup-m’u', s–f.
_Ú_icÚ_pİup
)

89 
def
 
	$d—ùiv©e
(
£lf
):

91 
£lf
.
_šdiÿtÜ
:

92 
£lf
.
_šdiÿtÜ
.
	$£t_¡©us
(
­pšdiÿtÜ
.
STATUS_PASSIVE
)

94 
£lf
.
_icÚ
.
	$£t_visibË
(
F®£
)

96 
def
 
	$upd©e_m’u
(
£lf
):

98 
£lf
.
_šdiÿtÜ
:

99 
£lf
.
_šdiÿtÜ
.
	$£t_m’u
(
£lf
.
_m’u
)

101 
def
 
	$£t_©‹ÁiÚ
(
£lf
, 
©‹ÁiÚ
):

103 #Chªg
icÚ
 
Úly
 
wh’
 
the
 
©‹ÁiÚ
 
chªge


104 
£lf
.
_©‹ÁiÚ
 =ğ
©‹ÁiÚ
:

107 
£lf
.
_šdiÿtÜ
:

108 
©‹ÁiÚ
:

109 
¡©us
 = 
­pšdiÿtÜ
.
STATUS_ATTENTION


111 
¡©us
 = 
­pšdiÿtÜ
.
STATUS_ACTIVE


113 
£lf
.
_šdiÿtÜ
.
	$£t_¡©us
(
¡©us
)

115 
©‹ÁiÚ
:

116 
icÚ
 = 
£lf
.
ATTENTION_ICON


118 
icÚ
 = 
£lf
.
NORMAL_ICON


120 
£lf
.
_icÚ
.
	$£t_äom_icÚ_Çme
(
icÚ
)

122 
£lf
.
_©‹ÁiÚ
 = 
©‹ÁiÚ


124 
def
 
	$_Ú_icÚ_pİup
(
£lf
, 
icÚ
, 
bu‰Ú
, 
time¡amp
):

126 
nÙ
 
£lf
.
_šdiÿtÜ
:

127 
£lf
.
_m’u
.
	$pİup
(
NÚe
, NÚe, 
Gtk
.
StusIcÚ
.
pos™iÚ_m’u
,

128 
icÚ
, 
bu‰Ú
, 
time¡amp
)

131 
def
 
	$_due_w™hš
(
sk
, 
dªg”_zÚe
):

133 
D‘”mše
 
a
 
sk
 
is
 
the
 
dªg”
 
zÚe
.

134 
CÚv’tiÚ
: 
a
 
dªg”
 
zÚe
 
of
 1 
day
 
šşudes
 
sks
 
due
 
today
.

136 
dd©e
 = 
sk
.
	$g‘_due_d©e
()

137 ià(
dd©e
 !ğ
D©e
.
	$no_d©e
()):

138 
dd©e
.
	`days_Ëá
(è< 
dªg”_zÚe
:

139  
True


140  
F®£


143 
şass
 
_A‰’tiÚ
:

146 
Defše
 
Ãed
 
©‹ÁiÚ
 
¡©e
 
d•’dšg
 
Ú
 
wh‘h”
 
th”e


147 
¬e
 
sks
 
š
 
dªg”
 
zÚe
.

149 
Th”e
 
¬e
 
two
 
Ëv–s
 
of
 
©‹ÁiÚ
:

150 "nÜm®": 
th”e
 
¬e
 
no
 
sks
 
š
 
dªg”
 
zÚe


151 "high": 
th”e
 
is
 
©
 
Ëa¡
 
Úe
 
sk
 
š
 
dªg”
 
zÚe


153 
A
 
sk
 
is
 
š
 
dªg”
 
zÚe
 
the
 
numb”
 
of
 
days
 
Ëá
 i 
Ëss


154 
thª
 
time
 
	$¥ª
 (
š
 
days
è
defšed
 
by
 
dªg”_zÚe
.

157 
def
 
	$__š™__
(
£lf
, 
dªg”_zÚe
, 
šdiÿtÜ
, 
Œ“
, 
»q
):

158 
£lf
.
__Œ“
 = 
Œ“


159 
£lf
.
__»q
 = 
»q


160 
£lf
.
_šdiÿtÜ
 = 
šdiÿtÜ


161 
£lf
.
dªg”_zÚe
 = danger_zone

163 #S‘u°
li¡
 
of
 
sks
 
š
 
dªg”
 
zÚe


165 
£lf
.
sks_dªg”
 = []

166 
tid
 
š
 
£lf
.
__Œ“
.
	$g‘_®l_nodes
():

167 
sk
 = 
£lf
.
__»q
.
	$g‘_sk
(
tid
)

168 
	$_due_w™hš
(
sk
, 
£lf
.
dªg”_zÚe
):

169 
£lf
.
sks_dªg”
.
	$­³nd
(
tid
)

171 #S‘ 
š™Ÿl
 
¡©us


172 
£lf
.
	$_upd©e_šdiÿtÜ
()

174 
def
 
	$_upd©e_šdiÿtÜ
(
£lf
):

176 
£lf
.
_šdiÿtÜ
.
	`£t_©‹ÁiÚ
(
	`Ën
(£lf.
sks_dªg”
) > 0)

178 
def
 
	$upd©e_Ú_sk_modif›d
(
£lf
, 
tid
):

179 
sk
 = 
£lf
.
__»q
.
	$g‘_sk
(
tid
)

180 
tid
 
š
 
£lf
.
sks_dªg”
:

181 
nÙ
 
	$_due_w™hš
(
sk
, 
£lf
.
dªg”_zÚe
):

182 
£lf
.
sks_dªg”
.
	$»move
(
tid
)

184 
	$_due_w™hš
(
sk
, 
£lf
.
dªg”_zÚe
):

185 
£lf
.
sks_dªg”
.
	$­³nd
(
tid
)

187 
£lf
.
	$_upd©e_šdiÿtÜ
()

189 
def
 
	$upd©e_Ú_sk_d–‘ed
(
£lf
, 
tid
):

190 
tid
 
š
 
£lf
.
sks_dªg”
:

191 
£lf
.
sks_dªg”
.
	$»move
(
tid
)

193 
£lf
.
	$_upd©e_šdiÿtÜ
()

196 
şass
 
NÙifiÿtiÚA»a
:

198 
Plugš
 
th©
 
di¥Ïy
 
a
 
nÙifiÿtiÚ
 
¬—
 
widg‘
 
Ü
 
ª
 
šdiÿtÜ


199 
to
 
quickly
 
acûss
 
sks
.

202 
DEFAULT_PREFERENCES
 = {"¡¬t_mšimized": 
F®£
,

203 "dªg”_zÚe": 1
	}
}

204 
PLUGIN_NAME
 = "notification_area"

205 
MAX_TITLE_LEN
 = 30

206 
MAX_ITEMS
 = 10

208 
def
 
	$__š™__
(
£lf
):

209 
£lf
.
_šdiÿtÜ
 = 
	$IcÚIndiÿtÜ
()

210 
£lf
.
__brow£r_hªdËr
 = 
NÚe


211 
£lf
.
__libÏrch_ÿÎbacks
 = []

213 
def
 
	$aùiv©e
(
£lf
, 
¶ugš_­i
):

215 
£lf
.
__¶ugš_­i
 = 
¶ugš_­i


216 
£lf
.
__v›w_mªag”
 = 
¶ugš_­i
.
	$g‘_v›w_mªag”
()

217 
£lf
.
__»que¡”
 = 
¶ugš_­i
.
	$g‘_»que¡”
()

218 #Tasks_š_m’u 
wl
 
hŞd
 
the
 
m’u_™ems
 
š
h
m’u
, 
to
 
quickly
 
acûss


219 #them 
giv’
 
the
 
sk
 
id
. 
CÚšs
 
tu¶e
 
of
 
this
 
fÜm©
:

220 #(
t™Ë
, 
key
, 
Gtk
.
M’uI‹m
)

221 
£lf
.
	$__š™_gtk
()

223 #W
lßd
 
´eã»nûs
 
befÜe
 
cÚÃùšg
 
to
 
Œ“


224 
£lf
.
	$´eã»nû_dŸlog_š™
()

225 
£lf
.
	$´eã»nûs_lßd
()

227 #EÇbË 
©‹ÁiÚ
 
mÚ™Ü
.

228 
£lf
.
__©‹ÁiÚ
 = 
NÚe


229 
£lf
.
__Œ“_©t
 = s–f.
	`__cÚÃù_to_Œ“
([

230 ("node-added-šv›w", 
£lf
.
__Ú_sk_added_©t
),

231 ("node-modif›d-šv›w", 
£lf
.
__Ú_sk_added_©t
),

232 ("node-d–‘ed-šv›w", 
£lf
.
__Ú_sk_d–‘ed_©t
),

234 
£lf
.
__Œ“_©t
.
	`­¶y_f‹r
('workview')

235 
£lf
.
	$__š™_©‹ÁiÚ
()

237 
£lf
.
__Œ“
 = s–f.
	`__cÚÃù_to_Œ“
([

238 ("node-added-šv›w", 
£lf
.
__Ú_sk_added
),

239 ("node-modif›d-šv›w", 
£lf
.
__Ú_sk_added
),

240 ("node-d–‘ed-šv›w", 
£lf
.
__Ú_sk_d–‘ed
),

242 
£lf
.
__Œ“
.
	`­¶y_f‹r
('workview')

244 #Wh’ 
no
 
	`wšdows
 (
brow£r
 
Ü
 
‹xt
 
ed™Üs
è
¬e
 
shown
, 
™
 
Œ›s
 
to
 
qu™


245 #W™h 
hidd’
 
brow£r
 
ªd
 
şosšg
 
the
 
Úly
 
sšgË
 
‹xt
 
ed™Ü
,

246 #GTG 
would
 
qu™
 
no
 
m©‹r
 
wh©


247 
£lf
.
__v›w_mªag”
.
	$£t_d«mÚ_mode
(
True
)

250 
£lf
.
	$__£t_brow£r_şo£_ÿÎback
(
£lf
.
__Ú_brow£r_mšimize
)

252 
£lf
.
´eã»nûs
["start_minimized"]:

253 
£lf
.
__v›w_mªag”
.
	$¡¬t_brow£r_hidd’
()

255 
def
 
	$d—ùiv©e
(
£lf
, 
¶ugš_­i
):

257 
£lf
.
_šdiÿtÜ
.
	$d—ùiv©e
()

259 #AÎow 
to
 
şo£
 
brow£r
 
aá”
 
d—ùiv©iÚ


260 
£lf
.
	$__£t_brow£r_şo£_ÿÎback
(
NÚe
)

262 #AÎow 
şosšg
 
GTG
 
aá”
 
the
 
Ï¡
 
wšdow


263 
£lf
.
__v›w_mªag”
.
	$£t_d«mÚ_mode
(
True
)

265 #D—ùiv©
LibL¬ch
 
ÿÎbacks


266 
key
, 
ev’t
 
š
 
£lf
.
__libÏrch_ÿÎbacks
:

267 
£lf
.
__Œ“
.
	$d”egi¡”_şlbck
(
ev’t
, 
key
)

268 
£lf
.
__Œ“
 = 
NÚe


269 
£lf
.
__libÏrch_ÿÎbacks
 = []

271 ## 
H–³r
 
m‘hods
 #############################################################
 __š™_gtk(£lf):

272 
m’u
 = 
Gtk
.
	$M’u
()

275 #FIXME 
‹¡
 
this
 
Ïb–
... 
is
 
™
 
Ãeded
? 
¶ay
 
w™h
 iˆ
a
 
l™e


276 
m’uI‹m
 = 
Gtk
.
	`M’uI‹m
(
Ïb–
=
	`_
('Add New Task'))

277 
m’uI‹m
.
	`cÚÃù
('aùiv©e', 
£lf
.
__İ’_sk
)

278 
m’u
.
	$­³nd
(
m’uI‹m
)

280 #Show 
Maš
 
Wšdow


281 
show_brow£r
 = 
Gtk
.
	`M’uI‹m
(
Ïb–
=
	`_
('Show Main Window'))

282 
show_brow£r
.
	`cÚÃù
('aùiv©e', 
£lf
.
__show_brow£r
)

283 
m’u
.
	$­³nd
(
show_brow£r
)

285 #£·¿tÜ (
™
's intendedo be‡fter show_all)

286 #£·¿tÜ 
should
 
be
 
shown
 
Úly
 
wh’
 
havšg
 
sks


287 
£lf
.
__sk_£·¿tÜ
 = 
Gtk
.
	$S•¬©ÜM’uI‹m
()

288 
m’u
.
	$­³nd
(
£lf
.
__sk_£·¿tÜ
)

289 
m’u_tİ_Ëngth
 = 
	$Ën
(
m’u
)

291 
m’u
.
	`­³nd
(
Gtk
.
	$S•¬©ÜM’uI‹m
())

293 #qu™ 
™em


294 
m’uI‹m
 = 
Gtk
.
	`M’uI‹m
(
Ïb–
=
	`_
('Quit'))

295 
m’uI‹m
.
	`cÚÃù
('aùiv©e', 
£lf
.
__v›w_mªag”
.
şo£_brow£r
)

296 
m’u
.
	$­³nd
(
m’uI‹m
)

298 
m’u
.
	$show_®l
()

299 
£lf
.
__sk_£·¿tÜ
.
	$hide
()

301 
£lf
.
__sks_m’u
 = 
	$SÜ‹dLim™edM’u
(
£lf
.
MAX_ITEMS
,

302 
m’u
, 
m’u_tİ_Ëngth
)

304 
£lf
.
_šdiÿtÜ
.
	$aùiv©e
(
£lf
.
__show_brow£r
, 
m’u
)

306 
def
 
	$__š™_©‹ÁiÚ
(
£lf
):

307 #U£ 
two
 
difã»Á
 
v›wŒ“
 
©‹ÁiÚ
 
ªd
 
m’u


308 #Thi 
way
 
we
 
ÿn
 
f‹r
 
them
 
šd•’d’y
.

309 #CÚv’tiÚ: 
dªg”
 
zÚe
 
is
 <=0, 
di§bË
 
©‹ÁiÚ


310 #F®lback: 
th”e
 
is
 
no
 
šdiÿtÜ
 
we
 
·ss
 
the
 
¡©us
 
icÚ
 
š¡—d


311 
£lf
.
´eã»nûs
['danger_zone'] > 0:

312 
£lf
.
__©‹ÁiÚ
 = 
	`_A‰’tiÚ
(

313 
£lf
.
´eã»nûs
['danger_zone'],

314 
£lf
.
_šdiÿtÜ
,

315 
£lf
.
__Œ“_©t
,

316 
£lf
.
__»que¡”
)

318 
£lf
.
__©‹ÁiÚ
 = 
NÚe


320 
def
 
	$__İ’_sk
(
£lf
, 
widg‘
, 
sk_id
=
NÚe
):

322 
O³ns
 
a
 
sk
 
š
 
the
 
TaskEd™Ü
, 
™
's‚ot currently opened.

323 
If
 
sk_id
 
is
 
NÚe
, 
™
 
ü—‹s
 
a
 
Ãw
 
sk
 
ªd
 
İ’s
 it

325 
sk_id
 
is
 
NÚe
:

326 
sk_id
 = 
£lf
.
__»que¡”
.
	`Ãw_sk
().
	$g‘_id
()

327 
Ãw_sk
 = 
True


329 
Ãw_sk
 = 
F®£


331 
£lf
.
__v›w_mªag”
.
	$İ’_sk
(
sk_id
, 
thisi¢ew
=
Ãw_sk
)

333 
def
 
	$__cÚÃù_to_Œ“
(
£lf
, 
sigÇl_şlbck
):

335 
Œ“
 = 
£lf
.
__»que¡”
.
	$g‘_sks_Œ“
()

336 #Reque¡ 
a
 
Ãw
 
v›w
 
so
 
we
 dØ
nÙ
 
šæu’û
 
ªybody


337 
Œ“
 =»e.
	`g‘_ba£Œ“
().
	$g‘_v›wŒ“
(
»äesh
=
F®£
)

339 
£lf
.
__libÏrch_ÿÎbacks
 = []

340 
sigÇl
, 
şlbck
 
š
 
sigÇl_şlbck
:

341 
cb_id
 = 
Œ“
.
	$»gi¡”_şlbck
(
sigÇl
, 
şlbck
)

342 
£lf
.
__libÏrch_ÿÎbacks
.
	`­³nd
((
cb_id
, 
sigÇl
))

343  
Œ“


345 
def
 
	$__Ú_sk_added_©t
(
£lf
, 
tid
, 
·th
):

346 #Upd©
icÚ
 
Ú
 
modifiÿtiÚ


347 
£lf
.
__©‹ÁiÚ
:

348 
£lf
.
__©‹ÁiÚ
.
	$upd©e_Ú_sk_modif›d
(
tid
)

350 
def
 
	$__Ú_sk_added
(
£lf
, 
tid
, 
·th
):

351 
£lf
.
__sk_£·¿tÜ
.
	$show
()

352 
sk
 = 
£lf
.
__»que¡”
.
	$g‘_sk
(
tid
)

353 
sk
 
is
 
NÚe
:

356 #–lsi 
of
 
the
 
t™Ë


357 
t™Ë
 = 
£lf
.
	`__ü—‹_shÜt_t™Ë
(
sk
.
	$g‘_t™Ë
())

359 #ü—tšg 
the
 
m’u
 
™em


360 #FIXME 
‹¡
 
»g»ssiÚ
: 
ü—‹
 
a
 
sk
 
like
 
H–lo_wÜld


361 #(
_
 
might
 
be
 
cÚv”‹d
)

362 
m’u_™em
 = 
Gtk
.
	$M’uI‹m
(
Ïb–
=
t™Ë
)

363 
m’u_™em
.
	`cÚÃù
('aùiv©e', 
£lf
.
__İ’_sk
, 
tid
)

364 
£lf
.
__sks_m’u
.
	`add
(
tid
, (
sk
.
	`g‘_due_d©e
(), 
t™Ë
), 
m’u_™em
)

366 
£lf
.
_šdiÿtÜ
.
	$upd©e_m’u
()

368 
def
 
	$__Ú_sk_d–‘ed_©t
(
£lf
, 
tid
, 
·th
):

369 #Upd©
icÚ
 
Ú
 
d–‘iÚ


370 
£lf
.
__©‹ÁiÚ
:

371 
£lf
.
__©‹ÁiÚ
.
	$upd©e_Ú_sk_d–‘ed
(
tid
)

373 
def
 
	$__Ú_sk_d–‘ed
(
£lf
, 
tid
, 
·th
):

374 
£lf
.
__sks_m’u
.
	$»move
(
tid
)

375 
£lf
.
__sks_m’u
.
	$em±y
():

376 
£lf
.
__sk_£·¿tÜ
.
	$hide
()

378 
def
 
	$__ü—‹_shÜt_t™Ë
(
£lf
, 
t™Ë
):

380 
™
 
is
 
nÙ
 
ignÜed
 
Ü
 
š‹½»‹d
 
as
 
ª
 
acûË¿tÜ
."""

381 
t™Ë
 =™Ë.
	`»¶aû
("_", "__")

382 
shÜt_t™Ë
 = 
t™Ë
[0:
£lf
.
MAX_TITLE_LEN
]

383 
	`Ën
(
t™Ë
è> 
£lf
.
MAX_TITLE_LEN
:

384 
shÜt_t™Ë
 = shÜt_t™Ë.
	`¡r
() + "..."

385  
shÜt_t™Ë


387 ###P»ã»nû 
m‘hods
 #######################################################
…»ã»nûs_lßd(£lf):

388 
£lf
.
´eã»nûs
 = s–f.
__¶ugš_­i
.
	`lßd_cÚfigu¿tiÚ_objeù
(

389 
£lf
.
PLUGIN_NAME
, "preferences",

390 
deçuÉ_v®ues
=
£lf
.
DEFAULT_PREFERENCES
)

392 
def
 
	$´eã»nûs_¡Üe
(
£lf
):

393 
£lf
.
__¶ugš_­i
.
	`§ve_cÚfigu¿tiÚ_objeù
(£lf.
PLUGIN_NAME
,

395 
£lf
.
´eã»nûs
)

397 
def
 
	$is_cÚfigu¿bË
(
£lf
):

399  
True


401 
def
 
	$´eã»nû_dŸlog_š™
(
£lf
):

402 
£lf
.
bud”
 = 
Gtk
.
	$Bud”
()

403 
£lf
.
bud”
.
	`add_äom_fe
(
os
.
·th
.
	`još
(

404 
os
.
·th
.
	`dœÇme
(os.·th.
	`ab¥©h
(
__fe__
)),

406 
£lf
.
´eã»nûs_dŸlog
 = s–f.
bud”
.
	`g‘_objeù
("preferences_dialog")

407 
£lf
.
chbox_mšimized
 = s–f.
bud”
.
	`g‘_objeù
("pref_chbox_minimized")

408 
£lf
.
¥šbu‰Ú_dªg”zÚe
 = \

409 
£lf
.
bud”
.
	`g‘_objeù
("pref_spinbutton_dangerzone")

410 
SIGNAL_CONNECTIONS_DIC
 = {

412 
£lf
.
Ú_´eã»nûs_ÿnûl
,

414 
£lf
.
Ú_´eã»nûs_ÿnûl
,

416 
£lf
.
Ú_´eã»nûs_ok
,

417 
	}
}

418 
£lf
.
bud”
.
	$cÚÃù_sigÇls
(
SIGNAL_CONNECTIONS_DIC
)

420 
def
 
	$cÚfigu»_dŸlog
(
£lf
, 
mªag”_dŸlog
):

421 
£lf
.
chbox_mšimized
.
	`£t_aùive
(£lf.
´eã»nûs
["start_minimized"])

422 
£lf
.
¥šbu‰Ú_dªg”zÚe
.
	`£t_v®ue
(£lf.
´eã»nûs
["danger_zone"])

423 
£lf
.
´eã»nûs_dŸlog
.
	$show_®l
()

424 
£lf
.
´eã»nûs_dŸlog
.
	$£t_Œªs›Á_fÜ
(
mªag”_dŸlog
)

426 
def
 
	$Ú_´eã»nûs_ÿnûl
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

427 
£lf
.
´eã»nûs_dŸlog
.
	$hide
()

428  
True


430 
def
 
	$Ú_´eã»nûs_ok
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

431 
dzÚe
 = 
£lf
.
¥šbu‰Ú_dªg”zÚe
.
	$g‘_v®ue
()

432 #upd©
dªg”
 
zÚe
 
Úly
 
™
 
has
 
chªged


433 #ªd 
»äesh
 
©‹ÁiÚ
 
mÚ™Ü


434 
nÙ
 
dzÚe
 =ğ
£lf
.
´eã»nûs
["danger_zone"]:

435 
£lf
.
´eã»nûs
["dªg”_zÚe"] = 
dzÚe


436 
£lf
.
	$__š™_©‹ÁiÚ
()

438 
£lf
.
´eã»nûs
["¡¬t_mšimized"] = s–f.
chbox_mšimized
.
	$g‘_aùive
()

439 
£lf
.
	$´eã»nûs_¡Üe
()

440 
£lf
.
´eã»nûs_dŸlog
.
	$hide
()

442 ###Brow£¸
m‘hods
 ###########################################################
 __Ú_brow£r_mšimize(£lf, widg‘=NÚe,…lugš_­i=NÚe):

443 
£lf
.
__v›w_mªag”
.
	$hide_brow£r
()

444  
True


446 
def
 
	$__show_brow£r
(
£lf
, 
£nd”
=
NÚe
, 
d©a
=None):

447 
mªag”
 = 
£lf
.
__¶ugš_­i
.
	$g‘_v›w_mªag”
()

448 
mªag”
.
	$show_brow£r
()

450 
def
 
	$__£t_brow£r_şo£_ÿÎback
(
£lf
, 
m‘hod
):

452 
un£t
 
the
 
´evious
 
ÿÎback
 """

454 
brow£r
 = 
£lf
.
__v›w_mªag”
.
	$g‘_brow£r
()

456 
£lf
.
__brow£r_hªdËr
 
is
 
nÙ
 
NÚe
:

457 
brow£r
.
wšdow
.
	$discÚÃù
(
£lf
.
__brow£r_hªdËr
)

459 
m‘hod
 
is
 
nÙ
 
NÚe
:

460 
£lf
.
__brow£r_hªdËr
 = 
brow£r
.
wšdow
.
	`cÚÃù
(

461 "d–‘e-ev’t", 
m‘hod
)

464 
şass
 
SÜ‹dLim™edM’u
:

467 
def
 
	$__š™__
(
£lf
, 
max_™ems
, 
gtk_m’u
, 
off£t
):

469 
gtk_m’u
 - 
™ems
 
¬e
 
added
 
to
 
this
 
m’u


470 
off£t
 - 
add
 
to
 
pos™iÚ
 
this
 offset

472 
£lf
.
max_™ems
 = max_items

473 
£lf
.
m’u
 = 
gtk_m’u


474 
£lf
.
off£t
 = offset

476 
£lf
.
sÜ‹d_keys
 = []

477 
£lf
.
–em’ts
 = {
	}
}

479 
def
 
	$add
(
£lf
, 
key
, 
sÜt_–em
, 
m’u_™em
):

481 
key
 
š
 
£lf
.
–em’ts
:

482 
£lf
.
	$»move
(
key
)

484 
™em
 = (
sÜt_–em
, 
key
)

485 
£lf
.
sÜ‹d_keys
.
	$­³nd
(
™em
)

486 
£lf
.
sÜ‹d_keys
.
	$sÜt
()

487 
pos™iÚ
 = 
£lf
.
sÜ‹d_keys
.
	$šdex
(
™em
)

488 
£lf
.
–em’ts
[
key
] = 
m’u_™em


489 
£lf
.
m’u
.
	`š£¹
(
m’u_™em
, 
pos™iÚ
 + s–f.
off£t
)

491 #Show/
hide
 
–em’ts


492 
pos™iÚ
 < 
£lf
.
max_™ems
:

493 
m’u_™em
.
	$show
()

495 
	`Ën
(
£lf
.
sÜ‹d_keys
è> s–f.
max_™ems
:

496 
hidd’_key
 = 
£lf
.
sÜ‹d_keys
[£lf.
max_™ems
][1]

497 
£lf
.
–em’ts
[
hidd’_key
].
	$hide
()

499 
def
 
	$»move
(
£lf
, 
key
):

501 
m’u_™em
 = 
£lf
.
–em’ts
.
	$pİ
(
key
)

502 
£lf
.
m’u
.
	$»move
(
m’u_™em
)

504 
™em
 
š
 
£lf
.
sÜ‹d_keys
:

505 
™em
[1] =ğ
key
:

506 
pos™iÚ
 = 
£lf
.
sÜ‹d_keys
.
	$šdex
(
™em
)

507 
£lf
.
sÜ‹d_keys
.
	$»move
(
™em
)

510 #show 
–em’t
 
which
 
kes
 
the
 
ä“d
 
¶aû


511 
was_di¥Ïyed
 = 
pos™iÚ
 < 
£lf
.
max_™ems


512 
hidd’_–em’ts
 = 
	`Ën
(
£lf
.
sÜ‹d_keys
è>ğ£lf.
max_™ems


513 
was_di¥Ïyed
 
ªd
 
hidd’_–em’ts
:

514 
shown_key
 = 
£lf
.
sÜ‹d_keys
[£lf.
max_™ems
 - 1][1]

515 
£lf
.
–em’ts
[
shown_key
].
	$show
()

517 
def
 
	$em±y
(
£lf
):

519  
£lf
.
sÜ‹d_keys
 == []

	@plugins/send_email/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
	gGTG
.
	g¶ugšs
.
	g£nd_ema
.
£ndEma
 
impÜt
 
	g¶ugšS’dEma


17 #suµ»s 
pyæakes
 
w¬nšg
 (
giv’
 
by
 
make
 
lšt
)

18 
F®£
 
is
 
	gTrue
:

19 
¶ugšS’dEma
()

	@plugins/send_email/sendEmail.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

15 - 
S’ds
 
the
 
sk
 
by
 
	ge
-
	gma
. (
Luÿ
 
	gInv”nizzi
)

16 - 
Added
 
suµÜt
 
gs
 
ªd
 
	gsubsks
. (
ThibauÉ
 
	gF
Ã©
	gvry
)

19 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gio


20 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


21 
impÜt
 
	gu¾lib
.
»que¡


22 
impÜt
 
	gu¾lib
.
·r£


23 
impÜt
 
	gu¾lib
.
”rÜ


25 
äom
 
GTG
 
impÜt
 
_


28 
şass
 
	g¶ugšS’dEma
:

30 
The
 
¶ugš
.

33 
def
 
	$ÚTaskO³Ãd
(
£lf
, 
¶ugš_­i
):

35 
Adds
 
the
 
bu‰Ú
 
wh’
 
a
 
sk
 
is
 
İ’ed
.

37 
£lf
.
¶ugš_­i
 =…lugin_api

38 #add 
a
 
	`™em
 (
bu‰Ú
è
to
 
the
 
ToŞB¬


39 
tb_TaskicÚ
 = 
Gtk
.
	$Image
()

40 
tb_TaskicÚ
.
	`£t_äom_icÚ_Çme
('mail-send', 32)

42 
£lf
.
tb_Taskbu‰Ú
 = 
Gtk
.
	$ToŞBu‰Ú
(
tb_TaskicÚ
)

43 
£lf
.
tb_Taskbu‰Ú
.
	`£t_Ïb–
(
	`_
("Send viaƒmail"))

44 
£lf
.
tb_Taskbu‰Ú
.
	`cÚÃù
('şicked', s–f.
ÚTbTaskBu‰Ú
, 
¶ugš_­i
)

45 
£lf
.
tb_Taskbu‰Ú
.
	$show_®l
()

47 
¶ugš_­i
.
	$add_toŞb¬_™em
(
£lf
.
tb_Taskbu‰Ú
)

49 
def
 
	$d—ùiv©e
(
£lf
, 
¶ugš_­i
):

51 
De§ùiv©es
 
the
 
¶ugš
.

53 #ev”ythšg 
should
 
be
 
»moved
, 
š
 
a
 
sk
 
is
 
cu¼’y
 
İ’ed


54 
Œy
:

55 
£lf
.
¶ugš_­i
.
	$»move_toŞb¬_™em
(
£lf
.
tb_Taskbu‰Ú
)

56 
exû±
:

57 
·ss


59 ## 
CORE
 
FUNCTIONS
 #############################################################
 onTbTaskBu‰Ú(£lf, widg‘,…lugš_­i):

61 
Wh’
 
the
 
u£r
 
´es£s
h
bu‰Ú
.

63 
sk
 = 
¶ugš_­i
.
	`g‘_ui
().
	$g‘_sk
()

65 #Body 
cÚšs
 
Stus
 
Tags
, 
Subsks
 
ªd
 
CÚ‹Á
.

66 
body
 = 
	`_
("Stus: %s"è% (
sk
.
	`g‘_¡©us
()) + \

67 
	`_
("\nTags: %s"è% (", ".
	`još
(
sk
.
	`g‘_gs_Çme
())) + \

68 
	`_
("\nSubtasks:\n%s") % (

69 "\À- ".
	`još
([
i
.
	$g‘_t™Ë
(è
i
 
š
 
sk
.
	`g‘_subsks
()])) + \

70 
	`_
("\nTask cÚ‹Á:\n%s"è% (
sk
.
	$g‘_exû½t
())

72 #T™Ë 
cÚšs
 
the
 
t™Ë
 
ªd
h
¡¬t
‡nd 
due
 
d©es
.

73 
t™Ë
 = 
	`_
("Task: %Ñask_t™Ë)s"è% {'sk_t™Ë': 
sk
.
	`g‘_t™Ë
()
	}
}

75 
·¿m‘”s
 = 
u¾lib
.
·r£
.
u¾’code
({'subjeù': 
t™Ë
, 'body': 
body
})

76 
·¿m‘”s
 =…¬am‘”s.
»¶aû
('+', '%20')

78 
	gGio
.
­p_šfo_g‘_deçuÉ_fÜ_uri_scheme
('mato').
Ïunch_uris
(

79 ['mato:' + 'gtg@exam¶e.com?' + 
·¿m‘”s
])

	@plugins/task_reaper/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
	gGTG
.
	g¶ugšs
.
	gsk_»­”
.
»­”
 
impÜt
 
	g¶ugšR—³r


16 #suµ»s 
pyæakes
 
w¬nšg
 (
giv’
 
by
 
make
 
lšt
)

17 
F®£
 
is
 
	gTrue
:

18 
¶ugšR—³r
()

	@plugins/task_reaper/reaper.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

13 
impÜt
 
os


15 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


17 
äom
 
th»adšg
 
impÜt
 
Tim”


19 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


20 
äom
 
	gGTG
.
	gtoŞs
.
d©es
 
impÜt
 
D©e


23 
şass
 
	g¶ugšR—³r
:

25 
DEFAULT_PREFERENCES
 = {'max_days': 30,

26 'is_autom©ic': 
F®£
,

27 'show_m’u_™em': 
True
}

29 
PLUGIN_NAME
 = "task-reaper"

31 #IÀ
of
 
autom©ic
 
»movšg
 
sks
, 
the
 
time


32 #b‘w“À
two
 
runs
 
of
 
the
 
ş—Ãr
 
funùiÚ


33 
	gTIME_BETWEEN_PURGES
 = 60 * 60

35 
def
 
	$__š™__
(
£lf
):

36 
£lf
.
·th
 = 
os
.·th.
	`dœÇme
(os.·th.
	$ab¥©h
(
__fe__
))

37 #GUI 
š™Ÿliz©iÚ


38 
£lf
.
bud”
 = 
Gtk
.
	$Bud”
()

39 
£lf
.
bud”
.
	`add_äom_fe
(
os
.
·th
.
	`još
(

40 
os
.
·th
.
	`dœÇme
(os.·th.
	`ab¥©h
(
__fe__
)) +

42 
£lf
.
´eã»nûs_dŸlog
 = s–f.
bud”
.
	`g‘_objeù
("preferences_dialog")

43 
£lf
.
´ef_chbox_show_m’u_™em
 = \

44 
£lf
.
bud”
.
	`g‘_objeù
("pref_chbox_show_menu_item")

45 
£lf
.
´ef_chbox_is_autom©ic
 = \

46 
£lf
.
bud”
.
	`g‘_objeù
("pref_chbox_is_automatic")

47 
£lf
.
´ef_¥šbŠ_max_days
 = \

48 
£lf
.
bud”
.
	`g‘_objeù
("pref_spinbtn_max_days")

49 
SIGNAL_CONNECTIONS_DIC
 = {

51 
£lf
.
Ú_´eã»nûs_ÿnûl
,

53 
£lf
.
Ú_´eã»nûs_ÿnûl
,

55 
£lf
.
Ú_´eã»nûs_ok
,

56 
	}
}

57 
£lf
.
bud”
.
	$cÚÃù_sigÇls
(
SIGNAL_CONNECTIONS_DIC
)

58 
£lf
.
m’u_™em
 = 
Gtk
.
	`M’uI‹m
("Delete old closedasks")

59 
£lf
.
m’u_™em
.
	`cÚÃù
('aùiv©e', s–f.
d–‘e_Şd_şo£d_sks
)

61 
def
 
	$aùiv©e
(
£lf
, 
¶ugš_­i
):

62 
£lf
.
¶ugš_­i
 =…lugin_api

63 #´eã»nû 
š™Ÿliz©iÚ


64 
£lf
.
m’u_™em_is_shown
 = 
F®£


65 
£lf
.
is_autom©ic
 = 
F®£


66 
£lf
.
tim”
 = 
NÚe


67 
£lf
.
	$´eã»nûs_lßd
()

68 
£lf
.
	$´eã»nûs_­¶y
()

70 
def
 
	$ÚTaskClo£d
(
£lf
, 
¶ugš_­i
):

71 
·ss


73 
def
 
	$ÚTaskO³Ãd
(
£lf
, 
¶ugš_­i
):

74 
·ss


76 
def
 
	$ÚQu™
(
£lf
, 
¶ugš_­i
):

77 
£lf
.
is_autom©ic
 
is
 
True
:

78 
£lf
.
	$ÿnûl_autİurge
()

80 
def
 
	$d—ùiv©e
(
£lf
, 
¶ugš_­i
):

81 
£lf
.
is_autom©ic
 
is
 
True
:

82 
£lf
.
	$ÿnûl_autİurge
()

83 
£lf
.
m’u_™em_is_shown
 
is
 
True
:

84 
¶ugš_­i
.
	$»move_m’u_™em
(
£lf
.
m’u_™em
)

86 ## 
HELPER
 
FUNCTIONS
 ###########################################################
 __log(£lf, mes§ge):

87 
Log
.
	$debug
(
mes§ge
)

89 ## 
CORE
 
FUNCTIONS
 #############################################################
 scheduË_autİurge(£lf):

90 
£lf
.
tim”
 = 
	$Tim”
(
£lf
.
TIME_BETWEEN_PURGES
,

91 
£lf
.
d–‘e_Şd_şo£d_sks
)

92 
£lf
.
tim”
.
	$£tD«mÚ
(
True
)

93 
£lf
.
tim”
.
	$¡¬t
()

94 
£lf
.
	`__log
("Automatic deletion of oldasks scheduled")

96 
def
 
	$ÿnûl_autİurge
(
£lf
):

97 
£lf
.
tim”
:

98 
£lf
.
	`__log
("Automatic deletion of oldasks cancelled")

99 
£lf
.
tim”
.
	$ÿnûl
()

101 
def
 
	$d–‘e_Şd_şo£d_sks
(
£lf
, 
widg‘
=
NÚe
):

102 
£lf
.
	`__log
("Starting deletion of oldasks")

103 
today
 = 
D©e
.
	$today
()

104 
max_days
 = 
£lf
.
´eã»nûs
["max_days"]

105 
»que¡”
 = 
£lf
.
¶ugš_­i
.
	$g‘_»que¡”
()

106 
şo£d_Œ“
 = 
»que¡”
.
	`g‘_sks_Œ“
(
Çme
='inactive')

107 
şo£d_sks
 = [
»que¡”
.
	$g‘_sk
(
tid
ètid 
š


108 
şo£d_Œ“
.
	`g‘_®l_nodes
()]

109 
to_»move
 = [
t
 ˆ
š
 
şo£d_sks


110 ià(
today
 - 
t
.
	`g‘_şo£d_d©e
()).
days
 > 
max_days
]

112 
sk
 
š
 
to_»move
:

113 
»que¡”
.
	`has_sk
(
sk
.
	$g‘_id
()):

114 
»que¡”
.
	`d–‘e_sk
(
sk
.
	$g‘_id
())

116 #Ià
autom©ic
 
purgšg
 
is
 
Ú
, 
scheduË
 
ªÙh”
 
run


117 
£lf
.
is_autom©ic
:

118 
£lf
.
	$scheduË_autİurge
()

120 ## 
P»ã»nûs
 
m‘hods
 ########################################################

121 
def
 
	$is_cÚfigu¿bË
(
£lf
):

123  
True


125 
def
 
	$cÚfigu»_dŸlog
(
£lf
, 
mªag”_dŸlog
):

126 
£lf
.
	$´eã»nûs_lßd
()

127 
£lf
.
´eã»nûs_dŸlog
.
	$£t_Œªs›Á_fÜ
(
mªag”_dŸlog
)

128 
£lf
.
´ef_chbox_is_autom©ic
.
	`£t_aùive
(

129 
£lf
.
´eã»nûs
["is_automatic"])

130 
£lf
.
´ef_chbox_show_m’u_™em
.
	`£t_aùive
(

131 
£lf
.
´eã»nûs
["show_menu_item"])

132 
£lf
.
´ef_¥šbŠ_max_days
.
	`£t_v®ue
(

133 
£lf
.
´eã»nûs
["max_days"])

134 
£lf
.
´eã»nûs_dŸlog
.
	$show_®l
()

136 
def
 
	$Ú_´eã»nûs_ÿnûl
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

137 
£lf
.
´eã»nûs_dŸlog
.
	$hide
()

138  
True


140 
def
 
	$Ú_´eã»nûs_ok
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

141 
£lf
.
´eã»nûs
["is_automatic"] = \

142 
£lf
.
´ef_chbox_is_autom©ic
.
	$g‘_aùive
()

143 
£lf
.
´eã»nûs
["show_menu_item"] = \

144 
£lf
.
´ef_chbox_show_m’u_™em
.
	$g‘_aùive
()

145 
£lf
.
´eã»nûs
["max_days"] = \

146 
£lf
.
´ef_¥šbŠ_max_days
.
	$g‘_v®ue
()

147 
£lf
.
	$´eã»nûs_­¶y
()

148 
£lf
.
	$´eã»nûs_¡Üe
()

149 
£lf
.
´eã»nûs_dŸlog
.
	$hide
()

151 
def
 
	$´eã»nûs_lßd
(
£lf
):

152 
£lf
.
´eã»nûs
 = s–f.
¶ugš_­i
.
	`lßd_cÚfigu¿tiÚ_objeù
(

153 
£lf
.
PLUGIN_NAME
, "preferences",

154 
deçuÉ_v®ues
=
£lf
.
DEFAULT_PREFERENCES
)

156 
def
 
	$´eã»nûs_¡Üe
(
£lf
):

157 
£lf
.
¶ugš_­i
.
	`§ve_cÚfigu¿tiÚ_objeù
(£lf.
PLUGIN_NAME
,

159 
£lf
.
´eã»nûs
)

161 
def
 
	$´eã»nûs_­¶y
(
£lf
):

162 #Showšg 
the
 
GUI


163 
£lf
.
´eã»nûs
['show_m’u_™em'] 
is
 
True
 
ªd
 \

164 
£lf
.
m’u_™em_is_shown
 
is
 
F®£
:

165 
£lf
.
¶ugš_­i
.
	$add_m’u_™em
(
£lf
.
m’u_™em
)

166 
£lf
.
m’u_™em_is_shown
 = 
True


167 
–if
 
£lf
.
´eã»nûs
['show_m’u_™em'] 
is
 
F®£
 
ªd
 \

168 
£lf
.
m’u_™em_is_shown
 
is
 
True
:

169 
£lf
.
¶ugš_­i
.
	$»move_m’u_™em
(
£lf
.
m’u_™em
)

170 
£lf
.
m’u_™em_is_shown
 = 
F®£


171 #Auto-
purge


172 
£lf
.
´eã»nûs
['is_autom©ic'] 
is
 
True
 
ªd
 \

173 
£lf
.
is_autom©ic
 
is
 
F®£
:

174 
£lf
.
is_autom©ic
 = 
True


175 #RuÀ
the
 
fœ¡
 
™”©iÚ
 
immedŸ‹ly
 
ªd
 
scheduË
 
Ãxt
 iteration

176 
£lf
.
	$d–‘e_Şd_şo£d_sks
()

177 
–if
 
£lf
.
´eã»nûs
['is_autom©ic'] 
is
 
F®£
 
ªd
 \

178 
£lf
.
is_autom©ic
 
is
 
True
:

179 
£lf
.
	$ÿnûl_autİurge
()

180 
£lf
.
is_autom©ic
 = 
F®£


	@plugins/tomboy/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
	gGTG
.
	g¶ugšs
.
	gtomboy
.
tomboy
 
impÜt
 
	g¶ugšTomboy


17 #suµ»s 
pyæakes
 
w¬nšg
 (
giv’
 
by
 
make
 
lšt
)

18 
F®£
 
is
 
	gTrue
:

19 
¶ugšTomboy
()

	@plugins/tomboy/combobox_enhanced.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

15 #TODO: 
put
 
this
 
š
 
a
 
şass
 
ex‹ndšg
 
Gtk
.
Combobox
 
ªd
 
¶aû
 
the
 
fe
 in

16 #GTG.
toŞs


18 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
	gGtk
, 
Gdk


19 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
GObjeù


22 
def
 
	$ifKeyP»s£dC®lback
(
widg‘
, 
key
, 
ÿÎback
):

24 
def
 
	$keyP»ss
(
combobox
, 
ev’t
):

25 
keyÇme
 = 
Gdk
.
	$keyv®_Çme
(
ev’t
.
keyv®
)

26 
keyÇme
 =ğ
key
:

27 
	$ÿÎback
()

28 
widg‘
.
	`cÚÃù
("key-´ess-ev’t", 
keyP»ss
)

31 
def
 
	$ifClbßrdTextIsInLi¡C®lback
(
şbßrd_obj
, 
li¡_obj
, 
ÿÎback
):

33 
def
 
	$şbßrdC®lback
(
şbßrd_obj
, 
‹xt
, 
li¡_obj
):

34 
	`Ën
([
x
 x 
š
 
li¡_obj
 x =ğ
‹xt
]) != 0:

35 
	$ÿÎback
(
‹xt
)

36 
şbßrd_obj
.
	$»que¡_‹xt
(
şbßrdC®lback
, 
li¡_obj
)

39 
def
 
	$li¡StÜeFromLi¡
(
li¡_obj
):

40 
li¡_¡Üe
 = 
Gtk
.
	$Li¡StÜe
(
GObjeù
.
TYPE_STRING
)

41 
–em
 
š
 
li¡_obj
:

42 
™”
 = 
li¡_¡Üe
.
	$­³nd
()

43 
li¡_¡Üe
.
	$£t
(
™”
, 0, 
–em
)

44  
li¡_¡Üe


47 
def
 
	$com¶‘iÚFromLi¡StÜe
(
li¡_¡Üe
):

48 
com¶‘iÚ
 = 
Gtk
.
	$EÁryCom¶‘iÚ
()

49 
com¶‘iÚ
.
	$£t_mšimum_key_Ëngth
(0)

50 
com¶‘iÚ
.
	$£t_‹xt_cŞumn
(0)

51 
com¶‘iÚ
.
	$£t_šlše_com¶‘iÚ
(
True
)

52 
com¶‘iÚ
.
	$£t_mod–
(
li¡_¡Üe
)

53  
com¶‘iÚ


56 
def
 
	$sm¬tifyComboboxEÁry
(
combobox
, 
li¡_obj
, 
ÿÎback
):

57 
’Œy
 = 
Gtk
.
	$EÁry
()

58 #check 
Clbßrd
 
cÚšs
 
ª
 
–em’t
 
of
 
the
 
li¡


59 
şbßrd
 = 
Gtk
.
	$Clbßrd
()

60 
	$ifClbßrdTextIsInLi¡C®lback
(
şbßrd
, 
li¡_obj
, 
’Œy
.
£t_‹xt
)

61 #´essšg 
EÁ”
 
wl
 
ÿu£
 
the
 
ÿÎback


62 
	`ifKeyP»s£dC®lback
(
’Œy
, "R‘uº", 
ÿÎback
)

63 #w¿°
the
 
combo
-
box
 
™
'soo†ong

64 
	`Ën
(
li¡_obj
) > 15:

65 
combobox
.
	$£t_w¿p_width
(5)

66 #pİuÏ‹ 
the
 
combo
-
box


67 
	`Ën
(
li¡_obj
) > 0:

68 
li¡_¡Üe
 = 
	$li¡StÜeFromLi¡
(
li¡_obj
)

69 
’Œy
.
	`£t_com¶‘iÚ
(
	$com¶‘iÚFromLi¡StÜe
(
li¡_¡Üe
))

70 
combobox
.
	$£t_mod–
(
li¡_¡Üe
)

71 
combobox
.
	$£t_aùive
(0)

72 
’Œy
.
	$£t_‹xt
(
li¡_¡Üe
[0][0])

73 
combobox
.
	$add
(
’Œy
)

74 
combobox
.
	`cÚÃù
('chªged', 
£tText
, 
’Œy
)

75 #»nd” 
the
 
combo
-
box
 
drİ
 
down
 
m’u


76 
ûÎ
 = 
Gtk
.
	$C–lR’d””Text
()

77 
combobox
.
	$·ck_¡¬t
(
ûÎ
, 
True
)

78 
combobox
.
	`add_©Œibu‹
(
ûÎ
, 'text', 0)

79  
’Œy


82 
def
 
	$£tText
(
combobox
, 
’Œy
):

83 
mod–
 = 
combobox
.
	$g‘_mod–
()

84 
šdex
 = 
combobox
.
	$g‘_aùive
()

85 
šdex
 > -1:

86 
’Œy
.
	`£t_‹xt
(
mod–
[
šdex
][0])

	@plugins/tomboy/tomboy.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2009 - 
Luÿ
 
Inv”nizzi
 <
šv”nizzi
.
l
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
impÜt
 
dbus


15 
impÜt
 
os


17 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
	gGtk
, 
	gGdk
, 
GdkPixbuf


19 
äom
 
GTG
 
impÜt
 
_


20 
äom
 
	gGTG
.
	g¶ugšs
.
	gtomboy
.
combobox_’hªûd
 
impÜt
 
sm¬tifyComboboxEÁry


23 
şass
 
	g¶ugšTomboy
:

25 
def
 
	$__š™__
(
£lf
):

26 #The£ 
tok’s
 
¬e
 
u£d
 
to
 
id’tify
 
the
 
begšnšg
 
ªd
h
’d
 
of
he

27 #tomboy 
nÙe
 
pošt
 
of
 
š£¹iÚ


28 
£lf
.
tok’_¡¬t
 = 'TOMBOY__'

29 
£lf
.
tok’_’d
 = '|'

30 
£lf
.
·th
 = 
os
.·th.
	`dœÇme
(os.·th.
	$ab¥©h
(
__fe__
))

31 
£lf
.
	$fšdTomboyIcÚP©h
()

33 #Tomboy 
š¡®ÏtiÚ
 
is
 
checked
 
through
 
the
 
´e£nû
 
of
 
™s
 
icÚ


34 
def
 
	$fšdTomboyIcÚP©h
(
£lf
):

35 
TOMBOY_ICON_PATH_ENDING
 = "icons/hicolor/scalable/apps/tomboy.svg"

36 
GNOTE_ICON_PATH_ENDING
 = "icons/hicolor/scalable/apps/gnote.svg"

37 
possibË_·ths
 = [

38 ("/u¤/sh¬e/" + 
TOMBOY_ICON_PATH_ENDING
, "tomboy"),

39 ("/u¤/sh¬e/" + 
GNOTE_ICON_PATH_ENDING
, "gnote"),

40 ("/u¤/loÿl/sh¬e/" + 
TOMBOY_ICON_PATH_ENDING
, "tomboy"),

41 ("/u¤/loÿl/sh¬e/" + 
GNOTE_ICON_PATH_ENDING
, "gnote")]

42 
·th
, 
soáw¬e
 
š
 
possibË_·ths
:

43 
os
.
·th
.
	$isfe
(
·th
):

44 
£lf
.
tomboy_icÚ_·th
 = 
·th


45 
£lf
.
soáw¬e
 = software

46  
True


47  
F®£


49 #FunùiÚ 
ÿÎed
 
upÚ
 
¶ug
-
š
 
aùiv©iÚ


50 
def
 
	$aùiv©e
(
£lf
, 
¶ugš_­i
):

51 
£lf
.
bud”
 = 
Gtk
.
	$Bud”
()

53 #R‘uº 
Œue
 
is
 
Tomboy
/
GnÙe
 i 
´e£Á
, 
Ùh”wi£
 
shows
 
a
 
dŸlog


54 #(
Úly
 
Úû
è
ªd
 
»tuºs
 
F®£


55 
def
 
	$checkTomboyP»£Á
(
£lf
):

56 
nÙ
 
	`ha§‰r
(
£lf
, 'activated'):

57 
£lf
.
aùiv©ed
 = s–f.
	$fšdTomboyIcÚP©h
()

58 #Th
nÙifiÿtiÚ
 
to
 
di§bË
 
the
 
¶ug
-
š
Øth
u£r
 
wl
 
be


59 #showed 
Úly
 
Úû


60 
DIALOG_DESTROY_WITH_PARENT
 = 
Gtk
.
DŸlogFÏgs
.
DESTROY_WITH_PARENT


61 
nÙ
 
£lf
.
aùiv©ed
:

62 
mes§ge
 = 
	`_
("Tomboy/Gnote‚ot found. Please install it or "

64 
dŸlog
 = 
Gtk
.
	`Mes§geDŸlog
(

65 
·»Á
=
£lf
.
¶ugš_­i
.
	`g‘_ui
().
	`g‘_wšdow
(),

66 
æags
=
DIALOG_DESTROY_WITH_PARENT
,

67 
ty³
=
Gtk
.
Mes§geTy³
.
ERROR
,

68 
bu‰Ús
=
Gtk
.
Bu‰ÚsTy³
.
OK
,

69 
mes§ge_fÜm©
=
mes§ge
,

71 
dŸlog
.
	$run
()

72 
dŸlog
.
	$de¡roy
()

73  
£lf
.
aùiv©ed


75 #R‘uº 
a
 
‹xtu®
 
tok’
 
to
 
»´e£Á
 
the
 
Tomboy
 
widg‘
. 
It
's useful

76 #sšû 
the
 
sk
 
is
 
§ved
 
as
 
pu»
 
‹xt


77 
def
 
	$widg‘TÙext
(
£lf
, 
widg‘
):

78  
£lf
.
tok’_¡¬t
 + 
widg‘
.
tomboy_nÙe_t™Ë
 + s–f.
tok’_’d


80 #CÚv”t 
®l
 
tomboy
 
nÙe
 
widg‘s
 
š
 
the
 
equiv®’t
 
‹xt


81 
def
 
	$ÚTaskClo£d
(
£lf
, 
¶ugš_­i
):

82 
nÙ
 
	`ha§‰r
(
£lf
, "aùiv©ed"è
Ü
‚Ù s–f.
aùiv©ed
 
is
 
True
:

83 #¶ugš 
has
 
nÙ
 
b“n
 
´İ”ly
 
aùiv©ed
, (
bug
 475877 )

84 #şosšg 
w™hout
 
executšg
 
ÚTaskClo£d


86 
ªchÜ
 
š
 
£lf
.
ªchÜs
:

87 
widg‘s
 = 
ªchÜ
.
	$g‘_widg‘s
()

88 
ªchÜ
.
	$g‘_d–‘ed
():

89 #Th
nÙe
 
has
 
b“n
 
d–‘ed
, 
sk


91 
™”_¡¬t
 = 
£lf
.
‹xtv›w
.
buff
.
	$g‘_™”_©_chd_ªchÜ
(
ªchÜ
)

92 
™”_’d
 = 
™”_¡¬t
.
	$cİy
()

93 
™”_’d
.
	$fÜw¬d_ch¬
()

94 
	`ty³
(
widg‘s
è=ğ
li¡
 
ªd
 
	`Ën
(widgets) != 0:

95 #th
ªchÜ
 
¡l
 
cÚšs
 
a
 
widg‘
.

96 
widg‘
 = 
widg‘s
[0]

97 
£lf
.
‹xtv›w
.
buff
.
	$d–‘e
(
™”_¡¬t
, 
™”_’d
)

98 
£lf
.
‹xtv›w
.
buff
.
	`š£¹
(
™”_¡¬t
,

99 
£lf
.
	$widg‘TÙext
(
widg‘
))

101 #add 
a
 
	`™em
(
bu‰Ú
è
to
 
the
 
ToŞB¬
, 
w™h
‡ 
niû
 
icÚ


102 
def
 
	$addBu‰ÚToToŞb¬
(
£lf
, 
¶ugš_­i
):

103 
nÙ
 
£lf
.
	$checkTomboyP»£Á
():

105 
tb_Taskbu‰Ú_image
 = 
Gtk
.
	$Image
()

106 
tb_Taskbu‰Ú_image_·th
 = 
£lf
.
tomboy_icÚ_·th


107 
tb_Taskbu‰Ú_pixbuf
 = 
GdkPixbuf
.
Pixbuf
.
	$Ãw_äom_fe_©_size
(

108 
tb_Taskbu‰Ú_image_·th
, 16, 16)

109 
tb_Taskbu‰Ú_image
.
	$£t_äom_pixbuf
(
tb_Taskbu‰Ú_pixbuf
)

110 
£lf
.
tb_Taskbu‰Ú
 = 
Gtk
.
	$ToŞBu‰Ú
(
tb_Taskbu‰Ú_image
)

111 
£lf
.
tb_Taskbu‰Ú
.
	`£t_Ïb–
(
	`_
("Add Tomboy‚ote"))

112 
£lf
.
tb_Taskbu‰Ú
.
	`cÚÃù
('şicked', s–f.
ÚTbTaskBu‰Ú
,

113 
£lf
.
¶ugš_­i
)

114 
£lf
.
tb_Taskbu‰Ú
.
	$show_®l
()

115 
£lf
.
¶ugš_­i
.
	$add_toŞb¬_™em
(
£lf
.
tb_Taskbu‰Ú
)

117 #CÚv”t 
®l
 
the
 
‹xtu®
 
tok’s
 
š
 
tomboy
 
nÙe
 
widg‘s


118 
def
 
	$cÚv”tTok’sToWidg‘s
(
£lf
):

119 
£lf
.
ªchÜs
 = []

120 
¡¬t_™”
 = 
£lf
.
‹xtv›w
.
buff
.
	$g‘_¡¬t_™”
()

121 
’d_™”
 = 
£lf
.
‹xtv›w
.
buff
.
	$g‘_’d_™”
()

122 
‹xt
 = 
£lf
.
‹xtv›w
.
buff
.
	$g‘_¦iû
(
¡¬t_™”
, 
’d_™”
, 
True
)

123 
‹xt_off£t
 = 0

124 
tok’_pos™iÚ
 = 
‹xt
.
	$fšd
(
£lf
.
tok’_¡¬t
)

125 
tok’_’dšg
 = 
‹xt
.
	$fšd
(
£lf
.
tok’_’d
, 
tok’_pos™iÚ
)

126 
nÙ
 
tok’_pos™iÚ
 < 0 
ªd
‚Ù 
tok’_’dšg
 < 0:

127 #d–‘
the
 
‹xt
 
of
h
tok’


128 
tomboy_nÙe_t™Ë
 = 
‹xt
[
tok’_pos™iÚ
 + 
	$Ën
(
£lf
.
tok’_¡¬t
):

129 
tok’_’dšg
]

130 
¡¬t_™”
 = 
£lf
.
‹xtv›w
.
buff
.
	`g‘_™”_©_off£t
(
‹xt_off£t
 +

131 
tok’_pos™iÚ
)

132 
’d_™”
 = 
£lf
.
‹xtv›w
.
buff
.
	`g‘_™”_©_off£t
(
‹xt_off£t
 +

133 
tok’_’dšg
 + 1)

134 
£lf
.
‹xtv›w
.
buff
.
	$d–‘e
(
¡¬t_™”
, 
’d_™”
)

135 #add 
the
 
widg‘


136 
widg‘
 = 
£lf
.
	$widg‘C»©e
(
tomboy_nÙe_t™Ë
)

137 
ªchÜ
 = 
£lf
.
	$‹xtv›wIn£¹Widg‘
(
widg‘
, 
¡¬t_™”
)

138 
£lf
.
ªchÜs
.
	$­³nd
(
ªchÜ
)

139 #fšd 
the
 
Ãxt


140 
¡¬t_™”
 = 
£lf
.
‹xtv›w
.
buff
.
	$g‘_™”_©_chd_ªchÜ
(
ªchÜ
)

141 
¡¬t_™”
.
	$fÜw¬d_ch¬
()

142 
’d_™”
 = 
£lf
.
‹xtv›w
.
buff
.
	$g‘_’d_™”
()

143 
‹xt
 = 
£lf
.
‹xtv›w
.
buff
.
	$g‘_¦iû
(
¡¬t_™”
, 
’d_™”
)

144 
‹xt_off£t
 = 
¡¬t_™”
.
	$g‘_off£t
()

145 
tok’_pos™iÚ
 = 
‹xt
.
	$fšd
(
£lf
.
tok’_¡¬t
)

146 
tok’_’dšg
 = 
‹xt
.
	$fšd
(
£lf
.
tok’_’d
)

148 
def
 
	$ÚTaskO³Ãd
(
£lf
, 
¶ugš_­i
):

149 
£lf
.
¶ugš_­i
 =…lugin_api

150 
nÙ
 
£lf
.
	$checkTomboyP»£Á
(è
Ü
 
nÙ
 
¶ugš_­i
.
	$is_ed™Ü
():

152 #NOTE: 
	`g‘_‹xtv›w
(è
Úly
 
wÜks
 
š
 
this
 
funùiÚ


153 #(
£e
 
GTG
/
cÜe
/
¶ugšs
/
­i
.
py
 
docs
)

154 
£lf
.
‹xtv›w
 = 
¶ugš_­i
.
	`g‘_ui
().
	$g‘_‹xtv›w
()

155 
£lf
.
	$addBu‰ÚToToŞb¬
(
¶ugš_­i
)

156 
£lf
.
	$cÚv”tTok’sToWidg‘s
()

158 
def
 
	$d—ùiv©e
(
£lf
, 
¶ugš_­i
):

159 
Œy
:

160 
£lf
.
	$ÚTaskClo£d
(
£lf
.
¶ugš_­i
)

161 
£lf
.
¶ugš_­i
.
	$»move_toŞb¬_™em
(
£lf
.
tb_Taskbu‰Ú
)

162 
exû±
 
A‰ribu‹E¼Ü
:

163 #th
¶ugš
 
wa¢
't used

164 
·ss


166 
def
 
	$şo£_dŸlog
(
£lf
, 
widg‘
, 
d©a
=
NÚe
):

167 
£lf
.
dŸlog
.
	$de¡roy
()

168  
True


170 #İ’ 
a
 
dbus
 
cÚÃùiÚ
 
to
 
tomboy


171 
def
 
	$g‘TomboyObjeù
(
£lf
):

172 
bus
 = 
dbus
.
	$SessiÚBus
()

173 
Œy
:

174 
obj
 = 
bus
.
	`g‘_objeù
("org.gnome.Tomboy",

176 
exû±
 
dbus
.
DBusExû±iÚ
:

177 
DIALOG_DESTROY_WITH_PARENT
 = 
Gtk
.
DŸlogFÏgs
.
DESTROY_WITH_PARENT


178 
nÙ
 
	`ha§‰r
(
£lf
, "disable_flag"):

179 
mes§ge
 = 
	`_
(

182 "Tomboy/GnÙ¶ugš iÀGTG."è% 
£lf
.
soáw¬e
.
	$t™Ë
()

183 
dŸlog
 = 
Gtk
.
	`Mes§geDŸlog
(

184 
·»Á
=
£lf
.
¶ugš_­i
.
	`g‘_ui
().
	`g‘_wšdow
(),

185 
æags
=
DIALOG_DESTROY_WITH_PARENT
,

186 
ty³
=
Gtk
.
Mes§geTy³
.
ERROR
,

187 
bu‰Ús
=
Gtk
.
Bu‰ÚsTy³
.
OK
,

188 
mes§ge_fÜm©
=
mes§ge
,

190 
dŸlog
.
	$run
()

191 
dŸlog
.
	$de¡roy
()

192 
£lf
.
di§bË_æag
 = 
True


193  
NÚe


194  
dbus
.
	`IÁ”çû
(
obj
, "org.gnome.Tomboy.RemoteControl")

196 #g‘ 
the
 
li¡
 
of
h
t™Ës
 oàth
nÙes


197 
def
 
	$g‘TomboyNÙeT™ËLi¡
(
£lf
):

198 
tomboy
 = 
£lf
.
	$g‘TomboyObjeù
()

199 
tomboy
 
is
 
NÚe
:

200  
NÚe


202 
	`¡r
(
tomboy
.
	$G‘NÙeT™Ë
(
nÙe
)ènÙ
š
 
tomboy
.
	`Li¡AÎNÙes
()]

204 
def
 
	$ÚTbTaskBu‰Ú
(
£lf
, 
widg‘
, 
¶ugš_­i
):

205 
t™Ë_li¡
 = 
£lf
.
	$g‘TomboyNÙeT™ËLi¡
()

206 
t™Ë_li¡
 
is
 
NÚe
:

208 #C»©
the
 
dŸlog


209 
u£r_š‹rçû_fe
 = 
os
.
·th
.
	`još
(
£lf
.path, "tomboy.ui")

210 
£lf
.
bud”
.
	$add_äom_fe
(
u£r_š‹rçû_fe
)

211 
£lf
.
dŸlog
 = s–f.
bud”
.
	`g‘_objeù
("InsertNoteDialog")

212 
£lf
.
combobox
 = s–f.
bud”
.
	`g‘_objeù
("titles_combobox")

213 
£lf
.
Ïb–_ÿ±iÚ
 = s–f.
bud”
.
	`g‘_objeù
("label_caption")

214 
£lf
.
bud”
.
	`cÚÃù_sigÇls
({

215 "Ú_bŠ_ÿnûl_şicked": 
£lf
.
şo£_dŸlog
,

216 "Ú_bŠ_add_şicked": 
£lf
.
nÙeCho£n
,

217 "Ú_In£¹NÙeDŸlog_şo£": 
£lf
.
şo£_dŸlog
,

218 
	}
})

219 
£lf
.
combobox_’Œy
 = 
	$sm¬tifyComboboxEÁry
(
£lf
.
combobox
,

220 
t™Ë_li¡
,

221 
£lf
.
nÙeCho£n
)

222 
£lf
.
dŸlog
.
	$show_®l
()

224 
def
 
	$_node_exi¡
(
£lf
, 
tomboy
, 
t™Ë
):

225 
nÙe
 
š
 
tomboy
.
	$Li¡AÎNÙes
():

226 
tomboy
.
	`G‘NÙeT™Ë
(
nÙe
è=ğ
t™Ë
:

227  
True


228  
F®£


230 #A 
t™Ë
 
has
 
b“n
 
cho£n
 
by
 
the
 
u£r
. 
If
h
nÙe
 
exi¡s
, 
™
 
wl
 
be


231 #lšked, 
Ùh”wi£
 
the
 
u£r
 
wl
 
have
h
İtiÚ
 
to
 
ü—‹
h
nÙe
.

232 
def
 
	$nÙeCho£n
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

233 
tomboy
 = 
£lf
.
	$g‘TomboyObjeù
()

234 
tomboy
 
is
 
NÚe
:

236 
suµo£d_t™Ë
 = 
£lf
.
combobox_’Œy
.
	$g‘_‹xt
()

237 
nÙ
 
£lf
.
	$_node_exi¡
(
tomboy
, 
suµo£d_t™Ë
):

238 
£lf
.
Ïb–_ÿ±iÚ
.
	`£t_‹xt
(
	`_
("That‚ote does‚otƒxist!"))

239 
DIALOG_DESTROY_WITH_PARENT
 = 
Gtk
.
DŸlogFÏgs
.
DESTROY_WITH_PARENT


240 
mes§ge
 = 
	`_
(

242 
dŸlog
 = 
Gtk
.
	$Mes§geDŸlog
(

243 
·»Á
=
£lf
.
dŸlog
,

244 
æags
=
DIALOG_DESTROY_WITH_PARENT
,

245 
ty³
=
Gtk
.
Mes§geTy³
.
QUESTION
,

246 
bu‰Ús
=
Gtk
.
Bu‰ÚsTy³
.
YES_NO
,

247 
mes§ge_fÜm©
=
mes§ge
,

249 
»¥Ú£
 = 
dŸlog
.
	$run
()

250 
dŸlog
.
	$de¡roy
()

251 
»¥Ú£
 =ğ
Gtk
.
Re¥Ú£Ty³
.
YES
:

252 
tomboy
.
	$C»©eNamedNÙe
(
suµo£d_t™Ë
)

255 #nÙ
š£¹iÚ


256 
m¬k_¡¬t
 = 
£lf
.
‹xtv›w
.
buff
.
	$g‘_š£¹
()

257 
™”_¡¬t
 = 
£lf
.
‹xtv›w
.
buff
.
	$g‘_™”_©_m¬k
(
m¬k_¡¬t
)

258 
tomboy_widg‘
 = 
£lf
.
	$widg‘C»©e
(
suµo£d_t™Ë
)

259 
ªchÜ
 = 
£lf
.
	$‹xtv›wIn£¹Widg‘
(
tomboy_widg‘
, 
™”_¡¬t
)

260 
£lf
.
ªchÜs
.
	$­³nd
(
ªchÜ
)

261 
£lf
.
dŸlog
.
	$de¡roy
()

263 #O³n 
a
 
nÙe
 
š
 
tomboy
 
­¶iÿtiÚ
 
vŸ
 
dbus


264 
def
 
	$tomboyDi¥ÏyNÙe
(
£lf
, 
widg‘
, 
d©a
=
NÚe
):

265 
tomboy
 = 
£lf
.
	$g‘TomboyObjeù
()

266 
tomboy
 
is
 
NÚe
:

268 
nÙe
 = 
tomboy
.
	$FšdNÙe
(
widg‘
.
tomboy_nÙe_t™Ë
)

269 
	`¡r
(
nÙe
) == "":

270 
DIALOG_DESTROY_WITH_PARENT
 = 
Gtk
.
DŸlogFÏgs
.
DESTROY_WITH_PARENT


271 
dŸlog
 = 
Gtk
.
	`Mes§geDŸlog
(
·»Á
=
£lf
.
¶ugš_­i
.
	`g‘_ui
().

272 
	`g‘_wšdow
(),

273 
æags
=
DIALOG_DESTROY_WITH_PARENT
,

274 
ty³
=
Gtk
.
Mes§geTy³
.
WARNING
,

275 
bu‰Ús
=
Gtk
.
Bu‰ÚsTy³
.
YES_NO
,

276 
mes§ge_fÜm©
=(
	`_
("This Tomboy‚ote \
‚otƒxist‡nymore. Do you wanto\
 it?")))

279 
»¥Ú£
 = 
dŸlog
.
	$run
()

280 
dŸlog
.
	$de¡roy
()

281 
»¥Ú£
 =ğ
Gtk
.
Re¥Ú£Ty³
.
YES
:

282 
tomboy
.
	$C»©eNamedNÙe
(
widg‘
.
tomboy_nÙe_t™Ë
)

283 
tomboy
.
	$Di¥ÏyNÙe
(
nÙe
)

285 
tomboy
.
	$Di¥ÏyNÙe
(
nÙe
)

287 #š£¹ 
a
 
widg‘
 
š
 
the
 
‹xtv›w


288 
def
 
	$‹xtv›wIn£¹Widg‘
(
£lf
, 
widg‘
, 
™”
):

289 
ªchÜ
 = 
£lf
.
‹xtv›w
.
buff
.
	$ü—‹_chd_ªchÜ
(
™”
)

290 
widg‘
.
	$show
()

291 
£lf
.
‹xtv›w
.
	$add_chd_©_ªchÜ
(
widg‘
, 
ªchÜ
)

292  
ªchÜ


294 #ü—‹ 
the
 
tomboy
 
widg‘


295 
def
 
	$widg‘C»©e
(
£lf
, 
tomboy_nÙe_t™Ë
):

296 
image
 = 
Gtk
.
	$Image
()

297 
wšdow
 = 
£lf
.
¶ugš_­i
.
	`g‘_ui
().
	$g‘_wšdow
()

298 
wšdow
.
	$»®ize
()

299 
pixbuf
 = 
Gdk
.
	$pixbuf_Ãw_äom_fe_©_size
(

300 
£lf
.
tomboy_icÚ_·th
, 16, 16)

301 
image
.
	$show
()

302 
image
.
	$£t_äom_pixbuf
(
pixbuf
)

303 
image
.
	$£t_®ignm’t
(0.5, 1.0)

304 
Ïb–
 = 
Gtk
.
	$Lab–
()

305 
wšdow_¡yË
 = 
wšdow
.
	$g‘_¡yË_cÚ‹xt
()

306 
cŞÜ
 = 
wšdow_¡yË
.
	`g‘_cŞÜ
(

307 
Gtk
.
S‹Ty³
.
PRELIGHT
).
	`to_cŞÜ
().
	$to_¡ršg
()

308 
t™Ë
 = 
tomboy_nÙe_t™Ë


309 
Ïb–
.
	`£t_m¬kup
("<¥ª und”lše='low' cŞÜ='%s'>%s</¥ª>" % (
cŞÜ
,

310 
t™Ë
)

312 
Ïb–
.
	$show
()

313 
Ïb–
.
	$£t_®ignm’t
(0.5, 1.0)

314 
ev’tbox
 = 
Gtk
.
	$Ev’tBox
()

315 
ev’tbox
.
	$£t_ev’ts
(
Gdk
.
Ev’tMask
.
BUTTON_PRESS_MASK
)

316 
ev’tbox
.
	`cÚÃù
('bu‰Ú_´ess_ev’t', 
£lf
.
tomboyDi¥ÏyNÙe
)

317 
box
 = 
Gtk
.
	$Box
()

318 
box
.
	$show
()

319 
box
.
	$add
(
image
)

320 
box
.
	$add
(
Ïb–
)

321 
ev’tbox
.
	$add
(
box
)

322 #th
ev’tbox
 
should
 
fŞlow
 
the
 
cŞours
 
of
h
‹xtv›w
 
to
 
bËnd
 
š


324 
‹xtv›w_¡yË
 = 
£lf
.
‹xtv›w
.
	$g‘_¡yË_cÚ‹xt
()

325 
¡©e
 
	$š
 (
Gtk
.
S‹Ty³
.
NORMAL
, Gtk.S‹Ty³.
PRELIGHT
,

326 
Gtk
.
S‹Ty³
.
ACTIVE
, Gtk.S‹Ty³.
SELECTED
,

327 
Gtk
.
S‹Ty³
.
INSENSITIVE
):

328 
fg_cŞÜ
 = 
‹xtv›w_¡yË
.
	$g‘_cŞÜ
(
¡©e
)

329 
ev’tbox
.
	$ov”ride_cŞÜ
(
¡©e
, 
fg_cŞÜ
)

331 
bg_cŞÜ
 = 
‹xtv›w_¡yË
.
	$g‘_background_cŞÜ
(
¡©e
)

332 
ev’tbox
.
	$ov”ride_background_cŞÜ
(
¡©e
, 
bg_cŞÜ
)

333 
ev’tbox
.
	$show
()

334 
ev’tbox
.
tomboy_nÙe_t™Ë
 =omboy_note_title

335 #cursÜ 
chªges
 
to
 
a
 
hªd


337 
def
 
	$»®ize_ÿÎback
(
widg‘
):

338 
ev’tbox
.
wšdow
.
	`£t_cursÜ
(
Gdk
.
CursÜ
.
	$Ãw
(
Gdk
.
HAND2
))

339 
ev’tbox
.
	`cÚÃù
("»®ize", 
»®ize_ÿÎback
)

340  
ev’tbox


	@plugins/untouched_tasks/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2012 - 
Tom
 
Kadwl
 <
tomkadwl
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
	gGTG
.
	g¶ugšs
.
	guÁouched_sks
.
uÁouchedTasks
 
impÜt
 
	g¶ugšUÁouchedTasks


17 #suµ»s 
pyæakes
 
w¬nšg
 (
giv’
 
by
 
make
 
lšt
)

18 
F®£
 
is
 
	gTrue
:

19 
¶ugšUÁouchedTasks
()

	@plugins/untouched_tasks/untouchedTasks.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2012 - 
Tom
 
Kadwl
 <
tomkadwl
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
th»adšg
 
impÜt
 
Tim”


15 
impÜt
 
d©‘ime


16 
impÜt
 
os


18 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


20 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
Log


23 
şass
 
	g¶ugšUÁouchedTasks
:

25 
DEFAULT_PREFERENCES
 = {'max_days': 30,

26 'is_autom©ic': 
F®£
,

29 
PLUGIN_NAME
 = "untouched-tasks"

31 #IÀ
of
 
autom©ic
 
»movšg
 
sks
, 
the
 
time


32 #b‘w“À
two
 
runs
 
of
 
the
 
ş—Ãr
 
funùiÚ


33 
	gTIME_BETWEEN_PURGES
 = 60 * 60

35 
def
 
	$__š™__
(
£lf
):

36 
£lf
.
·th
 = 
os
.·th.
	`dœÇme
(os.·th.
	$ab¥©h
(
__fe__
))

37 #GUI 
š™Ÿliz©iÚ


38 
£lf
.
bud”
 = 
Gtk
.
	$Bud”
()

39 
£lf
.
bud”
.
	`add_äom_fe
(
os
.
·th
.
	`još
(

40 
os
.
·th
.
	`dœÇme
(os.·th.
	`ab¥©h
(
__fe__
)) +

42 
£lf
.
´eã»nûs_dŸlog
 = s–f.
bud”
.
	`g‘_objeù
("preferences_dialog")

43 
£lf
.
´ef_chbox_is_autom©ic
 = \

44 
£lf
.
bud”
.
	`g‘_objeù
("pref_chbox_is_automatic")

45 
£lf
.
´ef_¥šbŠ_max_days
 = \

46 
£lf
.
bud”
.
	`g‘_objeù
("pref_spinbtn_max_days")

47 
£lf
.
´ef_g_Çme
 = \

48 
£lf
.
bud”
.
	`g‘_objeù
("pref_tag_name")

49 
SIGNAL_CONNECTIONS_DIC
 = {

51 
£lf
.
Ú_´eã»nûs_ÿnûl
,

53 
£lf
.
Ú_´eã»nûs_ÿnûl
,

55 
£lf
.
Ú_´eã»nûs_ok
,

56 
	}
}

57 
£lf
.
bud”
.
	$cÚÃù_sigÇls
(
SIGNAL_CONNECTIONS_DIC
)

58 
£lf
.
m’u_™em
 = 
Gtk
.
	`M’uI‹m
("Add @untouchedag")

59 
£lf
.
m’u_™em
.
	`cÚÃù
('aùiv©e', s–f.
add_uÁouched_g
)

61 
def
 
	$aùiv©e
(
£lf
, 
¶ugš_­i
):

62 
£lf
.
¶ugš_­i
 =…lugin_api

63 #´eã»nû 
š™Ÿliz©iÚ


64 
£lf
.
is_autom©ic
 = 
F®£


65 
£lf
.
tim”
 = 
NÚe


66 
£lf
.
	$´eã»nûs_lßd
()

67 
£lf
.
	$´eã»nûs_­¶y
()

68 #add 
m’u
 
™em


69 
£lf
.
¶ugš_­i
.
	$add_m’u_™em
(
£lf
.
m’u_™em
)

71 
def
 
	$d—ùiv©e
(
£lf
, 
¶ugš_­i
):

73 
D—ùiv©es
 
the
 
¶ugš
.

75 
¶ugš_­i
.
	$»move_m’u_™em
(
£lf
.
m’u_™em
)

76 #ev”ythšg 
should
 
be
 
»moved
, 
š
 
a
 
sk
 
is
 
cu¼’y
 
İ’ed


77 
Œy
:

78 
£lf
.
¶ugš_­i
.
	$»move_sk_toŞb¬_™em
(
£lf
.
tb_Taskbu‰Ú
)

79 
exû±
:

80 
·ss


82 ## 
HELPER
 
FUNCTIONS
 ###########################################################
 __log(£lf, mes§ge):

83 
Log
.
	$debug
(
mes§ge
)

85 ## 
CORE
 
FUNCTIONS
 #############################################################
 scheduË_autİurge(£lf):

86 
£lf
.
tim”
 = 
	$Tim”
(
£lf
.
TIME_BETWEEN_PURGES
,

87 
£lf
.
add_uÁouched_g
)

88 
£lf
.
tim”
.
	$£tD«mÚ
(
True
)

89 
£lf
.
tim”
.
	$¡¬t
()

90 
£lf
.
	`__log
("Automatic untouchedasks check scheduled")

92 
def
 
	$ÿnûl_autİurge
(
£lf
):

93 
£lf
.
tim”
:

94 
£lf
.
	`__log
("Automatic untouchedasks check cancelled")

95 
£lf
.
tim”
.
	$ÿnûl
()

97 
def
 
	$add_uÁouched_g
(
£lf
, 
widg‘
=
NÚe
):

98 #Ià
no
 
g
 
is
 
picked
 
up
 
äom
 
´eã»nûs


99 
g_Çme
 = 
£lf
.
´ef_g_Çme
.
	$g‘_‹xt
()

100 
nÙ
 
g_Çme
:

101 
g_Çme
 = 
£lf
.
´eã»nûs
['default_tag']

103 #Add @ 
u£r
 
has
 
nÙ
 
’‹»d
 
™


104 
g_Çme
.
	`fšd
('@') != 0:

105 
g_Çme
 = '@' +ag_name

107 
£lf
.
	`__log
("S¹šg…roûs fÜ‡ddšg " + 
g_Çme
)

108 
today
 = 
d©‘ime
.d©‘ime.
	$now
()

109 
max_days
 = 
£lf
.
´eã»nûs
["max_days"]

110 
»que¡”
 = 
£lf
.
¶ugš_­i
.
	$g‘_»que¡”
()

111 
şo£d_Œ“
 = 
»que¡”
.
	`g‘_sks_Œ“
(
Çme
='inactive')

112 
şo£d_sks
 = [
»que¡”
.
	$g‘_sk
(
tid
ètid 
š


113 
şo£d_Œ“
.
	`g‘_®l_nodes
()]

115 #Add 
uÁouched
 
g
 
to
 
®l
 
sks
 
wh”e
 
Ãw_d©e
 < 
time
 
now


116 
sk
 
š
 
şo£d_sks
:

117 
modif›d_time
 = 
sk
.
	$g‘_modif›d
()

118 
Ãw_time
 = 
modif›d_time
 + 
d©‘ime
.
	$timed–
(
days
=
max_days
)

119 
Ãw_time
 < 
today
:

120 
£lf
.
	`__log
('Addšg ' + 
g_Çme
 + 'ago: "' + 
sk
.
t™Ë
 +

122 
	$¡r
(
modif›d_time
))

123 
sk
.
	$add_g
(
g_Çme
)

125 #Ià
autom©ic
 
purgšg
 
is
 
Ú
, 
scheduË
 
ªÙh”
 
run


126 
£lf
.
is_autom©ic
:

127 
£lf
.
	$scheduË_autİurge
()

129 ## 
P»ã»nûs
 
m‘hods
 ########################################################

130 
def
 
	$is_cÚfigu¿bË
(
£lf
):

132  
True


134 
def
 
	$cÚfigu»_dŸlog
(
£lf
, 
mªag”_dŸlog
):

135 
£lf
.
	$´eã»nûs_lßd
()

136 
£lf
.
´eã»nûs_dŸlog
.
	$£t_Œªs›Á_fÜ
(
mªag”_dŸlog
)

137 
£lf
.
´ef_chbox_is_autom©ic
.
	`£t_aùive
(

138 
£lf
.
´eã»nûs
["is_automatic"])

139 
£lf
.
´ef_¥šbŠ_max_days
.
	`£t_v®ue
(

140 
£lf
.
´eã»nûs
["max_days"])

141 
£lf
.
´ef_g_Çme
.
	`£t_‹xt
(

142 
£lf
.
´eã»nûs
["default_tag"])

143 
£lf
.
´eã»nûs_dŸlog
.
	$show_®l
()

145 
def
 
	$Ú_´eã»nûs_ÿnûl
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

146 
£lf
.
´eã»nûs_dŸlog
.
	$hide
()

147  
True


149 
def
 
	$Ú_´eã»nûs_ok
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

150 
£lf
.
´eã»nûs
["is_automatic"] = \

151 
£lf
.
´ef_chbox_is_autom©ic
.
	$g‘_aùive
()

152 
£lf
.
´eã»nûs
["max_days"] = \

153 
£lf
.
´ef_¥šbŠ_max_days
.
	$g‘_v®ue
()

154 
£lf
.
´eã»nûs
['default_tag'] = \

155 
£lf
.
´ef_g_Çme
.
	$g‘_‹xt
()

156 
£lf
.
	$´eã»nûs_­¶y
()

157 
£lf
.
	$´eã»nûs_¡Üe
()

158 
£lf
.
´eã»nûs_dŸlog
.
	$hide
()

160 
def
 
	$´eã»nûs_lßd
(
£lf
):

161 
£lf
.
´eã»nûs
 = s–f.
¶ugš_­i
.
	`lßd_cÚfigu¿tiÚ_objeù
(

162 
£lf
.
PLUGIN_NAME
, "preferences",

163 
deçuÉ_v®ues
=
£lf
.
DEFAULT_PREFERENCES
)

165 
def
 
	$´eã»nûs_¡Üe
(
£lf
):

166 
£lf
.
¶ugš_­i
.
	`§ve_cÚfigu¿tiÚ_objeù
(£lf.
PLUGIN_NAME
,

168 
£lf
.
´eã»nûs
)

170 
def
 
	$´eã»nûs_­¶y
(
£lf
):

171 #Auto-
purge


172 
£lf
.
´eã»nûs
['is_autom©ic'] 
is
 
True
 
ªd
 \

173 
£lf
.
is_autom©ic
 
is
 
F®£
:

174 
£lf
.
is_autom©ic
 = 
True


175 #RuÀ
the
 
fœ¡
 
™”©iÚ
 
immedŸ‹ly
 
ªd
 
scheduË
 
Ãxt
 iteration

176 
£lf
.
	$add_uÁouched_g
()

177 
–if
 
£lf
.
´eã»nûs
['is_autom©ic'] 
is
 
F®£
 
ªd
 \

178 
£lf
.
is_autom©ic
 
is
 
True
:

179 
£lf
.
	$ÿnûl_autİurge
()

180 
£lf
.
is_autom©ic
 = 
F®£


	@plugins/urgency_color/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2012 - 
WŞ‹r
 
H–lmund
 <
wŞ‹rh6
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
	gGTG
.
	g¶ugšs
.
	gurg’cy_cŞÜ
.
urg’cy_cŞÜ
 
impÜt
 
	g¶ugšUrg’cyCŞÜ


16 #suµ»s 
pyæakes
 
w¬nšg
 (
giv’
 
by
 
make
 
lšt
)

17 
F®£
 
is
 
	gTrue
:

18 
¶ugšUrg’cyCŞÜ
()

	@plugins/urgency_color/urgency_color.py

1 #-*- 
codšg
: 
utf
-8 -*-

2 #Cİyrighˆ(
c
è2012 - 
WŞ‹r
 
H–lmund
 <
wŞ‹rh6
@
gma
.
com
>

3 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


4 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


5 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


7 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


8 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


9 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


11 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


12 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

14 
äom
 
m©h
 
impÜt
 
û


15 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gtk


16 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
Gdk


17 
impÜt
 
os


19 
äom
 
	gGTG
.
	gtoŞs
.
d©es
 
impÜt
 
D©e


22 
şass
 
	g¶ugšUrg’cyCŞÜ
:

24 
PLUGIN_NAME
 = 'Urgency Color'

25 
DEFAULT_PREFS
 = {

32 
def
 
	$__š™__
(
£lf
):

33 
£lf
.
_¶ugš_­i
 = 
NÚe


34 
£lf
.
»q
 = 
NÚe


36 
def
 
	$aùiv©e
(
£lf
, 
¶ugš_­i
):

38 
£lf
.
_¶ugš_­i
 = 
¶ugš_­i


39 
£lf
.
»q
 = s–f.
_¶ugš_­i
.
	$g‘_»que¡”
()

40 
£lf
.
	$´efs_lßd
()

41 
£lf
.
	$´efs_š™
()

42 #S‘ 
cŞÜ
 
funùiÚ


43 
£lf
.
	$_»äesh_sk_cŞÜ
()

45 
def
 
	$_»äesh_sk_cŞÜ
(
£lf
):

46 
£lf
.
_¶ugš_­i
.
	$£t_bgcŞÜ_func
(
£lf
.
bgcŞÜ
)

48 
def
 
	$_g‘_cŞÜ
(
£lf
, 
cŞšdex
):

49 
cŞšdex
 == 0:

50  
£lf
.
_´ef_d©a
['color_low']

51 
–if
 
cŞšdex
 == 1:

52  
£lf
.
_´ef_d©a
['color_normal']

53 
–if
 
cŞšdex
 == 2:

54  
£lf
.
_´ef_d©a
['color_high']

55 
–if
 
cŞšdex
 == 3:

56  
£lf
.
_´ef_d©a
['color_overdue']

58  
NÚe


60 
def
 
	$_g‘_g¿d›Á_cŞÜ
(
£lf
, 
cŞÜ1
, 
cŞÜ2
, 
pos™iÚ
):

62 
	$pos™iÚ
 (
a
 
v®ue
 
äom
 0 
to
 1è
š
 
the
 
g¿d›Á
 
fÜmed
 
by
he

63 
cŞÜs
 
cŞÜ1
 
ªd
 
cŞÜ2
, 
bÙh
 
of
 
ty³
 
Gdk
.
CŞÜ
"""

64 
cŞÜ1
 = 
Gdk
.
	$cŞÜ_·r£
(
cŞÜ1
)

65 
cŞÜ2
 = 
Gdk
.
	$cŞÜ_·r£
(
cŞÜ2
)

66 
R1
, 
G1
, 
B1
 = 
cŞÜ1
.
»d
, cŞÜ1.
g»’
, cŞÜ1.
blue


67 
R2
, 
G2
, 
B2
 = 
cŞÜ2
.
»d
, cŞÜ2.
g»’
, cŞÜ2.
blue


68 
R
 = 
R1
 + (
R2
 - R1è* 
pos™iÚ


69 
G
 = 
G1
 + (
G2
 - G1è* 
pos™iÚ


70 
B
 = 
B1
 + (
B2
 - B1è* 
pos™iÚ


71  
Gdk
.
	`CŞÜ
((
R
), (
G
), (
B
))

73 
def
 
	$g‘_node_bgcŞÜ
(
£lf
, 
node
):

75 
urg’cy
 
background
 
cŞÜ
"""

76 
sd©e
 = 
node
.
	$g‘_¡¬t_d©e
()

77 
dd©e
 = 
node
.
	$g‘_due_d©e
()

78 
day¦eá
 = 
dd©e
.
	$days_Ëá
()

80 #D©e 
	`undefšed
 (
Fix
 
to
 
bug
 #1039655)

81 ià(
dd©e
 =ğ
D©e
.
	$today
()):

82  
£lf
.
	$_g‘_cŞÜ
(2è#High 
urg’cy


83 
	`–if
 (
day¦eá
 < 0 
ªd
 
dd©e
 !ğ
D©e
.
	$no_d©e
()):

84  
£lf
.
	$_g‘_cŞÜ
(3) #Overdue

85 
	`–if
 (
sd©e
 =ğ
D©e
.
	$no_d©e
(è#Ha 
no
 
¡¬t
 
d©e


86 
ªd
 
dd©e
 !ğ
D©e
.
	$no_d©e
(è#ªd 
a
 
due
 
d©e


87 
ªd
 
nÙ
 
dd©e
.
	$is_fuzzy
()): #which 
is
 
nÙ
 
fuzzy
, i 
fixed


88  
£lf
.
	$_g‘_cŞÜ
(1) #Normal

90 #Fuzzy 
	`d©es
 (
now
, 
soÚ
, 
someday
)

91 #The£ 
ÿn
 
ignÜe
 
the
 
¡¬t
 
d©e


92 ià(
dd©e
 =ğ
D©e
.
	$now
()):

93  
£lf
.
	$_g‘_cŞÜ
(2)

94 
	`–if
 (
dd©e
 =ğ
D©e
.
	$soÚ
()):

95  
£lf
.
	$_g‘_cŞÜ
(1)

96 
	`–if
 (
dd©e
 =ğ
D©e
.
	$someday
()):

97  
£lf
.
	$_g‘_cŞÜ
(0)

99 #D©e 
fuÎy
 
defšed
. 
C®cuÏ‹
 
g¿d›Á
 
cŞÜ


100 
	`–if
 (
sd©e
 !ğ
D©e
.
	`no_d©e
(è!ğ
dd©e
):

101 
day¥ª
 = (
dd©e
 - 
sd©e
).
days


102 
»df
 = 
£lf
.
_´ef_d©a
['reddays']

103 
»ddays
 = (
	`û
(
»df
 / 100.0 * 
day¥ª
))

105 #G¿d›Á 
v¬ŸbËs


106 
g¿d_day¥ª
 = 
day¥ª
 - 
»ddays


107 
g¿d_h®f_day¥ª
 = 
g¿d_day¥ª
 / 2.0

109 #DeçuÉ 
to
 
low
 
urg’cy
 
cŞÜ


110 
cŞÜ
 = 
£lf
.
	$_g‘_cŞÜ
(0)

112 #CL : 
low
 
urg’cy
 
cŞÜ


113 #CN : 
nÜm®
 
urg’cy
 
cŞÜ


114 #CH : 
high
 
urg’cy
 
cŞÜ


115 #CO : 
ov”due
 
cŞÜ


116 #TØ
und”¡ªd
 
this
 
£ùiÚ
, 
™
 
is
 
—s›r
 
to
 
d¿w
 
out
 
a


117 #tim–š
divided
 
što
 3 
£ùiÚs
: 
CL
 
to
 
CN
, CNØ
CH
 
ªd


118 #th
»ddays
 
£ùiÚ
. 
Th’
 
pošt
 
out
 
the
 
¥ªs
 
of
he

119 #difã»Á 
	`v¬ŸbËs
 (
day¥ª
, 
day¦eá
, 
»ddays
,

120 #g¿d_day¥ª, 
g¿d_h®f_day¥ª
)

121 
day¦eá
 < 0: #CO

122 
cŞÜ
 = 
£lf
.
	$_g‘_cŞÜ
(3)

123 
–if
 
day¦eá
 <ğ
»ddays
: #CH

124 
cŞÜ
 = 
£lf
.
	$_g‘_cŞÜ
(2)

125 
–if
 
day¦eá
 <ğ(
day¥ª
 - 
g¿d_h®f_day¥ª
):

126 #G¿d›Á 
CN
 
to
 
CH


127 #Ha 
to
 
be
 
so
 
divisiÚ
 
by
 
™
 
is
 
nÚ
-
z”o


128 
¡•s
 = (
g¿d_h®f_day¥ª
)

129 
¡•
 = 
g¿d_h®f_day¥ª
 - (
day¦eá
 - 
»ddays
)

130 
cŞÜ
 = 
£lf
.
	`_g‘_g¿d›Á_cŞÜ
(£lf.
	`_g‘_cŞÜ
(1),

131 
£lf
.
	`_g‘_cŞÜ
(2),

132 
¡•
 / 
¡•s
)

133 
–if
 
day¦eá
 <ğ
day¥ª
:

134 #G¿d›Á 
CL
 
to
 
CN


135 
¡•s
 = (
g¿d_h®f_day¥ª
)

136 
¡•
 = 
g¿d_h®f_day¥ª
 - (
day¦eá
 -

137 
»ddays
 - 
g¿d_h®f_day¥ª
)

138 
cŞÜ
 = 
£lf
.
	`_g‘_g¿d›Á_cŞÜ
(£lf.
	`_g‘_cŞÜ
(0),

139 
£lf
.
	`_g‘_cŞÜ
(1),

140 
¡•
 / 
¡•s
)

142  
cŞÜ


144 #Insuffic›Á 
d©a
 
to
 
d‘”mše
 
urg’cy


146  
NÚe


148 
def
 
	$bgcŞÜ
(
£lf
, 
node
, 
¡ªd¬d_cŞÜ
):

149 
cŞÜ
 = 
£lf
.
	$g‘_node_bgcŞÜ
(
node
)

151 
def
 
	$__g‘_aùive_chd_li¡
(
node
):

153 
of
 
®l
 
the
 
chd»n
 oà
a
 
sk
 
which
 
¬e
 
aùive


154 (
i
.
e
 - 
the
 
subsks
 
which
 
¬e
 
nÙ
 
m¬ked
 
as
 'DÚe' 
Ü
 'Dismissed'

156 
chd_li¡
 = []

157 
chd_id
 
š
 
node
.
chd»n
:

158 
chd
 = 
node
.
»q
.
	$g‘_sk
(
chd_id
)

159 
chd_li¡
 +ğ
	$__g‘_aùive_chd_li¡
(
chd
)

160 
chd
.
	$g‘_¡©us
(è
š
 [
chd
.
STA_ACTIVE
]:

161 
chd_li¡
.
	$­³nd
(
chd_id
)

162  
chd_li¡


164 
chd_li¡
 = 
	$__g‘_aùive_chd_li¡
(
node
)

166 
day¦eá
 = 
NÚe


167 
chd_id
 
š
 
chd_li¡
:

168 
chd
 = 
£lf
.
»q
.
	$g‘_sk
(
chd_id
)

169 
chd
.
	`g‘_due_d©e
(è=ğ
D©e
.
	$no_d©e
():

172 
day¦eá_of_chd
 = 
chd
.
	`g‘_due_d©e
().
	$days_Ëá
()

173 
day¦eá
 
is
 
NÚe
:

174 
day¦eá
 = 
day¦eá_of_chd


175 
cŞÜ
 = 
£lf
.
	$g‘_node_bgcŞÜ
(
chd
)

176 
–if
 
day¦eá_of_chd
 < 
day¦eá
:

177 
day¦eá
 = 
day¦eá_of_chd


178 
cŞÜ
 = 
£lf
.
	$g‘_node_bgcŞÜ
(
chd
)

180  
cŞÜ


182 
def
 
	$d—ùiv©e
(
£lf
, 
¶ugš_­i
):

184 
£lf
.
_¶ugš_­i
.
	$£t_bgcŞÜ_func
()

186 #P»ã»nû 
dŸlog


187 
def
 
	$is_cÚfigu¿bË
(
£lf
):

189  
True


191 
def
 
	$cÚfigu»_dŸlog
(
£lf
, 
mªag”_dŸlog
):

192 
£lf
.
_´ef_d©a_pÙ’tŸl
 = s–f.
_´ef_d©a


193 
£lf
.
´efs_wšdow
.
	$show_®l
()

194 #£lf.
´efs_wšdow
.
	`£t_Œªs›Á_fÜ
(
mªag”_dŸlog
)

195 
·ss


197 
def
 
	$´efs_š™
(
£lf
):

198 
£lf
.
bud”
 = 
Gtk
.
	$Bud”
()

199 
£lf
.
bud”
.
	`add_äom_fe
(
os
.
·th
.
	`još
(

200 
os
.
·th
.
	`dœÇme
(os.·th.
	`ab¥©h
(
__fe__
)),

203 #G‘ 
the
 
widg‘s


205 
£lf
.
´efs_wšdow
 = s–f.
bud”
.
	`g‘_objeù
('prefs_window')

206 
£lf
.
´efs_wšdow
.
	`£t_t™Ë
(('GTG - %s…references'

207 % 
£lf
.
PLUGIN_NAME
))

208 
£lf
.
´efs_wšdow
.
	`£t_size_»que¡
(300, -1)

209 
£lf
.
´efs_wšdow
.
	$hide_Ú_d–‘e
()

211 #Spš 
bu‰Ú


212 
£lf
.
¥šbu‰Ú_»ddays
 = s–f.
bud”
.
	`g‘_objeù
('spinbutton_reddays')

214 #CŞÜbu‰Ú - 
OVERDUE


215 
£lf
.
cŞÜbu‰Ú_ov”due
 = s–f.
bud”
.
	`g‘_objeù
(

218 #CŞÜbu‰Ú - 
HIGH


219 
£lf
.
cŞÜbu‰Ú_high
 = s–f.
bud”
.
	`g‘_objeù
('colorbutton_high')

221 #CŞÜbu‰Ú - 
NORMAL


222 
£lf
.
cŞÜbu‰Ú_nÜm®
 = s–f.
bud”
.
	`g‘_objeù
('colorbutton_normal')

224 #CŞÜbu‰Ú - 
LOW


225 
£lf
.
cŞÜbu‰Ú_low
 = s–f.
bud”
.
	`g‘_objeù
('colorbutton_low')

228 
£lf
.
bu‰Ú_­¶y
 = s–f.
bud”
.
	`g‘_objeù
('button_apply')

229 
£lf
.
bu‰Ú_»£t
 = s–f.
bud”
.
	`g‘_objeù
('button_reset')

231 #Upd©
widg‘
's values

232 
£lf
.
	$´efs_upd©e_widg‘s
()

234 #SigÇÈ
cÚÃùiÚs


235 
SIGNAL_CONNECTIONS_DIC
 = {

237 
£lf
.
Ú_´efs_ÿnûl
,

239 
£lf
.
Ú_´efs_­¶y
,

241 
£lf
.
Ú_´efs_»£t
,

243 
£lf
.
Ú_´efs_¥šbu‰Ú_»ddays_chªged
,

245 
£lf
.
Ú_´efs_cŞÜbu‰Ú_ov”due_chªged
,

247 
£lf
.
Ú_´efs_cŞÜbu‰Ú_high_chªged
,

249 
£lf
.
Ú_´efs_cŞÜbu‰Ú_nÜm®_chªged
,

251 
£lf
.
Ú_´efs_cŞÜbu‰Ú_low_chªged
}

252 
£lf
.
bud”
.
	$cÚÃù_sigÇls
(
SIGNAL_CONNECTIONS_DIC
)

254 
def
 
	$´efs_upd©e_widg‘s
(
£lf
):

256 #Spš 
bu‰Ú


257 
£lf
.
¥šbu‰Ú_»ddays
.
	`£t_v®ue
(£lf.
_´ef_d©a
['reddays'])

258 #CŞÜbu‰Ú - 
OVERDUE


259 
£lf
.
cŞÜbu‰Ú_ov”due
.
	`£t_cŞÜ
(

260 
Gdk
.
	`cŞÜ_·r£
(
£lf
.
_´ef_d©a
['color_overdue']))

261 #CŞÜbu‰Ú - 
HIGH


262 
£lf
.
cŞÜbu‰Ú_high
.
	`£t_cŞÜ
(

263 
Gdk
.
	`cŞÜ_·r£
(
£lf
.
_´ef_d©a
['color_high']))

264 #CŞÜbu‰Ú - 
NORMAL


265 
£lf
.
cŞÜbu‰Ú_nÜm®
.
	`£t_cŞÜ
(

266 
Gdk
.
	`cŞÜ_·r£
(
£lf
.
_´ef_d©a
['color_normal']))

267 #CŞÜbu‰Ú - 
LOW


268 
£lf
.
cŞÜbu‰Ú_low
.
	`£t_cŞÜ
(

269 
Gdk
.
	`cŞÜ_·r£
(
£lf
.
_´ef_d©a
['color_low']))

271 
def
 
	$Ú_´efs_ÿnûl
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

272 
£lf
.
	$´efs_upd©e_widg‘s
()

273 
£lf
.
´efs_wšdow
.
	$hide
()

274  
True


276 
def
 
	$Ú_´efs_­¶y
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

277 
£lf
.
_´ef_d©a
 = s–f.
_´ef_d©a_pÙ’tŸl


278 
£lf
.
	$´efs_¡Üe
()

279 
£lf
.
	$_»äesh_sk_cŞÜ
()

280 
£lf
.
´efs_wšdow
.
	$hide
()

282 
def
 
	$Ú_´efs_»£t
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

283 #Re¡Ü
the
  
¶ugš
 
£‰šgs


284 
£lf
.
_´ef_d©a
 = s–f.
_´ef_d©a_pÙ’tŸl
 = 
	$diù
(
£lf
.
DEFAULT_PREFS
)

285 
£lf
.
	$´efs_upd©e_widg‘s
()

287 
def
 
	$´efs_lßd
(
£lf
):

288 
£lf
.
_´ef_d©a
 = s–f.
_¶ugš_­i
.
	`lßd_cÚfigu¿tiÚ_objeù
(

289 
£lf
.
PLUGIN_NAME
, "preferences",

290 
deçuÉ_v®ues
=
£lf
.
DEFAULT_PREFS
)

292 #CORRECT 
NAMES
 
FROM
 
OLD
 
PREFERENCES


293 #Thi 
is
 
a
 
dœty
 
fix
 
ªd
 
thus
 
should
 
be
 
»moved
 
š
‡

294 #di¡ªˆ
futu»
, 
wh’
 
nobody
 
has
 "»d", "y–low" 
Ü
 "green"

296 
Çm•aœs
 = {'»d': 'high', 'y–low': 'nÜm®', 'g»’': 'low'
	}
}

297 
ŞdÇme
, 
ÃwÇme
 
š
 
	gÇm•aœs
.
	$™ems
():

298 
Şd_key
, 
Ãw_key
 = "cŞÜ_" + 
ŞdÇme
, "cŞÜ_" + 
ÃwÇme


299 
Şd_key
 
š
 
£lf
.
_´ef_d©a
:

300 
£lf
.
_´ef_d©a
[
Ãw_key
] = s–f._´ef_d©a.
	$pİ
(
Şd_key
)

302 
def
 
	$´efs_¡Üe
(
£lf
):

303 
£lf
.
_¶ugš_­i
.
	`§ve_cÚfigu¿tiÚ_objeù
(

304 
£lf
.
PLUGIN_NAME
,

306 
£lf
.
_´ef_d©a
)

308 
def
 
	$Ú_´efs_¥šbu‰Ú_»ddays_chªged
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

309 
£lf
.
_´ef_d©a_pÙ’tŸl
['reddays'] = \

310 
£lf
.
¥šbu‰Ú_»ddays
.
	$g‘_v®ue
()

312 
def
 
	$Ú_´efs_cŞÜbu‰Ú_ov”due_chªged
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

313 
£lf
.
_´ef_d©a_pÙ’tŸl
['color_overdue'] = \

314 
£lf
.
cŞÜbu‰Ú_ov”due
.
	`g‘_cŞÜ
().
	$to_¡ršg
()

316 
def
 
	$Ú_´efs_cŞÜbu‰Ú_high_chªged
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

317 
£lf
.
_´ef_d©a_pÙ’tŸl
['color_high'] = \

318 
£lf
.
cŞÜbu‰Ú_high
.
	`g‘_cŞÜ
().
	$to_¡ršg
()

320 
def
 
	$Ú_´efs_cŞÜbu‰Ú_nÜm®_chªged
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

321 
£lf
.
_´ef_d©a_pÙ’tŸl
['color_normal'] = \

322 
£lf
.
cŞÜbu‰Ú_nÜm®
.
	`g‘_cŞÜ
().
	$to_¡ršg
()

324 
def
 
	$Ú_´efs_cŞÜbu‰Ú_low_chªged
(
£lf
, 
widg‘
=
NÚe
, 
d©a
=None):

325 
£lf
.
_´ef_d©a_pÙ’tŸl
['color_low'] = \

326 
£lf
.
cŞÜbu‰Ú_low
.
	`g‘_cŞÜ
().
	`to_¡ršg
()

	@tools/__init__.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

	@tools/bidict.py

1 
äom
 
funùoŞs
 
impÜt
 
	g»duû


2 #-*- 
codšg
: 
utf
-8 -*-

4 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


5 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


6 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


7 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


8 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


10 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


11 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


12 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


14 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


15 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

19 
şass
 
	$BiDiù
(
objeù
):

21 
BidœeùiÚ®
 
diùiÚ¬y
: 
the
 
·œs
 
¡Üed
 
ÿn
 
be
 
acûs£d
 
usšg
 
e™h”
he

22 
fœ¡
 
Ü
 
the
 
£cÚd
 
–em’t
 
as
 
	`key
 (
Çmed
 
key1
 
ªd
 
key2
).

23 
You
 
dÚ
't‚eedhis ifhere is‚o clash betweenhe domains ofhe first

24 
ªd
 
£cÚd
 
–em’t
 
of
 
the
 
·œs
.

27 
def
 
	$__š™__
(
£lf
, *
·œs
):

29 
In™Ÿliz©iÚ
 
of
 
the
 
bidœeùiÚ®
 
diùiÚ¬y


31 @
·¿m
 
·œs
: 
İtiÚ®
. 
A
 
li¡
 
of
…aœ 
to
 
add
Ø
the
 
diùiÚ¬y


33 
	`su³r
(
BiDiù
, 
£lf
).
	$__š™__
()

34 
£lf
.
_fœ¡_to_£cÚd
 = {
	}
}

35 
£lf
.
_£cÚd_to_fœ¡
 = {}

36 
·œ
 
š
 
·œs
:

37 
£lf
.
	$add
(
·œ
)

39 
def
 
	$add
(
£lf
, 
·œ
):

41 
Adds
 
a
 
	$·œ
 (
key1
, 
key2
è
to
 
the
 
diùiÚ¬y


43 @
·¿m
 
·œ
: 
the
…aœ 
fÜm©‹d
 
	`as
 (
key1
, 
key2
)

45 
£lf
.
_fœ¡_to_£cÚd
[
·œ
[0]] =…air[1]

46 
£lf
.
_£cÚd_to_fœ¡
[
·œ
[1]] =…air[0]

48 
def
 
	$_g‘_by_fœ¡
(
£lf
, 
key
):

50 
G‘s
 
the
 
key2
 
giv’
 
key1


52 @
·¿m
 
key
: 
the
 
fœ¡
 key

54  
£lf
.
_fœ¡_to_£cÚd
[
key
]

56 
def
 
	$_g‘_by_£cÚd
(
£lf
, 
key
):

58 
G‘s
 
the
 
key1
 
giv’
 
key2


60 @
·¿m
 
key
: 
the
 
£cÚd
 key

62  
£lf
.
_£cÚd_to_fœ¡
[
key
]

64 
def
 
	$_»move_by_fœ¡
(
£lf
, 
fœ¡
):

66 
Removes
 
a
 
·œ
 
giv’
 
the
 
fœ¡
 
key


68 @
·¿m
 
key
: 
the
 
fœ¡
 key

70 
£cÚd
 = 
£lf
.
_fœ¡_to_£cÚd
[
fœ¡
]

71 
d–
 
£lf
.
_£cÚd_to_fœ¡
[
£cÚd
]

72 
d–
 
£lf
.
_fœ¡_to_£cÚd
[
fœ¡
]

74 
def
 
	$_»move_by_£cÚd
(
£lf
, 
£cÚd
):

76 
Removes
 
a
 
·œ
 
giv’
 
the
 
£cÚd
 
key


78 @
·¿m
 
key
: 
the
 
£cÚd
 key

80 
fœ¡
 = 
£lf
.
_£cÚd_to_fœ¡
[
£cÚd
]

81 
d–
 
£lf
.
_fœ¡_to_£cÚd
[
fœ¡
]

82 
d–
 
£lf
.
_£cÚd_to_fœ¡
[
£cÚd
]

84 
def
 
	$_g‘_®l_fœ¡
(
£lf
):

86 
R‘uºs
 
the
 
li¡
 
of
 
®l
 
fœ¡
 
keys


88 @
»tuºs
: 
li¡


90  
	$li¡
(
£lf
.
_fœ¡_to_£cÚd
)

92 
def
 
	$_g‘_®l_£cÚd
(
£lf
):

94 
R‘uºs
 
the
 
li¡
 
of
 
®l
 
£cÚd
 
keys


96 @
»tuºs
: 
li¡


98  
	$li¡
(
£lf
.
_£cÚd_to_fœ¡
)

100 
def
 
	$__¡r__
(
£lf
):

102 
»tuºs
 
a
 
¡ršg
 
»´e£Ášg
 
the
 
cÚ‹Á
 
of
 
this
 
BiDiù


104 @
»tuºs
: 
¡ršg


106  
	`»duû
(
Ïmbda
 
‹xt
, 
keys
:

107 
	`¡r
(
‹xt
è+ sŒ(
keys
),

108 
	`™”
(
£lf
.
_fœ¡_to_£cÚd
.
	`™ems
()))

	@tools/borg.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
şass
 
	$BÜg
(
objeù
):

20 
This
 
·‰”n
 
’su»s
 
th©
 
®l
 
š¡ªûs
 
of
 
a
 
·¹icuÏr
 
şass
 
sh¬e


21 
the
 
§me
 
	`¡©e
 (
ju¡
 
šh”™
 
this
 
şass
 
to
 
have
 
™
 
wÜkšg
)

24 
_bÜg_¡©e
 = {
	}
}

26 
def
 
	$__š™__
(
£lf
):

27 
£lf
.
__diù__
 = s–f.
_bÜg_¡©e


	@tools/cleanxml.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
impÜt
 
os


18 
impÜt
 
	gxml
.
	gdom
.
mšidom


19 
impÜt
 
shut


20 
impÜt
 
sys


21 
impÜt
 
»


22 
impÜt
 
d©‘ime


24 
äom
 
	gGTG
.
	gtoŞs
.
logg”
 
impÜt
 
	gLog


26 #Thi 
is
 
the
 
awful
 
´‘ty
 
xml
 
thšgs


27 
	gb
 = "\t"

28 
’‹r
 = "\n"

29 
BACKUP_NBR
 = 7

30 
_USED_BACKUP
 = 
F®£


31 
_BACKUP_FILE_INFO
 = ""

33 #Tho£ 
two
 
funùiÚs
 
¬e
 
th”e
 
Úly
 
to
 
be
 
abË
Ø
»ad
 
´‘tyXML


34 #Sourû: 
h‰p
:

37 
def
 
ş—nDoc
(
docum’t
, 
šd’t
="", 
Ãwl
=""):

38 
node
 = 
docum’t
.
docum’tEËm’t


39 
	$ş—nNode
(
node
, 
šd’t
, 
Ãwl
)

42 
def
 
	$ş—nNode
(
cu¼’tNode
, 
šd’t
, 
Ãwl
):

43 
myf‹r
 = 
šd’t
 + 
Ãwl


44 
cu¼’tNode
.
hasChdNodes
:

45 
tÜemove
 = []

46 
node
 
š
 
cu¼’tNode
.
chdNodes
:

47 
node
.
nodeTy³
 == 3:

48 
v®
 = 
node
.
nodeV®ue
.
	`l¡r
(
myf‹r
).
	$¡r
(
myf‹r
)

49 
v®
 == "":

50 
tÜemove
.
	$­³nd
(
node
)

52 
node
.
nodeV®ue
 = 
v®


53 #now 
we
 
»move
 
the
 
nodes
 
th©
 
w”e
 
em±y


54 
n
 
š
 
tÜemove
:

55 
cu¼’tNode
.
	$»moveChd
(
n
)

56 
node
 
š
 
cu¼’tNode
.
chdNodes
:

57 
	$ş—nNode
(
node
, 
šd’t
, 
Ãwl
)

60 
def
 
	`ş—nSŒšg
(
¡ršg
, 
šd’t
="", 
Ãwl
=""):

61 #w
wl
 
»move
 
the
 
´‘ty
 
XML
 
¡uffs
.

62 #Fœt, 
we
 
»move
 
the
 \
n
 
ªd
 
b
 
š
 
–em’ts


63 
e
 = 
»
.
	`compe
('>\n\t*')

64 
tÜ‘uº
 = 
e
.
	`sub
('>', 
¡ršg
)

65 #th’ 
we
 
»move
 
the
 \
n
 
b
 
befÜe
 
şosšg
 
–em’ts


66 
f
 = 
»
.
	`compe
('\n\t*</')

67 
tÜ‘uº
 = 
f
.
	`sub
('</',oreturn)

68  
tÜ‘uº


70 #Thi 
add
 
a
 
‹xt
 
node
 
to
 
the
‚od
·»Á
. 
We
 
dÚ
't„eturn‡nything

71 #Beÿu£ 
the
 
doc
 
objeù
 
™£lf
 
is
 
modif›d
.

74 
def
 
	$addTextNode
(
doc
, 
·»Á
, 
t™Ë
, 
cÚ‹Á
):

75 
cÚ‹Á
:

76 
–em’t
 = 
doc
.
	$ü—‹EËm’t
(
t™Ë
)

77 
·»Á
.
	$­³ndChd
(
–em’t
)

78 
–em’t
.
	`­³ndChd
(
doc
.
	$ü—‹TextNode
(
cÚ‹Á
))

80 #Thi 
is
 
a
 
m‘hod
 
to
 
»ad
 
the
 
‹xŠode
 
of
h
XML


83 
def
 
	$»adTextNode
(
node
, 
t™Ë
):

84 
n
 = 
node
.
	$g‘EËm’tsByTagName
(
t™Ë
)

85 
n
 
ªd
‚[0].
	$hasChdNodes
():

86 
cÚ‹Á
 = 
n
[0].
chdNodes
[0].
nodeV®ue


87 
cÚ‹Á
:

88  
cÚ‹Á


89  
NÚe


92 
def
 
	$_Œy_İ’xmlfe
(
zefe
, 
roÙ
):

94 
f
 = 
	`İ’
(
zefe
, "r")

95 
¡ršged
 = 
f
.
	$»ad
()

96 
¡ršged
 = 
	$ş—nSŒšg
(
¡ršged
, 
b
, 
’‹r
)

97 
doc
 = 
xml
.
dom
.
mšidom
.
	$·r£SŒšg
(
¡ršged
)

98 
	$ş—nDoc
(
doc
, 
b
, 
’‹r
)

99 
xmÍrojeù
 = 
doc
.
	`g‘EËm’tsByTagName
(
roÙ
)[0]

100 
f
.
	$şo£
()

101  
doc
, 
xmÍrojeù


104 
def
 
	$_g‘_backup_Çme
(
zefe
):

106 
dœÇme
, 
f’ame
 = 
os
.
·th
.
	$¥l™
(
zefe
)

107  
os
.
·th
.
	`još
(
dœÇme
, 'backup', 
f’ame
)

110 
def
 
	$İ’xmlfe
(
zefe
, 
roÙ
):

113 
If
 
fe
 
could
 
nÙ
 
be
 
İ’ed
, 
Œy
:

114 - 
fe__


115 - 
fe
.
bak
.0

116 - 
fe
.
bak
.1

117 - .... 
uÁ
 
BACKUP_NBR


119 
If
 
fe
 
dÛ¢
'tƒxist, create‡‚ew file """

121 #»£ˆ
_USED_BACKUP
 
ªd
 
_BACKUP_FILE_INFO


122 
glob®
 
_USED_BACKUP


123 
glob®
 
_BACKUP_FILE_INFO


124 
_USED_BACKUP
 = 
F®£


125 
_BACKUP_FILE_INFO
 = ""

126 
tmpfe
 = 
zefe
 + '__'

127 
Œy
:

128 
os
.
·th
.
	$exi¡s
(
zefe
):

129  
	$_Œy_İ’xmlfe
(
zefe
, 
roÙ
)

130 
–if
 
os
.
·th
.
	$exi¡s
(
tmpfe
):

131 
Log
.
	`w¬nšg
("Som‘hšg h­³ÃdØ%s. Usšg backup" % 
zefe
)

132 
os
.
	$»Çme
(
tmpfe
, 
zefe
)

133 
_USED_BACKUP
 = 
True


134 
_BACKUP_FILE_INFO
 = "Recovered from backup made on: " + \

135 
d©‘ime
.d©‘ime.
	`äomtime¡amp
(

136 
os
.
·th
.
	`g‘mtime
(
tmpfe
)).
	`¡ráime
('%Y-%m-%d')

137  
	$_Œy_İ’xmlfe
(
zefe
, 
roÙ
)

139 
exû±
 
IOE¼Ü
 
as
 
msg
:

140 
	$´št
(
msg
)

141 
sys
.
	$ex™
(1)

143 
exû±
 
xml
.
·r£rs
.
ex·t
.
Ex·tE¼Ü
 
as
 
msg
:

144 
”rÜmsg
 = "E¼Ü…¬sšg XML f%s: %s" % (
zefe
, 
msg
)

145 
Log
.
	$”rÜ
(
”rÜmsg
)

146 
os
.
·th
.
	$exi¡s
(
tmpfe
):

147 
Log
.
	`w¬nšg
("Som‘hšg h­³ÃdØ%s. Usšg backup" % 
zefe
)

148 
os
.
	$»Çme
(
tmpfe
, 
zefe
)

149 
_USED_BACKUP
 = 
True


150 
_BACKUP_FILE_INFO
 = "Recovered from backup made on: " + \

151 
d©‘ime
.d©‘ime.
	`äomtime¡amp
(

152 
os
.
·th
.
	`g‘mtime
(
tmpfe
)).
	`¡ráime
('%Y-%m-%d')

153 #Ok, 
Œy
 
Úe
 
mÜe
 
time
 
now


154 
Œy
:

155  
	$_Œy_İ’xmlfe
(
zefe
, 
roÙ
)

156 
exû±
 
Exû±iÚ
 
as
 
msg
:

157 
Log
.
	`w¬nšg
('Faed w™h„—sÚ: %s' % 
msg
)

159 #Try 
to
 
»v”t
Ø
backup


160 
backup_Çme
 = 
	$_g‘_backup_Çme
(
zefe
)

161 
i
 
š
 
	$¿nge
(
BACKUP_NBR
):

162 
backup_fe
 = "%s.bak.%d" % (
backup_Çme
, 
i
)

163 
os
.
·th
.
	$exi¡s
(
backup_fe
):

164 
Log
.
	`šfo
("TryšgØ»¡Übacku°f%s" % 
backup_fe
)

165 
_USED_BACKUP
 = 
True


166 
_BACKUP_FILE_INFO
 = "Recovered from backup made on: " + \

167 
d©‘ime
.d©‘ime.
	`äomtime¡amp
(

168 
os
.
·th
.
	`g‘mtime
(
backup_fe
)).
	`¡ráime
('%Y-%m-%d')

169 
Œy
:

170  
	$_Œy_İ’xmlfe
(
backup_fe
, 
roÙ
)

171 
exû±
 
Exû±iÚ
 
as
 
msg
:

172 
Log
.
	`w¬nšg
('Faed w™h„—sÚ: %s' % 
msg
)

174 
Log
.
	`šfo
("No suitable backup was found")

176 #C»©šg 
em±y
 
fe


177 
doc
, 
xmÍrojeù
 = 
	$em±ydoc
(
roÙ
)

178 
Ãwfe
 = 
	$§vexml
(
zefe
, 
doc
)

179 
nÙ
 
Ãwfe
:

180 
Log
.
	`”rÜ
("Could‚Ù c»©¨Ãw f%s" % 
zefe
)

181 
sys
.
	$ex™
(1)

182 #£ˆ
_USED_BACKUP
 
ev’
 
th”e
's‡ failureo‚otify‡bouthe same

183 
_USED_BACKUP
 = 
True


184 
_BACKUP_FILE_INFO
 = "No backups found. Created‡‚ew file"

185  
	$_Œy_İ’xmlfe
(
zefe
, 
roÙ
)

187 #ex™ 
executiÚ
 
»ached
 
this
 
¡©em’t


188 
sys
.
	$ex™
(1)

191 #R‘uº 
a
 
doc
 
–em’t
 
w™h
 
Úly
 
Úe
 
roÙ
ƒËm’ˆ
of
 
the
 
Çme
 "root"

193 
def
 
	$em±ydoc
(
roÙ
):

194 
doc
 = 
xml
.
dom
.
mšidom
.
	$Docum’t
()

195 
roÙ´ojeù
 = 
doc
.
	$ü—‹EËm’t
(
roÙ
)

196 
doc
.
	$­³ndChd
(
roÙ´ojeù
)

197  
doc
, 
roÙ´ojeù


199 #wr™
a
 
XML
 
doc
 
to
‡ 
fe


202 
def
 
	$§vexml
(
zefe
, 
doc
, 
backup
=
F®£
):

203 #´šˆ"wr™šg % fe" %(
zefe
)

204 
tmpfe
 = 
zefe
 + '__'

205 
backup_Çme
 = 
	$_g‘_backup_Çme
(
zefe
)

207 #C»©
backup
 
dœeùÜy


208 
backup_dœ
 = 
os
.
·th
.
	$dœÇme
(
backup_Çme
)

209 
nÙ
 
os
.
·th
.
	$exi¡s
(
backup_dœ
):

210 
Œy
:

211 
os
.
	$makedœs
(
backup_dœ
)

212 
exû±
 
IOE¼Ü
 
as
 
”rÜ
:

213 
	`´št
("E¼Ü whü—tšg backup/ dœeùÜy:", 
”rÜ
)

214  
F®£


216 
Œy
:

217 
os
.
·th
.
	$exi¡s
(
zefe
):

218 
os
.
	$»Çme
(
zefe
, 
tmpfe
)

219 
f
 = 
	`İ’
(
zefe
, 
mode
='w+')

220 
´‘ty
 = 
doc
.
	$tİ»‰yxml
(
b
, 
’‹r
)

221 
f
 
ªd
 
´‘ty
:

222 
bwr™‹n
 = 
os
.
	`wr™e
(
f
.
	`f’o
(), 
	`by‹s
(
´‘ty
, 'utf8'))

223 
bwr™‹n
 !ğ
	$Ën
(
´‘ty
):

224 
	`´št
("”rÜ wr™šg f%s" % 
zefe
)

225 
f
.
	$şo£
()

226  
F®£


227 
f
.
	$şo£
()

229 
os
.
·th
.
	$exi¡s
(
tmpfe
):

230 
os
.
	$uÆšk
(
tmpfe
)

232 
backup
:

233 #W
wl
 
now
 
backup
 
the
 
fe


234 
backup_nbr
 = 
BACKUP_NBR


235 #W
k“p
 
BACKUP_NBR
 
v”siÚs
 
of
 
the
 
fe


236 #Th0 
is
 
the
 
younge¡
 
Úe


237 
backup_nbr
 > 0:

238 
Şd”
 = "%s.bak.%s" % (
backup_Çme
, 
backup_nbr
)

239 
backup_nbr
 -= 1

240 
Ãw”
 = "%s.bak.%s" % (
backup_Çme
, 
backup_nbr
)

241 
os
.
·th
.
	$exi¡s
(
Ãw”
):

242 
shut
.
	$move
(
Ãw”
, 
Şd”
)

243 #Th
bak
.0 
is
 
®ways
 
a
 
äesh
 
cİy
 
of
 
the
 
şo£d
 
fe


244 #SØ
th©
 
™
's‚otouched in case of bad opening‚extime

245 
cu¼’t
 = "%s.bak.0" % 
backup_Çme


246 
shut
.
	$cİy
(
zefe
, 
cu¼’t
)

248 
day_backup
 = "%s.%s.bak" % (

249 
backup_Çme
, 
d©‘ime
.
d©e
.
	`today
().
	`¡ráime
("%Y-%m-%d"))

250 
nÙ
 
os
.
·th
.
	$exi¡s
(
day_backup
):

251 
shut
.
	$cİy
(
zefe
, 
day_backup
)

252  
True


254 
	`´št
("nØf% Ü‚Ø´‘ty xml" % 
zefe
)

255  
F®£


256 
exû±
 
IOE¼Ü
 
as
 
msg
:

257 
	$´št
(
msg
)

258  
F®£


261 
def
 
	$u£d_backup
():

264  
_USED_BACKUP


267 
def
 
	$backup_fe_šfo
():

270  
_BACKUP_FILE_INFO


	@tools/clipboard.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
TaskClbßrd
 
®lows
 
to
 
	gcut
/
cİy
 
the
 
cÚ‹Á
 
of
 
a
 
TaskV›w
 
acüoss
 
muÉËs


19 
	gsked™Üs
, 
´e£rvšg
 
	gsubsks


23 
şass
 
	$TaskClbßrd
():

25 
def
 
	$__š™__
(
£lf
, 
»q
):

26 
£lf
.
desütiÚ
 = 
NÚe


27 
£lf
.
cÚ‹Á
 = []

28 
£lf
.
»q
 =„eq

30 """"
ke
 
two
 
Gtk
.
TextI‹r
 
as
 
·¿m‘”
 
ªd
 
cİy
 
the


33 
def
 
	$cİy
(
£lf
, 
¡¬t
, 
¡İ
, 
buÎ‘
=
NÚe
):

34 
£lf
.
	$ş—r
()

35 #Now, 
we
 
ke
 
ÿ»
 
of
 
the
 
nÜm®
, 
üoss
 
­¶iÿtiÚ
 
şbßrd


36 
‹xt
 = 
¡¬t
.
	$g‘_‹xt
(
¡İ
)

37 
‹xt
 
ªd
 
buÎ‘
:

38 #w
»¶aû
 
the
 
¬row
 
by
h
Üigš®
 "-"

39 
Ãw‹xt
 = 
‹xt
.
	`»¶aû
(
buÎ‘
, "-")

40 
£lf
.
desütiÚ
 = 
Ãw‹xt


41 
–if
 
‹xt
:

42 
£lf
.
desütiÚ
 = 
‹xt


44 
’d_lše
 = 
¡¬t
.
	$cİy
()

45 #w
ke
 
lše
 
aá”
†š
š
 
the
 
£ËùiÚ


46 
Ãxše
 = 
True


47 
’d_lše
.
	`g‘_lše
(è<ğ
¡İ
.
	$g‘_lše
(è
ªd
 
Ãxše
:

48 
Ãxše
 = 
’d_lše
.
	$fÜw¬d_lše
()

49 
’d_lše
.
	$backw¬d_ch¬
()

50 #w
wªt
 
to
 
d‘eù
 
subsks
 
š
 
the
 
£ËùiÚ


51 
gs
 = 
’d_lše
.
	`g‘_gs
(è+ƒnd_lše.
	$g‘_toggËd_gs
(
F®£
)

52 
is_subsk
 = 
F®£


53 

 
š
 
gs
:

54 
	`ha§‰r
(

, 'is_subtask'):

55 
is_subsk
 = 
True


56 
tid
 = 

.
chd


57 
s
 = 
£lf
.
»q
.
	$g‘_sk
(
tid
)

58 
s
.
	$£t_to_k“p
()

59 
s
.
	$sync
()

60 
£lf
.
cÚ‹Á
.
	`­³nd
(['subsk', 
tid
])

61 
nÙ
 
is_subsk
:

62 
’d_lše
.
	`g‘_lše
(è< 
¡İ
.
	$g‘_lše
():

63 
£lf
.
cÚ‹Á
.
	`­³nd
(['text', "%s\n" %

64 
¡¬t
.
	`g‘_‹xt
(
’d_lše
)])

66 
£lf
.
cÚ‹Á
.
	`­³nd
(['‹xt', 
¡¬t
.
	`g‘_‹xt
(
¡İ
)])

67 
’d_lše
.
	$fÜw¬d_ch¬
()

68 
¡¬t
.
	$fÜw¬d_lše
()

70 
def
 
	$·¡e_‹xt
(
£lf
):

71  
£lf
.
desütiÚ


73 
def
 
	$·¡e
(
£lf
):

74  
£lf
.
cÚ‹Á


76 
def
 
	$ş—r
(
£lf
):

77 
£lf
.
desütiiÚ
 = 
NÚe


78 
£lf
.
cÚ‹Á
 = []

	@tools/dates.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

19 
D©es
 
Could
 
be
 
nÜm®
 
	glike
 2012-04-01 
Ü
 
fuzzy
 
like
 
	gnow
, 
	gsoÚ
,

20 
	gsomeday
, 
Ï‹r
 
Ü
 
no
 
	gd©e
.

22 
	gD©e
.
	$·r£
(è
·r£s
 
®l
 
possibË
 
»´e£Á©iÚs
 
of
 
a
 
d©e
. """

24 
impÜt
 
ÿËnd¬


25 
impÜt
 
d©‘ime


26 
impÜt
 
loÿË


28 
äom
 
GTG
 
impÜt
 
_
, 
ng‘‹xt


30 
__®l__
 = 'Date',

32 
NOW
, 
SOON
, 
SOMEDAY
, 
NODATE
 = 
	`li¡
(
	$¿nge
(4))

33 #¡ršg 
»´e£Ášg
 
fuzzy
 
d©es
 + 
no
 
d©e


34 
ENGLISH_STRINGS
 = {

35 
NOW
: 'now',

36 
SOON
: 'soon',

37 
SOMEDAY
: 'someday',

38 
NODATE
: '',

39 
	}
}

41 
STRINGS
 = {

42 
NOW
: 
_
('now'),

43 
SOON
: 
_
('soon'),

44 
SOMEDAY
: 
_
('someday'),

45 
NODATE
: '',

48 
LOOKUP
 = {

49 'now': 
NOW
,

50 
_
('now').
low”
(): 
NOW
,

51 'soÚ': 
SOON
,

52 
_
('soÚ').
low”
(): 
SOON
,

53 'Ï‹r': 
SOMEDAY
,

54 
_
('Ï‹r').
low”
(): 
SOMEDAY
,

55 'someday': 
SOMEDAY
,

56 
_
('someday').
low”
(): 
SOMEDAY
,

57 '': 
NODATE
,

59 #funùiÚ 
givšg
 
absŞu‹
 
d©es
 
fuzzy
 d©e + 
no
 
d©e


60 
FUNCS
 = {

61 
NOW
: 
d©‘ime
.
d©e
.
today
(),

62 
SOON
: 
d©‘ime
.
d©e
.
today
(è+ d©‘ime.
timed–
(15),

63 
SOMEDAY
: 
d©‘ime
.
d©e
.
max
,

64 
NODATE
: 
d©‘ime
.
d©e
.
max
 - d©‘ime.
timed–
(1),

67 #ISO 8601 
d©e
 
fÜm©


68 
ISODATE
 = '%Y-%m-%d'

69 #g‘ 
d©e
 
fÜm©
 
äom
 
loÿË


70 
loÿË_fÜm©
 = 
loÿË
.
	$Æ_Ïngšfo
(
loÿË
.
D_FMT
)

73 
def
 
	$cÚv”t_d©‘ime_to_d©e
(
aday
):

75 
SŒ
 
unu§bË
 
time
 
šfÜm©iÚ
. """

76  
d©‘ime
.
	$d©e
(
aday
.
y—r
,‡day.
mÚth
,‡day.
day
)

79 
şass
 
	$D©e
(
objeù
):

82 
D©e
 
suµÜts
 
®l
 
the
 
m‘hods
 
of
h
¡ªd¬d
 
d©‘ime
.
d©e
 
şass
. 
A
 Date

83 
ÿn
 
be
 
cÚ¡ruùed
 
w™h
:

84 - 
the
 
fuzzy
 
¡ršgs
 'now', 'soÚ', '' (
no
 
d©e
, ), 
Ü
 'someday'

85 - 
a
 
¡ršg
 
cÚššg
 
ª
 
ISO
 
fÜm©
 
d©e
: 
YYYY
-
MM
-
DD
, 
Ü


86 - 
a
 
d©‘ime
.
d©e
 
Ü
 
D©e
 
š¡ªû
, or

87 - 
a
 
¡ršg
 
cÚššg
‡ 
loÿË
 
fÜm©
 
d©e
.

89 
_»®_d©e
 = 
NÚe


90 
_fuzzy
 = 
NÚe


92 
def
 
	`__š™__
(
£lf
, 
v®ue
=''):

93 
£lf
.
	$_·r£_š™_v®ue
(
v®ue
)

95 
def
 
	$_·r£_š™_v®ue
(
£lf
, 
v®ue
):

97 
v®ue
 
is
 
NÚe
:

98 
£lf
.
	$_·r£_š™_v®ue
(
NODATE
)

99 
–if
 
	$isš¡ªû
(
v®ue
, 
d©‘ime
.
d©e
):

100 
£lf
.
_»®_d©e
 = 
v®ue


101 
–if
 
	$isš¡ªû
(
v®ue
, 
D©e
):

102 #Cİy 
š‹º®
 
v®ues
 
äom
 
Ùh”
 
D©e
 
objeù


103 
£lf
.
_»®_d©e
 = 
v®ue
._real_date

104 
£lf
.
_fuzzy
 = 
v®ue
._fuzzy

105 
–if
 
	$isš¡ªû
(
v®ue
, 
¡r
è
Ü
 
	$isš¡ªû
(
v®ue
, 
¡r
):

106 
Œy
:

107 
da_ti
 = 
d©‘ime
.d©‘ime.
	`¡½time
(
v®ue
, 
loÿË_fÜm©
).
	$d©e
()

108 
£lf
.
_»®_d©e
 = 
	$cÚv”t_d©‘ime_to_d©e
(
da_ti
)

109 
exû±
 
V®ueE¼Ü
:

110 
Œy
:

111 #®low 
bÙh
 
loÿË
 
fÜm©
 
ªd
 
ISO
 format

112 
da_ti
 = 
d©‘ime
.d©‘ime.
	`¡½time
(
v®ue
, 
ISODATE
).
	$d©e
()

113 
£lf
.
_»®_d©e
 = 
	$cÚv”t_d©‘ime_to_d©e
(
da_ti
)

114 
exû±
 
V®ueE¼Ü
:

115 #™ 
mu¡
 
be
 
a
 
fuzzy
 
d©e


116 
Œy
:

117 
v®ue
 = 
	`¡r
(v®ue.
	$low”
())

118 
£lf
.
	$_·r£_š™_v®ue
(
LOOKUP
[
v®ue
])

119 
exû±
 
KeyE¼Ü
:

120 
¿i£
 
	`V®ueE¼Ü
("Unknown value for date: '%s'"

121 % 
v®ue
)

122 
–if
 
	$isš¡ªû
(
v®ue
, ):

123 
£lf
.
_fuzzy
 = 
v®ue


125 
¿i£
 
	`V®ueE¼Ü
("UnknowÀv®ufÜ d©e: '%s'" % 
v®ue
)

127 
def
 
	$d©e
(
£lf
):

129 
£lf
.
	$is_fuzzy
():

130  
FUNCS
[
£lf
.
_fuzzy
]

132  
£lf
.
_»®_d©e


134 
def
 
	$__add__
(
£lf
, 
Ùh”
):

135 
	$isš¡ªû
(
Ùh”
, 
d©‘ime
.
timed–
):

136  
	`D©e
(
£lf
.
	`d©e
(è+ 
Ùh”
)

138 
¿i£
 
NÙIm¶em’‹dE¼Ü


139 
__¿dd__
 = 
__add__


141 
def
 
	$__sub__
(
£lf
, 
Ùh”
):

142 
	`ha§‰r
(
Ùh”
, 'date'):

143  
£lf
.
	`d©e
(è- 
Ùh”
.
	$d©e
()

145  
£lf
.
	`d©e
(è- 
Ùh”


147 
def
 
	$__rsub__
(
£lf
, 
Ùh”
):

148 
	`ha§‰r
(
Ùh”
, 'date'):

149  
Ùh”
.
	`d©e
(è- 
£lf
.
	$d©e
()

151  
Ùh”
 - 
£lf
.
	$d©e
()

153 
def
 
	$__É__
(
£lf
, 
Ùh”
):

155 
	$isš¡ªû
(
Ùh”
, 
D©e
):

156 #K“°
fuzzy
 
d©es
 
b–ow
 
nÜm®
 dates

157 
£lf
.
	`d©e
(è=ğ
Ùh”
.
	$d©e
():

158 
nÙ
 
£lf
.
	$is_fuzzy
(è
ªd
 
Ùh”
.
	$is_fuzzy
():

159  
True


161  
F®£


162  
£lf
.
	`d©e
(è< 
Ùh”
.
	$d©e
()

163 
–if
 
	$isš¡ªû
(
Ùh”
, 
d©‘ime
.
d©e
):

164  
£lf
.
	`d©e
(è< 
Ùh”


166 
¿i£
 
NÙIm¶em’‹dE¼Ü


168 
def
 
	$__Ë__
(
£lf
, 
Ùh”
):

170 
	$isš¡ªû
(
Ùh”
, 
D©e
):

171 #K“°
fuzzy
 
d©es
 
b–ow
 
nÜm®
 dates

172 
£lf
.
	`d©e
(è=ğ
Ùh”
.
	$d©e
():

173 
£lf
.
	$is_fuzzy
(è
ªd
 
nÙ
 
Ùh”
.
	$is_fuzzy
():

174  
F®£


176  
True


177  
£lf
.
	`d©e
(è<ğ
Ùh”
.
	$d©e
()

178 
–if
 
	$isš¡ªû
(
Ùh”
, 
d©‘ime
.
d©e
):

179  
£lf
.
	`d©e
(è<ğ
Ùh”


181 
¿i£
 
NÙIm¶em’‹dE¼Ü


183 
def
 
	$__eq__
(
£lf
, 
Ùh”
):

185 
	$isš¡ªû
(
Ùh”
, 
D©e
):

186 #HªdË 
fuzzy
 
d©es
 
s™u©iÚs


187 
£lf
.
	`d©e
(è=ğ
Ùh”
.
	$d©e
():

188  
£lf
.
	`is_fuzzy
(è=ğ
Ùh”
.
	$is_fuzzy
()

190  
F®£


191 
–if
 
	$isš¡ªû
(
Ùh”
, 
d©‘ime
.
d©e
):

192  
£lf
.
	`d©e
(è=ğ
Ùh”


194 
¿i£
 
NÙIm¶em’‹dE¼Ü


196 
def
 
	$__Ã__
(
£lf
, 
Ùh”
):

198 
	$isš¡ªû
(
Ùh”
, 
D©e
):

199 #HªdË 
fuzzy
 
d©es
 
s™u©iÚs


200 
£lf
.
	`d©e
(è=ğ
Ùh”
.
	$d©e
():

201  
£lf
.
	`is_fuzzy
(è!ğ
Ùh”
.
	$is_fuzzy
()

203  
True


204 
–if
 
	$isš¡ªû
(
Ùh”
, 
d©‘ime
.
d©e
):

205  
£lf
.
	`d©e
(è!ğ
Ùh”


207 
¿i£
 
NÙIm¶em’‹dE¼Ü


209 
def
 
	$__gt__
(
£lf
, 
Ùh”
):

211 
	$isš¡ªû
(
Ùh”
, 
D©e
):

212 #K“°
fuzzy
 
d©es
 
b–ow
 
nÜm®
 dates

213 
£lf
.
	`d©e
(è=ğ
Ùh”
.
	$d©e
():

214 
£lf
.
	$is_fuzzy
(è
ªd
 
nÙ
 
Ùh”
.
	$is_fuzzy
():

215  
True


217  
F®£


218  
£lf
.
	`d©e
(è> 
Ùh”
.
	$d©e
()

219 
–if
 
	$isš¡ªû
(
Ùh”
, 
d©‘ime
.
d©e
):

220  
£lf
.
	`d©e
(è> 
Ùh”


222 
¿i£
 
NÙIm¶em’‹dE¼Ü


224 
def
 
	$__ge__
(
£lf
, 
Ùh”
):

226 
	$isš¡ªû
(
Ùh”
, 
D©e
):

227 #K“°
fuzzy
 
d©es
 
b–ow
 
nÜm®
 dates

228 
£lf
.
	`d©e
(è=ğ
Ùh”
.
	$d©e
():

229 
nÙ
 
£lf
.
	$is_fuzzy
(è
ªd
 
Ùh”
.
	$is_fuzzy
():

230  
F®£


232  
True


233  
£lf
.
	`d©e
(è>ğ
Ùh”
.
	$d©e
()

234 
–if
 
	$isš¡ªû
(
Ùh”
, 
d©‘ime
.
d©e
):

235  
£lf
.
	`d©e
(è>ğ
Ùh”


237 
¿i£
 
NÙIm¶em’‹dE¼Ü


239 
def
 
	$__¡r__
(
£lf
):

240 
£lf
.
_fuzzy
 
is
 
nÙ
 
NÚe
:

241  
STRINGS
[
£lf
.
_fuzzy
]

243  
£lf
.
_»®_d©e
.
	$isofÜm©
()

245 
def
 
	$__»´__
(
£lf
):

246  "GTG_D©e(%s)" % 
	$¡r
(
£lf
)

248 
def
 
	$xml_¡r
(
£lf
):

250 
£lf
.
_fuzzy
 
is
 
nÙ
 
NÚe
:

251  
ENGLISH_STRINGS
[
£lf
.
_fuzzy
]

253  
£lf
.
_»®_d©e
.
	$isofÜm©
()

255 
def
 
	$__boŞ__
(
£lf
):

256  
£lf
.
_fuzzy
 !ğ
NODATE


258 
def
 
	$__g‘©Œ__
(
£lf
, 
Çme
):

260 
Œy
:

261  
£lf
.
__diù__
[
Çme
]

262 
exû±
 
KeyE¼Ü
:

263  
	`g‘©Œ
(
£lf
.
	`d©e
(), 
Çme
)

265 
def
 
	$is_fuzzy
(
£lf
):

267 
True
 
the
 
D©e
 
is
 
Úe
 
of
h
fuzzy
 
v®ues
:

268 
now
, 
soÚ
, 
someday
 
Ü
 
no_d©e


270  
£lf
.
_fuzzy
 
is
 
nÙ
 
NÚe


272 
def
 
	$days_Ëá
(
£lf
):

274 
£lf
.
_fuzzy
 =ğ
NODATE
:

275  
NÚe


277  (
£lf
.
	`d©e
(è- 
d©‘ime
.
d©e
.
	`today
()).
days


279 @
şassm‘hod


280 
def
 
	$today
(
şs
):

282  
	`D©e
(
d©‘ime
.
d©e
.
	`today
())

284 @
şassm‘hod


285 
def
 
	$tomÜrow
(
şs
):

287  
	`D©e
(
d©‘ime
.
d©e
.
	`today
(è+ d©‘ime.
	`timed–
(1))

289 @
şassm‘hod


290 
def
 
	$now
(
şs
):

292  
	`D©e
(
NOW
)

294 @
şassm‘hod


295 
def
 
	$no_d©e
(
şs
):

297  
	`D©e
(
NODATE
)

299 @
şassm‘hod


300 
def
 
	$soÚ
(
şs
):

302  
	`D©e
(
SOON
)

304 @
şassm‘hod


305 
def
 
	$someday
(
şs
):

307  
	`D©e
(
SOMEDAY
)

309 @
şassm‘hod


310 
def
 
	$_·r£_Úly_mÚth_day
(
şs
, 
¡ršg
):

312 
Œy
:

313 
mday
 = (
¡ršg
)

314 
nÙ
 1 <ğ
mday
 <ğ31 
Ü
 
¡ršg
.
	`¡¬tsw™h
('0'):

315  
NÚe


316 
exû±
 
V®ueE¼Ü
:

317  
NÚe


319 
today
 = 
d©‘ime
.
d©e
.
	$today
()

320 
Œy
:

321 
»suÉ
 = 
today
.
	$»¶aû
(
day
=
mday
)

322 
exû±
 
V®ueE¼Ü
:

323 
»suÉ
 = 
NÚe


325 
»suÉ
 
is
 
NÚe
 
Ü
„esuÉ <ğ
today
:

326 
today
.
mÚth
 == 12:

327 
Ãxt_mÚth
 = 1

328 
Ãxt_y—r
 = 
today
.
y—r
 + 1

330 
Ãxt_mÚth
 = 
today
.
mÚth
 + 1

331 
Ãxt_y—r
 = 
today
.
y—r


333 
Œy
:

334 
»suÉ
 = 
d©‘ime
.
	$d©e
(
Ãxt_y—r
, 
Ãxt_mÚth
, 
mday
)

335 
exû±
 
V®ueE¼Ü
:

336 
·ss


338  
»suÉ


340 @
şassm‘hod


341 
def
 
	$_·r£_num”iÿl_fÜm©
(
şs
, 
¡ršg
):

343 
»suÉ
 = 
NÚe


344 
today
 = 
d©‘ime
.
d©e
.
	$today
()

345 
fmt
 
š
 ['%Y/%m/%d', '%Y%m%d', '%m%d']:

346 
Œy
:

347 
da_ti
 = 
d©‘ime
.d©‘ime.
	$¡½time
(
¡ršg
, 
fmt
)

348 
»suÉ
 = 
	$cÚv”t_d©‘ime_to_d©e
(
da_ti
)

349 '%Y' 
nÙ
 
š
 
fmt
:

350 #Ià
the
 
day
 
has
 
·s£d
, 
assume
h
Ãxt
 
y—r


351 
»suÉ
.
mÚth
 > 
today
.mÚth 
Ü
 \

352 (
»suÉ
.
mÚth
 =ğ
today
.mÚth 
ªd


353 
»suÉ
.
day
 >ğ
today
.day):

354 
y—r
 = 
today
.year

356 
y—r
 = 
today
.year + 1

357 
»suÉ
 =„esuÉ.
	$»¶aû
(
y—r
=year)

358 
exû±
 
V®ueE¼Ü
:

360  
»suÉ


362 @
şassm‘hod


363 
def
 
	$_·r£_‹xt_»´e£Á©iÚ
(
şs
, 
¡ršg
):

365 
today
 = 
d©‘ime
.
d©e
.
	$today
()

367 #acû±ed 
d©e
 
fÜm©s


368 
fÜm©s
 = {

370 
	`_
('today').
	`low”
(): 0,

372 
	`_
('tomÜrow').
	`low”
(): 1,

374 
	`_
('Ãxˆw“k').
	`low”
(): 7,

375 'ÃxˆmÚth': 
ÿËnd¬
.
mdays
[
today
.
mÚth
],

376 
	`_
('ÃxˆmÚth').
	`low”
(): 
ÿËnd¬
.
mdays
[
today
.
mÚth
],

377 'Ãxˆy—r': 365 + (
ÿËnd¬
.
	`i¦—p
(
today
.
y—r
)),

378 
	`_
('Ãxˆy—r').
	`low”
(): 365 + (
ÿËnd¬
.
	`i¦—p
(
today
.
y—r
)),

379 
	}
}

381 #add 
w“k
 
day
 
Çmes
 
š
 
the
 
cu¼’t
 
loÿË


382 
i
, (
	g’glish
, 
	gloÿl
è
š
 
’um”©e
([

383 ("MÚday", 
_
("Monday")),

384 ("Tuesday", 
_
("Tuesday")),

385 ("WedÃsday", 
_
("Wednesday")),

386 ("Thursday", 
_
("Thursday")),

387 ("Friday", 
_
("Friday")),

388 ("S©urday", 
_
("Saturday")),

389 ("Sunday", 
_
("Sunday")),

391 
off£t
 = 
i
 - 
today
.
w“kday
(è+ 7 * (˜<ğtoday.
	$w“kday
())

392 
fÜm©s
[
’glish
.
	`low”
()] = 
off£t


393 
fÜm©s
[
loÿl
.
	`low”
()] = 
off£t


395 
off£t
 = 
fÜm©s
.
	$g‘
(
¡ršg
, 
NÚe
)

396 
off£t
 
is
 
NÚe
:

397  
NÚe


399  
today
 + 
d©‘ime
.
	`timed–
(
off£t
)

401 @
şassm‘hod


402 
def
 
	$·r£
(
şs
, 
¡ršg
):

405 
¡ršg
 
may
 
be
 
š
 
Úe
 
of
 
the
 
fŞlowšg
 
fÜm©s
:

406 - 
YYYY
/
MM
/
DD
, 
YYYYMMDD
, 
MMDD
, 
D


407 - 
fuzzy
 
d©es


408 - 'today', 'tomÜrow', 'Ãxˆw“k', 'ÃxˆmÚth' 
Ü
 'Ãxˆy—r' 
š


409 
English
 
Ü
 
the
 
sy¡em
 
loÿË
.

411 #§n™iz
šput


412 
¡ršg
 
is
 
NÚe
:

413 
¡ršg
 = ''

415 
¡ršg
 = sŒšg.
	$low”
()

417 #Œy 
the
  
fÜm©s


418 
Œy
:

419  
	$D©e
(
¡ršg
)

420 
exû±
 
V®ueE¼Ü
:

421 
·ss


423 #dØ
£v”®
 
·rsšg


424 
»suÉ
 = 
şs
.
	$_·r£_Úly_mÚth_day
(
¡ršg
)

425 
»suÉ
 
is
 
NÚe
:

426 
»suÉ
 = 
şs
.
	$_·r£_num”iÿl_fÜm©
(
¡ršg
)

427 
»suÉ
 
is
 
NÚe
:

428 
»suÉ
 = 
şs
.
	$_·r£_‹xt_»´e£Á©iÚ
(
¡ršg
)

430 #AÂounû 
the
 
»suÉ


431 
»suÉ
 
is
 
nÙ
 
NÚe
:

432  
	$D©e
(
»suÉ
)

434 
¿i£
 
	`V®ueE¼Ü
("Cª'ˆ·r£ d©'%s'" % 
¡ršg
)

436 
def
 
	$to_»adabË_¡ršg
(
£lf
):

439 
Fuzzy
 
d©es
 => 
loÿlized
 
v”siÚ


440 
Clo£
 
d©es
 => 
Today
, 
TomÜrow
, 
In
 
X
 
days


441 
Oth”
 => 
w™h
 
loÿË
 
d©efÜm©
, 
¡rpšg
 
y—r
 
this
 year

443 
£lf
.
_fuzzy
 
is
 
nÙ
 
NÚe
:

444  
STRINGS
[
£lf
.
_fuzzy
]

446 
days_Ëá
 = 
£lf
.
	$days_Ëá
()

447 
days_Ëá
 == 0:

448  
	`_
('Today')

449 
–if
 
days_Ëá
 < 0:

450 
abs_days
 = 
	$abs
(
days_Ëá
)

451  
	`ng‘‹xt
('Ye¡”day', '%(days)d day ago', 
abs_days
) % \

452 {'days': 
abs_days
}

453 
–if
 
days_Ëá
 > 0 
ªd
 days_left <= 15:

454  
ng‘‹xt
('TomÜrow', 'IÀ%(days)d days', 
days_Ëá
) % \

455 {'days': 
days_Ëá
}

457 
loÿË_fÜm©
 = 
loÿË
.
	$Æ_Ïngšfo
(
loÿË
.
D_FMT
)

458 
ÿËnd¬
.
	`i¦—p
(
d©‘ime
.
d©e
.
	`today
().
y—r
):

459 
y—r_Ën
 = 366

461 
y—r_Ën
 = 365

462 (
days_Ëá
è/ 
y—r_Ën
 < 1.0:

463 #ià
™
' š†es thª‡ y—r, dÚ'
t
 
show
 
the
 
y—r
 
f›ld


464 
loÿË_fÜm©
 =†oÿË_fÜm©.
	`»¶aû
('/%Y', '')

465 
loÿË_fÜm©
 =†oÿË_fÜm©.
	`»¶aû
('.%Y', '.')

466  
£lf
.
_»®_d©e
.
	`¡ráime
(
loÿË_fÜm©
)

	@tools/interruptible.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
Uts
 
to
 
¡İ
 
ªd
 
qu™
 
g¿ûfuÎy
 
a
 
	gth»ad
, 
issušg
 
the
 
commªd
 
äom


19 
ªÙh”
 
	gÚe


23 
şass
 
	$IÁ”ru±ed
(
Exû±iÚ
):

25 
·ss


28 
def
 
	$š‹¼u±ibË
(
â
):

30 
A
 
decÜ©Ü
 
th©
 
makes
 
a
 
funùiÚ
 
š‹¼u±ibË
. 
It
 
should
 
be
 
­¶›d
 
Úly


31 
to
 
the
 
funùiÚ
 
which
 
is
h
rg‘
 
of
 
a
 
Th»ad
 
objeù
.

34 
def
 
	$Ãw
(*
¬gs
):

35 
Œy
:

36  
	$â
(*
¬gs
)

37 
exû±
 
IÁ”ru±ed
:

39  
Ãw


42 
def
 
	$_ÿnûÎ©iÚ_pošt
(
‹¡_funùiÚ
):

44 
This
 
funùiÚ
 
checks
 
a
 
‹¡_funùiÚ
 
ªd
, 
™
 
ev®u©es
 
to
 
True
, 
makes


45 
the
 
th»ad
 
	`qu™
 (
sim¬
 
to
 
	$±h»ad_ÿnûl
(è
š
 
C
)

46 
It
 
¡¬ts
 
w™h
 
a
 
_
 
as
 
™
's mostly used in‡ specialized form,‡s::

47 
ÿnûÎ©iÚ_pošt
 = 
funùoŞs
.
	`·¹Ÿl
(
_ÿnûÎ©iÚ_pošt
,

48 
Ïmbda
: 
qu™_cÚd™iÚ
 =ğ
True
)

50 @
·¿m
 
‹¡_funùiÚ
: 
the
 
funùiÚ
 
to
 
‹¡
 
befÜe
 
ÿnûÎšg


52 
	$‹¡_funùiÚ
():

53 
¿i£
 
IÁ”ru±ed


	@tools/keyring.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
	gŒy
:

18 
äom
 
gi
.
»pos™Üy
 
impÜt
 
GnomeKeyršg


19 
exû±
 
ImpÜtE¼Ü
:

20 
GnomeKeyršg
 = 
NÚe


22 
äom
 
GTG
.
toŞs
.
bÜg
 
impÜt
 
BÜg


23 
äom
 
GTG
.
toŞs
.
logg”
 
impÜt
 
Log


26 
şass
 
	$GNOMEKeyršg
(
BÜg
):

28 
def
 
	$__š™__
(
£lf
):

29 
	`su³r
(
Keyršg
, 
£lf
).
	$__š™__
()

30 
nÙ
 
	`ha§‰r
(
£lf
, "keyring"):

31 
»suÉ
, 
£lf
.
keyršg
 = 
GnomeKeyršg
.
	$g‘_deçuÉ_keyršg_sync
()

32 
»suÉ
 !ğ
GnomeKeyršg
.
ResuÉ
.
OK
:

33 
¿i£
 
	`Exû±iÚ
("Cª'ˆg‘ deçuÉ keyršg,ƒ¼Ü=%s" % 
»suÉ
)

35 
def
 
	`£t_·sswÜd
(
£lf
, 
Çme
, 
·sswÜd
, 
u£rid
=""):

36 
©Œs
 = 
GnomeKeyršg
.
A‰ribu‹
.
	$li¡_Ãw
()

37 
GnomeKeyršg
.
A‰ribu‹
.
	`li¡_­³nd_¡ršg
(
©Œs
, "back’d", 
Çme
)

38 
»suÉ
, 
·sswÜd_id
 = 
GnomeKeyršg
.
	$™em_ü—‹_sync
(

39 
£lf
.
keyršg
,

40 
GnomeKeyršg
.
I‹mTy³
.
GENERIC_SECRET
,

41 
Çme
,

42 
©Œs
,

43 
·sswÜd
,

44 
True
)

46 
»suÉ
 !ğ
GnomeKeyršg
.
ResuÉ
.
OK
:

47 
¿i£
 
	`Exû±iÚ
("Cª'ˆü—‹‡‚ew…asswÜd,ƒ¼Ü=%s" % 
»suÉ
)

49  
·sswÜd_id


51 
def
 
	$g‘_·sswÜd
(
£lf
, 
™em_id
):

52 
»suÉ
, 
™em_šfo
 = 
GnomeKeyršg
.
	$™em_g‘_šfo_sync
(

53 
£lf
.
keyršg
, 
™em_id
)

54 
»suÉ
 =ğ
GnomeKeyršg
.
ResuÉ
.
OK
:

55  
™em_šfo
.
	$g‘_£ü‘
()

60 
şass
 
	$F®lbackKeyršg
(
BÜg
):

62 
def
 
	$__š™__
(
£lf
):

63 
	`su³r
(
Keyršg
, 
£lf
).
	$__š™__
()

64 
nÙ
 
	`ha§‰r
(
£lf
, "keyring"):

65 
£lf
.
keyršg
 = {
	}
}

66 
£lf
.
max_key
 = 1

68 
def
 
£t_·sswÜd
(
£lf
, 
Çme
, 
·sswÜd
, 
u£rid
=""):

70 
It
 
is
 
th”e
 
beÿu£
 
of
 
GNOMEKeyršg
 """

72 #Fšd 
unu£d
 
key


73 
£lf
.
max_key
 
š
 s–f.
keyršg
:

74 
£lf
.
max_key
 += 1

76 
£lf
.
keyršg
[£lf.
max_key
] = 
·sswÜd


77  
£lf
.
max_key


79 
def
 
	$g‘_·sswÜd
(
£lf
, 
key
):

80  
£lf
.
keyršg
.
	`g‘
(
key
, "")

82 
GnomeKeyršg
 
is
 
nÙ
 
NÚe
:

83 
Keyršg
 = 
GNOMEKeyršg


85 
Log
.
	`šfo
("GNOME keyring was‚ot found,…asswords will be‚ot stored‡fter\
 of GTG")

87 
Keyršg
 = 
F®lbackKeyršg


	@tools/logger.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
GTG
 
moduËs
 
ªd
 
¶ugšs
 
th©
 
wish
 
to
 
u£
 
loggšg
 
should
 
impÜt
 
the
 
Log
 
	gobjeù
::

20 
äom
 
GTG
.
toŞs
.
logg”
 
impÜt
 
Log


22 ...
ªd
 
rg‘
 
™
 
w™h
 
debug
 
Ü
 
šfo
 
mes§ges
::

24 
Log
.
debug
('Something has goneerribly wrong!')

27 
impÜt
 
loggšg


30 
şass
 
	$Debug
(
objeù
):

33 
def
 
	$__š™__
(
£lf
):

35 #Ià
we
 
®»ady
 
have
 
a
 
logg”
, w
k“p
 
th©


36 
nÙ
 
	`ha§‰r
(
Debug
, "__logger"):

37 
£lf
.
	$__š™_logg”
()

39 #thi 
is
 
a
 
SšgËtÚ
.

40 
£lf
.
__diù__
['_Debug__logg”'] = 
Debug
.
__logg”


41 
£lf
.
debuggšg_mode
 = 
F®£


43 
def
 
	$__š™_logg”
(
£lf
):

44 
Debug
.
__logg”
 = 
loggšg
.
	`g‘Logg”
('gtg_logger')

45 #£ˆ
a
 
¡»am
 
hªdËr
 
debuggšg


46 
ch
 = 
loggšg
.
	$SŒ—mHªdËr
()

47 
ch
.
	$£tLev–
(
loggšg
.
DEBUG
)

48 
fÜm©‹r
 = 
loggšg
.
	`FÜm©‹r
("%(asctime)s - %(levelname)s - " +

51 
ch
.
	$£tFÜm©‹r
(
fÜm©‹r
)

52 
Debug
.
__logg”
.
	$addHªdËr
(
ch
)

54 
def
 
	$__g‘©Œ__
(
£lf
, 
©Œ
):

56  
	$g‘©Œ
(
Debug
.
__logg”
, 
©Œ
)

58 
def
 
	$__£‰r__
(
£lf
, 
©Œ
, 
v®ue
):

60  
	$£‰r
(
Debug
.
__logg”
, 
©Œ
, 
v®ue
)

62 
def
 
	$£t_debuggšg_mode
(
£lf
, 
v®ue
):

63 
£lf
.
debuggšg_mode
 = 
v®ue


65 
def
 
	$is_debuggšg_mode
(
£lf
):

66  
£lf
.
debuggšg_mode


68 #Th
sšgËtÚ
 
™£lf


69 
Log
 = 
	`Debug
()

	@tools/networkmanager.py

1 #!/
u¤
/
bš
/
’v
 
pythÚ3


2 #-*- 
codšg
: 
utf
-8 -*-

4 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


5 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


6 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


7 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


8 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


10 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


11 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


12 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


14 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


15 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

20 
äom
 
	ggi
.
»pos™Üy
 
impÜt
 
	gN‘wÜkMªag”
, 
NMCl›Á


23 
def
 
	$is_cÚÃùiÚ_up
():

25 
¡©e
 = 
NMCl›Á
.
	`Cl›Á
().
	$g‘_¡©e
()

26  
¡©e
 =ğ
N‘wÜkMªag”
.
S‹
.
CONNECTED_GLOBAL


28 
__Çme__
 == "__main__":

29 
	`´št
("is_cÚÃùiÚ_up(è=ğ%s" % 
	`is_cÚÃùiÚ_up
())

	@tools/shortcut.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
impÜt
 
sub´oûss


18 
impÜt
 
»


19 
impÜt
 
shËx


22 
	gCHECK_GSETTINGS_PRESENCE
 = "which gsettings"

23 
CHECK_VERSION
 = "gsettings†ist-keys " \

25 
NEW_TASK_ACTION
 = "gtg_new_task"

26 
NEW_TASK_NAME
 = "GTG New Task"

27 
GSETTINGS_GET_LIST
 = "gsettings get " \

30 
GSETTINGS_SET_LIST
 = "gsettings set " \

33 
GSETTINGS_GET
 = "gsettings get " \

38 
GSETTINGS_SET
 = "gsettings set " \

43 
GCONF_GET
 = "gconftool-2 --get /desktop/gnome/keybindings/custom"

44 
GCONF_SET
 = "gconftool-2 --type string --set /desktop/gnome/keybindings/custom"

47 
def
 
	$is_g£‰šgs_´e£Á
():

48  
	`boŞ
(
	$ÿÎ_sub´oûss
(
CHECK_GSETTINGS_PRESENCE
))

51 
def
 
	$g‘_§ved_bšdšg
():

53 
li¡_keys
 = 
	`ÿÎ_sub´oûss
(
CHECK_VERSION
).
	$¥l™lšes
()

54 "cu¡om-keybšdšgs" 
š
 
li¡_keys
:

55 
bšdšg
 = 
	$g‘_shÜtcut_äom_dcÚf
()

57 
bšdšg
 = 
	$g‘_shÜtcut_äom_gcÚf
()

58  
bšdšg


61 
def
 
	$g‘_shÜtcut_äom_dcÚf
():

63 
dcÚf_out
 = 
	$ÿÎ_sub´oûss
(
GSETTINGS_GET_LIST
)

64 
cu¡om_shÜtcuts_li¡
 = 
»
.
	`fšd®l
(
r
'\d+', 
dcÚf_out
)

66 
’Œy
 
š
 
cu¡om_shÜtcuts_li¡
:

67 
g‘_cmd
 = 
	`ÿÎ_sub´oûss
(
GSETTINGS_GET
, 
’Œy
, "/ command")

69 
NEW_TASK_ACTION
 
š
 
g‘_cmd
:

70 
g‘_bšd
 = 
	`ÿÎ_sub´oûss
(
GSETTINGS_GET
, 
’Œy
, "/ binding")

71  
g‘_bšd
.
	`¡r
("\'\n")

72  
NÚe


75 
def
 
	$g‘_shÜtcut_äom_gcÚf
():

77 
™em
 = 0

78 
True
:

79 
g‘_aùiÚ
 = 
	`ÿÎ_sub´oûss
(
GCONF_GET
, 
	`¡r
(
™em
), "/action")

81 
NEW_TASK_ACTION
 
š
 
g‘_aùiÚ
:

82 
g‘_bšd
 = 
	`ÿÎ_sub´oûss
(
GCONF_GET
, 
	`¡r
(
™em
), "/binding")

83  
g‘_bšd
.
	`r¡r
("\n")

85 
–if
 
g‘_aùiÚ
 == "":

86 
g‘_Çme
 = 
	`ÿÎ_sub´oûss
(
GCONF_GET
, 
	`¡r
(
™em
), "/name")

87 
g‘_Çme
 == "":

88  
NÚe


89 
™em
 += 1

92 
def
 
	$§ve_Ãw_bšdšg
(
bšdšg
, 
bu‰Ú_¡©e
):

94 
bu‰Ú_¡©e
:

95 
li¡_keys
 = 
	`ÿÎ_sub´oûss
(
CHECK_VERSION
).
	$¥l™lšes
()

96 "cu¡om-keybšdšgs" 
š
 
li¡_keys
:

97 
	$add_shÜtcut_to_dcÚf
(
bšdšg
)

99 
	$add_shÜtcut_to_gcÚf
(
bšdšg
)

102 
def
 
	$add_shÜtcut_to_dcÚf
(
bšdšg
):

104 
dcÚf_out
 = 
	$ÿÎ_sub´oûss
(
GSETTINGS_GET_LIST
)

105 
cu¡om_keys
 = 
»
.
	`fšd®l
(
r
'\d+', 
dcÚf_out
)

106 
a
 = []

108 
’Œy
 
š
 
cu¡om_keys
:

109 
g‘_cmd
 = 
	`ÿÎ_sub´oûss
(
GSETTINGS_GET
, 
’Œy
, "/ command")

111 
NEW_TASK_ACTION
 
š
 
g‘_cmd
:

112 
	`ÿÎ_sub´oûss
(
GSETTINGS_SET
, 
’Œy
, "/ bšdšg", 
bšdšg
)

114 
a
.
	`­³nd
((
’Œy
))

116 
a
 == []:

117 
šdex
 = 0

119 
a
.
	$sÜt
()

120 
šdex
 = 
a
[-1] + 1

121 
­³nd_this
 = "['/org/gnome/settings-daemon/plugins/media-keys/" \

122 "cu¡om-keybšdšgs/cu¡om" + 
	`¡r
(
šdex
) + "/']"

123 
	`ÿÎ_sub´oûss
(
GSETTINGS_SET
, 
	`¡r
(
šdex
), "/ commªd", 
NEW_TASK_ACTION
)

124 
	`ÿÎ_sub´oûss
(
GSETTINGS_SET
, 
	`¡r
(
šdex
), "/ bšdšg", 
bšdšg
)

125 
	`ÿÎ_sub´oûss
(
GSETTINGS_SET
, 
	`¡r
(
šdex
), "/‚ame", 
NEW_TASK_NAME
)

127 
šdex
 == 0:

128 
	`ÿÎ_sub´oûss
(
GSETTINGS_SET_LIST
, 
key
=' ' + 
­³nd_this
)

131 
»suÉ_li¡
 = 
dcÚf_out
[:-2] + ", " + 
­³nd_this
[1:]

132 
	$ÿÎ_sub´oûss
(
GSETTINGS_SET_LIST
, 
to_­³nd
=
»suÉ_li¡
)

135 
def
 
	$add_shÜtcut_to_gcÚf
(
bšdšg
):

137 
™em
 = 0

138 
True
:

139 
g‘_aùiÚ
 = 
	`ÿÎ_sub´oûss
(
GCONF_GET
, 
	`¡r
(
™em
), "/action")

141 
NEW_TASK_ACTION
 
š
 
g‘_aùiÚ
:

142 
	`ÿÎ_sub´oûss
(
GCONF_SET
, 
	`¡r
(
™em
), "/bšdšg", 
bšdšg
)

145 
g‘_aùiÚ
 == "":

146 
	`ÿÎ_sub´oûss
(
GCONF_SET
, 
	`¡r
(
™em
), "/aùiÚ", 
NEW_TASK_ACTION
)

147 
	`ÿÎ_sub´oûss
(
GCONF_SET
, 
	`¡r
(
™em
), "/bšdšg", 
bšdšg
)

148 
	`ÿÎ_sub´oûss
(
GCONF_SET
, 
	`¡r
(
™em
), "/Çme", 
NEW_TASK_NAME
)

150 
™em
 += 1

153 
def
 
	`ÿÎ_sub´oûss
(
cmd
, 
i
="", 
key
="", 
to_­³nd
=
NÚe
):

155 'cmd' 
hŞds
 
the
 
commªd
 
to
 
acûss
h
cÚfigu¿tiÚ
 
d©aba£
,

156 'i' 
acûs£s
 
a
 
cu¡om
 
shÜtcut
,

157 'key' 
acûs£s
 
v®ues
 
šside
 
the
 
shÜtcut
,

158 'to_­³nd' 
cÚšs
 
the
 
Ãw
 
v®ue
 
to
 
»¶aû
 
ªy
 """

159 
cmd
 = 
shËx
.
	`¥l™
(cmd + 
i
 + 
key
)

160 
to_­³nd
 
is
 
nÙ
 
NÚe
:

161 
cmd
.
	$­³nd
(
to_­³nd
)

162 
out
 = 
sub´oûss
.
	$Pİ’
(
cmd
, 
¡dout
=
sub´oûss
.
PIPE
, 
¡d”r
=subprocess.PIPE)

163  
out
.
	`communiÿ‹
()[0].
	`decode
('ascii')

166 
def
 
	$check_šv®id™y
(
bšdšg
, 
key
, 
mods
):

168 
mods
 == 0:

169 ià(
key
 >ğ97 
ªd
 key <= 122):

170 #key 
is
 
ª
 
®phab‘


172 
	`–if
 (
key
 >ğ48 
ªd
 key <= 57):

173 #key 
is
 
a
 
numb”


175 
	`–if
 (
key
 >ğ65361 
ªd
 key <= 65364):

176 #key 
is
 
Úe
 
of
 
the
 
¬row
 
keys


178 
–if
 
key
 == 32:

179 #key 
is
 'space'

	@tools/tags.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
impÜt
 
»


20 
def
 
	$exŒaù_gs_äom_‹xt
(
‹xt
):

22  
»
.
	`fšd®l
(
r
'(?:^|[\s])(@[\w\/\.\-\:\&]*\w)', 
‹xt
)

25 
def
 
	$·r£_g_li¡
(
‹xt
):

27 
pos™ive
 
Ü
 
nÙ
 
by
 
´•’dšg
 '!'.

29 @
·¿m
 
‹xt
: 
¡ršg
 
’Œy
 
äom
 
u£r


30 @: 
li¡
 
of
 
	`tuµËs
 (
g
, 
is_pos™ive
)

32 
»suÉ
 = []

33 
g
 
š
 
‹xt
.
	$¥l™
():

34 
g
.
	`¡¬tsw™h
('!'):

35 
g
 =ag[1:]

36 
is_pos™ive
 = 
F®£


38 
is_pos™ive
 = 
True


40 
nÙ
 
g
.
	`¡¬tsw™h
('@'):

41 
g
 = "@" +ag

43 
»suÉ
.
	`­³nd
((
g
, 
is_pos™ive
))

44  
»suÉ


	@tools/taskxml.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 #FunùiÚ 
to
 
cÚv”t
 
a
 
Task
 
objeù
Ø
ª
 
XML
 
¡ršg
 
ªd
 
back


18 
impÜt
 
	gxml
.
	gdom
.
mšidom
 
as
 minidom

19 
impÜt
 
	gxml
.
	g§x
.
§xuts
 
as
 saxutils

20 
äom
 
d©‘ime
 
impÜt
 datetime

22 
äom
 
	gGTG
.
toŞs
 
impÜt
 
ş—nxml


23 
äom
 
	gGTG
.
	gtoŞs
.
d©es
 
impÜt
 
D©e


26 
def
 
	$g‘_‹xt
(
node
):

27 
	`Ën
(
node
.
chdNodes
) > 0:

28  
node
.
fœ¡Chd
.
nodeV®ue
.
	$¡r
()

33 
def
 
	$»ad_node
(
xmÊode
, 
Çme
):

34 
node_li¡
 = 
xmÊode
.
	$g‘EËm’tsByTagName
(
Çme
)

35 
	`Ën
(
node_li¡
) > 0:

36  
	$g‘_‹xt
(
node_li¡
[0])

41 #Tak
ª
 
em±y
 
sk
,‡À
XML
 
node
 
ªd
  
a
 
Task
.

43 
def
 
	$sk_äom_xml
(
sk
, 
xmÊode
):

45 #´šˆ
xmÊode
.
	`tİ»‰yxml
()

47 
sk
.
	`£t_uuid
(
xmÊode
.
	`g‘A‰ribu‹
("uuid"))

48 
sk
.
	`£t_t™Ë
(
	`»ad_node
(
xmÊode
, "title"))

50 
¡©us
 = 
xmÊode
.
	`g‘A‰ribu‹
("status")

51 
dÚed©e
 = 
D©e
.
	`·r£
(
	`»ad_node
(
xmÊode
, "donedate"))

52 
sk
.
	$£t_¡©us
(
¡©us
, 
dÚed©e
=donedate)

54 
dued©e
 = 
	`D©e
(
	`»ad_node
(
xmÊode
, "duedate"))

55 
sk
.
	$£t_due_d©e
(
dued©e
)

57 
¡¬td©e
 = 
	`D©e
(
	`»ad_node
(
xmÊode
, "startdate"))

58 
sk
.
	$£t_¡¬t_d©e
(
¡¬td©e
)

60 
modif›d
 = 
	`»ad_node
(
xmÊode
, "modified")

61 
modif›d
 != "":

62 
modif›d
 = 
d©‘ime
.
	`¡½time
(modified, "%Y-%m-%dT%H:%M:%S")

63 
sk
.
	$£t_modif›d
(
modif›d
)

65 
gs
 = 
xmÊode
.
	`g‘A‰ribu‹
("gs").
	`»¶aû
(' ', '')

66 
gs
 = (
g
 g 
š
ags.
	`¥l™
(','èg.
	`¡r
() != "")

67 
g
 
š
 
gs
:

68 #FIXME 
why
 
uÃsÿ³
????

69 
sk
.
	`g_added
(
§xuts
.
	$uÃsÿ³
(
g
))

71 #FIXME 
why
 
we
 
Ãed
 
to
 
cÚv”t
 
th©
 
through
 
ª
 
XML
?

72 
cÚ‹Á
 = 
	`»ad_node
(
xmÊode
, "content")

73 
cÚ‹Á
 != "":

74 
cÚ‹Á
 = "<content>%s</content>" % content

75 
cÚ‹Á
 = 
mšidom
.
	`·r£SŒšg
(cÚ‹Á).
fœ¡Chd
.
	$toxml
()

76 
sk
.
	$£t_‹xt
(
cÚ‹Á
)

78 
subsk
 
š
 
xmÊode
.
	`g‘EËm’tsByTagName
("subtask"):

79 
sk
.
	`add_chd
(
	$g‘_‹xt
(
subsk
))

81 
©Œ
 
š
 
xmÊode
.
	`g‘EËm’tsByTagName
("attribute"):

82 
	`Ën
(
©Œ
.
chdNodes
) > 0:

83 
v®ue
 = 
	$g‘_‹xt
(
©Œ
)

85 
v®ue
 = ""

86 
key
 = 
©Œ
.
	`g‘A‰ribu‹
("key")

87 
Çme¥aû
 = 
©Œ
.
	`g‘A‰ribu‹
("namespace")

88 
sk
.
	$£t_©Œibu‹
(
key
, 
v®ue
, 
Çme¥aû
=namespace)

90 #FIXME dØ
we
 
Ãed
 
»mÙe
 
sk
 
ids
? 
I
 
dÚ
'think so

91 #FIXME 
so
 => 
»wÜk
 
them
 
što
 
a
 
mÜe
 
u§bË
 
¡ruùu»
!!!

92 #(
like
 
©Œibu‹s
)

93 #REMOTE 
TASK
 
IDS


95 
»mÙe_ids_li¡
 = 
xmÊode
.
	`g‘EËm’tsByTagName
("task-remote-ids")

96 
»mÙe_id
 
š
 
»mÙe_ids_li¡
:

97 
»mÙe_id
.
chdNodes
:

98 
node
 = 
»mÙe_id
.
chdNodes
[0]

99 
back’d_id
 = 
node
.
fœ¡Chd
.
nodeV®ue


100 
»mÙe_sk_id
 = 
node
.
chdNodes
[1].
fœ¡Chd
.
nodeV®ue


101 
sk
.
	`add_»mÙe_id
(
back’d_id
, 
»mÙe_sk_id
)

104  
sk


106 #FIXME 
maybe
 
´‘ty
 
XML
 
should
 
be
 
’ough
 
this
...

107 #Task 
as
 
·¿m‘”
 
the
 
doc
 
wh”e
 
to
 
put
h
XML
 
node


110 
def
 
	$sk_to_xml
(
doc
, 
sk
):

111 
t_xml
 = 
doc
.
	`ü—‹EËm’t
("task")

112 
t_xml
.
	`£tA‰ribu‹
("id", 
sk
.
	$g‘_id
())

113 
t_xml
.
	`£tA‰ribu‹
("¡©us", 
sk
.
	$g‘_¡©us
())

114 
t_xml
.
	`£tA‰ribu‹
("uuid", 
sk
.
	$g‘_uuid
())

115 
gs_¡r
 = ""

116 
g
 
š
 
sk
.
	$g‘_gs_Çme
():

117 
gs_¡r
 =ags_¡¸+ 
§xuts
.
	`esÿ³
(
	`¡r
(
g
)) + ","

118 
t_xml
.
	`£tA‰ribu‹
("gs", 
gs_¡r
[:-1])

119 
ş—nxml
.
	`addTextNode
(
doc
, 
t_xml
, "t™Ë", 
sk
.
	$g‘_t™Ë
())

120 
ş—nxml
.
	`addTextNode
(
doc
, 
t_xml
, "dued©e", 
sk
.
	`g‘_due_d©e
().
	$xml_¡r
())

121 
ş—nxml
.
	`addTextNode
(
doc
, 
t_xml
, "modif›d", 
sk
.
	$g‘_modif›d_¡ršg
())

122 
ş—nxml
.
	`addTextNode
(
doc
, 
t_xml
, "startdate",

123 
sk
.
	`g‘_¡¬t_d©e
().
	$xml_¡r
())

124 
ş—nxml
.
	`addTextNode
(
doc
, 
t_xml
, "donedate",

125 
sk
.
	`g‘_şo£d_d©e
().
	$xml_¡r
())

126 
chds
 = 
sk
.
	$g‘_chd»n
()

127 
c
 
š
 
chds
:

128 
ş—nxml
.
	`addTextNode
(
doc
, 
t_xml
, "subsk", 
c
)

129 
a
 
š
 
sk
.
©Œibu‹s
:

130 
Çme¥aû
, 
key
 = 
a


131 
cÚ‹Á
 = 
sk
.
©Œibu‹s
[
a
]

132 
–em’t
 = 
doc
.
	`ü—‹EËm’t
('attribute')

133 
–em’t
.
	`£tA‰ribu‹
("Çme¥aû", 
Çme¥aû
)

134 
–em’t
.
	`£tA‰ribu‹
("key", 
key
)

135 
–em’t
.
	`­³ndChd
(
doc
.
	$ü—‹TextNode
(
cÚ‹Á
))

136 
t_xml
.
	$­³ndChd
(
–em’t
)

137 
‹x
 = 
sk
.
	$g‘_‹xt
()

138 
‹x
:

139 #W
ke
 
the
 
xml
 
‹xt
 
ªd
 
cÚv”t
 
™
 
to
 
a
 
¡ršg


140 #buˆ
w™hout
 
the
 "<content />"

141 
–em’t
 = 
mšidom
.
	$·r£SŒšg
(
‹x
)

142 
‹mp
 = 
–em’t
.
fœ¡Chd
.
	`toxml
().
	`·¹™iÚ
("<content>")[2]

144 
desc
 = 
‹mp
.
	`·¹™iÚ
("</content>")[0]

145 #t_xml.
	`­³ndChd
(
–em’t
.
fœ¡Chd
)

146 
ş—nxml
.
	`addTextNode
(
doc
, 
t_xml
, "cÚ‹Á", 
desc
)

147 #£lf.
	`__wr™e_‹xŠode
(
doc
,
t_xml
,"cÚ‹Á",
t
.
	`g‘_‹xt
())

149 #REMOTE 
TASK
 
IDS


150 
»mÙe_ids_–em’t
 = 
doc
.
	`ü—‹EËm’t
("task-remote-ids")

151 
t_xml
.
	$­³ndChd
(
»mÙe_ids_–em’t
)

152 
»mÙe_ids_diù
 = 
sk
.
	$g‘_»mÙe_ids
()

153 
back’d_id
, 
sk_id
 
š
 
»mÙe_ids_diù
.
	$™ems
():

154 
back’d_–em’t
 = 
doc
.
	`ü—‹EËm’t
('backend')

155 
»mÙe_ids_–em’t
.
	$­³ndChd
(
back’d_–em’t
)

156 
back’d_–em’t
.
	`­³ndChd
(
doc
.
	$ü—‹TextNode
(
back’d_id
))

157 
sk_–em’t
 = 
doc
.
	`ü—‹EËm’t
('task-id')

158 
back’d_–em’t
.
	$­³ndChd
(
sk_–em’t
)

159 
sk_–em’t
.
	`­³ndChd
(
doc
.
	$ü—‹TextNode
(
sk_id
))

161  
t_xml


	@tools/twokeydict.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
CÚšs
 
	gTwoKeyDiù
, 
a
 
DiùiÚ¬y
 
which
 
®so
 
has
‡ 
£cÚd¬y
 
	gkey


21 
äom
 
	gGTG
.
	gtoŞs
.
bidiù
 
impÜt
 
BiDiù


24 
şass
 
	$TwoKeyDiù
(
objeù
):

26 
It
's‡ standard Dictionary with‡ secondary key.

27 
FÜ
 
exam¶e
, 
you
 
ÿn
 
add
 
ª
 
	`–em’t
 ('2', 'II', 
two
'), wherehe

28 
fœ¡
 
two
 
¬gum’ts
 
¬e
 
keys
 
ªd
 
the
 
thœd
 
is
h
¡Üed
 
objeù
,‡nd 
acûss


29 
™
 
as
::

30 
twokey
['2'] ==> 'two'

31 
twokey
['II'] ==> 'two'

32 
You
 
ÿn
 
®so
 
»que¡
 
the
 
Ùh”
 
key
, 
giv’
 
Úe
.

33 
FunùiÚ
 
ÿÎs
 
¡¬t
 
w™h
 
_
 
beÿu£
 
you
'll…robably wanto„enamehem

34 
wh’
 
you
 
u£
 
this
 
diùiÚ¬y
, 
the
 
§ke
 
of
 
ş¬™y
.

37 
def
 
	$__š™__
(
£lf
, *
ŒËts
):

39 
C»©es
 
the
 
TwoKeyDiù
 
ªd
 
İtiÚ®ly
 
pİuÏ‹s
 
™
 
w™h
 
some
 
d©a


41 @
·¿m
 
ŒËts
: 
tu¶es
 
pİuÏtšg
 
the
 
TwoKeyDiù
. 
FÜm©
:

42 ((
key1
, 
key2
, 
d©a_to_¡Üe
), ...)

44 
	`su³r
(
TwoKeyDiù
, 
£lf
).
	$__š™__
()

45 
£lf
.
_key_to_key_bidiù
 = 
	$BiDiù
()

46 
£lf
.
_´im¬y_to_v®ue
 = {
	}
}

47 
ŒËt
 
š
 
ŒËts
:

48 
£lf
.
	$add
(
ŒËt
)

50 
def
 
	$add
(
£lf
, 
ŒËt
):

52 
Adds
 
a
 
Ãw
 
ŒËt
 
to
 
the
 
TwoKeyDiù


54 @
·¿m
 
ŒËt
: 
a
 
tu¶e
 
fÜm©‹d
 
like
 
this
:

55 (
key1
, 
key2
, 
d©a_to_¡Üe
)

57 
£lf
.
_key_to_key_bidiù
.
	`add
((
ŒËt
[0],riplet[1]))

58 
£lf
.
_´im¬y_to_v®ue
[
ŒËt
[0]] =riplet[2]

60 
def
 
	$_g‘_by_´im¬y
(
£lf
, 
´im¬y
):

62 
G‘s
 
the
 
¡Üed
 
d©a
 
giv’
h
´im¬y
 
key


64 @
·¿m
 
´im¬y
: 
the
…rim¬y 
key


65 @
»tuºs
 
objeù
: 
the
 
¡Üed
 object

67  
£lf
.
_´im¬y_to_v®ue
[
´im¬y
]

69 
def
 
	$_g‘_by_£cÚd¬y
(
£lf
, 
£cÚd¬y
):

71 
G‘s
 
the
 
¡Üed
 
d©a
 
giv’
h
£cÚd¬y
 
key


73 @
·¿m
 
£cÚd¬y
: 
the
 
´im¬y
 
key


74 @
»tuºs
 
objeù
: 
the
 
¡Üed
 object

76 
´im¬y
 = 
£lf
.
_key_to_key_bidiù
.
	$_g‘_by_£cÚd
(
£cÚd¬y
)

77  
£lf
.
	$_g‘_by_´im¬y
(
´im¬y
)

79 
def
 
	$_»move_by_´im¬y
(
£lf
, 
´im¬y
):

81 
Removes
 
a
 
ŒËt
 
giv’
 
the
 
½im¬y
 
key
.

83 @
·¿m
 
´im¬y
: 
the
…rim¬y 
key


85 
d–
 
£lf
.
_´im¬y_to_v®ue
[
´im¬y
]

86 
£lf
.
_key_to_key_bidiù
.
	$_»move_by_fœ¡
(
´im¬y
)

88 
def
 
	$_»move_by_£cÚd¬y
(
£lf
, 
£cÚd¬y
):

90 
Removes
 
a
 
ŒËt
 
giv’
 
the
 
½im¬y
 
key
.

92 @
·¿m
 
£cÚd¬y
: 
the
 
´im¬y
 
key


94 
´im¬y
 = 
£lf
.
_key_to_key_bidiù
.
	$_g‘_by_£cÚd
(
£cÚd¬y
)

95 
£lf
.
	$_»move_by_´im¬y
(
´im¬y
)

97 
def
 
	$_g‘_£cÚd¬y_key
(
£lf
, 
´im¬y
):

99 
G‘s
 
the
 
£cÚd¬y
 
key
 
giv’
h
´im¬y


101 @
·¿m
 
´im¬y
: 
the
…rim¬y 
key


102 @
»tuºs
 
objeù
: 
the
 
£cÚd¬y
 
key


104  
£lf
.
_key_to_key_bidiù
.
	$_g‘_by_fœ¡
(
´im¬y
)

106 
def
 
	$_g‘_´im¬y_key
(
£lf
, 
£cÚd¬y
):

108 
G‘s
 
the
 
´im¬y
 
key
 
giv’
h
£cÚd¬y


110 @
·¿m
 
£cÚd¬y
: 
the
 secÚd¬y 
key


111 @
»tuºs
 
objeù
: 
the
 
´im¬y
 
key


113  
£lf
.
_key_to_key_bidiù
.
	$_g‘_by_£cÚd
(
£cÚd¬y
)

115 
def
 
	$_g‘_®l_´im¬y_keys
(
£lf
):

117 
R‘uºs
 
®l
 
´im¬y
 
keys


119 @
»tuºs
 
li¡
:†i¡ 
of
 
®l
 
´im¬y
 
keys


121  
£lf
.
_key_to_key_bidiù
.
	$_g‘_®l_fœ¡
()

123 
def
 
	$_g‘_®l_£cÚd¬y_keys
(
£lf
):

125 
R‘uºs
 
®l
 
£cÚd¬y
 
keys


127 @
»tuºs
 
li¡
:†i¡ 
of
 
®l
 
£cÚd¬y
 
keys


129  
£lf
.
_key_to_key_bidiù
.
	`_g‘_®l_£cÚd
()

	@tools/urlregex.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

18 
D‘eùs
 
u¾s
 
usšg
 
»gex


20 
Ba£d
 
Ú


21 
	gh‰ps
:

24 
impÜt
 
»


26 
UTF_CHARS
 = 
r
'a-z0-9_\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff'

28 
SUBST_DICT
 = {

29 "´e": 
r
'(?:[^/"\':!=]|^|\:)',

30 "domaš": 
r
'([\.-]|[^\s_\!\.\/])+\.[a-z]{2,}(?::[0-9]+)?',

31 "·th": 
r
'(?:[\.,]?[%s!\*\'\(\);:&=\+\$/%s#\[\]\-_,~@])' % (

32 
UTF_CHARS
, '%'),

33 "qu”y": 
r
'[a-z0-9!\*\'\(\);:&=\+\$/%#\[\]\-_\.,~]',

34 #V®id 
’d
-
of
-
·th
 
ch¬aù”s
 (
so
 /
foo
. 
dÛs
 
nÙ
 
gobbË
 
the
 
³riod
).

35 "·th_’d": 
r
'[%s\)=#/]' % 
UTF_CHARS
,

39 
HTTP_URI
 = '((%(pre)s)((https?://|www\\.)(%(domain)s)(\/%(path)s*' \

40 '%Õ©h_’d)s?)?(\?%(qu”y)s*%(qu”y_’d)s)?))' % 
SUBST_DICT


41 
FILE_URI
 = '(fe:///(%Õ©h)s*%Õ©h_’d)s?)?)' % 
SUBST_DICT


43 
URL_REGEX
 = 
»
.
compe
('%s|%s' % (
HTTP_URI
, 
FILE_URI
),„e.
IGNORECASE
)

46 
def
 
	$m©ch
(
‹xt
):

47  
»
.
	`m©ch
(
URL_REGEX
, 
‹xt
)

	@tools/watchdog.py

1 #-*- 
codšg
: 
utf
-8 -*-

3 #G‘tšg 
Thšgs
 
GNOME
! - 
a
 
³rsÚ®
 
Ügªiz”
 
the
 GNOME 
desktİ


4 #Cİyrighˆ(
c
è2008-2013 - 
LiÚ–
 
DricÙ
 & 
B”Œªd
 
Rous£au


5 #
#Thi 
´og¿m
 
is
 
ä“
 
soáw¬e
: 
you
 
ÿn
 
»di¡ribu‹
 
™
 
ªd
/
Ü
 
modify
 iˆ
und”


6 #th
‹rms
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
as
 
published
 
by
h
F»e
 
Soáw¬e


7 #Found©iÚ, 
e™h”
 
v”siÚ
 3 
of
 
the
 
Liûn£
, 
Ü
 (
©
 
your
 
İtiÚ
è
ªy
 
Ï‹r


9 #
#Thi 
´og¿m
 
is
 
di¡ribu‹d
 
š
 
the
 
hİe
 
th©
 
™
 
wl
 
be
 
u£ful
, 
but
 
WITHOUT


10 #ANY 
WARRANTY
; 
w™hout
 
ev’
 
the
 
im¶›d
 
w¬¿Áy
 
of
 
MERCHANTABILITY
 
Ü
 
FITNESS


11 #FOR 
A
 
PARTICULAR
 
PURPOSE
. 
S“
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
mÜe


13 #
#You 
should
 
have
 
»ûived
 
a
 
cİy
 
of
 
the
 
GNU
 
G’”®
 
Public
 
Liûn£
 
®Úg
 
w™h


14 #thi 
´og¿m
. 
If
 
nÙ
, 
£e
 <
h‰p
:

17 
impÜt
 
th»adšg


20 
şass
 
	$W©chdog
(
objeù
):

22 
a
 
sim¶e
 
th»ad
-
§ã
 
w©chdog
.

23 
u§ge
::

24 
w™h
 
	$W©chdod
(
timeout
, 
”rÜ_funùiÚ
):

25 #dØ
som‘hšg


28 
def
 
	$__š™__
(
£lf
, 
timeout
, 
”rÜ_funùiÚ
):

30 
Ju¡
 
£ts
 
the
 
timeout
 
ªd
h
funùiÚ
 
to
 
execu‹
 
wh’
 
ª
 
”rÜ
 
occours


32 @
·¿m
 
timeout
:imeouˆ
š
 
£cÚds


33 @
·¿m
 
”rÜ_funùiÚ
: 
wh©
 
to
 
execu‹
 
š
 
the
 
w©chdog
 
tim”


34 
Œigg”s


36 
£lf
.
timeout
 =imeout

37 
£lf
.
”rÜ_funùiÚ
 =ƒrror_function

39 
def
 
	$__’‹r__
(
£lf
):

41 
£lf
.
tim”
 = 
th»adšg
.
	$Tim”
(
£lf
.
timeout
, s–f.
”rÜ_funùiÚ
)

42 
£lf
.
tim”
.
	$¡¬t
()

44 
def
 
	$__ex™__
(
£lf
, 
ty³
, 
v®ue
, 
Œaûback
):

46 
Œy
:

47 
£lf
.
tim”
.
	$ÿnûl
()

48 
exû±
:

49 
·ss


50 
v®ue
 
is
 
NÚe
:

51  
True


52  
F®£


	@
1
.
1
/usr/include
115
3203
__init__.py
backends/__init__.py
backends/backend_evolution.py
backends/backend_gnote.py
backends/backend_launchpad.py
backends/backend_localfile.py
backends/backend_mantis.py
backends/backend_rtm.py
backends/backend_tomboy.py
backends/backendsignals.py
backends/genericbackend.py
backends/generictomboy.py
backends/periodicimportbackend.py
backends/rtm/__init__.py
backends/rtm/rtm.py
backends/syncengine.py
core/__init__.py
core/datastore.py
core/firstrun_tasks.py
core/plugins/__init__.py
core/plugins/api.py
core/plugins/engine.py
core/requester.py
core/search.py
core/tag.py
core/task.py
core/treefactory.py
gtk/__init__.py
gtk/backends_dialog/__init__.py
gtk/backends_dialog/addpanel.py
gtk/backends_dialog/backendscombo.py
gtk/backends_dialog/backendstree.py
gtk/backends_dialog/configurepanel.py
gtk/backends_dialog/parameters_ui/__init__.py
gtk/backends_dialog/parameters_ui/checkboxui.py
gtk/backends_dialog/parameters_ui/importtagsui.py
gtk/backends_dialog/parameters_ui/passwordui.py
gtk/backends_dialog/parameters_ui/pathui.py
gtk/backends_dialog/parameters_ui/periodui.py
gtk/backends_dialog/parameters_ui/textui.py
gtk/browser/CellRendererTags.py
gtk/browser/__init__.py
gtk/browser/browser.py
gtk/browser/custominfobar.py
gtk/browser/modifytags_dialog.py
gtk/browser/simple_color_selector.py
gtk/browser/tag_context_menu.py
gtk/browser/tag_editor.py
gtk/browser/treeview_factory.py
gtk/colors.py
gtk/crashhandler.py
gtk/dbuswrapper.py
gtk/delete_dialog.py
gtk/editor/__init__.py
gtk/editor/calendar.py
gtk/editor/editor.py
gtk/editor/taskview.py
gtk/editor/taskviewserial.py
gtk/help.py
gtk/manager.py
gtk/plugins.py
gtk/preferences.py
gtk/tag_completion.py
info.py
plugins/__init__.py
plugins/bugzilla/__init__.py
plugins/bugzilla/bug.py
plugins/bugzilla/bugzilla.py
plugins/bugzilla/notification.py
plugins/bugzilla/services.py
plugins/export/__init__.py
plugins/export/export.py
plugins/export/export_templates/description_pocketmod.py
plugins/export/export_templates/description_sexy.py
plugins/export/export_templates/description_simple.py
plugins/export/export_templates/description_statusrpt.py
plugins/export/export_templates/description_textual.py
plugins/export/task_str.py
plugins/export/templates.py
plugins/geolocalized_tasks/__init__.py
plugins/geolocalized_tasks/geolocalized_tasks.py
plugins/geolocalized_tasks/marker.py
plugins/hamster/__init__.py
plugins/hamster/hamster.py
plugins/not_today/__init__.py
plugins/not_today/not_today.py
plugins/notification_area/__init__.py
plugins/notification_area/notification_area.py
plugins/send_email/__init__.py
plugins/send_email/sendEmail.py
plugins/task_reaper/__init__.py
plugins/task_reaper/reaper.py
plugins/tomboy/__init__.py
plugins/tomboy/combobox_enhanced.py
plugins/tomboy/tomboy.py
plugins/untouched_tasks/__init__.py
plugins/untouched_tasks/untouchedTasks.py
plugins/urgency_color/__init__.py
plugins/urgency_color/urgency_color.py
tools/__init__.py
tools/bidict.py
tools/borg.py
tools/cleanxml.py
tools/clipboard.py
tools/dates.py
tools/interruptible.py
tools/keyring.py
tools/logger.py
tools/networkmanager.py
tools/shortcut.py
tools/tags.py
tools/taskxml.py
tools/twokeydict.py
tools/urlregex.py
tools/watchdog.py
